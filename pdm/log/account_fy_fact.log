
20190312134022开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312134022
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;

20190312134317开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312134317
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190312134317
SQL开始执行时间：20190312134317

create temporary table pdm.oa_budget_19_pre as
select *
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190312134317
SQL开始执行时间：20190312134317

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;

20190312134456开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312134456
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190312134456
SQL开始执行时间：20190312134456

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190312134456
SQL开始执行时间：20190312134456

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190312134456
SQL开始执行时间：20190312134456


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190312134457
SQL开始执行时间：20190312134457


create temporary table pdm.account_fy_all as
select a.cdepname
      ,a.u8dykm
      ,a.ccode
      ,a.ccode_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.cdepname = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.cdepname,ccode_lv2

;

20190312134901开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312134901
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190312134901
SQL开始执行时间：20190312134901

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190312134901
SQL开始执行时间：20190312134901

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190312134901
SQL开始执行时间：20190312134901


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190312134901
SQL开始执行时间：20190312134901


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8dykm
      ,a.ccode
      ,a.ccode_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.cdepname,ccode_lv2

;

20190312134943开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312134943
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190312134943
SQL开始执行时间：20190312134943

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190312134943
SQL开始执行时间：20190312134943

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190312134943
SQL开始执行时间：20190312134943


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190312134943
SQL开始执行时间：20190312134943


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8dykm
      ,a.ccode
      ,a.ccode_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,ccode_lv2

;
SQL结束执行时间：20190312134944
SQL开始执行时间：20190312134944

create table pdm.account_fy_fact as
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.ccode,6)
   and a.budgetperiodslist = b.budgetperiodslist

;

20190312135040开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312135040
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190312135040
SQL开始执行时间：20190312135040

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190312135040
SQL开始执行时间：20190312135040

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190312135040
SQL开始执行时间：20190312135040


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190312135040
SQL开始执行时间：20190312135040


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8dykm
      ,a.ccode
      ,a.ccode_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,ccode_lv2

;
SQL结束执行时间：20190312135041
SQL开始执行时间：20190312135041

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190312135041
SQL开始执行时间：20190312135041
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.ccode,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190312135041

20190315001526开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315001526
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190315001526
SQL开始执行时间：20190315001526

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190315001526
SQL开始执行时间：20190315001526

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190315001526
SQL开始执行时间：20190315001526


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190315001526
SQL开始执行时间：20190315001526


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190315001527
SQL开始执行时间：20190315001527

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190315001527
SQL开始执行时间：20190315001527
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190315001527

20190316001519开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316001519
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190316001519
SQL开始执行时间：20190316001519
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190316001520

20190317001517开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317001517
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190317001517
SQL开始执行时间：20190317001517

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190317001517
SQL开始执行时间：20190317001517

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190317001517
SQL开始执行时间：20190317001517


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190317001517
SQL开始执行时间：20190317001517


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190317001518
SQL开始执行时间：20190317001518

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190317001518
SQL开始执行时间：20190317001518
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190317001518

20190318001519开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318001519
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190318001519
SQL开始执行时间：20190318001519

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190318001519
SQL开始执行时间：20190318001519

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190318001519
SQL开始执行时间：20190318001519


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190318001519
SQL开始执行时间：20190318001519


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190318001520
SQL开始执行时间：20190318001520

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190318001520
SQL开始执行时间：20190318001520
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190318001520

20190319001519开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319001519
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190319001519
SQL开始执行时间：20190319001519

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190319001519
SQL开始执行时间：20190319001519

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190319001519
SQL开始执行时间：20190319001519


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190319001519
SQL开始执行时间：20190319001519


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190319001520
SQL开始执行时间：20190319001520

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190319001520
SQL开始执行时间：20190319001520
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190319001520

20190320001521开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320001521
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190320001521
SQL开始执行时间：20190320001521
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190320001522

20190321001521开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321001521
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190321001521
SQL开始执行时间：20190321001521

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190321001521
SQL开始执行时间：20190321001521

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190321001521
SQL开始执行时间：20190321001521


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190321001522
SQL开始执行时间：20190321001522


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190321001522
SQL开始执行时间：20190321001522

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190321001522
SQL开始执行时间：20190321001522
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190321001522

20190322112641开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322112641
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190322112642
SQL开始执行时间：20190322112642
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190322112643

20190323001521开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323001521
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190323001521
SQL开始执行时间：20190323001521

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190323001521
SQL开始执行时间：20190323001521

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190323001521
SQL开始执行时间：20190323001521


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190323001521
SQL开始执行时间：20190323001521


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190323001522
SQL开始执行时间：20190323001522

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190323001522
SQL开始执行时间：20190323001522
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190323001522

20190324001523开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324001523
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190324001523
SQL开始执行时间：20190324001523

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190324001523
SQL开始执行时间：20190324001523

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190324001523
SQL开始执行时间：20190324001523


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190324001524
SQL开始执行时间：20190324001524


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190324001524
SQL开始执行时间：20190324001524

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190324001524
SQL开始执行时间：20190324001524
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190324001524

20190325001515开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325001515
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190325001515
SQL开始执行时间：20190325001515

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190325001515
SQL开始执行时间：20190325001515

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190325001515
SQL开始执行时间：20190325001515


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190325001515
SQL开始执行时间：20190325001515


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190325001516
SQL开始执行时间：20190325001516

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190325001516
SQL开始执行时间：20190325001516
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190325001516

20190326001524开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326001524
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190326001524
SQL开始执行时间：20190326001524

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190326001524
SQL开始执行时间：20190326001524

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190326001524
SQL开始执行时间：20190326001524


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190326001524
SQL开始执行时间：20190326001524


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190326001525
SQL开始执行时间：20190326001525

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190326001525
SQL开始执行时间：20190326001525
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190326001525

20190327001524开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327001524
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190327001524
SQL开始执行时间：20190327001524

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190327001524
SQL开始执行时间：20190327001524

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190327001524
SQL开始执行时间：20190327001524


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190327001524
SQL开始执行时间：20190327001524


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190327001525
SQL开始执行时间：20190327001525

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190327001525
SQL开始执行时间：20190327001525
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190327001525

20190328001519开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328001519
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190328001519
SQL开始执行时间：20190328001519

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190328001519
SQL开始执行时间：20190328001519

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190328001519
SQL开始执行时间：20190328001519


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190328001519
SQL开始执行时间：20190328001519


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190328001520
SQL开始执行时间：20190328001520

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190328001520
SQL开始执行时间：20190328001520
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190328001520

20190329001516开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329001516
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190329001516
SQL开始执行时间：20190329001516

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190329001516
SQL开始执行时间：20190329001516

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190329001516
SQL开始执行时间：20190329001516


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190329001516
SQL开始执行时间：20190329001516


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190329001517
SQL开始执行时间：20190329001517

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190329001517
SQL开始执行时间：20190329001517
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190329001517

20190330001516开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330001516
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190330001516
SQL开始执行时间：20190330001516

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190330001516
SQL开始执行时间：20190330001516

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190330001516
SQL开始执行时间：20190330001516


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190330001516
SQL开始执行时间：20190330001516


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190330001517
SQL开始执行时间：20190330001517

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190330001517
SQL开始执行时间：20190330001517
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190330001517

20190331001514开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331001514
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190331001514
SQL开始执行时间：20190331001514

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190331001514
SQL开始执行时间：20190331001514

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190331001514
SQL开始执行时间：20190331001514


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190331001514
SQL开始执行时间：20190331001514


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190331001515
SQL开始执行时间：20190331001515

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190331001515
SQL开始执行时间：20190331001515
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190331001515

20190401001517开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401001517
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190401001517
SQL开始执行时间：20190401001517

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190401001517
SQL开始执行时间：20190401001517

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190401001517
SQL开始执行时间：20190401001517


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190401001517
SQL开始执行时间：20190401001517


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190401001518
SQL开始执行时间：20190401001518

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190401001518
SQL开始执行时间：20190401001518
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190401001518

20190402001523开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402001523
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190402001523
SQL开始执行时间：20190402001523
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190402001524

20190403001529开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403001529
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190403001529
SQL开始执行时间：20190403001529
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190403001530

20190404135127开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404135127
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190404135127
SQL开始执行时间：20190404135127
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190404135128

20190405001527开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405001527
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190405001527
SQL开始执行时间：20190405001527

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190405001527
SQL开始执行时间：20190405001527

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190405001527
SQL开始执行时间：20190405001527


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190405001527
SQL开始执行时间：20190405001527


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190405001528
SQL开始执行时间：20190405001528

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190405001528
SQL开始执行时间：20190405001528
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190405001528

20190406001520开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406001520
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190406001520
SQL开始执行时间：20190406001520

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190406001520
SQL开始执行时间：20190406001520

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190406001520
SQL开始执行时间：20190406001520


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190406001520
SQL开始执行时间：20190406001520


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190406001521
SQL开始执行时间：20190406001521

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190406001521
SQL开始执行时间：20190406001521
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190406001521

20190407001526开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407001526
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190407001526
SQL开始执行时间：20190407001526

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190407001526
SQL开始执行时间：20190407001526

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190407001526
SQL开始执行时间：20190407001526


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190407001526
SQL开始执行时间：20190407001526


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190407001527
SQL开始执行时间：20190407001527

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190407001527
SQL开始执行时间：20190407001527
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190407001527

20190408001518开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408001518
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190408001518
SQL开始执行时间：20190408001518

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190408001518
SQL开始执行时间：20190408001518

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190408001518
SQL开始执行时间：20190408001518


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190408001518
SQL开始执行时间：20190408001518


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190408001519
SQL开始执行时间：20190408001519

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190408001519
SQL开始执行时间：20190408001519
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190408001519

20190409001528开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409001528
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190409001528
SQL开始执行时间：20190409001528

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190409001528
SQL开始执行时间：20190409001528

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190409001528
SQL开始执行时间：20190409001528


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190409001528
SQL开始执行时间：20190409001528


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190409001529
SQL开始执行时间：20190409001529

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190409001529
SQL开始执行时间：20190409001529
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190409001529

20190410001524开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410001524
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190410001524
SQL开始执行时间：20190410001524

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190410001524
SQL开始执行时间：20190410001524

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190410001524
SQL开始执行时间：20190410001524


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190410001524
SQL开始执行时间：20190410001524


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190410001525
SQL开始执行时间：20190410001525

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190410001525
SQL开始执行时间：20190410001525
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190410001525

20190411001529开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411001529
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190411001530
SQL开始执行时间：20190411001530
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190411001531

20190412001532开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412001532
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190412001532
SQL开始执行时间：20190412001532

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190412001532
SQL开始执行时间：20190412001532

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190412001532
SQL开始执行时间：20190412001532


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190412001532
SQL开始执行时间：20190412001532


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190412001533
SQL开始执行时间：20190412001533

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190412001533
SQL开始执行时间：20190412001533
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190412001533

20190413001525开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413001525
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190413001525
SQL开始执行时间：20190413001525

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190413001525
SQL开始执行时间：20190413001525

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190413001525
SQL开始执行时间：20190413001525


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190413001525
SQL开始执行时间：20190413001525


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190413001526
SQL开始执行时间：20190413001526

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190413001526
SQL开始执行时间：20190413001526
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190413001526

20190414001531开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414001531
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190414001531
SQL开始执行时间：20190414001531

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190414001531
SQL开始执行时间：20190414001531

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190414001531
SQL开始执行时间：20190414001531


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190414001531
SQL开始执行时间：20190414001531


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190414001532
SQL开始执行时间：20190414001532

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190414001532
SQL开始执行时间：20190414001532
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190414001532

20190415001516开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415001516
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190415001516
SQL开始执行时间：20190415001516

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190415001516
SQL开始执行时间：20190415001516

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190415001516
SQL开始执行时间：20190415001516


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190415001516
SQL开始执行时间：20190415001516


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190415001517
SQL开始执行时间：20190415001517

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190415001517
SQL开始执行时间：20190415001517
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190415001517

20190416001523开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416001523
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190416001523
SQL开始执行时间：20190416001523

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190416001523
SQL开始执行时间：20190416001523

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190416001523
SQL开始执行时间：20190416001523


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190416001523
SQL开始执行时间：20190416001523


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190416001524
SQL开始执行时间：20190416001524

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190416001524
SQL开始执行时间：20190416001524
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190416001525

20190417001526开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417001526
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190417001527
SQL开始执行时间：20190417001527
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190417001528

20190418001521开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418001521
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190418001521
SQL开始执行时间：20190418001521

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190418001521
SQL开始执行时间：20190418001521

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190418001521
SQL开始执行时间：20190418001521


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190418001521
SQL开始执行时间：20190418001521


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190418001522
SQL开始执行时间：20190418001522

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190418001522
SQL开始执行时间：20190418001522
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190418001523

20190419001518开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419001518
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190419001518
SQL开始执行时间：20190419001518

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190419001518
SQL开始执行时间：20190419001518

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190419001518
SQL开始执行时间：20190419001518


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190419001518
SQL开始执行时间：20190419001518


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190419001519
SQL开始执行时间：20190419001519

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190419001519
SQL开始执行时间：20190419001519
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190419001519

20190420001527开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420001527
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190420001527
SQL开始执行时间：20190420001527

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190420001527
SQL开始执行时间：20190420001527

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190420001527
SQL开始执行时间：20190420001527


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190420001527
SQL开始执行时间：20190420001527


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190420001528
SQL开始执行时间：20190420001528

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190420001528
SQL开始执行时间：20190420001528
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190420001528

20190421001523开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421001523
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190421001523
SQL开始执行时间：20190421001523

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190421001523
SQL开始执行时间：20190421001523

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190421001523
SQL开始执行时间：20190421001523


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190421001523
SQL开始执行时间：20190421001523


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190421001524
SQL开始执行时间：20190421001524

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190421001524
SQL开始执行时间：20190421001524
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190421001524

20190422001518开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422001518
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190422001518
SQL开始执行时间：20190422001518

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190422001518
SQL开始执行时间：20190422001518

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190422001518
SQL开始执行时间：20190422001518


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190422001518
SQL开始执行时间：20190422001518


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190422001519
SQL开始执行时间：20190422001519

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190422001519
SQL开始执行时间：20190422001519
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190422001519

20190423001532开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423001532
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190423001532
SQL开始执行时间：20190423001532

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190423001532
SQL开始执行时间：20190423001532

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190423001532
SQL开始执行时间：20190423001532


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190423001532
SQL开始执行时间：20190423001532


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190423001533
SQL开始执行时间：20190423001533

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190423001533
SQL开始执行时间：20190423001533
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190423001533

20190424001542开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424001542
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190424001542
SQL开始执行时间：20190424001542

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190424001542
SQL开始执行时间：20190424001542

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190424001542
SQL开始执行时间：20190424001542


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190424001542
SQL开始执行时间：20190424001542


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190424001543
SQL开始执行时间：20190424001543

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190424001543
SQL开始执行时间：20190424001543
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190424001543

20190425001526开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425001526
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190425001526
SQL开始执行时间：20190425001526

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190425001527
SQL开始执行时间：20190425001527

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190425001527
SQL开始执行时间：20190425001527


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190425001527
SQL开始执行时间：20190425001527


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190425001527
SQL开始执行时间：20190425001527

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190425001527
SQL开始执行时间：20190425001527
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190425001528

20190426001531开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426001531
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190426001531
SQL开始执行时间：20190426001531

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190426001531
SQL开始执行时间：20190426001531

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190426001531
SQL开始执行时间：20190426001531


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190426001531
SQL开始执行时间：20190426001531


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190426001532
SQL开始执行时间：20190426001532

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190426001532
SQL开始执行时间：20190426001532
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190426001533

20190427001531开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427001531
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190427001531
SQL开始执行时间：20190427001531

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190427001531
SQL开始执行时间：20190427001531

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190427001531
SQL开始执行时间：20190427001531


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190427001531
SQL开始执行时间：20190427001531


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190427001532
SQL开始执行时间：20190427001532

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190427001532
SQL开始执行时间：20190427001532
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190427001533

20190429091430开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429091430
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190429091430
SQL开始执行时间：20190429091430

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190429091430
SQL开始执行时间：20190429091430

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190429091430
SQL开始执行时间：20190429091430


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190429091430
SQL开始执行时间：20190429091430


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190429091431
SQL开始执行时间：20190429091431

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190429091431
SQL开始执行时间：20190429091431
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190429091432

20190430001539开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430001539
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190430001539
SQL开始执行时间：20190430001539

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190430001540
SQL开始执行时间：20190430001540

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190430001540
SQL开始执行时间：20190430001540


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190430001540
SQL开始执行时间：20190430001540


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190430001541
SQL开始执行时间：20190430001541

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190430001541
SQL开始执行时间：20190430001541
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190430001541

20190501001543开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501001543
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190501001543
SQL开始执行时间：20190501001543

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190501001543
SQL开始执行时间：20190501001543

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190501001543
SQL开始执行时间：20190501001543


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190501001543
SQL开始执行时间：20190501001543


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190501001544
SQL开始执行时间：20190501001544

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190501001544
SQL开始执行时间：20190501001544
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190501001545

20190502001545开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502001545
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190502001545
SQL开始执行时间：20190502001545

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190502001545
SQL开始执行时间：20190502001545

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190502001545
SQL开始执行时间：20190502001545


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190502001545
SQL开始执行时间：20190502001545


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190502001546
SQL开始执行时间：20190502001546

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190502001546
SQL开始执行时间：20190502001546
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190502001547

20190503001530开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503001530
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190503001530
SQL开始执行时间：20190503001530

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190503001530
SQL开始执行时间：20190503001530

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190503001530
SQL开始执行时间：20190503001530


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190503001530
SQL开始执行时间：20190503001530


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190503001531
SQL开始执行时间：20190503001531

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190503001531
SQL开始执行时间：20190503001531
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190503001532

20190504001532开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504001532
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190504001532
SQL开始执行时间：20190504001532

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190504001532
SQL开始执行时间：20190504001532

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190504001532
SQL开始执行时间：20190504001532


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190504001532
SQL开始执行时间：20190504001532


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190504001533
SQL开始执行时间：20190504001533

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190504001533
SQL开始执行时间：20190504001533
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190504001533

20190505001517开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505001517
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190505001518
SQL开始执行时间：20190505001518

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190505001518
SQL开始执行时间：20190505001518

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190505001518
SQL开始执行时间：20190505001518


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190505001518
SQL开始执行时间：20190505001518


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190505001519
SQL开始执行时间：20190505001519

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190505001519
SQL开始执行时间：20190505001519
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190505001519

20190506001740开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506001740
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190506001740
SQL开始执行时间：20190506001740

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190506001740
SQL开始执行时间：20190506001740

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190506001740
SQL开始执行时间：20190506001740


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190506001740
SQL开始执行时间：20190506001740


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;

20190506085135开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506085135
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190506085135
SQL开始执行时间：20190506085135

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190506085135
SQL开始执行时间：20190506085135

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190506085135
SQL开始执行时间：20190506085135


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190506085135
SQL开始执行时间：20190506085135


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190506085136
SQL开始执行时间：20190506085136

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190506085136
SQL开始执行时间：20190506085136
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190506085136

20190507001752开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507001752
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190507001752
SQL开始执行时间：20190507001752

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190507001752
SQL开始执行时间：20190507001752

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190507001752
SQL开始执行时间：20190507001752


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190507001752
SQL开始执行时间：20190507001752


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190507001753
SQL开始执行时间：20190507001753

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190507001753
SQL开始执行时间：20190507001753
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190507001754

20190508001752开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508001752
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190508001752
SQL开始执行时间：20190508001752

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190508001752
SQL开始执行时间：20190508001752

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190508001752
SQL开始执行时间：20190508001752


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190508001752
SQL开始执行时间：20190508001752


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190508001753
SQL开始执行时间：20190508001753

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190508001753
SQL开始执行时间：20190508001753
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190508001753

20190510002331开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510002331
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190510002332
SQL开始执行时间：20190510002332

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190510002332
SQL开始执行时间：20190510002332

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190510002332
SQL开始执行时间：20190510002332


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190510002332
SQL开始执行时间：20190510002332


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190510002333
SQL开始执行时间：20190510002333

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190510002333
SQL开始执行时间：20190510002333
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190510002333

20190511002334开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511002334
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190511002334
SQL开始执行时间：20190511002334

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190511002335
SQL开始执行时间：20190511002335

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190511002335
SQL开始执行时间：20190511002335


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190511002335
SQL开始执行时间：20190511002335


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190511002336
SQL开始执行时间：20190511002336

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190511002336
SQL开始执行时间：20190511002336
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190511002336

20190512002335开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512002335
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190512002335
SQL开始执行时间：20190512002335

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190512002335
SQL开始执行时间：20190512002335

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190512002335
SQL开始执行时间：20190512002335


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190512002335
SQL开始执行时间：20190512002335


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190512002336
SQL开始执行时间：20190512002336

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190512002336
SQL开始执行时间：20190512002336
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190512002337

20190513002336开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513002336
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190513002336
SQL开始执行时间：20190513002336

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190513002336
SQL开始执行时间：20190513002336

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190513002336
SQL开始执行时间：20190513002336


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190513002336
SQL开始执行时间：20190513002336


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190513002337
SQL开始执行时间：20190513002337

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190513002337
SQL开始执行时间：20190513002337
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190513002338

20190514002350开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514002350
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190514002350
SQL开始执行时间：20190514002350

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190514002350
SQL开始执行时间：20190514002350

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190514002350
SQL开始执行时间：20190514002350


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190514002350
SQL开始执行时间：20190514002350


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190514002351
SQL开始执行时间：20190514002351

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190514002351
SQL开始执行时间：20190514002351
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190514002352

20190515002403开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515002403
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190515002403
SQL开始执行时间：20190515002403

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190515002404
SQL开始执行时间：20190515002404

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190515002404
SQL开始执行时间：20190515002404


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190515002404
SQL开始执行时间：20190515002404


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190515002405
SQL开始执行时间：20190515002405

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190515002405
SQL开始执行时间：20190515002405
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190515002405

20190516002420开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516002420
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190516002420
SQL开始执行时间：20190516002420

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190516002420
SQL开始执行时间：20190516002420

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190516002420
SQL开始执行时间：20190516002420


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190516002420
SQL开始执行时间：20190516002420


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190516002421
SQL开始执行时间：20190516002421

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190516002421
SQL开始执行时间：20190516002421
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190516002422

20190517002434开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517002434
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190517002434
SQL开始执行时间：20190517002434

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190517002434
SQL开始执行时间：20190517002434

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190517002434
SQL开始执行时间：20190517002434


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190517002434
SQL开始执行时间：20190517002434


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190517002435
SQL开始执行时间：20190517002435

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190517002435
SQL开始执行时间：20190517002435
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190517002436

20190518002432开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518002432
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190518002432
SQL开始执行时间：20190518002432

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190518002432
SQL开始执行时间：20190518002432

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190518002432
SQL开始执行时间：20190518002432


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190518002432
SQL开始执行时间：20190518002432


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190518002433
SQL开始执行时间：20190518002433

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190518002433
SQL开始执行时间：20190518002433
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190518002434

20190519002438开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519002438
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190519002439
SQL开始执行时间：20190519002439

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190519002439
SQL开始执行时间：20190519002439

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190519002439
SQL开始执行时间：20190519002439


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190519002439
SQL开始执行时间：20190519002439


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190519002440
SQL开始执行时间：20190519002440

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190519002440
SQL开始执行时间：20190519002440
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190519002440

20190520002442开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520002442
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190520002442
SQL开始执行时间：20190520002442

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190520002442
SQL开始执行时间：20190520002442

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190520002442
SQL开始执行时间：20190520002442


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190520002442
SQL开始执行时间：20190520002442


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190520002443
SQL开始执行时间：20190520002443

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190520002443
SQL开始执行时间：20190520002443
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190520002444

20190521002455开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521002455
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190521002455
SQL开始执行时间：20190521002455

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190521002455
SQL开始执行时间：20190521002455

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190521002455
SQL开始执行时间：20190521002455


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190521002455
SQL开始执行时间：20190521002455


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190521002456
SQL开始执行时间：20190521002456

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190521002456
SQL开始执行时间：20190521002456
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190521002457

20190522002459开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522002459
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190522002459
SQL开始执行时间：20190522002459

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190522002459
SQL开始执行时间：20190522002459

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190522002459
SQL开始执行时间：20190522002459


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190522002500
SQL开始执行时间：20190522002500


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190522002500
SQL开始执行时间：20190522002500

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190522002501
SQL开始执行时间：20190522002501
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190522002501

20190523002503开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523002503
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190523002504
SQL开始执行时间：20190523002504

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190523002504
SQL开始执行时间：20190523002504

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190523002504
SQL开始执行时间：20190523002504


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190523002504
SQL开始执行时间：20190523002504


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190523002505
SQL开始执行时间：20190523002505

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190523002505
SQL开始执行时间：20190523002505
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190523002505

20190524002505开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524002505
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190524002505
SQL开始执行时间：20190524002505

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190524002506
SQL开始执行时间：20190524002506

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190524002506
SQL开始执行时间：20190524002506


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190524002506
SQL开始执行时间：20190524002506


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190524002507
SQL开始执行时间：20190524002507

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190524002507
SQL开始执行时间：20190524002507
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190524002507

20190525002522开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525002522
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190525002522
SQL开始执行时间：20190525002522

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190525002522
SQL开始执行时间：20190525002522

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190525002522
SQL开始执行时间：20190525002522


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190525002523
SQL开始执行时间：20190525002523


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190525002523
SQL开始执行时间：20190525002523

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190525002524
SQL开始执行时间：20190525002524
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190525002524

20190526002527开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526002527
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190526002527
SQL开始执行时间：20190526002527

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190526002527
SQL开始执行时间：20190526002527

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190526002527
SQL开始执行时间：20190526002527


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190526002527
SQL开始执行时间：20190526002527


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190526002528
SQL开始执行时间：20190526002528

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190526002528
SQL开始执行时间：20190526002528
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190526002529

20190527002537开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527002537
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190527002537
SQL开始执行时间：20190527002537

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190527002537
SQL开始执行时间：20190527002537

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190527002538
SQL开始执行时间：20190527002538


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190527002538
SQL开始执行时间：20190527002538


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190527002539
SQL开始执行时间：20190527002539

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190527002539
SQL开始执行时间：20190527002539
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190527002539

20190528002540开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528002540
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190528002540
SQL开始执行时间：20190528002540

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190528002540
SQL开始执行时间：20190528002540

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190528002541
SQL开始执行时间：20190528002541


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190528002541
SQL开始执行时间：20190528002541


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190528002542
SQL开始执行时间：20190528002542

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190528002542
SQL开始执行时间：20190528002542
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190528002542

20190529002654开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529002654
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190529002655
SQL开始执行时间：20190529002655

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190529002655
SQL开始执行时间：20190529002655

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190529002655
SQL开始执行时间：20190529002655


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190529002655
SQL开始执行时间：20190529002655


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190529002656
SQL开始执行时间：20190529002656

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190529002656
SQL开始执行时间：20190529002656
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190529002656

20190530002613开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530002613
create temporary table pdm.oa_budget_19_person as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,case when cast((budgetperiodslist-1)/3 as SIGNED) = 0 then 1
            when cast((budgetperiodslist-1)/3 as SIGNED) = 1 then 4
            when cast((budgetperiodslist-1)/3 as SIGNED) = 2 then 7
            when cast((budgetperiodslist-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(budgetaccount) as budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is not null
   and budgetperiodslist is not null
 group by person,cast((budgetperiodslist-1)/3 as SIGNED),name
;
SQL结束执行时间：20190530002613
SQL开始执行时间：20190530002613

create temporary table pdm.oa_budget_19_pre as
select budgetinfoid
      ,cdepname_lv1
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,person
      ,name_ehr as budget_depnam
      ,name
      ,u8kemubm
      ,cdlx
      ,budgetperiodslist
      ,budgetaccount
      ,createdate
      ,approverid
      ,createrid
      ,budgetremark
      ,fnaincrement
      ,remark
  from edw.oa_budget_19
 where cdepname_lv1 is null
   and person is  null
   and budgetperiodslist in ('1','4','7','10')

;
SQL结束执行时间：20190530002613
SQL开始执行时间：20190530002613

insert into pdm.oa_budget_19_pre
select *
  from pdm.oa_budget_19_person
 where budgetperiodslist is not null
   and budgetaccount is not null

;
SQL结束执行时间：20190530002613
SQL开始执行时间：20190530002613


create temporary table pdm.oa_budget_19_pre1 as
select budgetinfoid
      ,cdepname_lv2
      ,cdepname_lv3
      ,cdepname_lv4
      ,cdepname_lv5
      ,cdepname_lv6
      ,budget_depnam
      ,name
      ,u8kemubm
      ,sum(budgetaccount) as budgetaccount
      ,budgetperiodslist
  from pdm.oa_budget_19_pre
 group by budget_depnam,budgetperiodslist,name
;
SQL结束执行时间：20190530002613
SQL开始执行时间：20190530002613


create temporary table pdm.account_fy_all as
select a.name_u8
      ,a.u8_kemu
      ,a.u8_code
      ,a.u8_code_name
      ,case when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 0 then 1
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 1 then 4
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 2 then 7
            when cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED) = 3 then 10
            end as budgetperiodslist
      ,sum(a.md) as md
  from pdm.account_fy a
  left join edw.dic_oa_u8_dept b
    on a.name_u8 = b.true_dept
 where dbill_date >= '2019-01-01'
 group by cast((select SUBSTR(a.dbill_date,6,2)-1)/3 as SIGNED),a.name_u8,u8_code_lv2

;
SQL结束执行时间：20190530002614
SQL开始执行时间：20190530002614

truncate table pdm.account_fy_fact
;
SQL结束执行时间：20190530002614
SQL开始执行时间：20190530002614
insert into pdm.account_fy_fact
select a.budgetinfoid
      ,a.cdepname_lv2
      ,a.cdepname_lv3
      ,a.cdepname_lv4
      ,a.cdepname_lv5
      ,a.cdepname_lv6
      ,a.budget_depnam
      ,a.name
      ,a.budgetperiodslist
      ,a.budgetaccount
      ,b.md
      ,a.budgetaccount - b.md as surplus_amount 
  from pdm.oa_budget_19_pre1 a
  left join pdm.account_fy_all b
    on a.budget_depnam = b.name_u8
   and left(a.u8kemubm,6) = left(b.u8_code,6)
   and a.budgetperiodslist = b.budgetperiodslist

;
SQL结束执行时间：20190530002615
