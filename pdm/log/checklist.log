
20190410030133å¼€å§‹æ‰§è¡Œ2019-04-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410030133

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410030133
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410030133
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190411142304å¼€å§‹æ‰§è¡Œ2019-04-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142304

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142304
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142304
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190411142509å¼€å§‹æ‰§è¡Œ2019-04-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142509

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142509
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142509
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142511
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142511


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142512
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142512

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142512
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142512

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142512
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142512

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142512

20190411142619å¼€å§‹æ‰§è¡Œ2019-04-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142619

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142619
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142619
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142621
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142621


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142622
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142622

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142622
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142622

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142622
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142622

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142622

20190412030133å¼€å§‹æ‰§è¡Œ2019-04-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030133

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030133
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030133
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030135
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030135


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030136

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030136

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030136

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030136

20190413030133å¼€å§‹æ‰§è¡Œ2019-04-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030133

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030133
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030133
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030135
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030135


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030136

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030136

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030136

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030136

20190414030136å¼€å§‹æ‰§è¡Œ2019-04-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030136

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030136
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030138
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030138


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030139

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030139

20190415030136å¼€å§‹æ‰§è¡Œ2019-04-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030136

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030136
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030138
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030138


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030139

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030139

20190416030138å¼€å§‹æ‰§è¡Œ2019-04-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030138

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030138
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030138
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030140


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030141

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030141

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030141

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030141

20190417030136å¼€å§‹æ‰§è¡Œ2019-04-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030136

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030136
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030136
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030139


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030139

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030139

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030139

20190418030138å¼€å§‹æ‰§è¡Œ2019-04-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030138

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030138
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030138
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030141


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030141

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030141

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030141

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030141

20190419030142å¼€å§‹æ‰§è¡Œ2019-04-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030142

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030142
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030144


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030145

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030145

20190420030137å¼€å§‹æ‰§è¡Œ2019-04-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030137

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030137
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030137
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030139


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030140

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030140

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030140

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030140

20190421030138å¼€å§‹æ‰§è¡Œ2019-04-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030138

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030138
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030138
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030141


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030141

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030141

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030142

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030142

20190422030139å¼€å§‹æ‰§è¡Œ2019-04-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030139

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030140
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030142


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030143

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030143

20190423030139å¼€å§‹æ‰§è¡Œ2019-04-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030139

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030139
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030139
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030141


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030142

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030142

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030142

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030142

20190424030140å¼€å§‹æ‰§è¡Œ2019-04-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030140

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030140
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030142


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030143

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030143

20190425030140å¼€å§‹æ‰§è¡Œ2019-04-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030140

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030140
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030140
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030142


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030143

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030143

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030143

20190426030142å¼€å§‹æ‰§è¡Œ2019-04-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030142

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030142
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030144


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030145

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030145

20190427030141å¼€å§‹æ‰§è¡Œ2019-04-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030141

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030141
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030143


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030144

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030144

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030144

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030144

20190428030142å¼€å§‹æ‰§è¡Œ2019-04-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030142

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030142
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030145


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030145

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030146
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030146

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030146

20190429030142å¼€å§‹æ‰§è¡Œ2019-04-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030142

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030142
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030142
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030144


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030145

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030145

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030145

20190430030141å¼€å§‹æ‰§è¡Œ2019-04-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030141

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030141
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030141
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030143


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030144

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030144

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030144
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030144

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030144

20190501030145å¼€å§‹æ‰§è¡Œ2019-04-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030145

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030145
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030145
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030147
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030147


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030148
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030148

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030148
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030148

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030148
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030148

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030148

20190502030147å¼€å§‹æ‰§è¡Œ2019-05-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030147

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030147
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030147
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030150


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030150

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030151

20190503030147å¼€å§‹æ‰§è¡Œ2019-05-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030147

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030147
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030147
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030150


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030150

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030151

20190504030147å¼€å§‹æ‰§è¡Œ2019-05-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030148

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030148
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030148
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030150


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030151

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030151

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030151

20190505030150å¼€å§‹æ‰§è¡Œ2019-05-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030150

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030150
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030150
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030152
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030152


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030153
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030153

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030153
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030153

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030153
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030153

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030153

20190506030152å¼€å§‹æ‰§è¡Œ2019-05-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030152

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030152
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030152
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030154


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030155

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030155

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030155

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030156

20190507030151å¼€å§‹æ‰§è¡Œ2019-05-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030151

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030151
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030154


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030154

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030154

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030155

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030155

20190508030152å¼€å§‹æ‰§è¡Œ2019-05-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030152

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030152
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030152
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030154


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030155

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030155

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030155

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030155

20190510030202å¼€å§‹æ‰§è¡Œ2019-05-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030202

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030202
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030205
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030205


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030205
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030205

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030205
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030205

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030206

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030206

20190511030154å¼€å§‹æ‰§è¡Œ2019-05-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030154

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030154
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030157


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030157

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030158

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030158

20190512030155å¼€å§‹æ‰§è¡Œ2019-05-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030155

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030155
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030155
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030157


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030158

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030158

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030158

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030158

20190513030154å¼€å§‹æ‰§è¡Œ2019-05-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030154

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030154
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030154
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030156


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030157

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030157

20190514030200å¼€å§‹æ‰§è¡Œ2019-05-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030202


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030203

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,case when a.hzfs = 'è‡ªå»º' then 'äº§å“ç±»' else 'LDT' end
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030203

20190515030159å¼€å§‹æ‰§è¡Œ2019-05-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515030159

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515030159
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190515095911å¼€å§‹æ‰§è¡Œ2019-05-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515095911

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515095911
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515095911
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190515101111å¼€å§‹æ‰§è¡Œ2019-05-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101111

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101111
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101113


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101114

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515101114

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515101114

20190516030156å¼€å§‹æ‰§è¡Œ2019-05-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030156

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030156
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030159

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030159

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030159

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030159

20190517030157å¼€å§‹æ‰§è¡Œ2019-05-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030157

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030157
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030157


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030158

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030158

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030158

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030158

20190518030156å¼€å§‹æ‰§è¡Œ2019-05-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030156

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030156
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030156


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030157

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030157

20190519030156å¼€å§‹æ‰§è¡Œ2019-05-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030156

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030156
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030156


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030156

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030156

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030157

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030157

20190520030201å¼€å§‹æ‰§è¡Œ2019-05-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030201

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030201
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030201


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030202

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030202

20190521030157å¼€å§‹æ‰§è¡Œ2019-05-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030157

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030157
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030200

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030200

20190522030157å¼€å§‹æ‰§è¡Œ2019-05-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030157

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030157
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030200

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030200

20190523030156å¼€å§‹æ‰§è¡Œ2019-05-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030156

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030156
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030200

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030200

20190524030156å¼€å§‹æ‰§è¡Œ2019-05-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030156

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030156
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030159

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030159

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030200

20190525030157å¼€å§‹æ‰§è¡Œ2019-05-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030157

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030157
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030159


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030200

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030200

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030200

20190526030157å¼€å§‹æ‰§è¡Œ2019-05-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030157

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030157
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030200


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030201

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030201

20190527030158å¼€å§‹æ‰§è¡Œ2019-05-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030158

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030158
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030201


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030202

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030202

20190528030158å¼€å§‹æ‰§è¡Œ2019-05-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030158

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030158
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030201


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030201

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030201

20190529030200å¼€å§‹æ‰§è¡Œ2019-05-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030203


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030203

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030204
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030204

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030204

20190530030158å¼€å§‹æ‰§è¡Œ2019-05-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030158

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030158
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030200


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030201

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030201

20190531030158å¼€å§‹æ‰§è¡Œ2019-05-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030158

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030158
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030201


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030201

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030202

20190601030200å¼€å§‹æ‰§è¡Œ2019-05-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030203


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030203

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030204
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030204

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030204

20190602030158å¼€å§‹æ‰§è¡Œ2019-06-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030158

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030158
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030201


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030201

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030201

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030202

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030202

20190603030205å¼€å§‹æ‰§è¡Œ2019-06-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030205

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030205
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030205
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030207
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030207


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030208

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030208

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030208

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030208

20190604030200å¼€å§‹æ‰§è¡Œ2019-06-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030203


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030203

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030204
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030204

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030204

20190605030200å¼€å§‹æ‰§è¡Œ2019-06-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030202
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030202


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030203

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030203

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030203

20190606030200å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606030200

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606030200
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190606084723å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606084723

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606084723
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606084723
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190606085330å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085330

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085331
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085331
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'ÇëºË²é' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'ÇëºË²é' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'·ñ'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;

20190606085454å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085454

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085454
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085454
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085457


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085458
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085458

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085458
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085458

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085458
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606085458

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606085458

20190607030205å¼€å§‹æ‰§è¡Œ2019-06-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030205

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030205
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030205
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030207
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030207


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030208

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030208

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030208

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030208

20190608030206å¼€å§‹æ‰§è¡Œ2019-06-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030206

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030206
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030209


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030210

20190609030208å¼€å§‹æ‰§è¡Œ2019-06-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030208

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030208
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030210


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030211
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030211

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030211
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030211

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030211
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030211

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030211

20190610030206å¼€å§‹æ‰§è¡Œ2019-06-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030206

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030206
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030209


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030209

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030209

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030210

20190611030206å¼€å§‹æ‰§è¡Œ2019-06-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030206

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030206
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030209


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030209

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030210

20190612030206å¼€å§‹æ‰§è¡Œ2019-06-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030206

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030206
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030209


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030209

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030210

20190613030206å¼€å§‹æ‰§è¡Œ2019-06-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030206

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030206
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030206
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030209


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030210

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030210

20190614030211å¼€å§‹æ‰§è¡Œ2019-06-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030211

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030211
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030211
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030213


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030214

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030214

20190615030211å¼€å§‹æ‰§è¡Œ2019-06-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030211

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030211
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030211
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030214


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030214

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030215

20190616030210å¼€å§‹æ‰§è¡Œ2019-06-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030210

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030210
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030213


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030213

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030214

20190617030210å¼€å§‹æ‰§è¡Œ2019-06-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030210

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030210
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030213


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030214

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030214

20190618030209å¼€å§‹æ‰§è¡Œ2019-06-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030209

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030209
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030212
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030212


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030213

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030213

20190619030209å¼€å§‹æ‰§è¡Œ2019-06-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030209

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030209
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030212
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030212


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030213

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030213

20190620030213å¼€å§‹æ‰§è¡Œ2019-06-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030213

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030213
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030216
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030216


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030216
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030216

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030216
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030216

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030216
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030216

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030216

20190621030209å¼€å§‹æ‰§è¡Œ2019-06-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030209

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030209
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030212
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030212


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030212
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030212

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030213

20190622030210å¼€å§‹æ‰§è¡Œ2019-06-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030210

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030210
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030213


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030214

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030214

20190623030209å¼€å§‹æ‰§è¡Œ2019-06-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030209

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030209
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030212
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030212


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030213

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030213

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030213

20190624030210å¼€å§‹æ‰§è¡Œ2019-06-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030210

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030210
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030210
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030213


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030214

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_biosan
      ,a.new_cszh
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_biosan > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030214
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030214

insert into pdm.checklist
select a.id
      ,null
      ,a.new_province
      ,a.ownerid
      ,left(a.createdon,10)
      ,null
      ,a.name
      ,left(a.new_finish_time,10)
      ,b.bi_cuscode
      ,b.bi_cusname
      ,null
      ,null
      ,c.bi_item_code
      ,c.bi_item_name
      ,'äº§å“ç±»'
      ,a.new_competitor_number
      ,a.new_cszh
      ,'æ˜¯'
      ,jzds_name
      ,localtimestamp()
   from edw.crm_screening_diagnosises a
   left join (select * from edw.dic_customer group by ccuscode) b
     on a.new_num = b.ccuscode
   left join (select * from edw.dic_item group by item_name) c
     on a.item_mx = c.item_name
 where a.new_competitor_number > 0
   and new_finish_time >= '2019-01-01'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030214

20190625030056å¼€å§‹æ‰§è¡Œ2019-06-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030056

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030056
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030059

20190626030100å¼€å§‹æ‰§è¡Œ2019-06-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030100

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030100
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030102


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030103

20190627030055å¼€å§‹æ‰§è¡Œ2019-06-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030055

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030055
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030058


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030059
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030059

20190628030057å¼€å§‹æ‰§è¡Œ2019-06-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030057

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030057
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030100


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030101

20190629030058å¼€å§‹æ‰§è¡Œ2019-06-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030058

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030058
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030101

20190630030057å¼€å§‹æ‰§è¡Œ2019-06-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030057

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030057
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030100
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030100

20190701030058å¼€å§‹æ‰§è¡Œ2019-06-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030058

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030058
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030101


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030102

20190702030100å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030100

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030100
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030103


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030104

20190702091048å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091048

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091048
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091051


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091052
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091052

20190702091256å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091256

 

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091256
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091256
insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091259
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091259


insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300


insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091300
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091300

20190703030056å¼€å§‹æ‰§è¡Œ2019-07-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030056

 
truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030056

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030057

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030057


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'bkgr'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101

insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030101

20190704030056å¼€å§‹æ‰§è¡Œ2019-07-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030056

 
truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030056

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030057

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030057


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100
insert into pdm.checklist
select null
      ,'bkgr'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100

insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030100

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030101
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030101

20190705030057å¼€å§‹æ‰§è¡Œ2019-07-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030057

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030057

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030058


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030102

20190706030059å¼€å§‹æ‰§è¡Œ2019-07-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030104

20190707030058å¼€å§‹æ‰§è¡Œ2019-07-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030059


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030103

20190708030058å¼€å§‹æ‰§è¡Œ2019-07-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030058


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030102

20190709030058å¼€å§‹æ‰§è¡Œ2019-07-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030059


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030102

20190710030059å¼€å§‹æ‰§è¡Œ2019-07-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030103

20190711030058å¼€å§‹æ‰§è¡Œ2019-07-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030059


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030103

20190712030059å¼€å§‹æ‰§è¡Œ2019-07-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030103

20190713030059å¼€å§‹æ‰§è¡Œ2019-07-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;

20190715090016å¼€å§‹æ‰§è¡Œ2019-07-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090016

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090016

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090017

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090017


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715090021
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715090021

20190716030059å¼€å§‹æ‰§è¡Œ2019-07-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030103

20190717030058å¼€å§‹æ‰§è¡Œ2019-07-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030059


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030103

20190718030058å¼€å§‹æ‰§è¡Œ2019-07-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030059


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030103
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030103

20190719030101å¼€å§‹æ‰§è¡Œ2019-07-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030101

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030101

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030102


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030105
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030106

20190720030058å¼€å§‹æ‰§è¡Œ2019-07-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030058

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030058


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030102

20190721030057å¼€å§‹æ‰§è¡Œ2019-07-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030057

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030057

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030058


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030101


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030102

20190722030059å¼€å§‹æ‰§è¡Œ2019-07-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030103
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030103

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030104

20190723030059å¼€å§‹æ‰§è¡Œ2019-07-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030059

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030059

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030100

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030100


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030103


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030104
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030104

20190724030057å¼€å§‹æ‰§è¡Œ2019-07-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030057

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030057

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030058

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030058


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030102
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030102

20190725030105å¼€å§‹æ‰§è¡Œ2019-07-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030105

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;

20190725090404å¼€å§‹æ‰§è¡Œ2019-07-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090404

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090404
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090404

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090405
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090405

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090405
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090405


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725090408
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725090408

20190726030108å¼€å§‹æ‰§è¡Œ2019-07-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030108

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030112

20190727030103å¼€å§‹æ‰§è¡Œ2019-07-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030107

20190728030103å¼€å§‹æ‰§è¡Œ2019-07-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030103


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030107

20190729030103å¼€å§‹æ‰§è¡Œ2019-07-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030108

20190730030110å¼€å§‹æ‰§è¡Œ2019-07-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030110

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030110

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030110

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030110


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030114


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030114
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030114

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030114






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030114

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030115
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030115

20190731030112å¼€å§‹æ‰§è¡Œ2019-07-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030117

20190801091209å¼€å§‹æ‰§è¡Œ2019-07-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091209

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091209

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091209
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091209


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091213
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091213

20190802030102å¼€å§‹æ‰§è¡Œ2019-08-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030102

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030103


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030107

20190803030107å¼€å§‹æ‰§è¡Œ2019-08-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030112

20190804030107å¼€å§‹æ‰§è¡Œ2019-08-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030112

20190805030108å¼€å§‹æ‰§è¡Œ2019-08-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030108

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030109


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030113

20190806030103å¼€å§‹æ‰§è¡Œ2019-08-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030107


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030108

20190807030103å¼€å§‹æ‰§è¡Œ2019-08-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030108

20190808030103å¼€å§‹æ‰§è¡Œ2019-08-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030108

20190809030102å¼€å§‹æ‰§è¡Œ2019-08-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030102

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030103


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030106


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030107

20190810030109å¼€å§‹æ‰§è¡Œ2019-08-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030109

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030109

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030110

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030110


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030113


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030114

20190811030109å¼€å§‹æ‰§è¡Œ2019-08-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030109

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030109

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030110

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030110


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030114
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030114

20190812030108å¼€å§‹æ‰§è¡Œ2019-08-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030108

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030109

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030109


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030113

20190813030103å¼€å§‹æ‰§è¡Œ2019-08-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030103

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030103

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030104


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030107


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030108
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030108

20190814030101å¼€å§‹æ‰§è¡Œ2019-08-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030101

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030102


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030106
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030106

20190815030104å¼€å§‹æ‰§è¡Œ2019-08-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030109

20190816030102å¼€å§‹æ‰§è¡Œ2019-08-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030102

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030102

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030103


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030106


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030107
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030107

20190817030104å¼€å§‹æ‰§è¡Œ2019-08-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030109

20190820091724å¼€å§‹æ‰§è¡Œ2019-08-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091724

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091724
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091724

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091725
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091725

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091725
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091725


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091729
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091729

20190821030104å¼€å§‹æ‰§è¡Œ2019-08-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030109

20190822030105å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030105

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030106


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030110

20190822170416å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170416

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170416
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170416

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170417
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170417

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170417
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170417


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170421
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170421

20190823030104å¼€å§‹æ‰§è¡Œ2019-08-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030109

20190824030104å¼€å§‹æ‰§è¡Œ2019-08-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030110

20190825030104å¼€å§‹æ‰§è¡Œ2019-08-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030108


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030109

20190826030104å¼€å§‹æ‰§è¡Œ2019-08-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030109

20190827030105å¼€å§‹æ‰§è¡Œ2019-08-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030105

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030106


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030110

20190828030104å¼€å§‹æ‰§è¡Œ2019-08-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030108


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030109

20190829030108å¼€å§‹æ‰§è¡Œ2019-08-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030108

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030109

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030109


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030113

20190830030104å¼€å§‹æ‰§è¡Œ2019-08-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030109

20190831030104å¼€å§‹æ‰§è¡Œ2019-08-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030104

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030104

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030105


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030109
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030109

20190901030106å¼€å§‹æ‰§è¡Œ2019-08-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030106

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030107


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030111

20190902030106å¼€å§‹æ‰§è¡Œ2019-09-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030106

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030107


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030110


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030111

20190903084646å¼€å§‹æ‰§è¡Œ2019-09-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084646

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084646
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084646

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084647
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084647

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084647
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084647


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084651
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084651

20190904030107å¼€å§‹æ‰§è¡Œ2019-09-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030107


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030111

20190905030105å¼€å§‹æ‰§è¡Œ2019-09-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030105

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030105

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030106


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030110
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030110

20190906030106å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030106

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030106

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030107


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030111
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030111

20190906171350å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171350

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171350
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171350

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171351
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171351

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171351
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171351


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171355
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171355


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171355
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171355
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171355
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171355

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171356
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171356

20190907030107å¼€å§‹æ‰§è¡Œ2019-09-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030113

20190908030107å¼€å§‹æ‰§è¡Œ2019-09-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030112

20190909030108å¼€å§‹æ‰§è¡Œ2019-09-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030108

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030109

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030109
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030109


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030113
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030113

20190910030107å¼€å§‹æ‰§è¡Œ2019-09-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030107

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030107

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030108

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030108
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030108


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030112
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030112

20190911030116å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030116

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030116

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030117

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030117


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030121
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030121

20190911163325å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163325

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163325
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163325

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163326
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163326

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163326
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163326


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163330
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163330

20190912030114å¼€å§‹æ‰§è¡Œ2019-09-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030114

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030115

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030115


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030119

20190913030114å¼€å§‹æ‰§è¡Œ2019-09-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030114

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030115

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030115


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030119

20190914030115å¼€å§‹æ‰§è¡Œ2019-09-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030115

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030115

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030116

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030116


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030120

20190915030111å¼€å§‹æ‰§è¡Œ2019-09-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030111

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030111

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030112


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030116

20190916030113å¼€å§‹æ‰§è¡Œ2019-09-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030113

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030114


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030118

20190916142451å¼€å§‹æ‰§è¡Œ2019-09-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142451

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142451
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142451

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142452
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142452

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142452
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142452


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142456
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142456


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142456
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142456
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916142457
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916142457

20190917030112å¼€å§‹æ‰§è¡Œ2019-09-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030117

20190918030113å¼€å§‹æ‰§è¡Œ2019-09-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030113

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030114


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030118


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030118
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030119

20190919030111å¼€å§‹æ‰§è¡Œ2019-09-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030111

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030111
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030111

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030112


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030116
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030116

20190920030112å¼€å§‹æ‰§è¡Œ2019-09-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030117


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030117
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030118

20190921030112å¼€å§‹æ‰§è¡Œ2019-09-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030118

20190922030114å¼€å§‹æ‰§è¡Œ2019-09-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030114

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030115

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030115


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030119

20190923030112å¼€å§‹æ‰§è¡Œ2019-09-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030117
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030117

20190924030114å¼€å§‹æ‰§è¡Œ2019-09-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030114

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030115

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030115
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030115


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030119


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030119
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030120
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030120

20190925030116å¼€å§‹æ‰§è¡Œ2019-09-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030116

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030116

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030117

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030117


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030122

20190926030112å¼€å§‹æ‰§è¡Œ2019-09-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030112

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030112
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030112

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030113


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030117


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926030118
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926030118

20190927030113å¼€å§‹æ‰§è¡Œ2019-09-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030113

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030113
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030113

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030114

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030114
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030114


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030118


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030118
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030118
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927030119
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927030119

20190928030116å¼€å§‹æ‰§è¡Œ2019-09-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030116

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030116

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030117

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030117


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030121


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928030122

20190929030116å¼€å§‹æ‰§è¡Œ2019-09-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030116

truncate table pdm.checklist
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030116
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030116

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.detection_num
      ,a.recall_num
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.detection_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030117

insert into pdm.checklist
select a.autoid
      ,a.db
      ,b.province
      ,a.cverifier
      ,null
      ,null
      ,case when a.feeler_mechanism is not null then a.feeler_mechanism else a.bi_cusname end
      ,a.ddate
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.bi_item_code
      ,a.bi_item_name
      ,a.business_class
      ,a.competitor_num
      ,a.recall_num
      ,'æ˜¯'
      ,competitor
      ,localtimestamp()
  from edw.x_detection_table a
  left join edw.map_customer b
    on a.bi_cuscode = b.bi_cuscode
 where a.competitor_num > 0
   and a.state = 'å–ç”¨'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030117
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030117


insert into pdm.checklist
select min(auto_id)
      ,'bkgr'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_bkgr a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample < '2019-06-01'
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030121
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030121


insert into pdm.checklist
select null
      ,'zysy'
      ,a.province
      ,null
      ,ddate_sampling
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sampling
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_sales_hospital a
 where ddate_sampling >= '2019-06-01'
 group by ddate_sampling,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'bksy'
      ,a.province
      ,null
      ,ddate_sample
      ,a.class_smaple
      ,a.bi_cusname
      ,ddate_sample
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.bi_cinvcode
      ,a.bi_cinvname
      ,a.item_code
      ,a.item_name
      ,a.business_class
      ,count(*) as inum_person
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_bk a
 where ddate_sample >= '2019-06-01'
 group by ddate_sample,bi_cuscode,bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122

insert into pdm.checklist
select min(auto_id)
      ,'wsylb'
      ,b.province
      ,a.person_ori
      ,a.ddate_sample
      ,a.class_smaple
      ,a.company_exp
      ,a.ddate
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when c.bi_cinvcode is not null then c.item_code else 'è¯·æ ¸æŸ¥' end
      ,case when c.bi_cinvcode is not null then c.level_three else 'è¯·æ ¸æŸ¥' end
      ,'LDT'
      ,count(*) as inum_person
      ,null
      ,'å¦'
      ,null
      ,localtimestamp()
  from edw.x_ldt_list_before a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select bi_cinvcode,item_code,level_three from edw.map_inventory group by bi_cinvcode) c
    on a.bi_cinvcode = c.bi_cinvcode
 where left(a.true_ccuscode,2) <> 'GL' 
   and ddate_sample >= '2019-06-01'
   and company_exp not in ('è´åº·','ç”„å…ƒ')
 group by a.ddate,a.true_ccuscode,a.bi_cinvcode,a.class_smaple

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122






insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-01-01'
      ,null
      ,a.bi_cusname
      ,'2019-01-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_january
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_january > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-02-01'
      ,null
      ,a.bi_cusname
      ,'2019-02-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_february
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_february > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122

insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-03-01'
      ,null
      ,a.bi_cusname
      ,'2019-03-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_march
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_march > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-04-01'
      ,null
      ,a.bi_cusname
      ,'2019-04-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_april
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_april > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-05-01'
      ,null
      ,a.bi_cusname
      ,'2019-05-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_may
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_may > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-06-01'
      ,null
      ,a.bi_cusname
      ,'2019-06-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_june
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_june > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-07-01'
      ,null
      ,a.bi_cusname
      ,'2019-07-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_july
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_july > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-08-01'
      ,null
      ,a.bi_cusname
      ,'2019-08-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_august
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_august > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-09-01'
      ,null
      ,a.bi_cusname
      ,'2019-09-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_september
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_september > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-10-01'
      ,null
      ,a.bi_cusname
      ,'2019-10-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_october
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_october > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-11-01'
      ,null
      ,a.bi_cusname
      ,'2019-11-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_november
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_november > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929030122
insert into pdm.checklist
select null
      ,'crm'
      ,a.new_province
      ,a.lastname
      ,'2019-12-01'
      ,null
      ,a.bi_cusname
      ,'2019-12-01'
      ,a.bi_cuscode
      ,a.bi_cusname
      ,null
      ,null
      ,a.item_code
      ,a.item_name
      ,'äº§å“ç±»'
      ,a.new_december
      ,0
      ,'å¦'
      ,null
      ,localtimestamp()
   from edw.crm_sale_screenings a
 where a.new_december > 0
   and year_ = '2019'
   and a.hzfs = 'è‡ªå»º'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929030122
