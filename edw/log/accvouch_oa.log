
20190308125316开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308125316



create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-07'

;
SQL结束执行时间：20190308125316
SQL开始执行时间：20190308125316

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190308125316
SQL开始执行时间：20190308125316

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 

;
SQL结束执行时间：20190308125316

20190315001510开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315001510


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-14'

;
SQL结束执行时间：20190315001511
SQL开始执行时间：20190315001511

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190315001511
SQL开始执行时间：20190315001511

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190315001511

20190316001503开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316001503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-15'

;
SQL结束执行时间：20190316001503
SQL开始执行时间：20190316001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190316001504
SQL开始执行时间：20190316001504

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190316001504

20190317001502开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-16'

;
SQL结束执行时间：20190317001502
SQL开始执行时间：20190317001502

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190317001502
SQL开始执行时间：20190317001502

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190317001503

20190318001503开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318001503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-17'

;
SQL结束执行时间：20190318001504
SQL开始执行时间：20190318001504

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190318001504
SQL开始执行时间：20190318001504

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190318001504

20190319001502开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-18'

;
SQL结束执行时间：20190319001503
SQL开始执行时间：20190319001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190319001504
SQL开始执行时间：20190319001504

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190319001505

20190320001500开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320001500


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-19'

;
SQL结束执行时间：20190320001501
SQL开始执行时间：20190320001501

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190320001501
SQL开始执行时间：20190320001501

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190320001501

20190321001503开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321001503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-20'

;
SQL结束执行时间：20190321001503
SQL开始执行时间：20190321001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190321001503
SQL开始执行时间：20190321001503

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190321001504

20190322112625开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322112625


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-21'

;
SQL结束执行时间：20190322112625
SQL开始执行时间：20190322112625

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190322112625
SQL开始执行时间：20190322112625

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190322112625

20190323001504开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-22'

;
SQL结束执行时间：20190323001505
SQL开始执行时间：20190323001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190323001505
SQL开始执行时间：20190323001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190323001505

20190324001510开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324001510


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-23'

;
SQL结束执行时间：20190324001510
SQL开始执行时间：20190324001510

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190324001510
SQL开始执行时间：20190324001510

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190324001510

20190325001504开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-24'

;
SQL结束执行时间：20190325001504
SQL开始执行时间：20190325001504

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190325001504
SQL开始执行时间：20190325001504

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190325001505

20190326001502开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-25'

;
SQL结束执行时间：20190326001503
SQL开始执行时间：20190326001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190326001503
SQL开始执行时间：20190326001503

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190326001504

20190327001505开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327001505


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-26'

;
SQL结束执行时间：20190327001505
SQL开始执行时间：20190327001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190327001505
SQL开始执行时间：20190327001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190327001506

20190328001502开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-27'

;
SQL结束执行时间：20190328001502
SQL开始执行时间：20190328001502

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190328001502
SQL开始执行时间：20190328001502

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190328001503

20190329001501开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329001501


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-28'

;
SQL结束执行时间：20190329001501
SQL开始执行时间：20190329001501

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190329001501
SQL开始执行时间：20190329001501

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190329001501

20190330001502开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-29'

;
SQL结束执行时间：20190330001503
SQL开始执行时间：20190330001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190330001503
SQL开始执行时间：20190330001503

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190330001503

20190331001503开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331001503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-30'

;
SQL结束执行时间：20190331001503
SQL开始执行时间：20190331001503

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190331001503
SQL开始执行时间：20190331001503

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190331001504

20190401001506开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-03-31'

;
SQL结束执行时间：20190401001506
SQL开始执行时间：20190401001506

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190401001506
SQL开始执行时间：20190401001506

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190401001507

20190402001504开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-01'

;
SQL结束执行时间：20190402001505
SQL开始执行时间：20190402001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190402001505
SQL开始执行时间：20190402001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190402001507

20190403001509开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403001509


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-02'

;
SQL结束执行时间：20190403001510
SQL开始执行时间：20190403001510

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190403001510
SQL开始执行时间：20190403001510

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190403001510

20190404135108开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404135108


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-03'

;
SQL结束执行时间：20190404135109
SQL开始执行时间：20190404135109

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190404135109
SQL开始执行时间：20190404135109

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190404135110

20190405001508开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405001508


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-04'

;
SQL结束执行时间：20190405001509
SQL开始执行时间：20190405001509

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190405001509
SQL开始执行时间：20190405001509

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190405001510

20190406001506开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-05'

;
SQL结束执行时间：20190406001506
SQL开始执行时间：20190406001506

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190406001506
SQL开始执行时间：20190406001506

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190406001507

20190407001514开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407001514


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-06'

;
SQL结束执行时间：20190407001514
SQL开始执行时间：20190407001514

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190407001514
SQL开始执行时间：20190407001514

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190407001515

20190408001506开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-07'

;
SQL结束执行时间：20190408001506
SQL开始执行时间：20190408001506

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190408001506
SQL开始执行时间：20190408001506

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190408001507

20190409001507开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409001507


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-08'

;
SQL结束执行时间：20190409001509
SQL开始执行时间：20190409001509

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190409001509
SQL开始执行时间：20190409001509

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190409001510

20190410001506开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-09'

;
SQL结束执行时间：20190410001507
SQL开始执行时间：20190410001507

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190410001507
SQL开始执行时间：20190410001507

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190410001507

20190411001512开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411001512


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-10'

;
SQL结束执行时间：20190411001513
SQL开始执行时间：20190411001513

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190411001513
SQL开始执行时间：20190411001513

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190411001513

20190412001514开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412001514


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-11'

;
SQL结束执行时间：20190412001514
SQL开始执行时间：20190412001514

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190412001514
SQL开始执行时间：20190412001514

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190412001515

20190413001511开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413001511


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-12'

;
SQL结束执行时间：20190413001511
SQL开始执行时间：20190413001511

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190413001511
SQL开始执行时间：20190413001511

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190413001512

20190414001519开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414001519


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-13'

;
SQL结束执行时间：20190414001519
SQL开始执行时间：20190414001519

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190414001519
SQL开始执行时间：20190414001519

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190414001519

20190415001504开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-14'

;
SQL结束执行时间：20190415001505
SQL开始执行时间：20190415001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190415001505
SQL开始执行时间：20190415001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190415001506

20190416001504开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-15'

;
SQL结束执行时间：20190416001505
SQL开始执行时间：20190416001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190416001505
SQL开始执行时间：20190416001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190416001506

20190417001507开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417001507


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-16'

;
SQL结束执行时间：20190417001508
SQL开始执行时间：20190417001508

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190417001508
SQL开始执行时间：20190417001508

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190417001508

20190418001504开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-17'

;
SQL结束执行时间：20190418001505
SQL开始执行时间：20190418001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190418001505
SQL开始执行时间：20190418001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190418001506

20190419001502开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419001502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-18'

;
SQL结束执行时间：20190419001502
SQL开始执行时间：20190419001502

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190419001502
SQL开始执行时间：20190419001502

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190419001503

20190420001511开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420001511


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-19'

;
SQL结束执行时间：20190420001512
SQL开始执行时间：20190420001512

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190420001512
SQL开始执行时间：20190420001512

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190420001513

20190421001510开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421001510


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-20'

;
SQL结束执行时间：20190421001511
SQL开始执行时间：20190421001511

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190421001511
SQL开始执行时间：20190421001511

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190421001512

20190422001506开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-21'

;
SQL结束执行时间：20190422001506
SQL开始执行时间：20190422001506

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190422001506
SQL开始执行时间：20190422001506

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190422001507

20190423001509开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423001509


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-22'

;
SQL结束执行时间：20190423001510
SQL开始执行时间：20190423001510

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190423001510
SQL开始执行时间：20190423001510

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190423001512

20190424001504开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-23'

;
SQL结束执行时间：20190424001505
SQL开始执行时间：20190424001505

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190424001505
SQL开始执行时间：20190424001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190424001506

20190425001503开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425001503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-24'

;
SQL结束执行时间：20190425001504
SQL开始执行时间：20190425001504

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190425001504
SQL开始执行时间：20190425001504

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190425001505

20190426001507开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426001507


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-25'

;
SQL结束执行时间：20190426001508
SQL开始执行时间：20190426001508

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190426001508
SQL开始执行时间：20190426001508

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190426001508

20190427001513开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427001513


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-26'

;
SQL结束执行时间：20190427001514
SQL开始执行时间：20190427001514

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190427001514
SQL开始执行时间：20190427001514

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190427001515

20190429091409开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429091409


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-28'

;
SQL结束执行时间：20190429091409
SQL开始执行时间：20190429091409

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190429091409
SQL开始执行时间：20190429091409

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190429091409

20190430001510开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430001510


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-29'

;
SQL结束执行时间：20190430001511
SQL开始执行时间：20190430001511

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190430001511
SQL开始执行时间：20190430001511

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190430001512

20190501001513开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501001513


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-04-30'

;
SQL结束执行时间：20190501001514
SQL开始执行时间：20190501001514

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190501001514
SQL开始执行时间：20190501001514

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190501001515

20190502001517开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502001517


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-05-01'

;
SQL结束执行时间：20190502001517
SQL开始执行时间：20190502001517

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190502001517
SQL开始执行时间：20190502001517

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190502001517

20190503001508开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503001508


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-05-02'

;
SQL结束执行时间：20190503001508
SQL开始执行时间：20190503001508

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190503001508
SQL开始执行时间：20190503001508

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190503001508

20190504001512开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504001512


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-05-03'

;
SQL结束执行时间：20190504001512
SQL开始执行时间：20190504001512

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190504001512
SQL开始执行时间：20190504001512

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190504001513

20190505001504开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 
 where left(a.baoxiaorq,10) >= '2019-05-04'

;
SQL结束执行时间：20190505001504
SQL开始执行时间：20190505001504

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190505001505
SQL开始执行时间：20190505001505

insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190505001505

20190506001500开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506001500


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190506001622
SQL开始执行时间：20190506001622

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190506001622
SQL开始执行时间：20190506001622

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190506001622
SQL开始执行时间：20190506001622
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190506001727

20190507001506开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507001506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190507001631
SQL开始执行时间：20190507001631

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190507001631
SQL开始执行时间：20190507001631

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190507001631
SQL开始执行时间：20190507001631
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190507001737

20190508001504开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508001504


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190508001630
SQL开始执行时间：20190508001630

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190508001630
SQL开始执行时间：20190508001630

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190508001630
SQL开始执行时间：20190508001630
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190508001737

20190509174327开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190509174327


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190509174445
SQL开始执行时间：20190509174445

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190509174445
SQL开始执行时间：20190509174445

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190509174445
SQL开始执行时间：20190509174445
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190509174547

20190510001548开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510001548


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190510001709
SQL开始执行时间：20190510001709

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190510001709
SQL开始执行时间：20190510001709

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190510001709
SQL开始执行时间：20190510001709
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190510001812

20190511001550开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511001550


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190511001712
SQL开始执行时间：20190511001712

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190511001712
SQL开始执行时间：20190511001712

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190511001712
SQL开始执行时间：20190511001712
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190511001816

20190512001545开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512001545


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190512001709
SQL开始执行时间：20190512001709

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190512001709
SQL开始执行时间：20190512001709

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190512001709
SQL开始执行时间：20190512001709
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190512001813

20190513001542开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513001542


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190513001708
SQL开始执行时间：20190513001708

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190513001708
SQL开始执行时间：20190513001708

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190513001708
SQL开始执行时间：20190513001708
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190513001813

20190514001549开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514001549


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190514001717
SQL开始执行时间：20190514001717

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190514001717
SQL开始执行时间：20190514001717

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190514001718
SQL开始执行时间：20190514001718
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190514001826

20190515001552开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515001552


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190515001723
SQL开始执行时间：20190515001723

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190515001723
SQL开始执行时间：20190515001723

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190515001723
SQL开始执行时间：20190515001723
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190515001833

20190516001555开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516001555


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190516001728
SQL开始执行时间：20190516001728

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190516001728
SQL开始执行时间：20190516001728

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190516001728
SQL开始执行时间：20190516001728
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190516001837

20190517001605开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517001605


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190517001737
SQL开始执行时间：20190517001737

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190517001737
SQL开始执行时间：20190517001737

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190517001737
SQL开始执行时间：20190517001737
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190517001846

20190518001600开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518001600


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190518001732
SQL开始执行时间：20190518001732

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190518001732
SQL开始执行时间：20190518001732

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190518001732
SQL开始执行时间：20190518001732
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190518001840

20190519001600开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519001600


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190519001733
SQL开始执行时间：20190519001733

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190519001733
SQL开始执行时间：20190519001733

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190519001733
SQL开始执行时间：20190519001733
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190519001844

20190520001601开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520001601


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190520001736
SQL开始执行时间：20190520001736

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190520001736
SQL开始执行时间：20190520001736

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190520001737
SQL开始执行时间：20190520001737
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190520001847

20190521001605开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521001605


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190521001745
SQL开始执行时间：20190521001745

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190521001745
SQL开始执行时间：20190521001745

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190521001745
SQL开始执行时间：20190521001745
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190521001857

20190522001605开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522001605


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190522001745
SQL开始执行时间：20190522001745

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190522001745
SQL开始执行时间：20190522001745

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190522001745
SQL开始执行时间：20190522001745
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190522001858

20190523001600开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523001600


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190523001742
SQL开始执行时间：20190523001742

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190523001742
SQL开始执行时间：20190523001742

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190523001742
SQL开始执行时间：20190523001742
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190523001855

20190524001554开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524001554


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190524001737
SQL开始执行时间：20190524001737

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190524001737
SQL开始执行时间：20190524001737

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190524001737
SQL开始执行时间：20190524001737
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190524001850

20190525001558开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525001558


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190525001742
SQL开始执行时间：20190525001742

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190525001742
SQL开始执行时间：20190525001742

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190525001742
SQL开始执行时间：20190525001742
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190525001856

20190526001558开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526001558


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190526001741
SQL开始执行时间：20190526001741

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190526001741
SQL开始执行时间：20190526001741

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190526001741
SQL开始执行时间：20190526001741
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190526001854

20190527001601开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527001601


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190527001747
SQL开始执行时间：20190527001747

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190527001747
SQL开始执行时间：20190527001747

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190527001747
SQL开始执行时间：20190527001747
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190527001902

20190528001601开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528001601


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190528001750
SQL开始执行时间：20190528001750

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190528001750
SQL开始执行时间：20190528001750

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190528001750
SQL开始执行时间：20190528001750
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190528001906

20190529001630开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529001630


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190529001827
SQL开始执行时间：20190529001827

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190529001827
SQL开始执行时间：20190529001827

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190529001827
SQL开始执行时间：20190529001827
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190529001953

20190530001607开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530001607


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190530001800
SQL开始执行时间：20190530001800

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190530001800
SQL开始执行时间：20190530001800

truncate table edw.accvouch_oa
;
SQL结束执行时间：20190530001800
SQL开始执行时间：20190530001800
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from ufdata.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from ufdata.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190530001918

20190531001609开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531001609


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190531001804
SQL开始执行时间：20190531001804

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190531001804
SQL开始执行时间：20190531001804


create temporary table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190531001804
SQL开始执行时间：20190531001804

insert into edw.code values('640110','Աɱ')
;

20190531093523开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531093523


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190531093715
SQL开始执行时间：20190531093715

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190531093715
SQL开始执行时间：20190531093715


create temporary table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190531093715
SQL开始执行时间：20190531093715

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190531093715
SQL开始执行时间：20190531093715



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190531093715
SQL开始执行时间：20190531093715
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;

20190531094921开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531094921


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113

drop table if exists edw.code
;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190531095113
SQL开始执行时间：20190531095113
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190531095230
SQL开始执行时间：20190531095230

drop table if exists edw.code
;
SQL结束执行时间：20190531095230

20190601001608开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601001608


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804

drop table if exists edw.code
;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190601001804
SQL开始执行时间：20190601001804
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190601001922
SQL开始执行时间：20190601001922

drop table if exists edw.code
;
SQL结束执行时间：20190601001922

20190602001614开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602001614


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812

drop table if exists edw.code
;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190602001812
SQL开始执行时间：20190602001812
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190602001930
SQL开始执行时间：20190602001930

drop table if exists edw.code
;
SQL结束执行时间：20190602001931

20190603001613开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603001613


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190603001811
SQL开始执行时间：20190603001811

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190603001811
SQL开始执行时间：20190603001811

drop table if exists edw.code
;
SQL结束执行时间：20190603001811
SQL开始执行时间：20190603001811
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190603001811
SQL开始执行时间：20190603001811

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190603001811
SQL开始执行时间：20190603001811



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190603001812
SQL开始执行时间：20190603001812
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190603001930
SQL开始执行时间：20190603001930

drop table if exists edw.code
;
SQL结束执行时间：20190603001930

20190604001609开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604001609


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816

drop table if exists edw.code
;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190604001816
SQL开始执行时间：20190604001816
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190604001937
SQL开始执行时间：20190604001937

drop table if exists edw.code
;
SQL结束执行时间：20190604001937

20190605001611开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605001611


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817

drop table if exists edw.code
;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190605001817
SQL开始执行时间：20190605001817
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190605001938
SQL开始执行时间：20190605001938

drop table if exists edw.code
;
SQL结束执行时间：20190605001938

20190606001623开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606001623


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831

drop table if exists edw.code
;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190606001831
SQL开始执行时间：20190606001831
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190606001953
SQL开始执行时间：20190606001953

drop table if exists edw.code
;
SQL结束执行时间：20190606001953

20190607001600开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607001600


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809

drop table if exists edw.code
;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190607001809
SQL开始执行时间：20190607001809
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190607001933
SQL开始执行时间：20190607001933

drop table if exists edw.code
;
SQL结束执行时间：20190607001933

20190608001609开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608001609


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818

drop table if exists edw.code
;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190608001818
SQL开始执行时间：20190608001818
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190608001942
SQL开始执行时间：20190608001942

drop table if exists edw.code
;
SQL结束执行时间：20190608001942

20190610084641开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610084641


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850

drop table if exists edw.code
;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190610084850
SQL开始执行时间：20190610084850
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190610085017
SQL开始执行时间：20190610085017

drop table if exists edw.code
;
SQL结束执行时间：20190610085017

20190611001609开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611001609


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825

drop table if exists edw.code
;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190611001825
SQL开始执行时间：20190611001825
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190611001951
SQL开始执行时间：20190611001951

drop table if exists edw.code
;
SQL结束执行时间：20190611001951

20190612001611开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612001611


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828

drop table if exists edw.code
;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190612001828
SQL开始执行时间：20190612001828
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190612001954
SQL开始执行时间：20190612001954

drop table if exists edw.code
;
SQL结束执行时间：20190612001954

20190613001608开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613001608


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190613001824
SQL开始执行时间：20190613001824

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190613001824
SQL开始执行时间：20190613001824

drop table if exists edw.code
;
SQL结束执行时间：20190613001824
SQL开始执行时间：20190613001824
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190613001825
SQL开始执行时间：20190613001825

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190613001825
SQL开始执行时间：20190613001825



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190613001825
SQL开始执行时间：20190613001825
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190613001951
SQL开始执行时间：20190613001951

drop table if exists edw.code
;
SQL结束执行时间：20190613001951

20190614001629开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614001629


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852

drop table if exists edw.code
;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190614001852
SQL开始执行时间：20190614001852
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190614002024
SQL开始执行时间：20190614002024

drop table if exists edw.code
;
SQL结束执行时间：20190614002024

20190615001637开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615001637


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902

drop table if exists edw.code
;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190615001902
SQL开始执行时间：20190615001902
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190615002034
SQL开始执行时间：20190615002034

drop table if exists edw.code
;
SQL结束执行时间：20190615002034

20190616001633开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616001633


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190616001859
SQL开始执行时间：20190616001859

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190616001859
SQL开始执行时间：20190616001859

drop table if exists edw.code
;
SQL结束执行时间：20190616001859
SQL开始执行时间：20190616001859
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190616001900
SQL开始执行时间：20190616001900

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190616001900
SQL开始执行时间：20190616001900



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190616001900
SQL开始执行时间：20190616001900
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190616002032
SQL开始执行时间：20190616002032

drop table if exists edw.code
;
SQL结束执行时间：20190616002032

20190617001638开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617001638


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190617001908
SQL开始执行时间：20190617001908

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190617001908
SQL开始执行时间：20190617001908

drop table if exists edw.code
;
SQL结束执行时间：20190617001908
SQL开始执行时间：20190617001908
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190617001909
SQL开始执行时间：20190617001909

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190617001909
SQL开始执行时间：20190617001909



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190617001909
SQL开始执行时间：20190617001909
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190617002041
SQL开始执行时间：20190617002041

drop table if exists edw.code
;
SQL结束执行时间：20190617002041

20190618001632开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618001632


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904

drop table if exists edw.code
;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190618001904
SQL开始执行时间：20190618001904
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190618002039
SQL开始执行时间：20190618002039

drop table if exists edw.code
;
SQL结束执行时间：20190618002039

20190619001636开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619001636


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909

drop table if exists edw.code
;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190619001909
SQL开始执行时间：20190619001909
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190619002046
SQL开始执行时间：20190619002046

drop table if exists edw.code
;
SQL结束执行时间：20190619002046

20190620001633开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620001633


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908

drop table if exists edw.code
;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908
create  table edw.code as
select ccode,ccode_name
  from ufdata.code
 where db = 'UFDATA_111_2018'
   and iyear = "2019"

;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908

insert into edw.code values('640110','人员成本')
;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190620001908
SQL开始执行时间：20190620001908
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,k.ccode
      ,k.ccode_name
      ,l.ccode
      ,l.ccode_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join (select * from edw.code group by ccode,ccode_name) k
	  on left(g.u8kemubm,4) = left(k.ccode,4)
	 and RIGHT(a.kmwb,CHAR_LENGTh(a.kmwb)-4) = k.ccode_name
	left join (select ccode,ccode_name from edw.code group by ccode) l
    on SUBSTRING(k.ccode,1,6) = l.ccode

;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044

drop table if exists edw.code
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044

update edw.accvouch_oa set oa_ccode = '66011904',oa_ccode_name='交通费',oa_ccode_lv2='660119',oa_ccode_name_lv2='差旅费' where oadykm = '6601交通费（其他）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '66011904',oa_ccode_name='交通费',oa_ccode_lv2='660119',oa_ccode_name_lv2='差旅费' where oadykm = '6601交通费（高铁票）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '66011904',oa_ccode_name='交通费',oa_ccode_lv2='660119',oa_ccode_name_lv2='差旅费' where oadykm = '6601交通费（客车、船票）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '53011904',oa_ccode_name='交通费',oa_ccode_lv2='530119',oa_ccode_name_lv2='差旅费' where oadykm = '6603交通费（客车、船票）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '66021904',oa_ccode_name='交通费',oa_ccode_lv2='660219',oa_ccode_name_lv2='差旅费' where oadykm = '6602交通费（高铁票）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '66011702',oa_ccode_name='会务招待',oa_ccode_lv2='660117',oa_ccode_name_lv2='业务招待费' where oadykm = '6601会务招待费'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '53011904',oa_ccode_name='交通费',oa_ccode_lv2='530119',oa_ccode_name_lv2='差旅费' where oadykm = '6603交通费（其他）'
;
SQL结束执行时间：20190620002044
SQL开始执行时间：20190620002044
update edw.accvouch_oa set oa_ccode = '66021904',oa_ccode_name='交通费',oa_ccode_lv2='660219',oa_ccode_name_lv2='差旅费' where oadykm = '6602交通费（其他）'
;
SQL结束执行时间：20190620002045
SQL开始执行时间：20190620002045
update edw.accvouch_oa set oa_ccode = '53011904',oa_ccode_name='交通费',oa_ccode_lv2='530119',oa_ccode_name_lv2='差旅费' where oadykm = '6603交通费（高铁票）'
;
SQL结束执行时间：20190620002045
SQL开始执行时间：20190620002045
update edw.accvouch_oa set oa_ccode = '66021904',oa_ccode_name='交通费',oa_ccode_lv2='660219',oa_ccode_name_lv2='差旅费' where oadykm = '6602交通费（客车、船票）'
;
SQL结束执行时间：20190620002045
SQL开始执行时间：20190620002045
update edw.accvouch_oa set oa_ccode = '6601010104',oa_ccode_name='交通补贴',oa_ccode_lv2='660101',oa_ccode_name_lv2='人员成本' where oadykm = '6601交通补贴'
;
SQL结束执行时间：20190620002045
SQL开始执行时间：20190620002045
update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where oadykm = '66010032试剂招标经费'
;
SQL结束执行时间：20190620002045
SQL开始执行时间：20190620002045
update edw.accvouch_oa set oa_ccode = '6602010104',oa_ccode_name='交通补贴',oa_ccode_lv2='660201',oa_ccode_name_lv2='人员成本' where oadykm = '6602交通补贴'
;
SQL结束执行时间：20190620002045

20190621001646开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621001646


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190621001922
SQL开始执行时间：20190621001922

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190621001922
SQL开始执行时间：20190621001922




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190621001922
SQL开始执行时间：20190621001922
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190621002058
SQL开始执行时间：20190621002058
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190621002058
SQL开始执行时间：20190621002058

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190621002058
SQL开始执行时间：20190621002058



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190621002058
SQL开始执行时间：20190621002058
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190621002058

20190622001634开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622001634


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190622001912
SQL开始执行时间：20190622001912

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190622001912
SQL开始执行时间：20190622001912




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190622001912
SQL开始执行时间：20190622001912
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190622002048
SQL开始执行时间：20190622002048
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190622002048
SQL开始执行时间：20190622002048

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190622002048
SQL开始执行时间：20190622002048



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190622002048
SQL开始执行时间：20190622002048
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190622002048

20190623001634开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623001634


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190623001913
SQL开始执行时间：20190623001913

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190623001913
SQL开始执行时间：20190623001913




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190623001913
SQL开始执行时间：20190623001913
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190623002051
SQL开始执行时间：20190623002051
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190623002051
SQL开始执行时间：20190623002051

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190623002051
SQL开始执行时间：20190623002051



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190623002052
SQL开始执行时间：20190623002052
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190623002052

20190624091131开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624091131


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190624091409
SQL开始执行时间：20190624091409

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190624091409
SQL开始执行时间：20190624091409




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190624091409
SQL开始执行时间：20190624091409
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190624091548
SQL开始执行时间：20190624091548
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190624091548
SQL开始执行时间：20190624091548

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190624091548
SQL开始执行时间：20190624091548



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190624091548
SQL开始执行时间：20190624091548
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190624091548

20190625001634开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625001634


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190625001922
SQL开始执行时间：20190625001922

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190625001922
SQL开始执行时间：20190625001922




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190625001922
SQL开始执行时间：20190625001922
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190625002103
SQL开始执行时间：20190625002103
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190625002103
SQL开始执行时间：20190625002103

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190625002103
SQL开始执行时间：20190625002103



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190625002103
SQL开始执行时间：20190625002103
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190625002103

20190626144915开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626144915


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190626145200
SQL开始执行时间：20190626145200

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190626145200
SQL开始执行时间：20190626145200




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190626145200
SQL开始执行时间：20190626145200
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190626145341
SQL开始执行时间：20190626145341
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190626145341
SQL开始执行时间：20190626145341

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190626145341
SQL开始执行时间：20190626145341



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190626145341
SQL开始执行时间：20190626145341
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190626145341

20190627001635开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627001635


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190627001926
SQL开始执行时间：20190627001926

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190627001926
SQL开始执行时间：20190627001926




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190627001926
SQL开始执行时间：20190627001926
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190627002108
SQL开始执行时间：20190627002108
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190627002108
SQL开始执行时间：20190627002108

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190627002108
SQL开始执行时间：20190627002108



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190627002108
SQL开始执行时间：20190627002108
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190627002108

20190628001656开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628001656


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190628001952
SQL开始执行时间：20190628001952

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190628001952
SQL开始执行时间：20190628001952




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190628001952
SQL开始执行时间：20190628001952
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190628002137
SQL开始执行时间：20190628002137
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190628002137
SQL开始执行时间：20190628002137

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190628002137
SQL开始执行时间：20190628002137



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190628002137
SQL开始执行时间：20190628002137
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190628002137

20190629001643开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629001643


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190629001939
SQL开始执行时间：20190629001939

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190629001939
SQL开始执行时间：20190629001939




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190629001939
SQL开始执行时间：20190629001939
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190629002122
SQL开始执行时间：20190629002122
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190629002122
SQL开始执行时间：20190629002122

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190629002123
SQL开始执行时间：20190629002123



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190629002123
SQL开始执行时间：20190629002123
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190629002123

20190702092022开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702092022


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	c.sjbxje as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190702092320
SQL开始执行时间：20190702092320

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190702092321
SQL开始执行时间：20190702092321




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190702092321
SQL开始执行时间：20190702092321
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190702092505
SQL开始执行时间：20190702092505
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190702092505
SQL开始执行时间：20190702092505

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190702092505
SQL开始执行时间：20190702092505



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190702092505
SQL开始执行时间：20190702092505
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190702092506

20190703001635开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703001635


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190703001937
SQL开始执行时间：20190703001937

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190703001937
SQL开始执行时间：20190703001937




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190703001937
SQL开始执行时间：20190703001937
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190703002123
SQL开始执行时间：20190703002123
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190703002123
SQL开始执行时间：20190703002123

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190703002123
SQL开始执行时间：20190703002123



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190703002123
SQL开始执行时间：20190703002123
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190703002123

20190704001635开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704001635


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190704001942
SQL开始执行时间：20190704001942

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190704001942
SQL开始执行时间：20190704001942




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190704001942
SQL开始执行时间：20190704001942
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190704002130
SQL开始执行时间：20190704002130
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190704002130
SQL开始执行时间：20190704002130

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190704002130
SQL开始执行时间：20190704002130



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190704002130
SQL开始执行时间：20190704002130
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190704002130

20190705001654开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705001654


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190705002003
SQL开始执行时间：20190705002003

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190705002003
SQL开始执行时间：20190705002003




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190705002003
SQL开始执行时间：20190705002003
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190705002155
SQL开始执行时间：20190705002155
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190705002155
SQL开始执行时间：20190705002155

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190705002155
SQL开始执行时间：20190705002155



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190705002155
SQL开始执行时间：20190705002155
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190705002155

20190706001658开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706001658


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190706002010
SQL开始执行时间：20190706002010

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190706002011
SQL开始执行时间：20190706002011




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190706002011
SQL开始执行时间：20190706002011
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190706002203
SQL开始执行时间：20190706002203
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190706002203
SQL开始执行时间：20190706002203

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190706002203
SQL开始执行时间：20190706002203



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190706002203
SQL开始执行时间：20190706002203
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190706002203

20190707001700开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707001700


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190707002013
SQL开始执行时间：20190707002013

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190707002013
SQL开始执行时间：20190707002013




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190707002013
SQL开始执行时间：20190707002013
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190707002206
SQL开始执行时间：20190707002206
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190707002206
SQL开始执行时间：20190707002206

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190707002206
SQL开始执行时间：20190707002206



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190707002206
SQL开始执行时间：20190707002206
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190707002206

20190708001712开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708001712


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190708002035
SQL开始执行时间：20190708002035

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190708002035
SQL开始执行时间：20190708002035




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190708002035
SQL开始执行时间：20190708002035
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190708002228
SQL开始执行时间：20190708002228
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190708002228
SQL开始执行时间：20190708002228

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190708002228
SQL开始执行时间：20190708002228



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190708002228
SQL开始执行时间：20190708002228
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190708002228

20190709001659开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709001659


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190709002019
SQL开始执行时间：20190709002019

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190709002019
SQL开始执行时间：20190709002019




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190709002019
SQL开始执行时间：20190709002019
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190709002215
SQL开始执行时间：20190709002215
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190709002215
SQL开始执行时间：20190709002215

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190709002215
SQL开始执行时间：20190709002215



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190709002215
SQL开始执行时间：20190709002215
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190709002215

20190710001701开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710001701


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190710002022
SQL开始执行时间：20190710002022

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190710002022
SQL开始执行时间：20190710002022




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190710002022
SQL开始执行时间：20190710002022
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190710002219
SQL开始执行时间：20190710002219
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190710002219
SQL开始执行时间：20190710002219

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190710002219
SQL开始执行时间：20190710002219



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190710002220
SQL开始执行时间：20190710002220
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190710002220

20190711001700开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711001700


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190711002027
SQL开始执行时间：20190711002027

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190711002027
SQL开始执行时间：20190711002027




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190711002027
SQL开始执行时间：20190711002027
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190711002223
SQL开始执行时间：20190711002223
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190711002223
SQL开始执行时间：20190711002223

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190711002224
SQL开始执行时间：20190711002224



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190711002224
SQL开始执行时间：20190711002224
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190711002224

20190712001720开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712001720


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190712002045
SQL开始执行时间：20190712002045

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190712002045
SQL开始执行时间：20190712002045




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190712002045
SQL开始执行时间：20190712002045
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190712002242
SQL开始执行时间：20190712002242
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190712002242
SQL开始执行时间：20190712002242

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190712002242
SQL开始执行时间：20190712002242



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190712002242
SQL开始执行时间：20190712002242
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190712002242

20190715090506开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715090506


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190715090833
SQL开始执行时间：20190715090833

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190715090833
SQL开始执行时间：20190715090833




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190715090833
SQL开始执行时间：20190715090833
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190715091030
SQL开始执行时间：20190715091030
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190715091030
SQL开始执行时间：20190715091030

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190715091030
SQL开始执行时间：20190715091030



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190715091030
SQL开始执行时间：20190715091030
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190715091030

20190716003817开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716003817


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190716004154
SQL开始执行时间：20190716004154

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190716004154
SQL开始执行时间：20190716004154




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190716004154
SQL开始执行时间：20190716004154
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190716004355
SQL开始执行时间：20190716004355
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190716004355
SQL开始执行时间：20190716004355

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190716004356
SQL开始执行时间：20190716004356



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190716004356
SQL开始执行时间：20190716004356
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190716004356

20190716144841开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716144841


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190716145218
SQL开始执行时间：20190716145218

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190716145218
SQL开始执行时间：20190716145218




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190716145218
SQL开始执行时间：20190716145218
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190716145420
SQL开始执行时间：20190716145420
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190716145420
SQL开始执行时间：20190716145420

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190716145420
SQL开始执行时间：20190716145420



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190716145420
SQL开始执行时间：20190716145420
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190716145420

20190717001657开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717001657


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190717002038
SQL开始执行时间：20190717002038

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190717002038
SQL开始执行时间：20190717002038




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190717002038
SQL开始执行时间：20190717002038
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190717002242
SQL开始执行时间：20190717002242
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190717002242
SQL开始执行时间：20190717002242

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190717002242
SQL开始执行时间：20190717002242



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190717002242
SQL开始执行时间：20190717002242
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190717002242

20190718001718开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718001718


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190718002059
SQL开始执行时间：20190718002059

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190718002059
SQL开始执行时间：20190718002059




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190718002059
SQL开始执行时间：20190718002059
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190718002303
SQL开始执行时间：20190718002303
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190718002303
SQL开始执行时间：20190718002303

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190718002303
SQL开始执行时间：20190718002303



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190718002303
SQL开始执行时间：20190718002303
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190718002304

20190719001701开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719001701


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190719002044
SQL开始执行时间：20190719002044

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190719002044
SQL开始执行时间：20190719002044




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190719002044
SQL开始执行时间：20190719002044
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190719002249
SQL开始执行时间：20190719002249
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190719002249
SQL开始执行时间：20190719002249

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190719002249
SQL开始执行时间：20190719002249



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190719002249
SQL开始执行时间：20190719002249
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190719002249

20190720001631开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720001631


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190720002008
SQL开始执行时间：20190720002008

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190720002008
SQL开始执行时间：20190720002008




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190720002008
SQL开始执行时间：20190720002008
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190720002213
SQL开始执行时间：20190720002213
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190720002213
SQL开始执行时间：20190720002213

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190720002213
SQL开始执行时间：20190720002213



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190720002213
SQL开始执行时间：20190720002213
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190720002213

20190721001631开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721001631


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190721002013
SQL开始执行时间：20190721002013

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190721002013
SQL开始执行时间：20190721002013




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190721002013
SQL开始执行时间：20190721002013
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190721002219
SQL开始执行时间：20190721002219
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190721002219
SQL开始执行时间：20190721002219

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190721002219
SQL开始执行时间：20190721002219



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190721002219
SQL开始执行时间：20190721002219
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190721002219

20190722001633开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722001633


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190722002013
SQL开始执行时间：20190722002013

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190722002013
SQL开始执行时间：20190722002013




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190722002013
SQL开始执行时间：20190722002013
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190722002219
SQL开始执行时间：20190722002219
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190722002220
SQL开始执行时间：20190722002220

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190722002220
SQL开始执行时间：20190722002220



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190722002220
SQL开始执行时间：20190722002220
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190722002220

20190723001636开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723001636


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190723002023
SQL开始执行时间：20190723002023

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190723002023
SQL开始执行时间：20190723002023




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190723002023
SQL开始执行时间：20190723002023
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;
SQL结束执行时间：20190723002229
SQL开始执行时间：20190723002229
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190723002229
SQL开始执行时间：20190723002229

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190723002229
SQL开始执行时间：20190723002229



delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190723002229
SQL开始执行时间：20190723002229
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190723002229

20190723164532开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190723164532


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190723164534
SQL开始执行时间：20190723164534

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190723164534
SQL开始执行时间：20190723164534




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190723164534
SQL开始执行时间：20190723164534
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;

20190724001649开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724001649


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	a.chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190724001651
SQL开始执行时间：20190724001651

create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190724001651
SQL开始执行时间：20190724001651




truncate table edw.accvouch_oa
;
SQL结束执行时间：20190724001651
SQL开始执行时间：20190724001651
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code

;

20190724085411开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724085411


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190724085413
SQL开始执行时间：20190724085413


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190724085413
SQL开始执行时间：20190724085413



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190724085414
SQL开始执行时间：20190724085414
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190724085416
SQL开始执行时间：20190724085416
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190724085417
SQL开始执行时间：20190724085417
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190724085419
SQL开始执行时间：20190724085419
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190724085421
SQL开始执行时间：20190724085421
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190724085423
SQL开始执行时间：20190724085423


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190724085423
SQL开始执行时间：20190724085423
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190724085624
SQL开始执行时间：20190724085624
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190724085624
SQL开始执行时间：20190724085624

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190724085624
SQL开始执行时间：20190724085624


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190724085624
SQL开始执行时间：20190724085624
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190724085624

20190724111944开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190724111944


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190724111946
SQL开始执行时间：20190724111946


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190724111946
SQL开始执行时间：20190724111946



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190724111947
SQL开始执行时间：20190724111947
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190724111949
SQL开始执行时间：20190724111949
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190724111950
SQL开始执行时间：20190724111950
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190724111952
SQL开始执行时间：20190724111952
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190724111954
SQL开始执行时间：20190724111954
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190724111956
SQL开始执行时间：20190724111956


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190724111956
SQL开始执行时间：20190724111956
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;

20190725001640开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725001640


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190725001642
SQL开始执行时间：20190725001642


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190725001642
SQL开始执行时间：20190725001642



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190725001643
SQL开始执行时间：20190725001643
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190725001645
SQL开始执行时间：20190725001645
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190725001647
SQL开始执行时间：20190725001647
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190725001649
SQL开始执行时间：20190725001649
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190725001651
SQL开始执行时间：20190725001651
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190725001654
SQL开始执行时间：20190725001654


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190725001654
SQL开始执行时间：20190725001654
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;

20190725090940开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725090940


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190725090941
SQL开始执行时间：20190725090941


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190725090941
SQL开始执行时间：20190725090941



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190725090942
SQL开始执行时间：20190725090942
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190725090944
SQL开始执行时间：20190725090944
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190725090945
SQL开始执行时间：20190725090945
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190725090947
SQL开始执行时间：20190725090947
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190725090949
SQL开始执行时间：20190725090949
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190725090951
SQL开始执行时间：20190725090951


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190725090951
SQL开始执行时间：20190725090951
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190725091157
SQL开始执行时间：20190725091157
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190725091158
SQL开始执行时间：20190725091158

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190725091158
SQL开始执行时间：20190725091158


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190725091158
SQL开始执行时间：20190725091158
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190725091158

20190726001635开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726001635


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190726001637
SQL开始执行时间：20190726001637


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190726001637
SQL开始执行时间：20190726001637



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190726001638
SQL开始执行时间：20190726001638
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190726001640
SQL开始执行时间：20190726001640
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190726001643
SQL开始执行时间：20190726001643
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190726001645
SQL开始执行时间：20190726001645
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190726001647
SQL开始执行时间：20190726001647
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190726001649
SQL开始执行时间：20190726001649


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190726001649
SQL开始执行时间：20190726001649
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190726001855
SQL开始执行时间：20190726001855
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190726001855
SQL开始执行时间：20190726001855

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190726001855
SQL开始执行时间：20190726001855


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190726001855
SQL开始执行时间：20190726001855
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190726001855

20190726085328开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190726085328


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190726085330
SQL开始执行时间：20190726085330


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190726085330
SQL开始执行时间：20190726085330



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190726085331
SQL开始执行时间：20190726085331
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190726085332
SQL开始执行时间：20190726085332
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190726085334
SQL开始执行时间：20190726085334
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190726085336
SQL开始执行时间：20190726085336
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190726085337
SQL开始执行时间：20190726085337
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190726085339
SQL开始执行时间：20190726085339


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190726085339
SQL开始执行时间：20190726085339
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190726085544
SQL开始执行时间：20190726085544
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190726085544
SQL开始执行时间：20190726085544

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190726085544
SQL开始执行时间：20190726085544


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190726085544
SQL开始执行时间：20190726085544
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190726085545

20190727001651开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727001651


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190727001653
SQL开始执行时间：20190727001653


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190727001653
SQL开始执行时间：20190727001653



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190727001655
SQL开始执行时间：20190727001655
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190727001656
SQL开始执行时间：20190727001656
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190727001658
SQL开始执行时间：20190727001658
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190727001700
SQL开始执行时间：20190727001700
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190727001702
SQL开始执行时间：20190727001702
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190727001704
SQL开始执行时间：20190727001704


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190727001704
SQL开始执行时间：20190727001704
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190727001917
SQL开始执行时间：20190727001917
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190727001917
SQL开始执行时间：20190727001917

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190727001917
SQL开始执行时间：20190727001917


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190727001917
SQL开始执行时间：20190727001917
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190727001918

20190728001644开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728001644


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190728001646
SQL开始执行时间：20190728001646


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190728001646
SQL开始执行时间：20190728001646



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190728001647
SQL开始执行时间：20190728001647
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190728001649
SQL开始执行时间：20190728001649
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190728001652
SQL开始执行时间：20190728001652
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190728001654
SQL开始执行时间：20190728001654
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190728001656
SQL开始执行时间：20190728001656
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190728001658
SQL开始执行时间：20190728001658


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190728001659
SQL开始执行时间：20190728001659
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190728001912
SQL开始执行时间：20190728001912
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190728001912
SQL开始执行时间：20190728001912

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190728001912
SQL开始执行时间：20190728001912


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190728001912
SQL开始执行时间：20190728001912
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190728001912

20190729001643开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729001643


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190729001645
SQL开始执行时间：20190729001645


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190729001645
SQL开始执行时间：20190729001645



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190729001647
SQL开始执行时间：20190729001647
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190729001649
SQL开始执行时间：20190729001649
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190729001651
SQL开始执行时间：20190729001651
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190729001653
SQL开始执行时间：20190729001653
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190729001655
SQL开始执行时间：20190729001655
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190729001657
SQL开始执行时间：20190729001657


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190729001657
SQL开始执行时间：20190729001657
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,a.kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;
SQL结束执行时间：20190729001911
SQL开始执行时间：20190729001911
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190729001911
SQL开始执行时间：20190729001911

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190729001911
SQL开始执行时间：20190729001911


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190729001912
SQL开始执行时间：20190729001912
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190729001912

20190729111014开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190729111014


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190729111016
SQL开始执行时间：20190729111016


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190729111017
SQL开始执行时间：20190729111017



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190729111018
SQL开始执行时间：20190729111018
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190729111019
SQL开始执行时间：20190729111019
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190729111021
SQL开始执行时间：20190729111021
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190729111023
SQL开始执行时间：20190729111023
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190729111025
SQL开始执行时间：20190729111025
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190729111027
SQL开始执行时间：20190729111027


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190729111027
SQL开始执行时间：20190729111027
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;

20190730001706开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730001706


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190730001707
SQL开始执行时间：20190730001707


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190730001707
SQL开始执行时间：20190730001707



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190730001709
SQL开始执行时间：20190730001709
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190730001710
SQL开始执行时间：20190730001710
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190730001712
SQL开始执行时间：20190730001712
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190730001714
SQL开始执行时间：20190730001714
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190730001717
SQL开始执行时间：20190730001717
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190730001719
SQL开始执行时间：20190730001719


truncate table edw.accvouch_oa
;
SQL结束执行时间：20190730001719
SQL开始执行时间：20190730001719
insert into edw.accvouch_oa
select a.id
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when a.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111'
            when a.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168'
            when a.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname

;

20190730084240开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730084240


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190730084241
SQL开始执行时间：20190730084241


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190730084241
SQL开始执行时间：20190730084241



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190730084243
SQL开始执行时间：20190730084243
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190730084244
SQL开始执行时间：20190730084244
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190730084245
SQL开始执行时间：20190730084245
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190730084247
SQL开始执行时间：20190730084247
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190730084249
SQL开始执行时间：20190730084249
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190730084251
SQL开始执行时间：20190730084251
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190730084253
SQL开始执行时间：20190730084253



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190730084253
SQL开始执行时间：20190730084253
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190730084530
SQL开始执行时间：20190730084530
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190730084530
SQL开始执行时间：20190730084530

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190730084530
SQL开始执行时间：20190730084530


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190730084531
SQL开始执行时间：20190730084531
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190730084531

20190730094030开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190730094030


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190730094031
SQL开始执行时间：20190730094031


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190730094031
SQL开始执行时间：20190730094031



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190730094033
SQL开始执行时间：20190730094033
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190730094034
SQL开始执行时间：20190730094034
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190730094035
SQL开始执行时间：20190730094035
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190730094037
SQL开始执行时间：20190730094037
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190730094039
SQL开始执行时间：20190730094039
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190730094041
SQL开始执行时间：20190730094041
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190730094043
SQL开始执行时间：20190730094043



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190730094043
SQL开始执行时间：20190730094043
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190730094318
SQL开始执行时间：20190730094318
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190730094318
SQL开始执行时间：20190730094318

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190730094318
SQL开始执行时间：20190730094318


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190730094318
SQL开始执行时间：20190730094318
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190730094319

20190731001706开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731001706


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190731001708
SQL开始执行时间：20190731001708


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190731001708
SQL开始执行时间：20190731001708



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190731001710
SQL开始执行时间：20190731001710
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190731001712
SQL开始执行时间：20190731001712
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190731001714
SQL开始执行时间：20190731001714
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190731001716
SQL开始执行时间：20190731001716
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190731001718
SQL开始执行时间：20190731001718
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190731001721
SQL开始执行时间：20190731001721
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190731001724
SQL开始执行时间：20190731001724



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190731001724
SQL开始执行时间：20190731001724
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190731002005
SQL开始执行时间：20190731002005
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190731002005
SQL开始执行时间：20190731002005

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190731002005
SQL开始执行时间：20190731002005


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190731002005
SQL开始执行时间：20190731002005
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190731002005

20190731103036开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190731103036


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190731103038
SQL开始执行时间：20190731103038


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190731103038
SQL开始执行时间：20190731103038



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190731103039
SQL开始执行时间：20190731103039
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190731103040
SQL开始执行时间：20190731103040
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190731103042
SQL开始执行时间：20190731103042
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190731103044
SQL开始执行时间：20190731103044
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190731103045
SQL开始执行时间：20190731103045
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190731103047
SQL开始执行时间：20190731103047
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190731103050
SQL开始执行时间：20190731103050



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190731103050
SQL开始执行时间：20190731103050
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190731103325
SQL开始执行时间：20190731103325
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190731103325
SQL开始执行时间：20190731103325

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190731103325
SQL开始执行时间：20190731103325


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190731103325
SQL开始执行时间：20190731103325
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190731103326

20190731131608开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190731131608


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190731131610
SQL开始执行时间：20190731131610


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190731131610
SQL开始执行时间：20190731131610



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190731131611
SQL开始执行时间：20190731131611
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190731131613
SQL开始执行时间：20190731131613
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190731131614
SQL开始执行时间：20190731131614
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190731131616
SQL开始执行时间：20190731131616
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190731131618
SQL开始执行时间：20190731131618
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190731131620
SQL开始执行时间：20190731131620
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190731131622
SQL开始执行时间：20190731131622



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190731131622
SQL开始执行时间：20190731131622
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190731131855
SQL开始执行时间：20190731131855
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190731131855
SQL开始执行时间：20190731131855

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190731131856
SQL开始执行时间：20190731131856


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190731131856
SQL开始执行时间：20190731131856
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190731131856

20190801001648开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801001648


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190801001650
SQL开始执行时间：20190801001650


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190801001650
SQL开始执行时间：20190801001650



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190801001652
SQL开始执行时间：20190801001652
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190801001653
SQL开始执行时间：20190801001653
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190801001655
SQL开始执行时间：20190801001655
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190801001657
SQL开始执行时间：20190801001657
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190801001700
SQL开始执行时间：20190801001700
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190801001702
SQL开始执行时间：20190801001702
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190801001705
SQL开始执行时间：20190801001705



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190801001705
SQL开始执行时间：20190801001705
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190801001934
SQL开始执行时间：20190801001934
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190801001934
SQL开始执行时间：20190801001934

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190801001934
SQL开始执行时间：20190801001934


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190801001934
SQL开始执行时间：20190801001934
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190801001935

20190801091943开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190801091943


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190801091945
SQL开始执行时间：20190801091945


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190801091945
SQL开始执行时间：20190801091945



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190801091946
SQL开始执行时间：20190801091946
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190801091948
SQL开始执行时间：20190801091948
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190801091949
SQL开始执行时间：20190801091949
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190801091951
SQL开始执行时间：20190801091951
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190801091953
SQL开始执行时间：20190801091953
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190801091955
SQL开始执行时间：20190801091955
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190801091958
SQL开始执行时间：20190801091958



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190801091958
SQL开始执行时间：20190801091958
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190801092226
SQL开始执行时间：20190801092226
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190801092226
SQL开始执行时间：20190801092226

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190801092226
SQL开始执行时间：20190801092226


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190801092226
SQL开始执行时间：20190801092226
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190801092226

20190802001702开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802001702


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190802001704
SQL开始执行时间：20190802001704


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190802001704
SQL开始执行时间：20190802001704



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190802001706
SQL开始执行时间：20190802001706
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190802001708
SQL开始执行时间：20190802001708
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190802001710
SQL开始执行时间：20190802001710
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190802001712
SQL开始执行时间：20190802001712
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190802001714
SQL开始执行时间：20190802001714
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190802001717
SQL开始执行时间：20190802001717
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190802001719
SQL开始执行时间：20190802001719



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190802001719
SQL开始执行时间：20190802001719
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190802001947
SQL开始执行时间：20190802001947
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190802001948
SQL开始执行时间：20190802001948

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190802001948
SQL开始执行时间：20190802001948


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190802001948
SQL开始执行时间：20190802001948
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190802001948

20190803001719开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803001719


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190803001721
SQL开始执行时间：20190803001721


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190803001721
SQL开始执行时间：20190803001721



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190803001723
SQL开始执行时间：20190803001723
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190803001725
SQL开始执行时间：20190803001725
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190803001727
SQL开始执行时间：20190803001727
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190803001729
SQL开始执行时间：20190803001729
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190803001732
SQL开始执行时间：20190803001732
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190803001734
SQL开始执行时间：20190803001734
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190803001737
SQL开始执行时间：20190803001737



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190803001737
SQL开始执行时间：20190803001737
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190803002010
SQL开始执行时间：20190803002010
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190803002010
SQL开始执行时间：20190803002010

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190803002010
SQL开始执行时间：20190803002010


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190803002010
SQL开始执行时间：20190803002010
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190803002010

20190804001709开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804001709


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190804001711
SQL开始执行时间：20190804001711


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190804001711
SQL开始执行时间：20190804001711



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190804001713
SQL开始执行时间：20190804001713
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190804001715
SQL开始执行时间：20190804001715
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190804001717
SQL开始执行时间：20190804001717
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190804001720
SQL开始执行时间：20190804001720
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190804001722
SQL开始执行时间：20190804001722
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190804001725
SQL开始执行时间：20190804001725
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190804001727
SQL开始执行时间：20190804001727



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190804001727
SQL开始执行时间：20190804001727
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190804001958
SQL开始执行时间：20190804001958
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190804001958
SQL开始执行时间：20190804001958

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190804001958
SQL开始执行时间：20190804001958


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190804001959
SQL开始执行时间：20190804001959
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190804001959

20190805001710开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805001710


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190805001712
SQL开始执行时间：20190805001712


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190805001712
SQL开始执行时间：20190805001712



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190805001714
SQL开始执行时间：20190805001714
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190805001716
SQL开始执行时间：20190805001716
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190805001718
SQL开始执行时间：20190805001718
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190805001721
SQL开始执行时间：20190805001721
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190805001723
SQL开始执行时间：20190805001723
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190805001726
SQL开始执行时间：20190805001726
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190805001728
SQL开始执行时间：20190805001728



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190805001728
SQL开始执行时间：20190805001728
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190805002001
SQL开始执行时间：20190805002001
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190805002002
SQL开始执行时间：20190805002002

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190805002002
SQL开始执行时间：20190805002002


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190805002002
SQL开始执行时间：20190805002002
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190805002002

20190805132020开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190805132020


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190805132022
SQL开始执行时间：20190805132022


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190805132022
SQL开始执行时间：20190805132022



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190805132023
SQL开始执行时间：20190805132023
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190805132024
SQL开始执行时间：20190805132024
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190805132026
SQL开始执行时间：20190805132026
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190805132028
SQL开始执行时间：20190805132028
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190805132030
SQL开始执行时间：20190805132030
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190805132032
SQL开始执行时间：20190805132032
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190805132034
SQL开始执行时间：20190805132034



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190805132034
SQL开始执行时间：20190805132034
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190805132304
SQL开始执行时间：20190805132304
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190805132304
SQL开始执行时间：20190805132304

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190805132304
SQL开始执行时间：20190805132304


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190805132304
SQL开始执行时间：20190805132304
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190805132305

20190805133121开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190805133121


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190805133123
SQL开始执行时间：20190805133123


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190805133123
SQL开始执行时间：20190805133123



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190805133124
SQL开始执行时间：20190805133124
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190805133126
SQL开始执行时间：20190805133126
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190805133127
SQL开始执行时间：20190805133127
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190805133129
SQL开始执行时间：20190805133129
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190805133131
SQL开始执行时间：20190805133131
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190805133133
SQL开始执行时间：20190805133133
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190805133135
SQL开始执行时间：20190805133135



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190805133135
SQL开始执行时间：20190805133135
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190805133404
SQL开始执行时间：20190805133404
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190805133404
SQL开始执行时间：20190805133404

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190805133404
SQL开始执行时间：20190805133404


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190805133405
SQL开始执行时间：20190805133405
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190805133405

20190805144447开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190805144447


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190805144449
SQL开始执行时间：20190805144449


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190805144449
SQL开始执行时间：20190805144449



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190805144451
SQL开始执行时间：20190805144451
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190805144452
SQL开始执行时间：20190805144452
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190805144454
SQL开始执行时间：20190805144454
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190805144455
SQL开始执行时间：20190805144455
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190805144457
SQL开始执行时间：20190805144457
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190805144459
SQL开始执行时间：20190805144459
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190805144502
SQL开始执行时间：20190805144502



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190805144502
SQL开始执行时间：20190805144502
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190805144730
SQL开始执行时间：20190805144730
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190805144730
SQL开始执行时间：20190805144730

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190805144730
SQL开始执行时间：20190805144730


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190805144731
SQL开始执行时间：20190805144731
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190805144731

20190806001649开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806001649


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190806001651
SQL开始执行时间：20190806001651


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190806001651
SQL开始执行时间：20190806001651



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190806001652
SQL开始执行时间：20190806001652
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190806001654
SQL开始执行时间：20190806001654
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190806001656
SQL开始执行时间：20190806001656
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190806001659
SQL开始执行时间：20190806001659
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190806001701
SQL开始执行时间：20190806001701
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190806001704
SQL开始执行时间：20190806001704
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190806001707
SQL开始执行时间：20190806001707



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190806001707
SQL开始执行时间：20190806001707
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190806001933
SQL开始执行时间：20190806001933
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190806001933
SQL开始执行时间：20190806001933

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190806001933
SQL开始执行时间：20190806001933


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190806001933
SQL开始执行时间：20190806001933
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190806001933

20190806093119开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190806093119


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190806093121
SQL开始执行时间：20190806093121


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190806093121
SQL开始执行时间：20190806093121



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190806093122
SQL开始执行时间：20190806093122
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190806093124
SQL开始执行时间：20190806093124
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190806093126
SQL开始执行时间：20190806093126
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190806093127
SQL开始执行时间：20190806093127
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190806093129
SQL开始执行时间：20190806093129
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190806093132
SQL开始执行时间：20190806093132
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190806093134
SQL开始执行时间：20190806093134



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190806093134
SQL开始执行时间：20190806093134
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190806093401
SQL开始执行时间：20190806093401
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190806093402
SQL开始执行时间：20190806093402

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190806093402
SQL开始执行时间：20190806093402


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190806093402
SQL开始执行时间：20190806093402
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190806093402

20190807001718开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807001718


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190807001720
SQL开始执行时间：20190807001720


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190807001721
SQL开始执行时间：20190807001721



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190807001722
SQL开始执行时间：20190807001722
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190807001724
SQL开始执行时间：20190807001724
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190807001726
SQL开始执行时间：20190807001726
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190807001729
SQL开始执行时间：20190807001729
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190807001732
SQL开始执行时间：20190807001732
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190807001735
SQL开始执行时间：20190807001735
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190807001738
SQL开始执行时间：20190807001738



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190807001738
SQL开始执行时间：20190807001738
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190807002003
SQL开始执行时间：20190807002003
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190807002003
SQL开始执行时间：20190807002003

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190807002003
SQL开始执行时间：20190807002003


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190807002003
SQL开始执行时间：20190807002003
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190807002003

20190807153154开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190807153154


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190807153155
SQL开始执行时间：20190807153155


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190807153155
SQL开始执行时间：20190807153155



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190807153157
SQL开始执行时间：20190807153157
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190807153158
SQL开始执行时间：20190807153158
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190807153200
SQL开始执行时间：20190807153200
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190807153202
SQL开始执行时间：20190807153202
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190807153204
SQL开始执行时间：20190807153204
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190807153206
SQL开始执行时间：20190807153206
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190807153208
SQL开始执行时间：20190807153208



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190807153208
SQL开始执行时间：20190807153208
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190807153434
SQL开始执行时间：20190807153434
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190807153434
SQL开始执行时间：20190807153434

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190807153434
SQL开始执行时间：20190807153434


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190807153434
SQL开始执行时间：20190807153434
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190807153434

20190808001647开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808001647


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190808001650
SQL开始执行时间：20190808001650


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190808001650
SQL开始执行时间：20190808001650



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190808001651
SQL开始执行时间：20190808001651
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190808001654
SQL开始执行时间：20190808001654
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190808001656
SQL开始执行时间：20190808001656
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190808001659
SQL开始执行时间：20190808001659
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190808001701
SQL开始执行时间：20190808001701
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190808001703
SQL开始执行时间：20190808001703
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190808001706
SQL开始执行时间：20190808001706



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190808001706
SQL开始执行时间：20190808001706
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190808001933
SQL开始执行时间：20190808001933
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190808001933
SQL开始执行时间：20190808001933

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190808001933
SQL开始执行时间：20190808001933


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190808001933
SQL开始执行时间：20190808001933
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190808001934

20190808090855开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190808090855


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190808090856
SQL开始执行时间：20190808090856


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190808090857
SQL开始执行时间：20190808090857



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190808090858
SQL开始执行时间：20190808090858
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190808090859
SQL开始执行时间：20190808090859
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190808090901
SQL开始执行时间：20190808090901
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190808090903
SQL开始执行时间：20190808090903
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190808090905
SQL开始执行时间：20190808090905
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190808090907
SQL开始执行时间：20190808090907
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190808090909
SQL开始执行时间：20190808090909



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190808090909
SQL开始执行时间：20190808090909
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190808091135
SQL开始执行时间：20190808091135
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190808091135
SQL开始执行时间：20190808091135

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190808091135
SQL开始执行时间：20190808091135


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190808091135
SQL开始执行时间：20190808091135
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190808091135

20190808092247开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190808092247


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190808092249
SQL开始执行时间：20190808092249


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190808092249
SQL开始执行时间：20190808092249



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190808092250
SQL开始执行时间：20190808092250
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190808092251
SQL开始执行时间：20190808092251
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190808092253
SQL开始执行时间：20190808092253
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190808092255
SQL开始执行时间：20190808092255
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190808092257
SQL开始执行时间：20190808092257
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190808092259
SQL开始执行时间：20190808092259
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190808092302
SQL开始执行时间：20190808092302



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190808092302
SQL开始执行时间：20190808092302
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190808092531
SQL开始执行时间：20190808092531
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190808092531
SQL开始执行时间：20190808092531

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190808092531
SQL开始执行时间：20190808092531


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190808092531
SQL开始执行时间：20190808092531
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190808092531

20190808092834开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190808092834


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190808092836
SQL开始执行时间：20190808092836


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190808092836
SQL开始执行时间：20190808092836



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190808092837
SQL开始执行时间：20190808092837
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190808092839
SQL开始执行时间：20190808092839
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190808092840
SQL开始执行时间：20190808092840
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190808092842
SQL开始执行时间：20190808092842
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190808092844
SQL开始执行时间：20190808092844
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190808092846
SQL开始执行时间：20190808092846
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190808092849
SQL开始执行时间：20190808092849



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190808092849
SQL开始执行时间：20190808092849
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190808093117
SQL开始执行时间：20190808093117
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190808093118
SQL开始执行时间：20190808093118

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190808093118
SQL开始执行时间：20190808093118


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190808093118
SQL开始执行时间：20190808093118
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190808093118

20190809001705开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809001705


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190809001707
SQL开始执行时间：20190809001707


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190809001707
SQL开始执行时间：20190809001707



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190809001708
SQL开始执行时间：20190809001708
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190809001710
SQL开始执行时间：20190809001710
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190809001712
SQL开始执行时间：20190809001712
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190809001714
SQL开始执行时间：20190809001714
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190809001716
SQL开始执行时间：20190809001716
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190809001719
SQL开始执行时间：20190809001719
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190809001722
SQL开始执行时间：20190809001722



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190809001722
SQL开始执行时间：20190809001722
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190809001949
SQL开始执行时间：20190809001949
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190809001949
SQL开始执行时间：20190809001949

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190809001950
SQL开始执行时间：20190809001950


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190809001950
SQL开始执行时间：20190809001950
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190809001950

20190809111123开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190809111123


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190809111125
SQL开始执行时间：20190809111125


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190809111125
SQL开始执行时间：20190809111125



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190809111126
SQL开始执行时间：20190809111126
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190809111128
SQL开始执行时间：20190809111128
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190809111129
SQL开始执行时间：20190809111129
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190809111131
SQL开始执行时间：20190809111131
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190809111133
SQL开始执行时间：20190809111133
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190809111135
SQL开始执行时间：20190809111135
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190809111138
SQL开始执行时间：20190809111138



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190809111138
SQL开始执行时间：20190809111138
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190809111405
SQL开始执行时间：20190809111405
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190809111405
SQL开始执行时间：20190809111405

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190809111405
SQL开始执行时间：20190809111405


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190809111405
SQL开始执行时间：20190809111405
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190809111405

20190809112207开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190809112207


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190809112208
SQL开始执行时间：20190809112208


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190809112209
SQL开始执行时间：20190809112209



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190809112210
SQL开始执行时间：20190809112210
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190809112211
SQL开始执行时间：20190809112211
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190809112213
SQL开始执行时间：20190809112213
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190809112215
SQL开始执行时间：20190809112215
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190809112217
SQL开始执行时间：20190809112217
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190809112219
SQL开始执行时间：20190809112219
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190809112222
SQL开始执行时间：20190809112222



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190809112222
SQL开始执行时间：20190809112222
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190809112450
SQL开始执行时间：20190809112450
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190809112450
SQL开始执行时间：20190809112450

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190809112450
SQL开始执行时间：20190809112450


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190809112450
SQL开始执行时间：20190809112450
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190809112450

20190812083932开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812083932


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190812083934
SQL开始执行时间：20190812083934


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190812083934
SQL开始执行时间：20190812083934



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190812083935
SQL开始执行时间：20190812083935
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190812083937
SQL开始执行时间：20190812083937
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190812083939
SQL开始执行时间：20190812083939
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190812083941
SQL开始执行时间：20190812083941
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190812083944
SQL开始执行时间：20190812083944
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190812083946
SQL开始执行时间：20190812083946
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190812083949
SQL开始执行时间：20190812083949



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190812083949
SQL开始执行时间：20190812083949
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190812084224
SQL开始执行时间：20190812084224
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190812084225
SQL开始执行时间：20190812084225

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190812084225
SQL开始执行时间：20190812084225


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190812084225
SQL开始执行时间：20190812084225
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190812084225

20190812085659开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190812085659


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190812085701
SQL开始执行时间：20190812085701


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190812085701
SQL开始执行时间：20190812085701



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190812085702
SQL开始执行时间：20190812085702
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190812085704
SQL开始执行时间：20190812085704
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190812085706
SQL开始执行时间：20190812085706
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190812085707
SQL开始执行时间：20190812085707
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190812085709
SQL开始执行时间：20190812085709
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190812085712
SQL开始执行时间：20190812085712
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190812085714
SQL开始执行时间：20190812085714



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190812085714
SQL开始执行时间：20190812085714
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190812085949
SQL开始执行时间：20190812085949
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190812085950
SQL开始执行时间：20190812085950

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190812085950
SQL开始执行时间：20190812085950


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190812085950
SQL开始执行时间：20190812085950
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190812085950

20190813001700开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813001700


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190813001703
SQL开始执行时间：20190813001703


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190813001703
SQL开始执行时间：20190813001703



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190813001704
SQL开始执行时间：20190813001704
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190813001707
SQL开始执行时间：20190813001707
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190813001709
SQL开始执行时间：20190813001709
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190813001711
SQL开始执行时间：20190813001711
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190813001713
SQL开始执行时间：20190813001713
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190813001716
SQL开始执行时间：20190813001716
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190813001718
SQL开始执行时间：20190813001718



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190813001718
SQL开始执行时间：20190813001718
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190813001953
SQL开始执行时间：20190813001953
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190813001953
SQL开始执行时间：20190813001953

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190813001953
SQL开始执行时间：20190813001953


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190813001953
SQL开始执行时间：20190813001953
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190813001953

20190813111211开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190813111211


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190813111213
SQL开始执行时间：20190813111213


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190813111213
SQL开始执行时间：20190813111213



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190813111214
SQL开始执行时间：20190813111214
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190813111216
SQL开始执行时间：20190813111216
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190813111217
SQL开始执行时间：20190813111217
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190813111219
SQL开始执行时间：20190813111219
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190813111221
SQL开始执行时间：20190813111221
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190813111224
SQL开始执行时间：20190813111224
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190813111226
SQL开始执行时间：20190813111226



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190813111226
SQL开始执行时间：20190813111226
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190813111454
SQL开始执行时间：20190813111454
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190813111454
SQL开始执行时间：20190813111454

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190813111455
SQL开始执行时间：20190813111455


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190813111455
SQL开始执行时间：20190813111455
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190813111455

20190814001659开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814001659


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190814001701
SQL开始执行时间：20190814001701


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190814001702
SQL开始执行时间：20190814001702



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190814001703
SQL开始执行时间：20190814001703
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190814001705
SQL开始执行时间：20190814001705
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190814001707
SQL开始执行时间：20190814001707
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190814001709
SQL开始执行时间：20190814001709
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190814001712
SQL开始执行时间：20190814001712
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190814001714
SQL开始执行时间：20190814001714
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190814001717
SQL开始执行时间：20190814001717



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190814001717
SQL开始执行时间：20190814001717
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190814001955
SQL开始执行时间：20190814001955
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190814001955
SQL开始执行时间：20190814001955

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190814001955
SQL开始执行时间：20190814001955


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190814001955
SQL开始执行时间：20190814001955
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190814001955

20190814092219开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190814092219


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190814092221
SQL开始执行时间：20190814092221


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190814092221
SQL开始执行时间：20190814092221



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190814092223
SQL开始执行时间：20190814092223
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190814092224
SQL开始执行时间：20190814092224
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190814092226
SQL开始执行时间：20190814092226
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190814092228
SQL开始执行时间：20190814092228
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190814092230
SQL开始执行时间：20190814092230
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190814092232
SQL开始执行时间：20190814092232
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190814092235
SQL开始执行时间：20190814092235



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190814092235
SQL开始执行时间：20190814092235
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190814092507
SQL开始执行时间：20190814092507
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190814092507
SQL开始执行时间：20190814092507

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190814092508
SQL开始执行时间：20190814092508


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190814092508
SQL开始执行时间：20190814092508
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190814092508

20190815001657开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815001657


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190815001659
SQL开始执行时间：20190815001659


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190815001659
SQL开始执行时间：20190815001659



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190815001701
SQL开始执行时间：20190815001701
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190815001703
SQL开始执行时间：20190815001703
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190815001705
SQL开始执行时间：20190815001705
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190815001707
SQL开始执行时间：20190815001707
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190815001709
SQL开始执行时间：20190815001709
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190815001712
SQL开始执行时间：20190815001712
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190815001715
SQL开始执行时间：20190815001715



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190815001715
SQL开始执行时间：20190815001715
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190815001954
SQL开始执行时间：20190815001954
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190815001954
SQL开始执行时间：20190815001954

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190815001954
SQL开始执行时间：20190815001954


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190815001954
SQL开始执行时间：20190815001954
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190815001954

20190815095256开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190815095256


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190815095257
SQL开始执行时间：20190815095257


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190815095257
SQL开始执行时间：20190815095257



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190815095259
SQL开始执行时间：20190815095259
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190815095300
SQL开始执行时间：20190815095300
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190815095302
SQL开始执行时间：20190815095302
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190815095304
SQL开始执行时间：20190815095304
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190815095306
SQL开始执行时间：20190815095306
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190815095308
SQL开始执行时间：20190815095308
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190815095311
SQL开始执行时间：20190815095311



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190815095311
SQL开始执行时间：20190815095311
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190815095544
SQL开始执行时间：20190815095544
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190815095544
SQL开始执行时间：20190815095544

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190815095544
SQL开始执行时间：20190815095544


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190815095544
SQL开始执行时间：20190815095544
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190815095544

20190816001653开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816001653


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190816001655
SQL开始执行时间：20190816001655


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190816001655
SQL开始执行时间：20190816001655



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190816001656
SQL开始执行时间：20190816001656
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190816001658
SQL开始执行时间：20190816001658
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190816001700
SQL开始执行时间：20190816001700
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190816001703
SQL开始执行时间：20190816001703
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190816001705
SQL开始执行时间：20190816001705
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190816001709
SQL开始执行时间：20190816001709
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190816001712
SQL开始执行时间：20190816001712



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190816001712
SQL开始执行时间：20190816001712
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190816001951
SQL开始执行时间：20190816001951
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190816001952
SQL开始执行时间：20190816001952

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190816001952
SQL开始执行时间：20190816001952


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190816001952
SQL开始执行时间：20190816001952
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190816001952

20190817001652开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817001652


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190817001654
SQL开始执行时间：20190817001654


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190817001654
SQL开始执行时间：20190817001654



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190817001656
SQL开始执行时间：20190817001656
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190817001658
SQL开始执行时间：20190817001658
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190817001700
SQL开始执行时间：20190817001700
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190817001702
SQL开始执行时间：20190817001702
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190817001705
SQL开始执行时间：20190817001705
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190817001709
SQL开始执行时间：20190817001709
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190817001712
SQL开始执行时间：20190817001712



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190817001712
SQL开始执行时间：20190817001712
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190817001955
SQL开始执行时间：20190817001955
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190817001955
SQL开始执行时间：20190817001955

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190817001955
SQL开始执行时间：20190817001955


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190817001956
SQL开始执行时间：20190817001956
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190817001956

20190818001622开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818001622


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190818001624
SQL开始执行时间：20190818001624


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190818001624
SQL开始执行时间：20190818001624



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190818001626
SQL开始执行时间：20190818001626
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190818001627
SQL开始执行时间：20190818001627
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190818001629
SQL开始执行时间：20190818001629
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190818001632
SQL开始执行时间：20190818001632
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190818001635
SQL开始执行时间：20190818001635
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190818001637
SQL开始执行时间：20190818001637
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190818001640
SQL开始执行时间：20190818001640



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190818001640
SQL开始执行时间：20190818001640
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190818001922
SQL开始执行时间：20190818001922
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190818001922
SQL开始执行时间：20190818001922

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190818001923
SQL开始执行时间：20190818001923


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190818001923
SQL开始执行时间：20190818001923
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190818001923

20190819001621开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819001621


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190819001623
SQL开始执行时间：20190819001623


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190819001623
SQL开始执行时间：20190819001623



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190819001625
SQL开始执行时间：20190819001625
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190819001626
SQL开始执行时间：20190819001626
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190819001628
SQL开始执行时间：20190819001628
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190819001631
SQL开始执行时间：20190819001631
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190819001634
SQL开始执行时间：20190819001634
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190819001636
SQL开始执行时间：20190819001636
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190819001639
SQL开始执行时间：20190819001639



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190819001639
SQL开始执行时间：20190819001639
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190819001924
SQL开始执行时间：20190819001924
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190819001924
SQL开始执行时间：20190819001924

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190819001924
SQL开始执行时间：20190819001924


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190819001924
SQL开始执行时间：20190819001924
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190819001924

20190819142121开始执行2019-01-24数据加载日志:
SQL开始执行时间：20190819142121


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190819142123
SQL开始执行时间：20190819142123


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190819142123
SQL开始执行时间：20190819142123



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190819142124
SQL开始执行时间：20190819142124
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190819142126
SQL开始执行时间：20190819142126
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190819142128
SQL开始执行时间：20190819142128
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190819142130
SQL开始执行时间：20190819142130
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190819142132
SQL开始执行时间：20190819142132
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190819142134
SQL开始执行时间：20190819142134
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190819142136
SQL开始执行时间：20190819142136



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190819142137
SQL开始执行时间：20190819142137
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190819142415
SQL开始执行时间：20190819142415
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190819142415
SQL开始执行时间：20190819142415

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190819142416
SQL开始执行时间：20190819142416


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190819142416
SQL开始执行时间：20190819142416
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190819142416

20190820001623开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820001623


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190820001626
SQL开始执行时间：20190820001626


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190820001626
SQL开始执行时间：20190820001626



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190820001627
SQL开始执行时间：20190820001627
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190820001629
SQL开始执行时间：20190820001629
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190820001631
SQL开始执行时间：20190820001631
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190820001634
SQL开始执行时间：20190820001634
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190820001636
SQL开始执行时间：20190820001636
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190820001639
SQL开始执行时间：20190820001639
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190820001642
SQL开始执行时间：20190820001642



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190820001642
SQL开始执行时间：20190820001642
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190820001929
SQL开始执行时间：20190820001929
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190820001929
SQL开始执行时间：20190820001929

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190820001929
SQL开始执行时间：20190820001929


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190820001929
SQL开始执行时间：20190820001929
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190820001929

20190821001654开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821001654


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190821001656
SQL开始执行时间：20190821001656


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190821001656
SQL开始执行时间：20190821001656



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190821001658
SQL开始执行时间：20190821001658
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190821001659
SQL开始执行时间：20190821001659
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190821001702
SQL开始执行时间：20190821001702
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190821001705
SQL开始执行时间：20190821001705
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190821001707
SQL开始执行时间：20190821001707
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190821001710
SQL开始执行时间：20190821001710
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190821001714
SQL开始执行时间：20190821001714



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190821001714
SQL开始执行时间：20190821001714
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190821002002
SQL开始执行时间：20190821002002
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190821002002
SQL开始执行时间：20190821002002

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190821002002
SQL开始执行时间：20190821002002


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190821002002
SQL开始执行时间：20190821002002
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190821002003

20190821100038开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190821100038


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190821100040
SQL开始执行时间：20190821100040


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190821100040
SQL开始执行时间：20190821100040



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190821100042
SQL开始执行时间：20190821100042
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190821100043
SQL开始执行时间：20190821100043
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190821100045
SQL开始执行时间：20190821100045
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190821100047
SQL开始执行时间：20190821100047
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190821100049
SQL开始执行时间：20190821100049
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190821100051
SQL开始执行时间：20190821100051
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190821100054
SQL开始执行时间：20190821100054



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190821100054
SQL开始执行时间：20190821100054
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190821100338
SQL开始执行时间：20190821100338
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190821100338
SQL开始执行时间：20190821100338

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190821100339
SQL开始执行时间：20190821100339


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190821100339
SQL开始执行时间：20190821100339
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190821100339

20190822001641开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822001641


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190822001643
SQL开始执行时间：20190822001643


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190822001643
SQL开始执行时间：20190822001643



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190822001644
SQL开始执行时间：20190822001644
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190822001646
SQL开始执行时间：20190822001646
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190822001648
SQL开始执行时间：20190822001648
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190822001651
SQL开始执行时间：20190822001651
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190822001653
SQL开始执行时间：20190822001653
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190822001656
SQL开始执行时间：20190822001656
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190822001659
SQL开始执行时间：20190822001659



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190822001659
SQL开始执行时间：20190822001659
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190822001944
SQL开始执行时间：20190822001944
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190822001944
SQL开始执行时间：20190822001944

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190822001945
SQL开始执行时间：20190822001945


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190822001945
SQL开始执行时间：20190822001945
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190822001945

20190822090650开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190822090650


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190822090652
SQL开始执行时间：20190822090652


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190822090652
SQL开始执行时间：20190822090652



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190822090653
SQL开始执行时间：20190822090653
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190822090655
SQL开始执行时间：20190822090655
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190822090657
SQL开始执行时间：20190822090657
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190822090659
SQL开始执行时间：20190822090659
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190822090701
SQL开始执行时间：20190822090701
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190822090703
SQL开始执行时间：20190822090703
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190822090706
SQL开始执行时间：20190822090706



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190822090706
SQL开始执行时间：20190822090706
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190822090950
SQL开始执行时间：20190822090950
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190822090950
SQL开始执行时间：20190822090950

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190822090950
SQL开始执行时间：20190822090950


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190822090950
SQL开始执行时间：20190822090950
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190822090950

20190822092349开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190822092349


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190822092351
SQL开始执行时间：20190822092351


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190822092351
SQL开始执行时间：20190822092351



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190822092352
SQL开始执行时间：20190822092352
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190822092354
SQL开始执行时间：20190822092354
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190822092356
SQL开始执行时间：20190822092356
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190822092358
SQL开始执行时间：20190822092358
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190822092400
SQL开始执行时间：20190822092400
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190822092402
SQL开始执行时间：20190822092402
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190822092405
SQL开始执行时间：20190822092405



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190822092405
SQL开始执行时间：20190822092405
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190822092650
SQL开始执行时间：20190822092650
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190822092650
SQL开始执行时间：20190822092650

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190822092650
SQL开始执行时间：20190822092650


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190822092650
SQL开始执行时间：20190822092650
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190822092650

20190823001647开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823001647


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190823001650
SQL开始执行时间：20190823001650


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190823001650
SQL开始执行时间：20190823001650



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190823001651
SQL开始执行时间：20190823001651
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190823001653
SQL开始执行时间：20190823001653
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190823001655
SQL开始执行时间：20190823001655
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190823001657
SQL开始执行时间：20190823001657
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190823001700
SQL开始执行时间：20190823001700
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190823001703
SQL开始执行时间：20190823001703
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190823001706
SQL开始执行时间：20190823001706



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190823001706
SQL开始执行时间：20190823001706
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190823001952
SQL开始执行时间：20190823001952
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190823001952
SQL开始执行时间：20190823001952

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190823001952
SQL开始执行时间：20190823001952


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190823001952
SQL开始执行时间：20190823001952
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190823001953

20190823091619开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190823091619


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190823091621
SQL开始执行时间：20190823091621


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190823091621
SQL开始执行时间：20190823091621



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190823091622
SQL开始执行时间：20190823091622
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190823091624
SQL开始执行时间：20190823091624
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190823091626
SQL开始执行时间：20190823091626
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190823091628
SQL开始执行时间：20190823091628
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190823091630
SQL开始执行时间：20190823091630
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190823091632
SQL开始执行时间：20190823091632
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190823091635
SQL开始执行时间：20190823091635



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190823091635
SQL开始执行时间：20190823091635
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190823091919
SQL开始执行时间：20190823091919
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190823091919
SQL开始执行时间：20190823091919

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190823091919
SQL开始执行时间：20190823091919


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190823091919
SQL开始执行时间：20190823091919
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190823091919

20190824001708开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824001708


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190824001710
SQL开始执行时间：20190824001710


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190824001710
SQL开始执行时间：20190824001710



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190824001711
SQL开始执行时间：20190824001711
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190824001713
SQL开始执行时间：20190824001713
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190824001715
SQL开始执行时间：20190824001715
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190824001718
SQL开始执行时间：20190824001718
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190824001720
SQL开始执行时间：20190824001720
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190824001723
SQL开始执行时间：20190824001723
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190824001726
SQL开始执行时间：20190824001726



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190824001726
SQL开始执行时间：20190824001726
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190824002016
SQL开始执行时间：20190824002016
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190824002017
SQL开始执行时间：20190824002017

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190824002017
SQL开始执行时间：20190824002017


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190824002017
SQL开始执行时间：20190824002017
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190824002017

20190825001701开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825001701


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190825001703
SQL开始执行时间：20190825001703


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190825001703
SQL开始执行时间：20190825001703



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190825001705
SQL开始执行时间：20190825001705
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190825001708
SQL开始执行时间：20190825001708
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190825001710
SQL开始执行时间：20190825001710
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190825001712
SQL开始执行时间：20190825001712
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190825001714
SQL开始执行时间：20190825001714
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190825001717
SQL开始执行时间：20190825001717
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190825001720
SQL开始执行时间：20190825001720



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190825001720
SQL开始执行时间：20190825001720
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190825002008
SQL开始执行时间：20190825002008
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190825002008
SQL开始执行时间：20190825002008

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190825002009
SQL开始执行时间：20190825002009


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190825002009
SQL开始执行时间：20190825002009
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190825002009

20190826001656开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826001656


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190826001659
SQL开始执行时间：20190826001659


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190826001659
SQL开始执行时间：20190826001659



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190826001701
SQL开始执行时间：20190826001701
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190826001703
SQL开始执行时间：20190826001703
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190826001706
SQL开始执行时间：20190826001706
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190826001708
SQL开始执行时间：20190826001708
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190826001711
SQL开始执行时间：20190826001711
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190826001713
SQL开始执行时间：20190826001713
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190826001716
SQL开始执行时间：20190826001716



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190826001716
SQL开始执行时间：20190826001716
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190826002004
SQL开始执行时间：20190826002004
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190826002004
SQL开始执行时间：20190826002004

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190826002004
SQL开始执行时间：20190826002004


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190826002004
SQL开始执行时间：20190826002004
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190826002005

20190826092313开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190826092313


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190826092315
SQL开始执行时间：20190826092315


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190826092315
SQL开始执行时间：20190826092315



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190826092316
SQL开始执行时间：20190826092316
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190826092318
SQL开始执行时间：20190826092318
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190826092320
SQL开始执行时间：20190826092320
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190826092322
SQL开始执行时间：20190826092322
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190826092324
SQL开始执行时间：20190826092324
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190826092326
SQL开始执行时间：20190826092326
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190826092329
SQL开始执行时间：20190826092329



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190826092329
SQL开始执行时间：20190826092329
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 10961 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190826092616
SQL开始执行时间：20190826092616
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190826092616
SQL开始执行时间：20190826092616

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190826092616
SQL开始执行时间：20190826092616


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190826092616
SQL开始执行时间：20190826092616
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190826092616

20190827092131开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190827092131


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190827092133
SQL开始执行时间：20190827092133


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190827092133
SQL开始执行时间：20190827092133



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190827092134
SQL开始执行时间：20190827092134
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190827092136
SQL开始执行时间：20190827092136
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190827092137
SQL开始执行时间：20190827092137
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190827092139
SQL开始执行时间：20190827092139
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190827092141
SQL开始执行时间：20190827092141
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190827092144
SQL开始执行时间：20190827092144
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190827092146
SQL开始执行时间：20190827092146



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190827092146
SQL开始执行时间：20190827092146
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190827092435
SQL开始执行时间：20190827092435
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190827092435
SQL开始执行时间：20190827092435

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190827092435
SQL开始执行时间：20190827092435


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190827092436
SQL开始执行时间：20190827092436
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190827092436

20190828085017开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828085017


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190828085019
SQL开始执行时间：20190828085019


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190828085019
SQL开始执行时间：20190828085019



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190828085021
SQL开始执行时间：20190828085021
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190828085022
SQL开始执行时间：20190828085022
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190828085025
SQL开始执行时间：20190828085025
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190828085027
SQL开始执行时间：20190828085027
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190828085029
SQL开始执行时间：20190828085029
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190828085032
SQL开始执行时间：20190828085032
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190828085035
SQL开始执行时间：20190828085035



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190828085035
SQL开始执行时间：20190828085035
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190828085324
SQL开始执行时间：20190828085324
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190828085324
SQL开始执行时间：20190828085324

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190828085324
SQL开始执行时间：20190828085324


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190828085324
SQL开始执行时间：20190828085324
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190828085325

20190828092836开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190828092836


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190828092838
SQL开始执行时间：20190828092838


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190828092838
SQL开始执行时间：20190828092838



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190828092840
SQL开始执行时间：20190828092840
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190828092841
SQL开始执行时间：20190828092841
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190828092843
SQL开始执行时间：20190828092843
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190828092845
SQL开始执行时间：20190828092845
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190828092847
SQL开始执行时间：20190828092847
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190828092850
SQL开始执行时间：20190828092850
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190828092852
SQL开始执行时间：20190828092852



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190828092852
SQL开始执行时间：20190828092852
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190828093143
SQL开始执行时间：20190828093143
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190828093143
SQL开始执行时间：20190828093143

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190828093143
SQL开始执行时间：20190828093143


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190828093143
SQL开始执行时间：20190828093143
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190828093143

20190829001701开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829001701


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190829001703
SQL开始执行时间：20190829001703


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190829001703
SQL开始执行时间：20190829001703



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190829001705
SQL开始执行时间：20190829001705
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190829001707
SQL开始执行时间：20190829001707
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190829001710
SQL开始执行时间：20190829001710
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190829001713
SQL开始执行时间：20190829001713
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190829001715
SQL开始执行时间：20190829001715
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190829001718
SQL开始执行时间：20190829001718
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190829001721
SQL开始执行时间：20190829001721



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190829001721
SQL开始执行时间：20190829001721
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190829002015
SQL开始执行时间：20190829002015
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190829002015
SQL开始执行时间：20190829002015

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190829002015
SQL开始执行时间：20190829002015


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190829002015
SQL开始执行时间：20190829002015
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190829002016

20190830001707开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830001707


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190830001709
SQL开始执行时间：20190830001709


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190830001709
SQL开始执行时间：20190830001709



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190830001711
SQL开始执行时间：20190830001711
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190830001713
SQL开始执行时间：20190830001713
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190830001715
SQL开始执行时间：20190830001715
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190830001718
SQL开始执行时间：20190830001718
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190830001721
SQL开始执行时间：20190830001721
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190830001724
SQL开始执行时间：20190830001724
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190830001726
SQL开始执行时间：20190830001726



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190830001726
SQL开始执行时间：20190830001726
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190830002023
SQL开始执行时间：20190830002023
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190830002023
SQL开始执行时间：20190830002023

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190830002024
SQL开始执行时间：20190830002024


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190830002024
SQL开始执行时间：20190830002024
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190830002024

20190831001636开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831001636


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190831001638
SQL开始执行时间：20190831001638


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190831001638
SQL开始执行时间：20190831001638



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190831001640
SQL开始执行时间：20190831001640
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190831001642
SQL开始执行时间：20190831001642
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190831001644
SQL开始执行时间：20190831001644
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190831001646
SQL开始执行时间：20190831001646
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190831001649
SQL开始执行时间：20190831001649
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190831001651
SQL开始执行时间：20190831001651
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190831001654
SQL开始执行时间：20190831001654



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190831001654
SQL开始执行时间：20190831001654
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190831001943
SQL开始执行时间：20190831001943
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190831001944
SQL开始执行时间：20190831001944

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190831001944
SQL开始执行时间：20190831001944


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190831001944
SQL开始执行时间：20190831001944
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190831001944

20190902094336开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902094336


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190902094338
SQL开始执行时间：20190902094338


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190902094338
SQL开始执行时间：20190902094338



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190902094340
SQL开始执行时间：20190902094340
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190902094342
SQL开始执行时间：20190902094342
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190902094344
SQL开始执行时间：20190902094344
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190902094346
SQL开始执行时间：20190902094346
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190902094349
SQL开始执行时间：20190902094349
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190902094352
SQL开始执行时间：20190902094352
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190902094354
SQL开始执行时间：20190902094354



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190902094354
SQL开始执行时间：20190902094354
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190902094645
SQL开始执行时间：20190902094645
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190902094645
SQL开始执行时间：20190902094645

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190902094645
SQL开始执行时间：20190902094645


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190902094645
SQL开始执行时间：20190902094645
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190902094645

20190903001651开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903001651


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190903001653
SQL开始执行时间：20190903001653


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190903001653
SQL开始执行时间：20190903001653



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190903001655
SQL开始执行时间：20190903001655
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190903001657
SQL开始执行时间：20190903001657
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190903001659
SQL开始执行时间：20190903001659
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190903001701
SQL开始执行时间：20190903001701
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190903001704
SQL开始执行时间：20190903001704
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190903001706
SQL开始执行时间：20190903001706
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190903001710
SQL开始执行时间：20190903001710



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190903001710
SQL开始执行时间：20190903001710
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190903002009
SQL开始执行时间：20190903002009
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190903002009
SQL开始执行时间：20190903002009

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190903002009
SQL开始执行时间：20190903002009


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190903002010
SQL开始执行时间：20190903002010
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190903002010

20190904104507开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904104507


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;

20190904105035开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904105035


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;

20190904105503开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904105503


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190904105505
SQL开始执行时间：20190904105505


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190904105505
SQL开始执行时间：20190904105505



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190904105506
SQL开始执行时间：20190904105506
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190904105508
SQL开始执行时间：20190904105508
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190904105510
SQL开始执行时间：20190904105510
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190904105512
SQL开始执行时间：20190904105512
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190904105514
SQL开始执行时间：20190904105514
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190904105517
SQL开始执行时间：20190904105517
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190904105520
SQL开始执行时间：20190904105520



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190904105520
SQL开始执行时间：20190904105520
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190904105818
SQL开始执行时间：20190904105818
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190904105819
SQL开始执行时间：20190904105819

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190904105819
SQL开始执行时间：20190904105819


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190904105819
SQL开始执行时间：20190904105819
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190904105819

20190904182502开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190904182502


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190904182504
SQL开始执行时间：20190904182504


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190904182504
SQL开始执行时间：20190904182504



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190904182505
SQL开始执行时间：20190904182505
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190904182507
SQL开始执行时间：20190904182507
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190904182509
SQL开始执行时间：20190904182509
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190904182511
SQL开始执行时间：20190904182511
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190904182513
SQL开始执行时间：20190904182513
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190904182516
SQL开始执行时间：20190904182516
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190904182518
SQL开始执行时间：20190904182518



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190904182518
SQL开始执行时间：20190904182518
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190904182815
SQL开始执行时间：20190904182815
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190904182815
SQL开始执行时间：20190904182815

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190904182815
SQL开始执行时间：20190904182815


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190904182815
SQL开始执行时间：20190904182815
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190904182815
SQL开始执行时间：20190904182815

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190904182816
SQL开始执行时间：20190904182816
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190904182816

20190905001650开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905001650


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190905001652
SQL开始执行时间：20190905001652


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190905001652
SQL开始执行时间：20190905001652



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190905001654
SQL开始执行时间：20190905001654
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190905001656
SQL开始执行时间：20190905001656
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190905001658
SQL开始执行时间：20190905001658
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190905001701
SQL开始执行时间：20190905001701
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190905001703
SQL开始执行时间：20190905001703
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190905001706
SQL开始执行时间：20190905001706
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190905001709
SQL开始执行时间：20190905001709



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190905001709
SQL开始执行时间：20190905001709
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190905002010
SQL开始执行时间：20190905002010
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190905002011
SQL开始执行时间：20190905002011

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190905002011
SQL开始执行时间：20190905002011


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190905002011
SQL开始执行时间：20190905002011
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190905002011
SQL开始执行时间：20190905002011

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190905002011
SQL开始执行时间：20190905002011
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190905002011

20190905105811开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190905105811


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190905105813
SQL开始执行时间：20190905105813


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190905105813
SQL开始执行时间：20190905105813



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190905105815
SQL开始执行时间：20190905105815
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190905105816
SQL开始执行时间：20190905105816
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190905105818
SQL开始执行时间：20190905105818
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190905105820
SQL开始执行时间：20190905105820
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190905105823
SQL开始执行时间：20190905105823
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190905105825
SQL开始执行时间：20190905105825
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190905105828
SQL开始执行时间：20190905105828



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190905105828
SQL开始执行时间：20190905105828
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;

20190905110009开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190905110009


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190905110011
SQL开始执行时间：20190905110011


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190905110011
SQL开始执行时间：20190905110011



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190905110012
SQL开始执行时间：20190905110012
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190905110014
SQL开始执行时间：20190905110014
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190905110016
SQL开始执行时间：20190905110016
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190905110018
SQL开始执行时间：20190905110018
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190905110020
SQL开始执行时间：20190905110020
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190905110023
SQL开始执行时间：20190905110023
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190905110026
SQL开始执行时间：20190905110026



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190905110128
SQL开始执行时间：20190905110128
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190905110430
SQL开始执行时间：20190905110430
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190905110430
SQL开始执行时间：20190905110430

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190905110430
SQL开始执行时间：20190905110430


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190905110431
SQL开始执行时间：20190905110431
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190905110431
SQL开始执行时间：20190905110431

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190905110431
SQL开始执行时间：20190905110431
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190905110431

20190906001651开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906001651


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190906001654
SQL开始执行时间：20190906001654


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190906001654
SQL开始执行时间：20190906001654



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190906001655
SQL开始执行时间：20190906001655
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190906001657
SQL开始执行时间：20190906001657
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190906001700
SQL开始执行时间：20190906001700
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190906001702
SQL开始执行时间：20190906001702
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190906001705
SQL开始执行时间：20190906001705
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190906001708
SQL开始执行时间：20190906001708
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190906001710
SQL开始执行时间：20190906001710



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190906001711
SQL开始执行时间：20190906001711
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190906002012
SQL开始执行时间：20190906002012
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190906002012
SQL开始执行时间：20190906002012

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190906002012
SQL开始执行时间：20190906002012


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190906002012
SQL开始执行时间：20190906002012
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190906002012
SQL开始执行时间：20190906002012

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190906002013
SQL开始执行时间：20190906002013
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190906002013

20190907001705开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907001705


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190907001707
SQL开始执行时间：20190907001707


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190907001707
SQL开始执行时间：20190907001707



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190907001709
SQL开始执行时间：20190907001709
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190907001711
SQL开始执行时间：20190907001711
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190907001713
SQL开始执行时间：20190907001713
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190907001716
SQL开始执行时间：20190907001716
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190907001719
SQL开始执行时间：20190907001719
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190907001723
SQL开始执行时间：20190907001723
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190907001727
SQL开始执行时间：20190907001727



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190907001727
SQL开始执行时间：20190907001727
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190907002034
SQL开始执行时间：20190907002034
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190907002034
SQL开始执行时间：20190907002034

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190907002034
SQL开始执行时间：20190907002034


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190907002034
SQL开始执行时间：20190907002034
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190907002034
SQL开始执行时间：20190907002034

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190907002035
SQL开始执行时间：20190907002035
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190907002035

20190908001705开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908001705


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190908001707
SQL开始执行时间：20190908001707


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190908001707
SQL开始执行时间：20190908001707



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190908001709
SQL开始执行时间：20190908001709
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190908001711
SQL开始执行时间：20190908001711
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190908001713
SQL开始执行时间：20190908001713
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190908001716
SQL开始执行时间：20190908001716
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190908001718
SQL开始执行时间：20190908001718
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190908001721
SQL开始执行时间：20190908001721
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190908001725
SQL开始执行时间：20190908001725



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190908001725
SQL开始执行时间：20190908001725
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190908002030
SQL开始执行时间：20190908002030
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190908002031
SQL开始执行时间：20190908002031

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190908002031
SQL开始执行时间：20190908002031


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190908002031
SQL开始执行时间：20190908002031
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190908002031
SQL开始执行时间：20190908002031

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190908002031
SQL开始执行时间：20190908002031
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190908002031

20190909001656开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909001656


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190909001658
SQL开始执行时间：20190909001658


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190909001658
SQL开始执行时间：20190909001658



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190909001700
SQL开始执行时间：20190909001700
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190909001702
SQL开始执行时间：20190909001702
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190909001704
SQL开始执行时间：20190909001704
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190909001706
SQL开始执行时间：20190909001706
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190909001709
SQL开始执行时间：20190909001709
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190909001712
SQL开始执行时间：20190909001712
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190909001715
SQL开始执行时间：20190909001715



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190909001715
SQL开始执行时间：20190909001715
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190909002023
SQL开始执行时间：20190909002023
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190909002024

20190909090103开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190909090103


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190909090105
SQL开始执行时间：20190909090105


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190909090105
SQL开始执行时间：20190909090105



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190909090107
SQL开始执行时间：20190909090107
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190909090109
SQL开始执行时间：20190909090109
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190909090111
SQL开始执行时间：20190909090111
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190909090113
SQL开始执行时间：20190909090113
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190909090115
SQL开始执行时间：20190909090115
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190909090117
SQL开始执行时间：20190909090117
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190909090120
SQL开始执行时间：20190909090120



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190909090120
SQL开始执行时间：20190909090120
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190909090420
SQL开始执行时间：20190909090420
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190909090420
SQL开始执行时间：20190909090420

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190909090421
SQL开始执行时间：20190909090421


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190909090421
SQL开始执行时间：20190909090421
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190909090421
SQL开始执行时间：20190909090421

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190909090421
SQL开始执行时间：20190909090421
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190909090421

20190910001648开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910001648


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190910001651
SQL开始执行时间：20190910001651


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190910001651
SQL开始执行时间：20190910001651



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190910001652
SQL开始执行时间：20190910001652
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190910001654
SQL开始执行时间：20190910001654
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190910001657
SQL开始执行时间：20190910001657
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190910001700
SQL开始执行时间：20190910001700
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190910001702
SQL开始执行时间：20190910001702
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190910001705
SQL开始执行时间：20190910001705
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190910001708
SQL开始执行时间：20190910001708



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190910001708
SQL开始执行时间：20190910001708
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190910002013
SQL开始执行时间：20190910002013
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190910002013
SQL开始执行时间：20190910002013

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190910002013
SQL开始执行时间：20190910002013


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190910002013
SQL开始执行时间：20190910002013
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190910002014
SQL开始执行时间：20190910002014

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190910002014
SQL开始执行时间：20190910002014
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190910002014

20190910100740开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190910100740


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190910100742
SQL开始执行时间：20190910100742


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190910100742
SQL开始执行时间：20190910100742



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190910100743
SQL开始执行时间：20190910100743
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190910100745
SQL开始执行时间：20190910100745
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190910100747
SQL开始执行时间：20190910100747
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190910100749
SQL开始执行时间：20190910100749
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190910100751
SQL开始执行时间：20190910100751
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190910100754
SQL开始执行时间：20190910100754
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190910100757
SQL开始执行时间：20190910100757



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190910100757
SQL开始执行时间：20190910100757
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190910101101
SQL开始执行时间：20190910101101
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190910101101
SQL开始执行时间：20190910101101

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190910101101
SQL开始执行时间：20190910101101


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190910101101
SQL开始执行时间：20190910101101
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190910101102
SQL开始执行时间：20190910101102

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190910101102
SQL开始执行时间：20190910101102
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190910101102

20190911001648开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911001648


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190911001651
SQL开始执行时间：20190911001651


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190911001651
SQL开始执行时间：20190911001651



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190911001652
SQL开始执行时间：20190911001652
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190911001654
SQL开始执行时间：20190911001654
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190911001657
SQL开始执行时间：20190911001657
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190911001659
SQL开始执行时间：20190911001659
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190911001702
SQL开始执行时间：20190911001702
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190911001705
SQL开始执行时间：20190911001705
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190911001707
SQL开始执行时间：20190911001707



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190911001707
SQL开始执行时间：20190911001707
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190911002038
SQL开始执行时间：20190911002038
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190911002038
SQL开始执行时间：20190911002038

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190911002038
SQL开始执行时间：20190911002038


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190911002038
SQL开始执行时间：20190911002038
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190911002038
SQL开始执行时间：20190911002038

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190911002039
SQL开始执行时间：20190911002039
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190911002039

20190912001657开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912001657


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190912001700
SQL开始执行时间：20190912001700


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190912001700
SQL开始执行时间：20190912001700



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190912001702
SQL开始执行时间：20190912001702
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190912001703
SQL开始执行时间：20190912001703
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190912001706
SQL开始执行时间：20190912001706
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190912001708
SQL开始执行时间：20190912001708
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190912001711
SQL开始执行时间：20190912001711
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190912001713
SQL开始执行时间：20190912001713
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190912001717
SQL开始执行时间：20190912001717



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190912001717
SQL开始执行时间：20190912001717
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190912002052
SQL开始执行时间：20190912002052
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190912002053
SQL开始执行时间：20190912002053

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190912002053
SQL开始执行时间：20190912002053


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190912002053
SQL开始执行时间：20190912002053
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190912002053
SQL开始执行时间：20190912002053

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190912002053
SQL开始执行时间：20190912002053
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190912002054

20190913001707开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913001707


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190913001709
SQL开始执行时间：20190913001709


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190913001710
SQL开始执行时间：20190913001710



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190913001711
SQL开始执行时间：20190913001711
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190913001713
SQL开始执行时间：20190913001713
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190913001716
SQL开始执行时间：20190913001716
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190913001719
SQL开始执行时间：20190913001719
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190913001721
SQL开始执行时间：20190913001721
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190913001725
SQL开始执行时间：20190913001725
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190913001729
SQL开始执行时间：20190913001729



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190913001729
SQL开始执行时间：20190913001729
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190913002105
SQL开始执行时间：20190913002105
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190913002105
SQL开始执行时间：20190913002105

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190913002105
SQL开始执行时间：20190913002105


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190913002105
SQL开始执行时间：20190913002105
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190913002105
SQL开始执行时间：20190913002105

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190913002106
SQL开始执行时间：20190913002106
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190913002106

20190914001754开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914001754


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190914001756
SQL开始执行时间：20190914001756


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190914001756
SQL开始执行时间：20190914001756



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190914001758
SQL开始执行时间：20190914001758
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190914001800
SQL开始执行时间：20190914001800
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190914001802
SQL开始执行时间：20190914001802
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190914001805
SQL开始执行时间：20190914001805
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190914001807
SQL开始执行时间：20190914001807
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190914001810
SQL开始执行时间：20190914001810
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190914001813
SQL开始执行时间：20190914001813



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190914001813
SQL开始执行时间：20190914001813
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190914002150
SQL开始执行时间：20190914002150
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190914002150
SQL开始执行时间：20190914002150

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190914002150
SQL开始执行时间：20190914002150


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190914002150
SQL开始执行时间：20190914002150
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190914002151
SQL开始执行时间：20190914002151

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190914002151
SQL开始执行时间：20190914002151
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190914002151

20190915001649开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915001649


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190915001651
SQL开始执行时间：20190915001651


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190915001651
SQL开始执行时间：20190915001651



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190915001653
SQL开始执行时间：20190915001653
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190915001655
SQL开始执行时间：20190915001655
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190915001657
SQL开始执行时间：20190915001657
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190915001700
SQL开始执行时间：20190915001700
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190915001703
SQL开始执行时间：20190915001703
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190915001705
SQL开始执行时间：20190915001705
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190915001708
SQL开始执行时间：20190915001708



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190915001708
SQL开始执行时间：20190915001708
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190915002046
SQL开始执行时间：20190915002046
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190915002046
SQL开始执行时间：20190915002046

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190915002046
SQL开始执行时间：20190915002046


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190915002047
SQL开始执行时间：20190915002047
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190915002047
SQL开始执行时间：20190915002047

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190915002047
SQL开始执行时间：20190915002047
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190915002047

20190916001653开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916001653


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190916001655
SQL开始执行时间：20190916001655


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190916001655
SQL开始执行时间：20190916001655



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190916001657
SQL开始执行时间：20190916001657
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190916001659
SQL开始执行时间：20190916001659
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190916001701
SQL开始执行时间：20190916001701
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190916001704
SQL开始执行时间：20190916001704
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190916001706
SQL开始执行时间：20190916001706
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190916001709
SQL开始执行时间：20190916001709
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190916001712
SQL开始执行时间：20190916001712



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190916001712
SQL开始执行时间：20190916001712
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190916002053
SQL开始执行时间：20190916002053
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190916002053
SQL开始执行时间：20190916002053

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190916002053
SQL开始执行时间：20190916002053


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190916002053
SQL开始执行时间：20190916002053
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190916002054
SQL开始执行时间：20190916002054

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190916002054
SQL开始执行时间：20190916002054
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190916002054

20190916083654开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190916083654


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190916083656
SQL开始执行时间：20190916083656


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190916083657
SQL开始执行时间：20190916083657



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190916083658
SQL开始执行时间：20190916083658
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190916083700
SQL开始执行时间：20190916083700
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190916083702
SQL开始执行时间：20190916083702
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190916083704
SQL开始执行时间：20190916083704
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190916083706
SQL开始执行时间：20190916083706
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190916083709
SQL开始执行时间：20190916083709
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190916083712
SQL开始执行时间：20190916083712



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190916083712
SQL开始执行时间：20190916083712
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190916084047
SQL开始执行时间：20190916084047
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190916084047
SQL开始执行时间：20190916084047

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190916084047
SQL开始执行时间：20190916084047


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190916084047
SQL开始执行时间：20190916084047
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190916084047
SQL开始执行时间：20190916084047

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190916084048
SQL开始执行时间：20190916084048
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190916084048

20190916092214开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190916092214


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190916092216
SQL开始执行时间：20190916092216


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190916092216
SQL开始执行时间：20190916092216



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190916092218
SQL开始执行时间：20190916092218
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190916092220
SQL开始执行时间：20190916092220
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190916092221
SQL开始执行时间：20190916092221
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190916092224
SQL开始执行时间：20190916092224
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190916092226
SQL开始执行时间：20190916092226
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190916092228
SQL开始执行时间：20190916092228
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190916092231
SQL开始执行时间：20190916092231



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190916092231
SQL开始执行时间：20190916092231
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190916092608
SQL开始执行时间：20190916092608
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190916092608
SQL开始执行时间：20190916092608

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190916092609
SQL开始执行时间：20190916092609


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190916092609
SQL开始执行时间：20190916092609
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190916092609
SQL开始执行时间：20190916092609

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190916092609
SQL开始执行时间：20190916092609
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190916092609

20190916095352开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190916095352


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190916095354
SQL开始执行时间：20190916095354


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190916095354
SQL开始执行时间：20190916095354



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190916095356
SQL开始执行时间：20190916095356
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190916095357
SQL开始执行时间：20190916095357
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190916095359
SQL开始执行时间：20190916095359
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190916095401
SQL开始执行时间：20190916095401
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190916095404
SQL开始执行时间：20190916095404
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190916095406
SQL开始执行时间：20190916095406
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190916095409
SQL开始执行时间：20190916095409



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190916095409
SQL开始执行时间：20190916095409
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190916095743
SQL开始执行时间：20190916095743
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190916095744
SQL开始执行时间：20190916095744

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190916095744
SQL开始执行时间：20190916095744


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190916095744
SQL开始执行时间：20190916095744
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190916095744
SQL开始执行时间：20190916095744

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190916095744
SQL开始执行时间：20190916095744
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190916095745

20190916131103开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190916131103


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190916131106
SQL开始执行时间：20190916131106


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190916131106
SQL开始执行时间：20190916131106



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190916131107
SQL开始执行时间：20190916131107
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190916131109
SQL开始执行时间：20190916131109
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190916131111
SQL开始执行时间：20190916131111
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190916131113
SQL开始执行时间：20190916131113
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190916131115
SQL开始执行时间：20190916131115
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190916131118
SQL开始执行时间：20190916131118
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190916131121
SQL开始执行时间：20190916131121



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190916131121
SQL开始执行时间：20190916131121
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190916131500
SQL开始执行时间：20190916131500
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190916131501
SQL开始执行时间：20190916131501

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190916131501
SQL开始执行时间：20190916131501


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190916131501
SQL开始执行时间：20190916131501
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190916131501
SQL开始执行时间：20190916131501

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190916131501
SQL开始执行时间：20190916131501
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190916131502

20190917001719开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917001719


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190917001722
SQL开始执行时间：20190917001722


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190917001722
SQL开始执行时间：20190917001722



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190917001724
SQL开始执行时间：20190917001724
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190917001726
SQL开始执行时间：20190917001726
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190917001729
SQL开始执行时间：20190917001729
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190917001731
SQL开始执行时间：20190917001731
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190917001734
SQL开始执行时间：20190917001734
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190917001737
SQL开始执行时间：20190917001737
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190917001740
SQL开始执行时间：20190917001740



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190917001740
SQL开始执行时间：20190917001740
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190917002116
SQL开始执行时间：20190917002116
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190917002116
SQL开始执行时间：20190917002116

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190917002117
SQL开始执行时间：20190917002117


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190917002117
SQL开始执行时间：20190917002117
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190917002117
SQL开始执行时间：20190917002117

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190917002117
SQL开始执行时间：20190917002117
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190917002117

20190917091428开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190917091428


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190917091431
SQL开始执行时间：20190917091431


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190917091431
SQL开始执行时间：20190917091431



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190917091432
SQL开始执行时间：20190917091432
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190917091434
SQL开始执行时间：20190917091434
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190917091436
SQL开始执行时间：20190917091436
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190917091438
SQL开始执行时间：20190917091438
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190917091441
SQL开始执行时间：20190917091441
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190917091443
SQL开始执行时间：20190917091443
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190917091446
SQL开始执行时间：20190917091446



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190917091446
SQL开始执行时间：20190917091446
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190917091819
SQL开始执行时间：20190917091819
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190917091820
SQL开始执行时间：20190917091820

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190917091820
SQL开始执行时间：20190917091820


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190917091820
SQL开始执行时间：20190917091820
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190917091820
SQL开始执行时间：20190917091820

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190917091820
SQL开始执行时间：20190917091820
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190917091820

20190918001725开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918001725


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190918001728
SQL开始执行时间：20190918001728


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190918001728
SQL开始执行时间：20190918001728



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190918001730
SQL开始执行时间：20190918001730
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190918001733
SQL开始执行时间：20190918001733
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190918001735
SQL开始执行时间：20190918001735
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190918001738
SQL开始执行时间：20190918001738
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190918001740
SQL开始执行时间：20190918001740
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190918001743
SQL开始执行时间：20190918001743
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190918001746
SQL开始执行时间：20190918001746



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190918001746
SQL开始执行时间：20190918001746
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190918002124
SQL开始执行时间：20190918002124
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190918002124
SQL开始执行时间：20190918002124

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190918002125
SQL开始执行时间：20190918002125


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190918002125
SQL开始执行时间：20190918002125
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190918002125
SQL开始执行时间：20190918002125

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190918002125
SQL开始执行时间：20190918002125
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190918002125

20190918093341开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190918093341


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190918093343
SQL开始执行时间：20190918093343


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190918093343
SQL开始执行时间：20190918093343



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190918093344
SQL开始执行时间：20190918093344
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190918093346
SQL开始执行时间：20190918093346
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190918093348
SQL开始执行时间：20190918093348
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190918093350
SQL开始执行时间：20190918093350
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190918093353
SQL开始执行时间：20190918093353
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190918093355
SQL开始执行时间：20190918093355
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190918093358
SQL开始执行时间：20190918093358



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190918093358
SQL开始执行时间：20190918093358
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190918093735
SQL开始执行时间：20190918093735
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190918093735
SQL开始执行时间：20190918093735

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190918093735
SQL开始执行时间：20190918093735


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190918093735
SQL开始执行时间：20190918093735
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190918093735
SQL开始执行时间：20190918093735

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190918093736
SQL开始执行时间：20190918093736
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190918093736

20190919001717开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919001717


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190919001720
SQL开始执行时间：20190919001720


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190919001720
SQL开始执行时间：20190919001720



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190919001723
SQL开始执行时间：20190919001723
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190919001725
SQL开始执行时间：20190919001725
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190919001727
SQL开始执行时间：20190919001727
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190919001730
SQL开始执行时间：20190919001730
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190919001733
SQL开始执行时间：20190919001733
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190919001736
SQL开始执行时间：20190919001736
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190919001739
SQL开始执行时间：20190919001739



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190919001739
SQL开始执行时间：20190919001739
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190919002115
SQL开始执行时间：20190919002115
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190919002115
SQL开始执行时间：20190919002115

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190919002115
SQL开始执行时间：20190919002115


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190919002115
SQL开始执行时间：20190919002115
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190919002115
SQL开始执行时间：20190919002115

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190919002116
SQL开始执行时间：20190919002116
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190919002116

20190919101315开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190919101315


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190919101317
SQL开始执行时间：20190919101317


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190919101317
SQL开始执行时间：20190919101317



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190919101318
SQL开始执行时间：20190919101318
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190919101320
SQL开始执行时间：20190919101320
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190919101322
SQL开始执行时间：20190919101322
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190919101324
SQL开始执行时间：20190919101324
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190919101327
SQL开始执行时间：20190919101327
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190919101329
SQL开始执行时间：20190919101329
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190919101332
SQL开始执行时间：20190919101332



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190919101332
SQL开始执行时间：20190919101332
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190919101706
SQL开始执行时间：20190919101706
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190919101706
SQL开始执行时间：20190919101706

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190919101707
SQL开始执行时间：20190919101707


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190919101707
SQL开始执行时间：20190919101707
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190919101707
SQL开始执行时间：20190919101707

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190919101707
SQL开始执行时间：20190919101707
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190919101707

20190920001730开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920001730


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190920001733
SQL开始执行时间：20190920001733


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190920001733
SQL开始执行时间：20190920001733



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190920001735
SQL开始执行时间：20190920001735
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190920001737
SQL开始执行时间：20190920001737
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190920001740
SQL开始执行时间：20190920001740
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190920001742
SQL开始执行时间：20190920001742
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190920001745
SQL开始执行时间：20190920001745
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190920001748
SQL开始执行时间：20190920001748
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190920001752
SQL开始执行时间：20190920001752



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190920001753
SQL开始执行时间：20190920001753
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190920002132
SQL开始执行时间：20190920002132
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190920002132
SQL开始执行时间：20190920002132

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190920002132
SQL开始执行时间：20190920002132


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190920002132
SQL开始执行时间：20190920002132
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190920002133
SQL开始执行时间：20190920002133

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190920002133
SQL开始执行时间：20190920002133
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190920002133

20190920100545开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190920100545


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190920100547
SQL开始执行时间：20190920100547


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190920100547
SQL开始执行时间：20190920100547



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190920100549
SQL开始执行时间：20190920100549
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190920100550
SQL开始执行时间：20190920100550
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190920100552
SQL开始执行时间：20190920100552
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190920100555
SQL开始执行时间：20190920100555
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190920100557
SQL开始执行时间：20190920100557
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190920100600
SQL开始执行时间：20190920100600
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190920100603
SQL开始执行时间：20190920100603



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190920100603
SQL开始执行时间：20190920100603
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190920100940
SQL开始执行时间：20190920100940
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190920100940
SQL开始执行时间：20190920100940

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190920100940
SQL开始执行时间：20190920100940


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190920100940
SQL开始执行时间：20190920100940
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190920100941
SQL开始执行时间：20190920100941

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190920100941
SQL开始执行时间：20190920100941
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190920100941

20190921001721开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921001721


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190921001724
SQL开始执行时间：20190921001724


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190921001724
SQL开始执行时间：20190921001724



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190921001726
SQL开始执行时间：20190921001726
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190921001729
SQL开始执行时间：20190921001729
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190921001731
SQL开始执行时间：20190921001731
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190921001734
SQL开始执行时间：20190921001734
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190921001737
SQL开始执行时间：20190921001737
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190921001740
SQL开始执行时间：20190921001740
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190921001743
SQL开始执行时间：20190921001743



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190921001743
SQL开始执行时间：20190921001743
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190921002123
SQL开始执行时间：20190921002123
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190921002123
SQL开始执行时间：20190921002123

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190921002124
SQL开始执行时间：20190921002124


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190921002124
SQL开始执行时间：20190921002124
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190921002124
SQL开始执行时间：20190921002124

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190921002124
SQL开始执行时间：20190921002124
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190921002124

20190922001727开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922001727


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190922001729
SQL开始执行时间：20190922001729


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190922001730
SQL开始执行时间：20190922001730



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190922001731
SQL开始执行时间：20190922001731
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190922001733
SQL开始执行时间：20190922001733
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190922001736
SQL开始执行时间：20190922001736
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190922001738
SQL开始执行时间：20190922001738
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190922001741
SQL开始执行时间：20190922001741
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190922001744
SQL开始执行时间：20190922001744
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190922001749
SQL开始执行时间：20190922001749



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190922001749
SQL开始执行时间：20190922001749
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190922002128
SQL开始执行时间：20190922002128
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190922002128
SQL开始执行时间：20190922002128

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190922002128
SQL开始执行时间：20190922002128


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190922002129
SQL开始执行时间：20190922002129
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190922002129
SQL开始执行时间：20190922002129

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190922002129
SQL开始执行时间：20190922002129
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190922002129

20190923001813开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923001813


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190923001816
SQL开始执行时间：20190923001816


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190923001816
SQL开始执行时间：20190923001816



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190923001818
SQL开始执行时间：20190923001818
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190923001820
SQL开始执行时间：20190923001820
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190923001822
SQL开始执行时间：20190923001822
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190923001824
SQL开始执行时间：20190923001824
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190923001827
SQL开始执行时间：20190923001827
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190923001830
SQL开始执行时间：20190923001830
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190923001833
SQL开始执行时间：20190923001833



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190923001833
SQL开始执行时间：20190923001833
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190923002212
SQL开始执行时间：20190923002212
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190923002212
SQL开始执行时间：20190923002212

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190923002213
SQL开始执行时间：20190923002213


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190923002213
SQL开始执行时间：20190923002213
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190923002213
SQL开始执行时间：20190923002213

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190923002213
SQL开始执行时间：20190923002213
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190923002213

20190923112606开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190923112606


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190923112608
SQL开始执行时间：20190923112608


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190923112608
SQL开始执行时间：20190923112608



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190923112610
SQL开始执行时间：20190923112610
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190923112611
SQL开始执行时间：20190923112611
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190923112613
SQL开始执行时间：20190923112613
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190923112616
SQL开始执行时间：20190923112616
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190923112618
SQL开始执行时间：20190923112618
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190923112621
SQL开始执行时间：20190923112621
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190923112624
SQL开始执行时间：20190923112624



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190923112624
SQL开始执行时间：20190923112624
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190923113007
SQL开始执行时间：20190923113007
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190923113007
SQL开始执行时间：20190923113007

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190923113007
SQL开始执行时间：20190923113007


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190923113008
SQL开始执行时间：20190923113008
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190923113008
SQL开始执行时间：20190923113008

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190923113008
SQL开始执行时间：20190923113008
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190923113008

20190924001728开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924001728


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190924001730
SQL开始执行时间：20190924001730


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190924001730
SQL开始执行时间：20190924001730



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190924001732
SQL开始执行时间：20190924001732
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190924001734
SQL开始执行时间：20190924001734
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190924001737
SQL开始执行时间：20190924001737
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190924001740
SQL开始执行时间：20190924001740
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190924001744
SQL开始执行时间：20190924001744
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190924001747
SQL开始执行时间：20190924001747
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190924001751
SQL开始执行时间：20190924001751



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190924001751
SQL开始执行时间：20190924001751
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190924002208
SQL开始执行时间：20190924002208
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190924002208
SQL开始执行时间：20190924002208

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190924002208
SQL开始执行时间：20190924002208


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190924002209
SQL开始执行时间：20190924002209
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190924002209
SQL开始执行时间：20190924002209

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190924002209
SQL开始执行时间：20190924002209
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190924002209

20190924093059开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190924093059


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190924093101
SQL开始执行时间：20190924093101


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190924093101
SQL开始执行时间：20190924093101



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190924093102
SQL开始执行时间：20190924093102
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190924093104
SQL开始执行时间：20190924093104
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190924093106
SQL开始执行时间：20190924093106
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190924093109
SQL开始执行时间：20190924093109
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190924093111
SQL开始执行时间：20190924093111
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190924093114
SQL开始执行时间：20190924093114
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190924093117
SQL开始执行时间：20190924093117



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190924093117
SQL开始执行时间：20190924093117
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190924093506
SQL开始执行时间：20190924093506
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190924093506
SQL开始执行时间：20190924093506

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190924093506
SQL开始执行时间：20190924093506


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190924093506
SQL开始执行时间：20190924093506
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190924093507
SQL开始执行时间：20190924093507

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190924093507
SQL开始执行时间：20190924093507
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190924093507

20190925090423开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925090423


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190925090426
SQL开始执行时间：20190925090426


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190925090426
SQL开始执行时间：20190925090426



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190925090427
SQL开始执行时间：20190925090427
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190925090429
SQL开始执行时间：20190925090429
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190925090432
SQL开始执行时间：20190925090432
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190925090435
SQL开始执行时间：20190925090435
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190925090437
SQL开始执行时间：20190925090437
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190925090440
SQL开始执行时间：20190925090440
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190925090444
SQL开始执行时间：20190925090444



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190925090444
SQL开始执行时间：20190925090444
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190925090830
SQL开始执行时间：20190925090830
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190925090830
SQL开始执行时间：20190925090830

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190925090831
SQL开始执行时间：20190925090831


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190925090831
SQL开始执行时间：20190925090831
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190925090831
SQL开始执行时间：20190925090831

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190925090831
SQL开始执行时间：20190925090831
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190925090831

20190925112658开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190925112658


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190925112700
SQL开始执行时间：20190925112700


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190925112700
SQL开始执行时间：20190925112700



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190925112702
SQL开始执行时间：20190925112702
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190925112704
SQL开始执行时间：20190925112704
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190925112706
SQL开始执行时间：20190925112706
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190925112708
SQL开始执行时间：20190925112708
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190925112711
SQL开始执行时间：20190925112711
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190925112713
SQL开始执行时间：20190925112713
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190925112716
SQL开始执行时间：20190925112716



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190925112716
SQL开始执行时间：20190925112716
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190925113102
SQL开始执行时间：20190925113102
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190925113102
SQL开始执行时间：20190925113102

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190925113102
SQL开始执行时间：20190925113102


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190925113102
SQL开始执行时间：20190925113102
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190925113102
SQL开始执行时间：20190925113102

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190925113103
SQL开始执行时间：20190925113103
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190925113103

20190926001731开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926001731


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190926001733
SQL开始执行时间：20190926001733


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190926001733
SQL开始执行时间：20190926001733



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190926001735
SQL开始执行时间：20190926001735
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190926001738
SQL开始执行时间：20190926001738
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190926001741
SQL开始执行时间：20190926001741
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190926001744
SQL开始执行时间：20190926001744
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190926001747
SQL开始执行时间：20190926001747
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190926001750
SQL开始执行时间：20190926001750
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190926001753
SQL开始执行时间：20190926001753



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190926001753
SQL开始执行时间：20190926001753
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190926002147
SQL开始执行时间：20190926002147
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190926002147
SQL开始执行时间：20190926002147

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190926002147
SQL开始执行时间：20190926002147


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190926002147
SQL开始执行时间：20190926002147
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190926002148
SQL开始执行时间：20190926002148

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190926002148
SQL开始执行时间：20190926002148
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190926002148

20190927093726开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927093726


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190927093729
SQL开始执行时间：20190927093729


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190927093729
SQL开始执行时间：20190927093729



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190927093730
SQL开始执行时间：20190927093730
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190927093732
SQL开始执行时间：20190927093732
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190927093735
SQL开始执行时间：20190927093735
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190927093738
SQL开始执行时间：20190927093738
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190927093740
SQL开始执行时间：20190927093740
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190927093743
SQL开始执行时间：20190927093743
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190927093747
SQL开始执行时间：20190927093747



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190927093747
SQL开始执行时间：20190927093747
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190927094135
SQL开始执行时间：20190927094135
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190927094135
SQL开始执行时间：20190927094135

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190927094135
SQL开始执行时间：20190927094135


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190927094135
SQL开始执行时间：20190927094135
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190927094136
SQL开始执行时间：20190927094136

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190927094136
SQL开始执行时间：20190927094136
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190927094136

20190928001726开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928001726


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190928001728
SQL开始执行时间：20190928001728


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190928001728
SQL开始执行时间：20190928001728



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190928001730
SQL开始执行时间：20190928001730
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190928001732
SQL开始执行时间：20190928001732
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190928001735
SQL开始执行时间：20190928001735
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190928001737
SQL开始执行时间：20190928001737
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190928001740
SQL开始执行时间：20190928001740
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190928001743
SQL开始执行时间：20190928001743
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190928001748
SQL开始执行时间：20190928001748



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190928001748
SQL开始执行时间：20190928001748
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190928002138
SQL开始执行时间：20190928002138
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190928002139
SQL开始执行时间：20190928002139

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190928002139
SQL开始执行时间：20190928002139


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190928002139
SQL开始执行时间：20190928002139
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190928002139
SQL开始执行时间：20190928002139

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190928002139
SQL开始执行时间：20190928002139
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190928002139

20190929001719开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929001719


create temporary table edw.accvouch_oa_pre as
SELECT
  a.id,
  a.requestid,
	a.baoxiaorq,
	a.liuchengbh,
	a.baoxiaor,
	a.baoxiaorbm,
	c.cdr as chengdanr,
	a.chengdanrbm,
	a.kaipiaogs,
	a.feiyonglx,
	d.selectname,
	c.fashengrq,
  c.u8km,
  c.kmwb,
	a.neibuhy,
	a.neibuhylx,
	a.pingzhengscrq,
	c.xiangguankh,
	a.baoxiaorgs,
	b.subcompanyname,
	(ifnull(c.jine,0) - ifnull(c.sh,0)) as jine,
	c.shuoming,
	c.beizhu,
	c.sjqy,
	CONCAT(c.shuoming,'-',ifnull(c.beizhu,'')) as new_beizhu
FROM
	ufdata.oa_formtable_main_183 a
	LEFT JOIN ufdata.oa_hrmsubcompany b 
	  ON a.baoxiaorgs = b.id
	left join ufdata.oa_formtable_main_183_dt1 c 
	  on a.id = c.mainid
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) d 
	  on a.feiyonglx = d.Selectvalue 
	 and a.feiyonglx !=1 

;
SQL结束执行时间：20190929001721
SQL开始执行时间：20190929001721


create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_SelectItem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQL结束执行时间：20190929001721
SQL开始执行时间：20190929001721



CREATE INDEX index_accvouch_oa_pre_chengdanrbm ON edw.accvouch_oa_pre(chengdanrbm)
;
SQL结束执行时间：20190929001723
SQL开始执行时间：20190929001723
CREATE INDEX index_accvouch_oa_pre_baoxiaorbm ON edw.accvouch_oa_pre(baoxiaorbm)
;
SQL结束执行时间：20190929001725
SQL开始执行时间：20190929001725
CREATE INDEX index_accvouch_oa_pre_baoxiaor ON edw.accvouch_oa_pre(baoxiaor)
;
SQL结束执行时间：20190929001728
SQL开始执行时间：20190929001728
CREATE INDEX index_accvouch_oa_pre_chengdanr ON edw.accvouch_oa_pre(chengdanr)
;
SQL结束执行时间：20190929001731
SQL开始执行时间：20190929001731
CREATE INDEX index_accvouch_oa_pre_kaipiaogs ON edw.accvouch_oa_pre(kaipiaogs)
;
SQL结束执行时间：20190929001733
SQL开始执行时间：20190929001733
CREATE INDEX index_accvouch_oa_pre_feiyonglx ON edw.accvouch_oa_pre(feiyonglx)
;
SQL结束执行时间：20190929001736
SQL开始执行时间：20190929001736
CREATE INDEX index_accvouch_oa_pre_requestid ON edw.accvouch_oa_pre(requestid)
;
SQL结束执行时间：20190929001740
SQL开始执行时间：20190929001740



truncate table edw.accvouch_oa
;
SQL结束执行时间：20190929001740
SQL开始执行时间：20190929001740
insert into edw.accvouch_oa
select a.id
      ,case when m.currentnodetype = '0' then '发起'
            when m.currentnodetype = '1' then '审核'
            when m.currentnodetype = '2' then '审核'
            when m.currentnodetype = '3' then '归档'
            else '未知' end as lc_state
      ,a.baoxiaorq
      ,a.liuchengbh
      ,a.baoxiaor
      ,c.lastname as bx_name
      ,a.baoxiaorbm
      ,b.departmentname as bxr_dept_name
      ,a.chengdanr
      ,d.lastname as cd_name
      ,a.chengdanrbm
      ,e.departmentname as cdr_dept_name
      ,f.subcompanyname as kaipiaogs
      ,a.subcompanyname
      ,case when f.subcompanyname = '浙江博圣生物技术股份有限公司' then 'UFDATA_111_2018'
            when f.subcompanyname = '杭州贝生医疗器械有限公司' then 'UFDATA_168_2018'
            when f.subcompanyname = '湖北奥博特生物技术有限公司' then 'UFDATA_588_2018'
            when f.subcompanyname = '杭州贝安云科技有限公司' then 'UFDATA_555_2018'
            when f.subcompanyname = '杭州宝荣科技有限公司' then 'UFDATA_222_2018'
            when f.subcompanyname = '杭州启代医疗门诊部有限公司' then 'UFDATA_666_2018'
            when f.subcompanyname = '杭州博圣云鼎冷链物流有限公司' then 'UFDATA_169_2018'
            when f.subcompanyname = '南京卓恩生物技术有限公司' then 'UFDATA_118_2018'
            when f.subcompanyname = '宁波贝生医疗器械有限公司' then 'UFDATA_333_2018'
            when f.subcompanyname = '上海恩允实业有限公司' then 'UFDATA_123_2018'
            else '未知' end as db
      ,a.feiyonglx
      ,a.selectname
      ,a.u8km
      ,g.kemumc
      ,g.u8kemubm
      ,a.kmwb
      ,case when k.oa_code is null then '请核查' else k.u8_code end
      ,case when k.oa_code is null then '请核查' else k.code end
      ,k.code_name
      ,k.code_lv2
      ,k.code_lv2_name
      ,a.fashengrq
      ,a.pingzhengscrq
      ,a.xiangguankh
      ,h.kehumc
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cuscode 
            when h.kehumc is null	then null 
            else '请核查' end as bi_cuscode
      ,case when l.ccusname is not null and h.kehumc is not null then l.bi_cusname
            when h.kehumc is null	then null 
            else '请核查' end as bi_cusname
      ,h.selectname
      ,a.neibuhy
      ,i.huiyimc
      ,a.neibuhylx
      ,j.selectname
      ,a.jine
      ,a.shuoming
      ,a.beizhu
      ,a.new_beizhu
      ,localtimestamp()
  from edw.accvouch_oa_pre a
	left join ufdata.oa_hrmdepartment e on a.chengdanrbm = e.id
	left join ufdata.oa_hrmdepartment b on a.baoxiaorbm = b.id
	left join ufdata.oa_hrmresource c on a.baoxiaor = c.id
	left join ufdata.oa_hrmresource d on a.chengdanr = d.id
	left join ufdata.oa_hrmsubcompany f on a.kaipiaogs = f.id
	left join ufdata.oa_uf_u8dykm g on a.u8km = g.id
	left join ufdata.oa_formtable_main_6_pre h on a.xiangguankh = h.id
	left join ufdata.oa_formtable_main_112 i on a.neibuhy = i.id
	left join (select Selectvalue,selectname from ufdata.oa_workflow_SelectItem where fieldid = 6530 group by Selectvalue) j
	  on a.feiyonglx = j.Selectvalue 
	left join edw.dic_code k
	  on a.kmwb = k.oa_code
	left join (select * from edw.dic_customer group by ccusname) l
	  on h.kehumc = l.ccusname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQL结束执行时间：20190929002133
SQL开始执行时间：20190929002133
update edw.accvouch_oa a
 inner join edw.dic_code b
   on a.u8dykm = b.oa_code
   set a.oadykm = b.u8_code
      ,a.oa_ccode = b.code
      ,a.oa_ccode_name = b.code_name
      ,a.oa_ccode_lv2 = b.code_lv2
      ,a.oa_ccode_name_lv2 = b.code_lv2_name
 where a.kmwb is null
   and a.baoxiaorq >= '2019-01-01'

;
SQL结束执行时间：20190929002134
SQL开始执行时间：20190929002134

update edw.accvouch_oa set oadykm = '6601试剂招标经费',oa_ccode = '660131',oa_ccode_name='试剂招标经费',oa_ccode_lv2='660131',oa_ccode_name_lv2='试剂招标经费' where kmwb = '66010032试剂招标经费'
;
SQL结束执行时间：20190929002134
SQL开始执行时间：20190929002134


delete from edw.accvouch_oa where baoxiaorq = '2019-01-15' and oadykm = '6605人员成本其他'
;
SQL结束执行时间：20190929002134
SQL开始执行时间：20190929002134
delete from edw.accvouch_oa where baoxiaorq = '2018-11-27' and oadykm = '6605押金'
;
SQL结束执行时间：20190929002134
SQL开始执行时间：20190929002134

update edw.accvouch_oa set fashengrq = '2019-07-08' where fashengrq = '1019-07-08'
;
SQL结束执行时间：20190929002134
SQL开始执行时间：20190929002134
update edw.accvouch_oa set fashengrq = '2019-07-30' where fashengrq = '1019-07-30'
;
SQL结束执行时间：20190929002135
