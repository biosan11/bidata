
20190530111354开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190530111354
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111355开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190530111355
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111355开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190530111355
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111355开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190530111355
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111356开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190530111356
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111356开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190530111356
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111356开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190530111356
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111356开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190530111356
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111357开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190530111357
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111357开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190530111357
/*
CREATE TABLE `checklist_sy` (
  `province_ori` varchar(60) DEFAULT NULL COMMENT '销售省份',
  `person_ori` varchar(60) DEFAULT NULL COMMENT '负责人',
  `ddate_sample` date DEFAULT NULL COMMENT '实验日期',
  `hospital` varchar(20) DEFAULT NULL COMMENT '实验单位',
  `company_id` varchar(120) DEFAULT NULL COMMENT '实验单位编号',
  `company_exp` varchar(120) DEFAULT NULL COMMENT '实验单位名称',
  `ddate` date DEFAULT NULL COMMENT '日期',
  `collection_hospital` varchar(120) DEFAULT NULL COMMENT '采血单位',
  `ccuscode` varchar(20) DEFAULT NULL COMMENT '客户编号',
  `ccusname` varchar(120) DEFAULT NULL COMMENT '客户名称',
  `item_code` varchar(40) DEFAULT NULL COMMENT '项目编号',
  `item_name` varchar(255) DEFAULT NULL COMMENT '项目名称',
  `cbustype` varchar(60) DEFAULT NULL COMMENT '业务类型',
  `inum_person` int(6) DEFAULT NULL COMMENT '检测量',
  `conclusion` varchar(60) DEFAULT NULL COMMENT '实验结论',
  `sys_time` datetime DEFAULT NULL COMMENT '数据时间戳',
  KEY `index_checklist_ccuscode` (`ccuscode`),
  KEY `index_checklist_item_code` (`item_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='检测量表-实验室'
;

20190530111527开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190530111527




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111527
SQL开始执行时间：20190530111527
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date >= '2019-01-01'

;
SQL结束执行时间：20190530111531
SQL开始执行时间：20190530111531

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111534
SQL开始执行时间：20190530111534
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111538
SQL开始执行时间：20190530111538
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111543
SQL开始执行时间：20190530111543

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111543
SQL开始执行时间：20190530111543
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;

20190530111646开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190530111646




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111646
SQL开始执行时间：20190530111646
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-02'

;

20190530111656开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190530111656




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111656
SQL开始执行时间：20190530111656
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-01'

;
SQL结束执行时间：20190530111659
SQL开始执行时间：20190530111659

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111659
SQL开始执行时间：20190530111659
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111659
SQL开始执行时间：20190530111659
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111659
SQL开始执行时间：20190530111659

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111659
SQL开始执行时间：20190530111659
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111701
SQL开始执行时间：20190530111701

delete from edw.checklist_sy where experiment_date = '2019-01-01'
;

20190530111701开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190530111701




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111701
SQL开始执行时间：20190530111701
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-02'

;
SQL结束执行时间：20190530111704
SQL开始执行时间：20190530111704

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111704
SQL开始执行时间：20190530111704
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111704
SQL开始执行时间：20190530111704
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111704
SQL开始执行时间：20190530111704

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111704
SQL开始执行时间：20190530111704
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111714
SQL开始执行时间：20190530111714

delete from edw.checklist_sy where experiment_date = '2019-01-02'
;

20190530111714开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190530111714




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111714
SQL开始执行时间：20190530111714
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-03'

;
SQL结束执行时间：20190530111717
SQL开始执行时间：20190530111717

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111717
SQL开始执行时间：20190530111717
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111717
SQL开始执行时间：20190530111717
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111718
SQL开始执行时间：20190530111718

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111718
SQL开始执行时间：20190530111718
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111730
SQL开始执行时间：20190530111730

delete from edw.checklist_sy where experiment_date = '2019-01-03'
;

20190530111731开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190530111731




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111731
SQL开始执行时间：20190530111731
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-04'

;
SQL结束执行时间：20190530111734
SQL开始执行时间：20190530111734

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111734
SQL开始执行时间：20190530111734
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111734
SQL开始执行时间：20190530111734
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111734
SQL开始执行时间：20190530111734

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111734
SQL开始执行时间：20190530111734
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111744
SQL开始执行时间：20190530111744

delete from edw.checklist_sy where experiment_date = '2019-01-04'
;

20190530111744开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190530111744




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111744
SQL开始执行时间：20190530111744
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-05'

;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747

delete from edw.checklist_sy where experiment_date = '2019-01-05'
;

20190530111747开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190530111747




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111747
SQL开始执行时间：20190530111747
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-06'

;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750

delete from edw.checklist_sy where experiment_date = '2019-01-06'
;

20190530111750开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190530111750




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111750
SQL开始执行时间：20190530111750
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-07'

;
SQL结束执行时间：20190530111753
SQL开始执行时间：20190530111753

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111753
SQL开始执行时间：20190530111753
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111754
SQL开始执行时间：20190530111754
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111754
SQL开始执行时间：20190530111754

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111754
SQL开始执行时间：20190530111754
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111804
SQL开始执行时间：20190530111804

delete from edw.checklist_sy where experiment_date = '2019-01-07'
;

20190530111805开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190530111805




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111805
SQL开始执行时间：20190530111805
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-08'

;
SQL结束执行时间：20190530111808
SQL开始执行时间：20190530111808

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111808
SQL开始执行时间：20190530111808
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111808
SQL开始执行时间：20190530111808
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111808
SQL开始执行时间：20190530111808

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111808
SQL开始执行时间：20190530111808
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111822
SQL开始执行时间：20190530111822

delete from edw.checklist_sy where experiment_date = '2019-01-08'
;

20190530111822开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190530111822




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111822
SQL开始执行时间：20190530111822
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-09'

;
SQL结束执行时间：20190530111825
SQL开始执行时间：20190530111825

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111825
SQL开始执行时间：20190530111825
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111825
SQL开始执行时间：20190530111825
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111826
SQL开始执行时间：20190530111826

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111826
SQL开始执行时间：20190530111826
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111837
SQL开始执行时间：20190530111837

delete from edw.checklist_sy where experiment_date = '2019-01-09'
;

20190530111837开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190530111837




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111837
SQL开始执行时间：20190530111837
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-10'

;
SQL结束执行时间：20190530111840
SQL开始执行时间：20190530111840

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530111840
SQL开始执行时间：20190530111840
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530111840
SQL开始执行时间：20190530111840
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530111840
SQL开始执行时间：20190530111840

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530111840
SQL开始执行时间：20190530111840
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530111851
SQL开始执行时间：20190530111851

delete from edw.checklist_sy where experiment_date = '2019-01-10'
;

20190530111852开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190530111852




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530111852
SQL开始执行时间：20190530111852
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-11'

;

20190530112232开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190530112232




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112232
SQL开始执行时间：20190530112232
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-01'

;
SQL结束执行时间：20190530112234
SQL开始执行时间：20190530112234

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112234
SQL开始执行时间：20190530112234
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112234
SQL开始执行时间：20190530112234
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112234
SQL开始执行时间：20190530112234

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112234
SQL开始执行时间：20190530112234
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112236
SQL开始执行时间：20190530112236

delete from edw.checklist_sy where ddate = '2019-01-01'
;
SQL结束执行时间：20190530112236
SQL开始执行时间：20190530112236
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112236

20190530112237开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190530112237




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112237
SQL开始执行时间：20190530112237
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-02'

;
SQL结束执行时间：20190530112239
SQL开始执行时间：20190530112239

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112239
SQL开始执行时间：20190530112239
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112239
SQL开始执行时间：20190530112239
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112240
SQL开始执行时间：20190530112240

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112240
SQL开始执行时间：20190530112240
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112249
SQL开始执行时间：20190530112249

delete from edw.checklist_sy where ddate = '2019-01-02'
;
SQL结束执行时间：20190530112249
SQL开始执行时间：20190530112249
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112250

20190530112250开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190530112250




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112250
SQL开始执行时间：20190530112250
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-03'

;
SQL结束执行时间：20190530112252
SQL开始执行时间：20190530112252

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112253
SQL开始执行时间：20190530112253
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112253
SQL开始执行时间：20190530112253
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112253
SQL开始执行时间：20190530112253

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112253
SQL开始执行时间：20190530112253
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112306
SQL开始执行时间：20190530112306

delete from edw.checklist_sy where ddate = '2019-01-03'
;
SQL结束执行时间：20190530112306
SQL开始执行时间：20190530112306
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112306

20190530112307开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190530112307




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112307
SQL开始执行时间：20190530112307
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-04'

;
SQL结束执行时间：20190530112309
SQL开始执行时间：20190530112309

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112309
SQL开始执行时间：20190530112309
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112309
SQL开始执行时间：20190530112309
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112310
SQL开始执行时间：20190530112310

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112310
SQL开始执行时间：20190530112310
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112320
SQL开始执行时间：20190530112320

delete from edw.checklist_sy where ddate = '2019-01-04'
;
SQL结束执行时间：20190530112320
SQL开始执行时间：20190530112320
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112320

20190530112321开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190530112321




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112321
SQL开始执行时间：20190530112321
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-05'

;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323

delete from edw.checklist_sy where ddate = '2019-01-05'
;
SQL结束执行时间：20190530112323
SQL开始执行时间：20190530112323
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112323

20190530112324开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190530112324




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112324
SQL开始执行时间：20190530112324
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-06'

;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326

delete from edw.checklist_sy where ddate = '2019-01-06'
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112326

20190530112326开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190530112326




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112326
SQL开始执行时间：20190530112326
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-07'

;
SQL结束执行时间：20190530112329
SQL开始执行时间：20190530112329

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112329
SQL开始执行时间：20190530112329
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112329
SQL开始执行时间：20190530112329
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112329
SQL开始执行时间：20190530112329

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112329
SQL开始执行时间：20190530112329
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112340
SQL开始执行时间：20190530112340

delete from edw.checklist_sy where ddate = '2019-01-07'
;
SQL结束执行时间：20190530112340
SQL开始执行时间：20190530112340
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112340

20190530112340开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190530112340




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112340
SQL开始执行时间：20190530112340
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-08'

;
SQL结束执行时间：20190530112343
SQL开始执行时间：20190530112343

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112343
SQL开始执行时间：20190530112343
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112343
SQL开始执行时间：20190530112343
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112344
SQL开始执行时间：20190530112344

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112344
SQL开始执行时间：20190530112344
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112357
SQL开始执行时间：20190530112357

delete from edw.checklist_sy where ddate = '2019-01-08'
;
SQL结束执行时间：20190530112357
SQL开始执行时间：20190530112357
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112358

20190530112358开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190530112358




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112358
SQL开始执行时间：20190530112358
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-09'

;
SQL结束执行时间：20190530112400
SQL开始执行时间：20190530112400

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112400
SQL开始执行时间：20190530112400
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112401
SQL开始执行时间：20190530112401
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112401
SQL开始执行时间：20190530112401

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112401
SQL开始执行时间：20190530112401
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112412
SQL开始执行时间：20190530112412

delete from edw.checklist_sy where ddate = '2019-01-09'
;
SQL结束执行时间：20190530112412
SQL开始执行时间：20190530112412
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112413

20190530112413开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190530112413




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112413
SQL开始执行时间：20190530112413
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-10'

;
SQL结束执行时间：20190530112415
SQL开始执行时间：20190530112415

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112415
SQL开始执行时间：20190530112415
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112416
SQL开始执行时间：20190530112416
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112416
SQL开始执行时间：20190530112416

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112416
SQL开始执行时间：20190530112416
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112427
SQL开始执行时间：20190530112427

delete from edw.checklist_sy where ddate = '2019-01-10'
;
SQL结束执行时间：20190530112427
SQL开始执行时间：20190530112427
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112427

20190530112427开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190530112427




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112427
SQL开始执行时间：20190530112427
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-11'

;
SQL结束执行时间：20190530112430
SQL开始执行时间：20190530112430

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112430
SQL开始执行时间：20190530112430
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112430
SQL开始执行时间：20190530112430
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112430
SQL开始执行时间：20190530112430

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112430
SQL开始执行时间：20190530112430
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112437
SQL开始执行时间：20190530112437

delete from edw.checklist_sy where ddate = '2019-01-11'
;
SQL结束执行时间：20190530112437
SQL开始执行时间：20190530112437
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112437

20190530112437开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190530112437




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112437
SQL开始执行时间：20190530112437
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-12'

;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440

delete from edw.checklist_sy where ddate = '2019-01-12'
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112440

20190530112440开始执行2019-01-13数据加载日志:
SQL开始执行时间：20190530112440




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112440
SQL开始执行时间：20190530112440
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-13'

;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443

delete from edw.checklist_sy where ddate = '2019-01-13'
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112443

20190530112443开始执行2019-01-14数据加载日志:
SQL开始执行时间：20190530112443




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112443
SQL开始执行时间：20190530112443
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-14'

;
SQL结束执行时间：20190530112446
SQL开始执行时间：20190530112446

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112446
SQL开始执行时间：20190530112446
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112446
SQL开始执行时间：20190530112446
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112446
SQL开始执行时间：20190530112446

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112446
SQL开始执行时间：20190530112446
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112457
SQL开始执行时间：20190530112457

delete from edw.checklist_sy where ddate = '2019-01-14'
;
SQL结束执行时间：20190530112457
SQL开始执行时间：20190530112457
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112458

20190530112458开始执行2019-01-15数据加载日志:
SQL开始执行时间：20190530112458




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112458
SQL开始执行时间：20190530112458
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-15'

;
SQL结束执行时间：20190530112500
SQL开始执行时间：20190530112500

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112500
SQL开始执行时间：20190530112500
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112501
SQL开始执行时间：20190530112501
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112501
SQL开始执行时间：20190530112501

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112501
SQL开始执行时间：20190530112501
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112511
SQL开始执行时间：20190530112511

delete from edw.checklist_sy where ddate = '2019-01-15'
;
SQL结束执行时间：20190530112511
SQL开始执行时间：20190530112511
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112512

20190530112512开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190530112512




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112512
SQL开始执行时间：20190530112512
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-16'

;
SQL结束执行时间：20190530112514
SQL开始执行时间：20190530112514

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112514
SQL开始执行时间：20190530112514
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112515
SQL开始执行时间：20190530112515
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112515
SQL开始执行时间：20190530112515

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112515
SQL开始执行时间：20190530112515
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112524
SQL开始执行时间：20190530112524

delete from edw.checklist_sy where ddate = '2019-01-16'
;
SQL结束执行时间：20190530112524
SQL开始执行时间：20190530112524
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112525

20190530112525开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190530112525




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112525
SQL开始执行时间：20190530112525
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-17'

;
SQL结束执行时间：20190530112527
SQL开始执行时间：20190530112527

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112528
SQL开始执行时间：20190530112528
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112528
SQL开始执行时间：20190530112528
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112528
SQL开始执行时间：20190530112528

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112528
SQL开始执行时间：20190530112528
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112536
SQL开始执行时间：20190530112536

delete from edw.checklist_sy where ddate = '2019-01-17'
;
SQL结束执行时间：20190530112536
SQL开始执行时间：20190530112536
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112536

20190530112536开始执行2019-01-18数据加载日志:
SQL开始执行时间：20190530112536




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112536
SQL开始执行时间：20190530112536
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-18'

;
SQL结束执行时间：20190530112539
SQL开始执行时间：20190530112539

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112539
SQL开始执行时间：20190530112539
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112539
SQL开始执行时间：20190530112539
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112539
SQL开始执行时间：20190530112539

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112539
SQL开始执行时间：20190530112539
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112546
SQL开始执行时间：20190530112546

delete from edw.checklist_sy where ddate = '2019-01-18'
;
SQL结束执行时间：20190530112546
SQL开始执行时间：20190530112546
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112547

20190530112547开始执行2019-01-19数据加载日志:
SQL开始执行时间：20190530112547




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112547
SQL开始执行时间：20190530112547
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-19'

;
SQL结束执行时间：20190530112549
SQL开始执行时间：20190530112549

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112549
SQL开始执行时间：20190530112549
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112549
SQL开始执行时间：20190530112549
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112549
SQL开始执行时间：20190530112549

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112549
SQL开始执行时间：20190530112549
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112550
SQL开始执行时间：20190530112550

delete from edw.checklist_sy where ddate = '2019-01-19'
;
SQL结束执行时间：20190530112550
SQL开始执行时间：20190530112550
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112550

20190530112550开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190530112550




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112550
SQL开始执行时间：20190530112550
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-20'

;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553

delete from edw.checklist_sy where ddate = '2019-01-20'
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112553

20190530112553开始执行2019-01-21数据加载日志:
SQL开始执行时间：20190530112553




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112553
SQL开始执行时间：20190530112553
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-21'

;
SQL结束执行时间：20190530112556
SQL开始执行时间：20190530112556

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112556
SQL开始执行时间：20190530112556
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112556
SQL开始执行时间：20190530112556
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112557
SQL开始执行时间：20190530112557

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112557
SQL开始执行时间：20190530112557
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112607
SQL开始执行时间：20190530112607

delete from edw.checklist_sy where ddate = '2019-01-21'
;
SQL结束执行时间：20190530112607
SQL开始执行时间：20190530112607
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112608

20190530112608开始执行2019-01-22数据加载日志:
SQL开始执行时间：20190530112608




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112608
SQL开始执行时间：20190530112608
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-22'

;
SQL结束执行时间：20190530112611
SQL开始执行时间：20190530112611

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112611
SQL开始执行时间：20190530112611
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112611
SQL开始执行时间：20190530112611
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112611
SQL开始执行时间：20190530112611

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112611
SQL开始执行时间：20190530112611
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112620
SQL开始执行时间：20190530112620

delete from edw.checklist_sy where ddate = '2019-01-22'
;
SQL结束执行时间：20190530112620
SQL开始执行时间：20190530112620
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112621

20190530112621开始执行2019-01-23数据加载日志:
SQL开始执行时间：20190530112621




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112621
SQL开始执行时间：20190530112621
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-23'

;
SQL结束执行时间：20190530112624
SQL开始执行时间：20190530112624

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112624
SQL开始执行时间：20190530112624
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112624
SQL开始执行时间：20190530112624
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112624
SQL开始执行时间：20190530112624

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112624
SQL开始执行时间：20190530112624
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112636
SQL开始执行时间：20190530112636

delete from edw.checklist_sy where ddate = '2019-01-23'
;
SQL结束执行时间：20190530112636
SQL开始执行时间：20190530112636
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112637

20190530112637开始执行2019-01-24数据加载日志:
SQL开始执行时间：20190530112637




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112637
SQL开始执行时间：20190530112637
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-24'

;
SQL结束执行时间：20190530112640
SQL开始执行时间：20190530112640

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112640
SQL开始执行时间：20190530112640
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112640
SQL开始执行时间：20190530112640
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112640
SQL开始执行时间：20190530112640

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112640
SQL开始执行时间：20190530112640
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112650
SQL开始执行时间：20190530112650

delete from edw.checklist_sy where ddate = '2019-01-24'
;
SQL结束执行时间：20190530112650
SQL开始执行时间：20190530112650
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112650

20190530112650开始执行2019-01-25数据加载日志:
SQL开始执行时间：20190530112650




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112650
SQL开始执行时间：20190530112650
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-25'

;
SQL结束执行时间：20190530112653
SQL开始执行时间：20190530112653

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112653
SQL开始执行时间：20190530112653
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112653
SQL开始执行时间：20190530112653
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112653
SQL开始执行时间：20190530112653

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112653
SQL开始执行时间：20190530112653
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112701
SQL开始执行时间：20190530112701

delete from edw.checklist_sy where ddate = '2019-01-25'
;
SQL结束执行时间：20190530112701
SQL开始执行时间：20190530112701
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112702

20190530112702开始执行2019-01-26数据加载日志:
SQL开始执行时间：20190530112702




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112702
SQL开始执行时间：20190530112702
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-26'

;
SQL结束执行时间：20190530112704
SQL开始执行时间：20190530112704

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112704
SQL开始执行时间：20190530112704
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112704
SQL开始执行时间：20190530112704
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112704
SQL开始执行时间：20190530112704

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112704
SQL开始执行时间：20190530112704
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112705
SQL开始执行时间：20190530112705

delete from edw.checklist_sy where ddate = '2019-01-26'
;
SQL结束执行时间：20190530112705
SQL开始执行时间：20190530112705
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112705

20190530112705开始执行2019-01-27数据加载日志:
SQL开始执行时间：20190530112705




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112705
SQL开始执行时间：20190530112705
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-27'

;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708

delete from edw.checklist_sy where ddate = '2019-01-27'
;
SQL结束执行时间：20190530112708
SQL开始执行时间：20190530112708
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112709

20190530112709开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190530112709




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112709
SQL开始执行时间：20190530112709
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-28'

;
SQL结束执行时间：20190530112711
SQL开始执行时间：20190530112711

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112711
SQL开始执行时间：20190530112711
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112712
SQL开始执行时间：20190530112712
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112712
SQL开始执行时间：20190530112712

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112712
SQL开始执行时间：20190530112712
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112723
SQL开始执行时间：20190530112723

delete from edw.checklist_sy where ddate = '2019-01-28'
;
SQL结束执行时间：20190530112723
SQL开始执行时间：20190530112723
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112723

20190530112723开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190530112723




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112723
SQL开始执行时间：20190530112723
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-29'

;
SQL结束执行时间：20190530112726
SQL开始执行时间：20190530112726

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112726
SQL开始执行时间：20190530112726
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112727
SQL开始执行时间：20190530112727
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112727
SQL开始执行时间：20190530112727

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112727
SQL开始执行时间：20190530112727
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112743
SQL开始执行时间：20190530112743

delete from edw.checklist_sy where ddate = '2019-01-29'
;
SQL结束执行时间：20190530112743
SQL开始执行时间：20190530112743
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112744

20190530112744开始执行2019-01-30数据加载日志:
SQL开始执行时间：20190530112744




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112744
SQL开始执行时间：20190530112744
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-30'

;
SQL结束执行时间：20190530112747
SQL开始执行时间：20190530112747

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112747
SQL开始执行时间：20190530112747
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112747
SQL开始执行时间：20190530112747
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112747
SQL开始执行时间：20190530112747

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112747
SQL开始执行时间：20190530112747
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112758
SQL开始执行时间：20190530112758

delete from edw.checklist_sy where ddate = '2019-01-30'
;
SQL结束执行时间：20190530112758
SQL开始执行时间：20190530112758
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112758

20190530112758开始执行2019-01-31数据加载日志:
SQL开始执行时间：20190530112758




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112758
SQL开始执行时间：20190530112758
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-01-31'

;
SQL结束执行时间：20190530112801
SQL开始执行时间：20190530112801

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112801
SQL开始执行时间：20190530112801
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112801
SQL开始执行时间：20190530112801
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112802
SQL开始执行时间：20190530112802

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112802
SQL开始执行时间：20190530112802
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112814
SQL开始执行时间：20190530112814

delete from edw.checklist_sy where ddate = '2019-01-31'
;
SQL结束执行时间：20190530112814
SQL开始执行时间：20190530112814
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112815

20190530112815开始执行2019-02-01数据加载日志:
SQL开始执行时间：20190530112815




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112815
SQL开始执行时间：20190530112815
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-01'

;
SQL结束执行时间：20190530112817
SQL开始执行时间：20190530112817

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112817
SQL开始执行时间：20190530112817
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112818
SQL开始执行时间：20190530112818
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112818
SQL开始执行时间：20190530112818

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112818
SQL开始执行时间：20190530112818
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112827
SQL开始执行时间：20190530112827

delete from edw.checklist_sy where ddate = '2019-02-01'
;
SQL结束执行时间：20190530112827
SQL开始执行时间：20190530112827
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112828

20190530112828开始执行2019-02-02数据加载日志:
SQL开始执行时间：20190530112828




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112828
SQL开始执行时间：20190530112828
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-02'

;
SQL结束执行时间：20190530112831
SQL开始执行时间：20190530112831

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112831
SQL开始执行时间：20190530112831
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112831
SQL开始执行时间：20190530112831
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112831
SQL开始执行时间：20190530112831

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112831
SQL开始执行时间：20190530112831
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112840
SQL开始执行时间：20190530112840

delete from edw.checklist_sy where ddate = '2019-02-02'
;
SQL结束执行时间：20190530112840
SQL开始执行时间：20190530112840
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112840

20190530112840开始执行2019-02-03数据加载日志:
SQL开始执行时间：20190530112840




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112840
SQL开始执行时间：20190530112840
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-03'

;
SQL结束执行时间：20190530112843
SQL开始执行时间：20190530112843

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112843
SQL开始执行时间：20190530112843
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112843
SQL开始执行时间：20190530112843
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112843
SQL开始执行时间：20190530112843

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112843
SQL开始执行时间：20190530112843
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112851
SQL开始执行时间：20190530112851

delete from edw.checklist_sy where ddate = '2019-02-03'
;
SQL结束执行时间：20190530112851
SQL开始执行时间：20190530112851
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112851

20190530112852开始执行2019-02-04数据加载日志:
SQL开始执行时间：20190530112852




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112852
SQL开始执行时间：20190530112852
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-04'

;
SQL结束执行时间：20190530112854
SQL开始执行时间：20190530112854

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112854
SQL开始执行时间：20190530112854
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112854
SQL开始执行时间：20190530112854
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112854
SQL开始执行时间：20190530112854

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112854
SQL开始执行时间：20190530112854
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112855
SQL开始执行时间：20190530112855

delete from edw.checklist_sy where ddate = '2019-02-04'
;
SQL结束执行时间：20190530112855
SQL开始执行时间：20190530112855
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112855

20190530112855开始执行2019-02-05数据加载日志:
SQL开始执行时间：20190530112855




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112855
SQL开始执行时间：20190530112855
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-05'

;
SQL结束执行时间：20190530112857
SQL开始执行时间：20190530112857

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112857
SQL开始执行时间：20190530112857
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112857
SQL开始执行时间：20190530112857
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112857
SQL开始执行时间：20190530112857

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112857
SQL开始执行时间：20190530112857
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112858
SQL开始执行时间：20190530112858

delete from edw.checklist_sy where ddate = '2019-02-05'
;
SQL结束执行时间：20190530112858
SQL开始执行时间：20190530112858
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112858

20190530112858开始执行2019-02-06数据加载日志:
SQL开始执行时间：20190530112858




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112858
SQL开始执行时间：20190530112858
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-06'

;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901

delete from edw.checklist_sy where ddate = '2019-02-06'
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112901

20190530112901开始执行2019-02-07数据加载日志:
SQL开始执行时间：20190530112901




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112901
SQL开始执行时间：20190530112901
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-07'

;
SQL结束执行时间：20190530112904
SQL开始执行时间：20190530112904

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112904
SQL开始执行时间：20190530112904
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112904
SQL开始执行时间：20190530112904
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112904
SQL开始执行时间：20190530112904

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112904
SQL开始执行时间：20190530112904
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112905
SQL开始执行时间：20190530112905

delete from edw.checklist_sy where ddate = '2019-02-07'
;
SQL结束执行时间：20190530112905
SQL开始执行时间：20190530112905
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112905

20190530112905开始执行2019-02-08数据加载日志:
SQL开始执行时间：20190530112905




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112905
SQL开始执行时间：20190530112905
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-08'

;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908

delete from edw.checklist_sy where ddate = '2019-02-08'
;
SQL结束执行时间：20190530112908
SQL开始执行时间：20190530112908
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112909

20190530112909开始执行2019-02-09数据加载日志:
SQL开始执行时间：20190530112909




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112909
SQL开始执行时间：20190530112909
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-09'

;
SQL结束执行时间：20190530112911
SQL开始执行时间：20190530112911

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112911
SQL开始执行时间：20190530112911
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112911
SQL开始执行时间：20190530112911
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112911
SQL开始执行时间：20190530112911

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112911
SQL开始执行时间：20190530112911
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112912
SQL开始执行时间：20190530112912

delete from edw.checklist_sy where ddate = '2019-02-09'
;
SQL结束执行时间：20190530112912
SQL开始执行时间：20190530112912
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112912

20190530112912开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190530112912




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112912
SQL开始执行时间：20190530112912
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-10'

;
SQL结束执行时间：20190530112914
SQL开始执行时间：20190530112914

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112914
SQL开始执行时间：20190530112914
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112914
SQL开始执行时间：20190530112914
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112914
SQL开始执行时间：20190530112914

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112914
SQL开始执行时间：20190530112914
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112915
SQL开始执行时间：20190530112915

delete from edw.checklist_sy where ddate = '2019-02-10'
;
SQL结束执行时间：20190530112915
SQL开始执行时间：20190530112915
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112915

20190530112915开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190530112915




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112915
SQL开始执行时间：20190530112915
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-11'

;
SQL结束执行时间：20190530112917
SQL开始执行时间：20190530112917

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112917
SQL开始执行时间：20190530112917
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112918
SQL开始执行时间：20190530112918
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112918
SQL开始执行时间：20190530112918

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112918
SQL开始执行时间：20190530112918
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112925
SQL开始执行时间：20190530112925

delete from edw.checklist_sy where ddate = '2019-02-11'
;
SQL结束执行时间：20190530112925
SQL开始执行时间：20190530112925
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112926

20190530112926开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190530112926




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112926
SQL开始执行时间：20190530112926
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-12'

;
SQL结束执行时间：20190530112929
SQL开始执行时间：20190530112929

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112929
SQL开始执行时间：20190530112929
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112929
SQL开始执行时间：20190530112929
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112929
SQL开始执行时间：20190530112929

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112929
SQL开始执行时间：20190530112929
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112940
SQL开始执行时间：20190530112940

delete from edw.checklist_sy where ddate = '2019-02-12'
;
SQL结束执行时间：20190530112940
SQL开始执行时间：20190530112940
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112941

20190530112941开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190530112941




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112941
SQL开始执行时间：20190530112941
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-13'

;
SQL结束执行时间：20190530112943
SQL开始执行时间：20190530112943

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112944
SQL开始执行时间：20190530112944
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112944
SQL开始执行时间：20190530112944
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112944
SQL开始执行时间：20190530112944

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112944
SQL开始执行时间：20190530112944
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530112954
SQL开始执行时间：20190530112954

delete from edw.checklist_sy where ddate = '2019-02-13'
;
SQL结束执行时间：20190530112954
SQL开始执行时间：20190530112954
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530112954

20190530112954开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190530112954




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530112954
SQL开始执行时间：20190530112954
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-14'

;
SQL结束执行时间：20190530112957
SQL开始执行时间：20190530112957

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530112957
SQL开始执行时间：20190530112957
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530112957
SQL开始执行时间：20190530112957
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530112958
SQL开始执行时间：20190530112958

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530112958
SQL开始执行时间：20190530112958
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113010
SQL开始执行时间：20190530113010

delete from edw.checklist_sy where ddate = '2019-02-14'
;
SQL结束执行时间：20190530113010
SQL开始执行时间：20190530113010
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113011

20190530113011开始执行2019-02-15数据加载日志:
SQL开始执行时间：20190530113011




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113011
SQL开始执行时间：20190530113011
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-15'

;
SQL结束执行时间：20190530113014
SQL开始执行时间：20190530113014

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113014
SQL开始执行时间：20190530113014
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113014
SQL开始执行时间：20190530113014
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113014
SQL开始执行时间：20190530113014

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113014
SQL开始执行时间：20190530113014
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113024
SQL开始执行时间：20190530113024

delete from edw.checklist_sy where ddate = '2019-02-15'
;
SQL结束执行时间：20190530113024
SQL开始执行时间：20190530113024
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113024

20190530113025开始执行2019-02-16数据加载日志:
SQL开始执行时间：20190530113025




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113025
SQL开始执行时间：20190530113025
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-16'

;
SQL结束执行时间：20190530113027
SQL开始执行时间：20190530113027

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113027
SQL开始执行时间：20190530113027
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113027
SQL开始执行时间：20190530113027
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113027
SQL开始执行时间：20190530113027

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113027
SQL开始执行时间：20190530113027
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113028
SQL开始执行时间：20190530113028

delete from edw.checklist_sy where ddate = '2019-02-16'
;
SQL结束执行时间：20190530113028
SQL开始执行时间：20190530113028
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113028

20190530113028开始执行2019-02-17数据加载日志:
SQL开始执行时间：20190530113028




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113028
SQL开始执行时间：20190530113028
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-17'

;
SQL结束执行时间：20190530113030
SQL开始执行时间：20190530113030

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113030
SQL开始执行时间：20190530113030
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113030
SQL开始执行时间：20190530113030
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113030
SQL开始执行时间：20190530113030

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113030
SQL开始执行时间：20190530113030
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113031
SQL开始执行时间：20190530113031

delete from edw.checklist_sy where ddate = '2019-02-17'
;
SQL结束执行时间：20190530113031
SQL开始执行时间：20190530113031
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113031

20190530113031开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190530113031




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113031
SQL开始执行时间：20190530113031
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-18'

;
SQL结束执行时间：20190530113034
SQL开始执行时间：20190530113034

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113034
SQL开始执行时间：20190530113034
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113034
SQL开始执行时间：20190530113034
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113034
SQL开始执行时间：20190530113034

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113034
SQL开始执行时间：20190530113034
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113046
SQL开始执行时间：20190530113046

delete from edw.checklist_sy where ddate = '2019-02-18'
;
SQL结束执行时间：20190530113046
SQL开始执行时间：20190530113046
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113047

20190530113047开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190530113047




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113047
SQL开始执行时间：20190530113047
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-19'

;
SQL结束执行时间：20190530113050
SQL开始执行时间：20190530113050

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113050
SQL开始执行时间：20190530113050
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113050
SQL开始执行时间：20190530113050
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113050
SQL开始执行时间：20190530113050

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113050
SQL开始执行时间：20190530113050
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113103
SQL开始执行时间：20190530113103

delete from edw.checklist_sy where ddate = '2019-02-19'
;
SQL结束执行时间：20190530113103
SQL开始执行时间：20190530113103
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113104

20190530113104开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190530113104




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113104
SQL开始执行时间：20190530113104
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-20'

;
SQL结束执行时间：20190530113107
SQL开始执行时间：20190530113107

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113107
SQL开始执行时间：20190530113107
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113107
SQL开始执行时间：20190530113107
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113107
SQL开始执行时间：20190530113107

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113107
SQL开始执行时间：20190530113107
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113122
SQL开始执行时间：20190530113122

delete from edw.checklist_sy where ddate = '2019-02-20'
;
SQL结束执行时间：20190530113122
SQL开始执行时间：20190530113122
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113122

20190530113123开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190530113123




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113123
SQL开始执行时间：20190530113123
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-21'

;
SQL结束执行时间：20190530113125
SQL开始执行时间：20190530113125

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113125
SQL开始执行时间：20190530113125
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113126
SQL开始执行时间：20190530113126
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113126
SQL开始执行时间：20190530113126

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113126
SQL开始执行时间：20190530113126
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113136
SQL开始执行时间：20190530113136

delete from edw.checklist_sy where ddate = '2019-02-21'
;
SQL结束执行时间：20190530113137
SQL开始执行时间：20190530113137
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113137

20190530113137开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190530113137




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113137
SQL开始执行时间：20190530113137
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-22'

;
SQL结束执行时间：20190530113140
SQL开始执行时间：20190530113140

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113140
SQL开始执行时间：20190530113140
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113140
SQL开始执行时间：20190530113140
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113140
SQL开始执行时间：20190530113140

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113140
SQL开始执行时间：20190530113140
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113149
SQL开始执行时间：20190530113149

delete from edw.checklist_sy where ddate = '2019-02-22'
;
SQL结束执行时间：20190530113149
SQL开始执行时间：20190530113149
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113150

20190530113150开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190530113150




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113150
SQL开始执行时间：20190530113150
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-23'

;
SQL结束执行时间：20190530113152
SQL开始执行时间：20190530113152

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113152
SQL开始执行时间：20190530113152
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113152
SQL开始执行时间：20190530113152
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113152
SQL开始执行时间：20190530113152

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113152
SQL开始执行时间：20190530113152
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113153
SQL开始执行时间：20190530113153

delete from edw.checklist_sy where ddate = '2019-02-23'
;
SQL结束执行时间：20190530113153
SQL开始执行时间：20190530113153
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113153

20190530113153开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190530113153




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113153
SQL开始执行时间：20190530113153
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-24'

;
SQL结束执行时间：20190530113156
SQL开始执行时间：20190530113156

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113156
SQL开始执行时间：20190530113156
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113156
SQL开始执行时间：20190530113156
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113156
SQL开始执行时间：20190530113156

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113156
SQL开始执行时间：20190530113156
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113157
SQL开始执行时间：20190530113157

delete from edw.checklist_sy where ddate = '2019-02-24'
;
SQL结束执行时间：20190530113157
SQL开始执行时间：20190530113157
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113157

20190530113157开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190530113157




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113157
SQL开始执行时间：20190530113157
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-25'

;
SQL结束执行时间：20190530113200
SQL开始执行时间：20190530113200

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113200
SQL开始执行时间：20190530113200
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113200
SQL开始执行时间：20190530113200
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113200
SQL开始执行时间：20190530113200

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113200
SQL开始执行时间：20190530113200
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113213
SQL开始执行时间：20190530113213

delete from edw.checklist_sy where ddate = '2019-02-25'
;
SQL结束执行时间：20190530113213
SQL开始执行时间：20190530113213
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113214

20190530113214开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190530113214




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113214
SQL开始执行时间：20190530113214
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-26'

;
SQL结束执行时间：20190530113217
SQL开始执行时间：20190530113217

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113217
SQL开始执行时间：20190530113217
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113217
SQL开始执行时间：20190530113217
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113217
SQL开始执行时间：20190530113217

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113217
SQL开始执行时间：20190530113217
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113231
SQL开始执行时间：20190530113231

delete from edw.checklist_sy where ddate = '2019-02-26'
;
SQL结束执行时间：20190530113232
SQL开始执行时间：20190530113232
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113232

20190530113232开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190530113232




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113232
SQL开始执行时间：20190530113232
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-27'

;
SQL结束执行时间：20190530113235
SQL开始执行时间：20190530113235

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113235
SQL开始执行时间：20190530113235
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113235
SQL开始执行时间：20190530113235
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113236
SQL开始执行时间：20190530113236

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113236
SQL开始执行时间：20190530113236
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113249
SQL开始执行时间：20190530113249

delete from edw.checklist_sy where ddate = '2019-02-27'
;
SQL结束执行时间：20190530113249
SQL开始执行时间：20190530113249
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113249

20190530113250开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190530113250




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113250
SQL开始执行时间：20190530113250
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-02-28'

;
SQL结束执行时间：20190530113252
SQL开始执行时间：20190530113252

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113252
SQL开始执行时间：20190530113252
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113253
SQL开始执行时间：20190530113253
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113253
SQL开始执行时间：20190530113253

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113253
SQL开始执行时间：20190530113253
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113305
SQL开始执行时间：20190530113305

delete from edw.checklist_sy where ddate = '2019-02-28'
;
SQL结束执行时间：20190530113305
SQL开始执行时间：20190530113305
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113306

20190530113306开始执行2019-03-01数据加载日志:
SQL开始执行时间：20190530113306




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113306
SQL开始执行时间：20190530113306
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-01'

;
SQL结束执行时间：20190530113309
SQL开始执行时间：20190530113309

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113309
SQL开始执行时间：20190530113309
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113309
SQL开始执行时间：20190530113309
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113309
SQL开始执行时间：20190530113309

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113309
SQL开始执行时间：20190530113309
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113318
SQL开始执行时间：20190530113318

delete from edw.checklist_sy where ddate = '2019-03-01'
;
SQL结束执行时间：20190530113318
SQL开始执行时间：20190530113318
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113319

20190530113319开始执行2019-03-02数据加载日志:
SQL开始执行时间：20190530113319




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113319
SQL开始执行时间：20190530113319
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-02'

;
SQL结束执行时间：20190530113321
SQL开始执行时间：20190530113321

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113321
SQL开始执行时间：20190530113321
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322

delete from edw.checklist_sy where ddate = '2019-03-02'
;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113322

20190530113322开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190530113322




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113322
SQL开始执行时间：20190530113322
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-03'

;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325

delete from edw.checklist_sy where ddate = '2019-03-03'
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113325

20190530113325开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190530113325




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113325
SQL开始执行时间：20190530113325
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-04'

;
SQL结束执行时间：20190530113328
SQL开始执行时间：20190530113328

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113328
SQL开始执行时间：20190530113328
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113328
SQL开始执行时间：20190530113328
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113328
SQL开始执行时间：20190530113328

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113328
SQL开始执行时间：20190530113328
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113339
SQL开始执行时间：20190530113339

delete from edw.checklist_sy where ddate = '2019-03-04'
;
SQL结束执行时间：20190530113339
SQL开始执行时间：20190530113339
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113340

20190530113340开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190530113340




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113340
SQL开始执行时间：20190530113340
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-05'

;
SQL结束执行时间：20190530113343
SQL开始执行时间：20190530113343

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113343
SQL开始执行时间：20190530113343
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113343
SQL开始执行时间：20190530113343
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113344
SQL开始执行时间：20190530113344

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113344
SQL开始执行时间：20190530113344
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113358
SQL开始执行时间：20190530113358

delete from edw.checklist_sy where ddate = '2019-03-05'
;
SQL结束执行时间：20190530113359
SQL开始执行时间：20190530113359
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113359

20190530113359开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190530113359




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113359
SQL开始执行时间：20190530113359
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-06'

;
SQL结束执行时间：20190530113402
SQL开始执行时间：20190530113402

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113402
SQL开始执行时间：20190530113402
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113402
SQL开始执行时间：20190530113402
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113403
SQL开始执行时间：20190530113403

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113403
SQL开始执行时间：20190530113403
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113415
SQL开始执行时间：20190530113415

delete from edw.checklist_sy where ddate = '2019-03-06'
;
SQL结束执行时间：20190530113415
SQL开始执行时间：20190530113415
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113416

20190530113416开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190530113416




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113416
SQL开始执行时间：20190530113416
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-07'

;
SQL结束执行时间：20190530113419
SQL开始执行时间：20190530113419

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113419
SQL开始执行时间：20190530113419
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113419
SQL开始执行时间：20190530113419
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113419
SQL开始执行时间：20190530113419

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113419
SQL开始执行时间：20190530113419
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113430
SQL开始执行时间：20190530113430

delete from edw.checklist_sy where ddate = '2019-03-07'
;
SQL结束执行时间：20190530113430
SQL开始执行时间：20190530113430
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113431

20190530113431开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190530113431




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113431
SQL开始执行时间：20190530113431
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-08'

;
SQL结束执行时间：20190530113434
SQL开始执行时间：20190530113434

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113434
SQL开始执行时间：20190530113434
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113434
SQL开始执行时间：20190530113434
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113434
SQL开始执行时间：20190530113434

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113434
SQL开始执行时间：20190530113434
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113442
SQL开始执行时间：20190530113442

delete from edw.checklist_sy where ddate = '2019-03-08'
;
SQL结束执行时间：20190530113442
SQL开始执行时间：20190530113442
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113443

20190530113443开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190530113443




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113443
SQL开始执行时间：20190530113443
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-09'

;
SQL结束执行时间：20190530113445
SQL开始执行时间：20190530113445

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113445
SQL开始执行时间：20190530113445
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113445
SQL开始执行时间：20190530113445
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113445
SQL开始执行时间：20190530113445

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113445
SQL开始执行时间：20190530113445
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113446
SQL开始执行时间：20190530113446

delete from edw.checklist_sy where ddate = '2019-03-09'
;
SQL结束执行时间：20190530113446
SQL开始执行时间：20190530113446
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113446

20190530113446开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190530113446




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113446
SQL开始执行时间：20190530113446
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-10'

;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449

delete from edw.checklist_sy where ddate = '2019-03-10'
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113449

20190530113449开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190530113449




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113449
SQL开始执行时间：20190530113449
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-11'

;
SQL结束执行时间：20190530113451
SQL开始执行时间：20190530113451

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113452
SQL开始执行时间：20190530113452
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113452
SQL开始执行时间：20190530113452
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113452
SQL开始执行时间：20190530113452

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113452
SQL开始执行时间：20190530113452
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113502
SQL开始执行时间：20190530113502

delete from edw.checklist_sy where ddate = '2019-03-11'
;
SQL结束执行时间：20190530113502
SQL开始执行时间：20190530113502
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113503

20190530113503开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190530113503




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113503
SQL开始执行时间：20190530113503
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-12'

;
SQL结束执行时间：20190530113506
SQL开始执行时间：20190530113506

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113506
SQL开始执行时间：20190530113506
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113506
SQL开始执行时间：20190530113506
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113506
SQL开始执行时间：20190530113506

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113506
SQL开始执行时间：20190530113506
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113521
SQL开始执行时间：20190530113521

delete from edw.checklist_sy where ddate = '2019-03-12'
;
SQL结束执行时间：20190530113522
SQL开始执行时间：20190530113522
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113522

20190530113522开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190530113522




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113522
SQL开始执行时间：20190530113522
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-13'

;
SQL结束执行时间：20190530113525
SQL开始执行时间：20190530113525

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113525
SQL开始执行时间：20190530113525
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113525
SQL开始执行时间：20190530113525
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113526
SQL开始执行时间：20190530113526

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113526
SQL开始执行时间：20190530113526
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113538
SQL开始执行时间：20190530113538

delete from edw.checklist_sy where ddate = '2019-03-13'
;
SQL结束执行时间：20190530113538
SQL开始执行时间：20190530113538
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113538

20190530113538开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190530113538




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113538
SQL开始执行时间：20190530113538
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-14'

;
SQL结束执行时间：20190530113541
SQL开始执行时间：20190530113541

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113541
SQL开始执行时间：20190530113541
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113541
SQL开始执行时间：20190530113541
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113542
SQL开始执行时间：20190530113542

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113542
SQL开始执行时间：20190530113542
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113553
SQL开始执行时间：20190530113553

delete from edw.checklist_sy where ddate = '2019-03-14'
;
SQL结束执行时间：20190530113553
SQL开始执行时间：20190530113553
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113554

20190530113554开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190530113554




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113554
SQL开始执行时间：20190530113554
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-15'

;
SQL结束执行时间：20190530113556
SQL开始执行时间：20190530113556

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113556
SQL开始执行时间：20190530113556
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113557
SQL开始执行时间：20190530113557
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113557
SQL开始执行时间：20190530113557

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113557
SQL开始执行时间：20190530113557
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113605
SQL开始执行时间：20190530113605

delete from edw.checklist_sy where ddate = '2019-03-15'
;
SQL结束执行时间：20190530113605
SQL开始执行时间：20190530113605
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113605

20190530113605开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190530113605




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113605
SQL开始执行时间：20190530113605
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-16'

;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608

delete from edw.checklist_sy where ddate = '2019-03-16'
;
SQL结束执行时间：20190530113608
SQL开始执行时间：20190530113608
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113609

20190530113609开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190530113609




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113609
SQL开始执行时间：20190530113609
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-17'

;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611

delete from edw.checklist_sy where ddate = '2019-03-17'
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113611

20190530113611开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190530113611




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113611
SQL开始执行时间：20190530113611
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-18'

;
SQL结束执行时间：20190530113614
SQL开始执行时间：20190530113614

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113614
SQL开始执行时间：20190530113614
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113614
SQL开始执行时间：20190530113614
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113615
SQL开始执行时间：20190530113615

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113615
SQL开始执行时间：20190530113615
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113627
SQL开始执行时间：20190530113627

delete from edw.checklist_sy where ddate = '2019-03-18'
;
SQL结束执行时间：20190530113627
SQL开始执行时间：20190530113627
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113628

20190530113628开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190530113628




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113628
SQL开始执行时间：20190530113628
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-19'

;
SQL结束执行时间：20190530113631
SQL开始执行时间：20190530113631

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113631
SQL开始执行时间：20190530113631
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113631
SQL开始执行时间：20190530113631
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113631
SQL开始执行时间：20190530113631

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113631
SQL开始执行时间：20190530113631
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113645
SQL开始执行时间：20190530113645

delete from edw.checklist_sy where ddate = '2019-03-19'
;
SQL结束执行时间：20190530113645
SQL开始执行时间：20190530113645
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113646

20190530113646开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190530113646




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113646
SQL开始执行时间：20190530113646
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-20'

;
SQL结束执行时间：20190530113648
SQL开始执行时间：20190530113648

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113648
SQL开始执行时间：20190530113648
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113649
SQL开始执行时间：20190530113649
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113649
SQL开始执行时间：20190530113649

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113649
SQL开始执行时间：20190530113649
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113701
SQL开始执行时间：20190530113701

delete from edw.checklist_sy where ddate = '2019-03-20'
;
SQL结束执行时间：20190530113701
SQL开始执行时间：20190530113701
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113702

20190530113702开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190530113702




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113702
SQL开始执行时间：20190530113702
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-21'

;
SQL结束执行时间：20190530113704
SQL开始执行时间：20190530113704

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113704
SQL开始执行时间：20190530113704
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113705
SQL开始执行时间：20190530113705
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113705
SQL开始执行时间：20190530113705

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113705
SQL开始执行时间：20190530113705
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113716
SQL开始执行时间：20190530113716

delete from edw.checklist_sy where ddate = '2019-03-21'
;
SQL结束执行时间：20190530113716
SQL开始执行时间：20190530113716
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113716

20190530113716开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190530113716




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113716
SQL开始执行时间：20190530113716
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-22'

;
SQL结束执行时间：20190530113719
SQL开始执行时间：20190530113719

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113719
SQL开始执行时间：20190530113719
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113719
SQL开始执行时间：20190530113719
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113720
SQL开始执行时间：20190530113720

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113720
SQL开始执行时间：20190530113720
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113728
SQL开始执行时间：20190530113728

delete from edw.checklist_sy where ddate = '2019-03-22'
;
SQL结束执行时间：20190530113729
SQL开始执行时间：20190530113729
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113729

20190530113729开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190530113729




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113729
SQL开始执行时间：20190530113729
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-23'

;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732

delete from edw.checklist_sy where ddate = '2019-03-23'
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113732

20190530113732开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190530113732




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113732
SQL开始执行时间：20190530113732
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-24'

;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735

delete from edw.checklist_sy where ddate = '2019-03-24'
;
SQL结束执行时间：20190530113735
SQL开始执行时间：20190530113735
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113736

20190530113736开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190530113736




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113736
SQL开始执行时间：20190530113736
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-25'

;
SQL结束执行时间：20190530113738
SQL开始执行时间：20190530113738

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113738
SQL开始执行时间：20190530113738
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113739
SQL开始执行时间：20190530113739
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113739
SQL开始执行时间：20190530113739

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113739
SQL开始执行时间：20190530113739
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113750
SQL开始执行时间：20190530113750

delete from edw.checklist_sy where ddate = '2019-03-25'
;
SQL结束执行时间：20190530113750
SQL开始执行时间：20190530113750
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113751

20190530113751开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190530113751




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113751
SQL开始执行时间：20190530113751
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-26'

;
SQL结束执行时间：20190530113754
SQL开始执行时间：20190530113754

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113754
SQL开始执行时间：20190530113754
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113754
SQL开始执行时间：20190530113754
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113754
SQL开始执行时间：20190530113754

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113754
SQL开始执行时间：20190530113754
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113809
SQL开始执行时间：20190530113809

delete from edw.checklist_sy where ddate = '2019-03-26'
;
SQL结束执行时间：20190530113809
SQL开始执行时间：20190530113809
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113809

20190530113810开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190530113810




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113810
SQL开始执行时间：20190530113810
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-27'

;
SQL结束执行时间：20190530113812
SQL开始执行时间：20190530113812

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113812
SQL开始执行时间：20190530113812
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113813
SQL开始执行时间：20190530113813
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113813
SQL开始执行时间：20190530113813

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113813
SQL开始执行时间：20190530113813
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113825
SQL开始执行时间：20190530113825

delete from edw.checklist_sy where ddate = '2019-03-27'
;
SQL结束执行时间：20190530113825
SQL开始执行时间：20190530113825
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113826

20190530113826开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190530113826




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113826
SQL开始执行时间：20190530113826
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-28'

;
SQL结束执行时间：20190530113829
SQL开始执行时间：20190530113829

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113829
SQL开始执行时间：20190530113829
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113829
SQL开始执行时间：20190530113829
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113829
SQL开始执行时间：20190530113829

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113829
SQL开始执行时间：20190530113829
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113840
SQL开始执行时间：20190530113840

delete from edw.checklist_sy where ddate = '2019-03-28'
;
SQL结束执行时间：20190530113840
SQL开始执行时间：20190530113840
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113840

20190530113840开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190530113840




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113840
SQL开始执行时间：20190530113840
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-29'

;
SQL结束执行时间：20190530113843
SQL开始执行时间：20190530113843

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113843
SQL开始执行时间：20190530113843
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113843
SQL开始执行时间：20190530113843
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113843
SQL开始执行时间：20190530113843

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113843
SQL开始执行时间：20190530113843
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113851
SQL开始执行时间：20190530113851

delete from edw.checklist_sy where ddate = '2019-03-29'
;
SQL结束执行时间：20190530113851
SQL开始执行时间：20190530113851
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113852

20190530113852开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190530113852




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113852
SQL开始执行时间：20190530113852
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-30'

;
SQL结束执行时间：20190530113854
SQL开始执行时间：20190530113854

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113854
SQL开始执行时间：20190530113854
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113854
SQL开始执行时间：20190530113854
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113855
SQL开始执行时间：20190530113855

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113855
SQL开始执行时间：20190530113855
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113855
SQL开始执行时间：20190530113855

delete from edw.checklist_sy where ddate = '2019-03-30'
;
SQL结束执行时间：20190530113855
SQL开始执行时间：20190530113855
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113855

20190530113855开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190530113855




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113855
SQL开始执行时间：20190530113855
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-03-31'

;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858

delete from edw.checklist_sy where ddate = '2019-03-31'
;
SQL结束执行时间：20190530113858
SQL开始执行时间：20190530113858
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113859

20190530113859开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190530113859




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113859
SQL开始执行时间：20190530113859
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-01'

;
SQL结束执行时间：20190530113901
SQL开始执行时间：20190530113901

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113901
SQL开始执行时间：20190530113901
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113902
SQL开始执行时间：20190530113902
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113902
SQL开始执行时间：20190530113902

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113902
SQL开始执行时间：20190530113902
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113914
SQL开始执行时间：20190530113914

delete from edw.checklist_sy where ddate = '2019-04-01'
;
SQL结束执行时间：20190530113914
SQL开始执行时间：20190530113914
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113915

20190530113915开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190530113915




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113915
SQL开始执行时间：20190530113915
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-02'

;
SQL结束执行时间：20190530113918
SQL开始执行时间：20190530113918

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113918
SQL开始执行时间：20190530113918
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113918
SQL开始执行时间：20190530113918
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113918
SQL开始执行时间：20190530113918

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113918
SQL开始执行时间：20190530113918
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113932
SQL开始执行时间：20190530113932

delete from edw.checklist_sy where ddate = '2019-04-02'
;
SQL结束执行时间：20190530113932
SQL开始执行时间：20190530113932
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113933

20190530113933开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190530113933




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113933
SQL开始执行时间：20190530113933
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-03'

;
SQL结束执行时间：20190530113936
SQL开始执行时间：20190530113936

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113936
SQL开始执行时间：20190530113936
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113936
SQL开始执行时间：20190530113936
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113936
SQL开始执行时间：20190530113936

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113936
SQL开始执行时间：20190530113936
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530113948
SQL开始执行时间：20190530113948

delete from edw.checklist_sy where ddate = '2019-04-03'
;
SQL结束执行时间：20190530113949
SQL开始执行时间：20190530113949
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530113949

20190530113949开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190530113949




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530113949
SQL开始执行时间：20190530113949
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-04'

;
SQL结束执行时间：20190530113952
SQL开始执行时间：20190530113952

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530113952
SQL开始执行时间：20190530113952
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530113952
SQL开始执行时间：20190530113952
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530113952
SQL开始执行时间：20190530113952

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530113952
SQL开始执行时间：20190530113952
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114002
SQL开始执行时间：20190530114002

delete from edw.checklist_sy where ddate = '2019-04-04'
;
SQL结束执行时间：20190530114002
SQL开始执行时间：20190530114002
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114003

20190530114003开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190530114003




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114003
SQL开始执行时间：20190530114003
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-05'

;
SQL结束执行时间：20190530114005
SQL开始执行时间：20190530114005

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114005
SQL开始执行时间：20190530114005
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114005
SQL开始执行时间：20190530114005
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114005
SQL开始执行时间：20190530114005

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114005
SQL开始执行时间：20190530114005
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114007
SQL开始执行时间：20190530114007

delete from edw.checklist_sy where ddate = '2019-04-05'
;
SQL结束执行时间：20190530114007
SQL开始执行时间：20190530114007
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114007

20190530114007开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190530114007




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114007
SQL开始执行时间：20190530114007
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-06'

;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010

delete from edw.checklist_sy where ddate = '2019-04-06'
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114010

20190530114010开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190530114010




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114010
SQL开始执行时间：20190530114010
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-07'

;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013

delete from edw.checklist_sy where ddate = '2019-04-07'
;
SQL结束执行时间：20190530114013
SQL开始执行时间：20190530114013
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114013

20190530114014开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190530114014




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114014
SQL开始执行时间：20190530114014
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-08'

;
SQL结束执行时间：20190530114016
SQL开始执行时间：20190530114016

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114016
SQL开始执行时间：20190530114016
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114016
SQL开始执行时间：20190530114016
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114017
SQL开始执行时间：20190530114017

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114017
SQL开始执行时间：20190530114017
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114029
SQL开始执行时间：20190530114029

delete from edw.checklist_sy where ddate = '2019-04-08'
;
SQL结束执行时间：20190530114029
SQL开始执行时间：20190530114029
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114030

20190530114030开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190530114030




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114030
SQL开始执行时间：20190530114030
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-09'

;
SQL结束执行时间：20190530114033
SQL开始执行时间：20190530114033

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114033
SQL开始执行时间：20190530114033
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114033
SQL开始执行时间：20190530114033
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114033
SQL开始执行时间：20190530114033

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114033
SQL开始执行时间：20190530114033
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114047
SQL开始执行时间：20190530114047

delete from edw.checklist_sy where ddate = '2019-04-09'
;
SQL结束执行时间：20190530114047
SQL开始执行时间：20190530114047
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114048

20190530114048开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190530114048




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114048
SQL开始执行时间：20190530114048
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-10'

;
SQL结束执行时间：20190530114050
SQL开始执行时间：20190530114050

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114051
SQL开始执行时间：20190530114051
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114051
SQL开始执行时间：20190530114051
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114051
SQL开始执行时间：20190530114051

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114051
SQL开始执行时间：20190530114051
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114102
SQL开始执行时间：20190530114102

delete from edw.checklist_sy where ddate = '2019-04-10'
;
SQL结束执行时间：20190530114103
SQL开始执行时间：20190530114103
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114103

20190530114103开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190530114103




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114103
SQL开始执行时间：20190530114103
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-11'

;
SQL结束执行时间：20190530114106
SQL开始执行时间：20190530114106

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114106
SQL开始执行时间：20190530114106
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114106
SQL开始执行时间：20190530114106
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114107
SQL开始执行时间：20190530114107

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114107
SQL开始执行时间：20190530114107
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114117
SQL开始执行时间：20190530114117

delete from edw.checklist_sy where ddate = '2019-04-11'
;
SQL结束执行时间：20190530114118
SQL开始执行时间：20190530114118
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114118

20190530114118开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190530114118




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114118
SQL开始执行时间：20190530114118
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-12'

;
SQL结束执行时间：20190530114121
SQL开始执行时间：20190530114121

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114121
SQL开始执行时间：20190530114121
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114121
SQL开始执行时间：20190530114121
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114121
SQL开始执行时间：20190530114121

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114121
SQL开始执行时间：20190530114121
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114130
SQL开始执行时间：20190530114130

delete from edw.checklist_sy where ddate = '2019-04-12'
;
SQL结束执行时间：20190530114130
SQL开始执行时间：20190530114130
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114131

20190530114131开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190530114131




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114131
SQL开始执行时间：20190530114131
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-13'

;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114133
SQL开始执行时间：20190530114133

delete from edw.checklist_sy where ddate = '2019-04-13'
;
SQL结束执行时间：20190530114134
SQL开始执行时间：20190530114134
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114134

20190530114134开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190530114134




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114134
SQL开始执行时间：20190530114134
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-14'

;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114136
SQL开始执行时间：20190530114136

delete from edw.checklist_sy where ddate = '2019-04-14'
;
SQL结束执行时间：20190530114137
SQL开始执行时间：20190530114137
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114137

20190530114137开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190530114137




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114137
SQL开始执行时间：20190530114137
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-15'

;
SQL结束执行时间：20190530114139
SQL开始执行时间：20190530114139

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114140
SQL开始执行时间：20190530114140
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114140
SQL开始执行时间：20190530114140
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114140
SQL开始执行时间：20190530114140

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114140
SQL开始执行时间：20190530114140
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114152
SQL开始执行时间：20190530114152

delete from edw.checklist_sy where ddate = '2019-04-15'
;
SQL结束执行时间：20190530114152
SQL开始执行时间：20190530114152
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114153

20190530114153开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190530114153




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114153
SQL开始执行时间：20190530114153
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-16'

;
SQL结束执行时间：20190530114156
SQL开始执行时间：20190530114156

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114156
SQL开始执行时间：20190530114156
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114156
SQL开始执行时间：20190530114156
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114156
SQL开始执行时间：20190530114156

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114156
SQL开始执行时间：20190530114156
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114209
SQL开始执行时间：20190530114209

delete from edw.checklist_sy where ddate = '2019-04-16'
;
SQL结束执行时间：20190530114209
SQL开始执行时间：20190530114209
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114209

20190530114209开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190530114209




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114209
SQL开始执行时间：20190530114209
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-17'

;
SQL结束执行时间：20190530114212
SQL开始执行时间：20190530114212

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114212
SQL开始执行时间：20190530114212
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114213
SQL开始执行时间：20190530114213
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114213
SQL开始执行时间：20190530114213

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114213
SQL开始执行时间：20190530114213
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114228
SQL开始执行时间：20190530114228

delete from edw.checklist_sy where ddate = '2019-04-17'
;
SQL结束执行时间：20190530114228
SQL开始执行时间：20190530114228
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114228

20190530114229开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190530114229




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114229
SQL开始执行时间：20190530114229
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-18'

;
SQL结束执行时间：20190530114231
SQL开始执行时间：20190530114231

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114231
SQL开始执行时间：20190530114231
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114231
SQL开始执行时间：20190530114231
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114232
SQL开始执行时间：20190530114232

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114232
SQL开始执行时间：20190530114232
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114240
SQL开始执行时间：20190530114240

delete from edw.checklist_sy where ddate = '2019-04-18'
;
SQL结束执行时间：20190530114240
SQL开始执行时间：20190530114240
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114241

20190530114241开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190530114241




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114241
SQL开始执行时间：20190530114241
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-19'

;
SQL结束执行时间：20190530114243
SQL开始执行时间：20190530114243

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114244
SQL开始执行时间：20190530114244
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114244
SQL开始执行时间：20190530114244
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114244
SQL开始执行时间：20190530114244

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114244
SQL开始执行时间：20190530114244
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114253
SQL开始执行时间：20190530114253

delete from edw.checklist_sy where ddate = '2019-04-19'
;
SQL结束执行时间：20190530114253
SQL开始执行时间：20190530114253
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114254

20190530114254开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190530114254




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114254
SQL开始执行时间：20190530114254
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-20'

;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256

delete from edw.checklist_sy where ddate = '2019-04-20'
;
SQL结束执行时间：20190530114256
SQL开始执行时间：20190530114256
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114256

20190530114257开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190530114257




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114257
SQL开始执行时间：20190530114257
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-21'

;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259

delete from edw.checklist_sy where ddate = '2019-04-21'
;
SQL结束执行时间：20190530114259
SQL开始执行时间：20190530114259
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114300

20190530114300开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190530114300




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114300
SQL开始执行时间：20190530114300
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-22'

;
SQL结束执行时间：20190530114302
SQL开始执行时间：20190530114302

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114302
SQL开始执行时间：20190530114302
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114303
SQL开始执行时间：20190530114303
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114303
SQL开始执行时间：20190530114303

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114303
SQL开始执行时间：20190530114303
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114316
SQL开始执行时间：20190530114316

delete from edw.checklist_sy where ddate = '2019-04-22'
;
SQL结束执行时间：20190530114316
SQL开始执行时间：20190530114316
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114317

20190530114317开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190530114317




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114317
SQL开始执行时间：20190530114317
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-23'

;
SQL结束执行时间：20190530114320
SQL开始执行时间：20190530114320

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114320
SQL开始执行时间：20190530114320
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114320
SQL开始执行时间：20190530114320
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114321
SQL开始执行时间：20190530114321

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114321
SQL开始执行时间：20190530114321
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114334
SQL开始执行时间：20190530114334

delete from edw.checklist_sy where ddate = '2019-04-23'
;
SQL结束执行时间：20190530114334
SQL开始执行时间：20190530114334
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114334

20190530114335开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190530114335




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114335
SQL开始执行时间：20190530114335
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-24'

;
SQL结束执行时间：20190530114337
SQL开始执行时间：20190530114337

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114337
SQL开始执行时间：20190530114337
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114338
SQL开始执行时间：20190530114338
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114338
SQL开始执行时间：20190530114338

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114338
SQL开始执行时间：20190530114338
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114351
SQL开始执行时间：20190530114351

delete from edw.checklist_sy where ddate = '2019-04-24'
;
SQL结束执行时间：20190530114352
SQL开始执行时间：20190530114352
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114352

20190530114352开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190530114352




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114352
SQL开始执行时间：20190530114352
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-25'

;
SQL结束执行时间：20190530114355
SQL开始执行时间：20190530114355

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114355
SQL开始执行时间：20190530114355
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114355
SQL开始执行时间：20190530114355
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114355
SQL开始执行时间：20190530114355

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114355
SQL开始执行时间：20190530114355
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114407
SQL开始执行时间：20190530114407

delete from edw.checklist_sy where ddate = '2019-04-25'
;
SQL结束执行时间：20190530114407
SQL开始执行时间：20190530114407
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114407

20190530114407开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190530114407




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114407
SQL开始执行时间：20190530114407
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-26'

;
SQL结束执行时间：20190530114410
SQL开始执行时间：20190530114410

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114410
SQL开始执行时间：20190530114410
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114410
SQL开始执行时间：20190530114410
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114410
SQL开始执行时间：20190530114410

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114410
SQL开始执行时间：20190530114410
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114418
SQL开始执行时间：20190530114418

delete from edw.checklist_sy where ddate = '2019-04-26'
;
SQL结束执行时间：20190530114418
SQL开始执行时间：20190530114418
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114418

20190530114419开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190530114419




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114419
SQL开始执行时间：20190530114419
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-27'

;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114421
SQL开始执行时间：20190530114421

delete from edw.checklist_sy where ddate = '2019-04-27'
;
SQL结束执行时间：20190530114422
SQL开始执行时间：20190530114422
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114422

20190530114422开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190530114422




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114422
SQL开始执行时间：20190530114422
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-28'

;
SQL结束执行时间：20190530114425
SQL开始执行时间：20190530114425

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114425
SQL开始执行时间：20190530114425
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114425
SQL开始执行时间：20190530114425
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114425
SQL开始执行时间：20190530114425

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114425
SQL开始执行时间：20190530114425
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114432
SQL开始执行时间：20190530114432

delete from edw.checklist_sy where ddate = '2019-04-28'
;
SQL结束执行时间：20190530114432
SQL开始执行时间：20190530114432
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114433

20190530114433开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190530114433




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114433
SQL开始执行时间：20190530114433
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-29'

;
SQL结束执行时间：20190530114436
SQL开始执行时间：20190530114436

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114436
SQL开始执行时间：20190530114436
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114436
SQL开始执行时间：20190530114436
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114436
SQL开始执行时间：20190530114436

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114436
SQL开始执行时间：20190530114436
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114452
SQL开始执行时间：20190530114452

delete from edw.checklist_sy where ddate = '2019-04-29'
;
SQL结束执行时间：20190530114453
SQL开始执行时间：20190530114453
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114453

20190530114453开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190530114453




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114453
SQL开始执行时间：20190530114453
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-04-30'

;
SQL结束执行时间：20190530114456
SQL开始执行时间：20190530114456

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114456
SQL开始执行时间：20190530114456
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114457
SQL开始执行时间：20190530114457
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114457
SQL开始执行时间：20190530114457

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114457
SQL开始执行时间：20190530114457
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114510
SQL开始执行时间：20190530114510

delete from edw.checklist_sy where ddate = '2019-04-30'
;
SQL结束执行时间：20190530114510
SQL开始执行时间：20190530114510
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114511

20190530114511开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190530114511




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114511
SQL开始执行时间：20190530114511
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-01'

;
SQL结束执行时间：20190530114513
SQL开始执行时间：20190530114513

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114513
SQL开始执行时间：20190530114513
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114513
SQL开始执行时间：20190530114513
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114513
SQL开始执行时间：20190530114513

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114513
SQL开始执行时间：20190530114513
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114514
SQL开始执行时间：20190530114514

delete from edw.checklist_sy where ddate = '2019-05-01'
;
SQL结束执行时间：20190530114514
SQL开始执行时间：20190530114514
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114515

20190530114515开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190530114515




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114515
SQL开始执行时间：20190530114515
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-02'

;
SQL结束执行时间：20190530114517
SQL开始执行时间：20190530114517

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114517
SQL开始执行时间：20190530114517
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114517
SQL开始执行时间：20190530114517
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114518
SQL开始执行时间：20190530114518

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114518
SQL开始执行时间：20190530114518
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114521
SQL开始执行时间：20190530114521

delete from edw.checklist_sy where ddate = '2019-05-02'
;
SQL结束执行时间：20190530114521
SQL开始执行时间：20190530114521
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114521

20190530114521开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190530114521




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114521
SQL开始执行时间：20190530114521
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-03'

;
SQL结束执行时间：20190530114524
SQL开始执行时间：20190530114524

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114524
SQL开始执行时间：20190530114524
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114524
SQL开始执行时间：20190530114524
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114524
SQL开始执行时间：20190530114524

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114524
SQL开始执行时间：20190530114524
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114527
SQL开始执行时间：20190530114527

delete from edw.checklist_sy where ddate = '2019-05-03'
;
SQL结束执行时间：20190530114527
SQL开始执行时间：20190530114527
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114527

20190530114527开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190530114527




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114527
SQL开始执行时间：20190530114527
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-04'

;
SQL结束执行时间：20190530114530
SQL开始执行时间：20190530114530

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114530
SQL开始执行时间：20190530114530
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114530
SQL开始执行时间：20190530114530
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114530
SQL开始执行时间：20190530114530

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114530
SQL开始执行时间：20190530114530
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114531
SQL开始执行时间：20190530114531

delete from edw.checklist_sy where ddate = '2019-05-04'
;
SQL结束执行时间：20190530114531
SQL开始执行时间：20190530114531
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114531

20190530114531开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190530114531




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114531
SQL开始执行时间：20190530114531
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-05'

;
SQL结束执行时间：20190530114534
SQL开始执行时间：20190530114534

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114534
SQL开始执行时间：20190530114534
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114534
SQL开始执行时间：20190530114534
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114534
SQL开始执行时间：20190530114534

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114534
SQL开始执行时间：20190530114534
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114543
SQL开始执行时间：20190530114543

delete from edw.checklist_sy where ddate = '2019-05-05'
;
SQL结束执行时间：20190530114543
SQL开始执行时间：20190530114543
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114543

20190530114544开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190530114544




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114544
SQL开始执行时间：20190530114544
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-06'

;
SQL结束执行时间：20190530114546
SQL开始执行时间：20190530114546

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114547
SQL开始执行时间：20190530114547
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114547
SQL开始执行时间：20190530114547
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114547
SQL开始执行时间：20190530114547

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114547
SQL开始执行时间：20190530114547
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114610
SQL开始执行时间：20190530114610

delete from edw.checklist_sy where ddate = '2019-05-06'
;
SQL结束执行时间：20190530114610
SQL开始执行时间：20190530114610
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114611

20190530114611开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190530114611




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114611
SQL开始执行时间：20190530114611
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-07'

;
SQL结束执行时间：20190530114614
SQL开始执行时间：20190530114614

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114614
SQL开始执行时间：20190530114614
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114615
SQL开始执行时间：20190530114615
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114615
SQL开始执行时间：20190530114615

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114615
SQL开始执行时间：20190530114615
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114642
SQL开始执行时间：20190530114642

delete from edw.checklist_sy where ddate = '2019-05-07'
;
SQL结束执行时间：20190530114642
SQL开始执行时间：20190530114642
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114643

20190530114644开始执行2019-05-08数据加载日志:
SQL开始执行时间：20190530114644




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114644
SQL开始执行时间：20190530114644
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-08'

;
SQL结束执行时间：20190530114646
SQL开始执行时间：20190530114646

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114647
SQL开始执行时间：20190530114647
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114647
SQL开始执行时间：20190530114647
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114647
SQL开始执行时间：20190530114647

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114647
SQL开始执行时间：20190530114647
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114715
SQL开始执行时间：20190530114715

delete from edw.checklist_sy where ddate = '2019-05-08'
;
SQL结束执行时间：20190530114716
SQL开始执行时间：20190530114716
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114717

20190530114717开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190530114717




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114717
SQL开始执行时间：20190530114717
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-09'

;
SQL结束执行时间：20190530114719
SQL开始执行时间：20190530114719

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114720
SQL开始执行时间：20190530114720
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114720
SQL开始执行时间：20190530114720
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114721
SQL开始执行时间：20190530114721

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114721
SQL开始执行时间：20190530114721
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114757
SQL开始执行时间：20190530114757

delete from edw.checklist_sy where ddate = '2019-05-09'
;
SQL结束执行时间：20190530114758
SQL开始执行时间：20190530114758
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114759

20190530114759开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190530114759




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114759
SQL开始执行时间：20190530114759
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-10'

;
SQL结束执行时间：20190530114802
SQL开始执行时间：20190530114802

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114802
SQL开始执行时间：20190530114802
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114803
SQL开始执行时间：20190530114803
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114803
SQL开始执行时间：20190530114803

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114803
SQL开始执行时间：20190530114803
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114823
SQL开始执行时间：20190530114823

delete from edw.checklist_sy where ddate = '2019-05-10'
;
SQL结束执行时间：20190530114824
SQL开始执行时间：20190530114824
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114824

20190530114825开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190530114825




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114825
SQL开始执行时间：20190530114825
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-11'

;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114827
SQL开始执行时间：20190530114827

delete from edw.checklist_sy where ddate = '2019-05-11'
;
SQL结束执行时间：20190530114828
SQL开始执行时间：20190530114828
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114828

20190530114828开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190530114828




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114828
SQL开始执行时间：20190530114828
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-12'

;
SQL结束执行时间：20190530114830
SQL开始执行时间：20190530114830

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114830
SQL开始执行时间：20190530114830
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114830
SQL开始执行时间：20190530114830
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114830
SQL开始执行时间：20190530114830

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114830
SQL开始执行时间：20190530114830
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114831
SQL开始执行时间：20190530114831

delete from edw.checklist_sy where ddate = '2019-05-12'
;
SQL结束执行时间：20190530114831
SQL开始执行时间：20190530114831
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114831

20190530114831开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190530114831




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114831
SQL开始执行时间：20190530114831
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-13'

;
SQL结束执行时间：20190530114834
SQL开始执行时间：20190530114834

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114834
SQL开始执行时间：20190530114834
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114835
SQL开始执行时间：20190530114835
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114835
SQL开始执行时间：20190530114835

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114835
SQL开始执行时间：20190530114835
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530114939
SQL开始执行时间：20190530114939

delete from edw.checklist_sy where ddate = '2019-05-13'
;
SQL结束执行时间：20190530114940
SQL开始执行时间：20190530114940
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530114942

20190530114943开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190530114943




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530114943
SQL开始执行时间：20190530114943
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-14'

;
SQL结束执行时间：20190530114945
SQL开始执行时间：20190530114945

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530114946
SQL开始执行时间：20190530114946
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530114946
SQL开始执行时间：20190530114946
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530114947
SQL开始执行时间：20190530114947

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530114947
SQL开始执行时间：20190530114947
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115113
SQL开始执行时间：20190530115113

delete from edw.checklist_sy where ddate = '2019-05-14'
;
SQL结束执行时间：20190530115113
SQL开始执行时间：20190530115113
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115117

20190530115117开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190530115117




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115117
SQL开始执行时间：20190530115117
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-15'

;
SQL结束执行时间：20190530115120
SQL开始执行时间：20190530115120

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115120
SQL开始执行时间：20190530115120
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115121
SQL开始执行时间：20190530115121
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115121
SQL开始执行时间：20190530115121

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115121
SQL开始执行时间：20190530115121
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115236
SQL开始执行时间：20190530115236

delete from edw.checklist_sy where ddate = '2019-05-15'
;
SQL结束执行时间：20190530115236
SQL开始执行时间：20190530115236
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115240

20190530115240开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190530115240




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115240
SQL开始执行时间：20190530115240
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-16'

;
SQL结束执行时间：20190530115243
SQL开始执行时间：20190530115243

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115243
SQL开始执行时间：20190530115243
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115244
SQL开始执行时间：20190530115244
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115244
SQL开始执行时间：20190530115244

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115244
SQL开始执行时间：20190530115244
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115306
SQL开始执行时间：20190530115306

delete from edw.checklist_sy where ddate = '2019-05-16'
;
SQL结束执行时间：20190530115306
SQL开始执行时间：20190530115306
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115307

20190530115307开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190530115307




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115307
SQL开始执行时间：20190530115307
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-17'

;
SQL结束执行时间：20190530115310
SQL开始执行时间：20190530115310

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115310
SQL开始执行时间：20190530115310
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115310
SQL开始执行时间：20190530115310
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115310
SQL开始执行时间：20190530115310

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115310
SQL开始执行时间：20190530115310
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115319
SQL开始执行时间：20190530115319

delete from edw.checklist_sy where ddate = '2019-05-17'
;
SQL结束执行时间：20190530115320
SQL开始执行时间：20190530115320
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115320

20190530115320开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190530115320




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115320
SQL开始执行时间：20190530115320
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-18'

;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323

delete from edw.checklist_sy where ddate = '2019-05-18'
;
SQL结束执行时间：20190530115323
SQL开始执行时间：20190530115323
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115324

20190530115324开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190530115324




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115324
SQL开始执行时间：20190530115324
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-19'

;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115326
SQL开始执行时间：20190530115326

delete from edw.checklist_sy where ddate = '2019-05-19'
;
SQL结束执行时间：20190530115327
SQL开始执行时间：20190530115327
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115327

20190530115327开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190530115327




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115327
SQL开始执行时间：20190530115327
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-20'

;
SQL结束执行时间：20190530115330
SQL开始执行时间：20190530115330

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115330
SQL开始执行时间：20190530115330
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115330
SQL开始执行时间：20190530115330
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115330
SQL开始执行时间：20190530115330

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115330
SQL开始执行时间：20190530115330
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115346
SQL开始执行时间：20190530115346

delete from edw.checklist_sy where ddate = '2019-05-20'
;
SQL结束执行时间：20190530115346
SQL开始执行时间：20190530115346
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115347

20190530115347开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190530115347




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115347
SQL开始执行时间：20190530115347
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-21'

;
SQL结束执行时间：20190530115350
SQL开始执行时间：20190530115350

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115350
SQL开始执行时间：20190530115350
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115350
SQL开始执行时间：20190530115350
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115350
SQL开始执行时间：20190530115350

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115350
SQL开始执行时间：20190530115350
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115410
SQL开始执行时间：20190530115410

delete from edw.checklist_sy where ddate = '2019-05-21'
;
SQL结束执行时间：20190530115411
SQL开始执行时间：20190530115411
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115412

20190530115412开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190530115412




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115412
SQL开始执行时间：20190530115412
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-22'

;
SQL结束执行时间：20190530115414
SQL开始执行时间：20190530115414

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115415
SQL开始执行时间：20190530115415
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115415
SQL开始执行时间：20190530115415
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115415
SQL开始执行时间：20190530115415

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115415
SQL开始执行时间：20190530115415
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115432
SQL开始执行时间：20190530115432

delete from edw.checklist_sy where ddate = '2019-05-22'
;
SQL结束执行时间：20190530115432
SQL开始执行时间：20190530115432
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115433

20190530115433开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190530115433




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115433
SQL开始执行时间：20190530115433
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-23'

;
SQL结束执行时间：20190530115436
SQL开始执行时间：20190530115436

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115436
SQL开始执行时间：20190530115436
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115436
SQL开始执行时间：20190530115436
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115436
SQL开始执行时间：20190530115436

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115436
SQL开始执行时间：20190530115436
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115447
SQL开始执行时间：20190530115447

delete from edw.checklist_sy where ddate = '2019-05-23'
;
SQL结束执行时间：20190530115447
SQL开始执行时间：20190530115447
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115448

20190530115448开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190530115448




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115448
SQL开始执行时间：20190530115448
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-24'

;
SQL结束执行时间：20190530115451
SQL开始执行时间：20190530115451

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115451
SQL开始执行时间：20190530115451
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115451
SQL开始执行时间：20190530115451
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115451
SQL开始执行时间：20190530115451

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115451
SQL开始执行时间：20190530115451
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115458
SQL开始执行时间：20190530115458

delete from edw.checklist_sy where ddate = '2019-05-24'
;
SQL结束执行时间：20190530115459
SQL开始执行时间：20190530115459
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115459

20190530115459开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190530115459




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115459
SQL开始执行时间：20190530115459
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-25'

;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502

delete from edw.checklist_sy where ddate = '2019-05-25'
;
SQL结束执行时间：20190530115502
SQL开始执行时间：20190530115502
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115503

20190530115503开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190530115503




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115503
SQL开始执行时间：20190530115503
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-26'

;
SQL结束执行时间：20190530115505
SQL开始执行时间：20190530115505

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115505
SQL开始执行时间：20190530115505
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115505
SQL开始执行时间：20190530115505
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115505
SQL开始执行时间：20190530115505

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115505
SQL开始执行时间：20190530115505
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115506
SQL开始执行时间：20190530115506

delete from edw.checklist_sy where ddate = '2019-05-26'
;
SQL结束执行时间：20190530115506
SQL开始执行时间：20190530115506
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115507

20190530115507开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190530115507




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115507
SQL开始执行时间：20190530115507
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-27'

;
SQL结束执行时间：20190530115509
SQL开始执行时间：20190530115509

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115509
SQL开始执行时间：20190530115509
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115509
SQL开始执行时间：20190530115509
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115509
SQL开始执行时间：20190530115509

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115509
SQL开始执行时间：20190530115509
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115516
SQL开始执行时间：20190530115516

delete from edw.checklist_sy where ddate = '2019-05-27'
;
SQL结束执行时间：20190530115516
SQL开始执行时间：20190530115516
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115517

20190530115517开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190530115517




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115517
SQL开始执行时间：20190530115517
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-28'

;
SQL结束执行时间：20190530115519
SQL开始执行时间：20190530115519

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115519
SQL开始执行时间：20190530115519
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115519
SQL开始执行时间：20190530115519
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115519
SQL开始执行时间：20190530115519

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115519
SQL开始执行时间：20190530115519
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115524
SQL开始执行时间：20190530115524

delete from edw.checklist_sy where ddate = '2019-05-28'
;
SQL结束执行时间：20190530115524
SQL开始执行时间：20190530115524
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115525

20190530115525开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530115525




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115525
SQL开始执行时间：20190530115525
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-29'

;
SQL结束执行时间：20190530115527
SQL开始执行时间：20190530115527

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115527
SQL开始执行时间：20190530115527
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115527
SQL开始执行时间：20190530115527
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115527
SQL开始执行时间：20190530115527

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115527
SQL开始执行时间：20190530115527
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115528
SQL开始执行时间：20190530115528

delete from edw.checklist_sy where ddate = '2019-05-29'
;
SQL结束执行时间：20190530115528
SQL开始执行时间：20190530115528
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115529

20190530115529开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190530115529




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115529
SQL开始执行时间：20190530115529
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-30'

;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115531
SQL开始执行时间：20190530115531

delete from edw.checklist_sy where ddate = '2019-05-30'
;
SQL结束执行时间：20190530115532
SQL开始执行时间：20190530115532
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115532

20190530115532开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190530115532




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190530115532
SQL开始执行时间：20190530115532
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-05-31'

;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534
CREATE INDEX index_checklist_sy_pre_collection ON edw.checklist_sy_pre(collection_hospital)
;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534
CREATE INDEX index_checklist_sy_pre_project ON edw.checklist_sy_pre(project)
;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534

drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534

delete from edw.checklist_sy where ddate = '2019-05-31'
;
SQL结束执行时间：20190530115534
SQL开始执行时间：20190530115534
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190530115534

20190814164643开始执行2018-01-01数据加载日志:
SQL开始执行时间：20190814164643




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164643
SQL开始执行时间：20190814164643
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-01'

;
SQL结束执行时间：20190814164647
SQL开始执行时间：20190814164647

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;

20190814164652开始执行2018-01-02数据加载日志:
SQL开始执行时间：20190814164652




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164652
SQL开始执行时间：20190814164652
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-02'

;
SQL结束执行时间：20190814164655
SQL开始执行时间：20190814164655

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;

20190814164656开始执行2018-01-03数据加载日志:
SQL开始执行时间：20190814164656




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164656
SQL开始执行时间：20190814164656
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-03'

;
SQL结束执行时间：20190814164659
SQL开始执行时间：20190814164659

CREATE INDEX index_checklist_sy_pre_hospital ON edw.checklist_sy_pre(hospital)
;

20190814164659开始执行2018-01-04数据加载日志:
SQL开始执行时间：20190814164659




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164659
SQL开始执行时间：20190814164659
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-04'

;

20190814164702开始执行2018-01-05数据加载日志:
SQL开始执行时间：20190814164702




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164702
SQL开始执行时间：20190814164702
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-05'

;

20190814164822开始执行2018-01-01数据加载日志:
SQL开始执行时间：20190814164822




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164822
SQL开始执行时间：20190814164822
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-01'

;
SQL结束执行时间：20190814164825
SQL开始执行时间：20190814164825


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814164825
SQL开始执行时间：20190814164825
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814164826
SQL开始执行时间：20190814164826

delete from edw.checklist_sy where ddate = '2018-01-01'
;
SQL结束执行时间：20190814164826
SQL开始执行时间：20190814164826
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814164826

20190814164826开始执行2018-01-02数据加载日志:
SQL开始执行时间：20190814164826




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164826
SQL开始执行时间：20190814164826
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-02'

;
SQL结束执行时间：20190814164830
SQL开始执行时间：20190814164830


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814164830
SQL开始执行时间：20190814164830
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814164853
SQL开始执行时间：20190814164853

delete from edw.checklist_sy where ddate = '2018-01-02'
;
SQL结束执行时间：20190814164853
SQL开始执行时间：20190814164853
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814164854

20190814164854开始执行2018-01-03数据加载日志:
SQL开始执行时间：20190814164854




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164854
SQL开始执行时间：20190814164854
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-03'

;
SQL结束执行时间：20190814164858
SQL开始执行时间：20190814164858


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814164858
SQL开始执行时间：20190814164858
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814164922
SQL开始执行时间：20190814164922

delete from edw.checklist_sy where ddate = '2018-01-03'
;
SQL结束执行时间：20190814164922
SQL开始执行时间：20190814164922
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814164923

20190814164923开始执行2018-01-04数据加载日志:
SQL开始执行时间：20190814164923




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164923
SQL开始执行时间：20190814164923
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-04'

;
SQL结束执行时间：20190814164926
SQL开始执行时间：20190814164926


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814164926
SQL开始执行时间：20190814164926
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814164948
SQL开始执行时间：20190814164948

delete from edw.checklist_sy where ddate = '2018-01-04'
;
SQL结束执行时间：20190814164948
SQL开始执行时间：20190814164948
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;

20190814164950开始执行2018-01-05数据加载日志:
SQL开始执行时间：20190814164950




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814164950
SQL开始执行时间：20190814164950
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-05'

;
SQL结束执行时间：20190814164953
SQL开始执行时间：20190814164953


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814164953
SQL开始执行时间：20190814164953
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;

20190814165040开始执行2018-01-01数据加载日志:
SQL开始执行时间：20190814165040




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165040
SQL开始执行时间：20190814165040
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-01'

;
SQL结束执行时间：20190814165043
SQL开始执行时间：20190814165043


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165043
SQL开始执行时间：20190814165043
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165045
SQL开始执行时间：20190814165045

delete from edw.checklist_sy where ddate = '2018-01-01'
;
SQL结束执行时间：20190814165045
SQL开始执行时间：20190814165045
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165045

20190814165045开始执行2018-01-02数据加载日志:
SQL开始执行时间：20190814165045




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165045
SQL开始执行时间：20190814165045
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-02'

;
SQL结束执行时间：20190814165048
SQL开始执行时间：20190814165048


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165048
SQL开始执行时间：20190814165048
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165112
SQL开始执行时间：20190814165112

delete from edw.checklist_sy where ddate = '2018-01-02'
;
SQL结束执行时间：20190814165112
SQL开始执行时间：20190814165112
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165112

20190814165113开始执行2018-01-03数据加载日志:
SQL开始执行时间：20190814165113




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165113
SQL开始执行时间：20190814165113
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-03'

;
SQL结束执行时间：20190814165116
SQL开始执行时间：20190814165116


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165116
SQL开始执行时间：20190814165116
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165140
SQL开始执行时间：20190814165140

delete from edw.checklist_sy where ddate = '2018-01-03'
;
SQL结束执行时间：20190814165140
SQL开始执行时间：20190814165140
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165141

20190814165141开始执行2018-01-04数据加载日志:
SQL开始执行时间：20190814165141




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165141
SQL开始执行时间：20190814165141
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-04'

;
SQL结束执行时间：20190814165145
SQL开始执行时间：20190814165145


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165145
SQL开始执行时间：20190814165145
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165206
SQL开始执行时间：20190814165206

delete from edw.checklist_sy where ddate = '2018-01-04'
;
SQL结束执行时间：20190814165206
SQL开始执行时间：20190814165206
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165207

20190814165207开始执行2018-01-05数据加载日志:
SQL开始执行时间：20190814165207




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165207
SQL开始执行时间：20190814165207
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-05'

;
SQL结束执行时间：20190814165210
SQL开始执行时间：20190814165210


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165211
SQL开始执行时间：20190814165211
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165225
SQL开始执行时间：20190814165225

delete from edw.checklist_sy where ddate = '2018-01-05'
;
SQL结束执行时间：20190814165225
SQL开始执行时间：20190814165225
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165226

20190814165226开始执行2018-01-06数据加载日志:
SQL开始执行时间：20190814165226




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165226
SQL开始执行时间：20190814165226
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-06'

;
SQL结束执行时间：20190814165229
SQL开始执行时间：20190814165229


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165229
SQL开始执行时间：20190814165229
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165232
SQL开始执行时间：20190814165232

delete from edw.checklist_sy where ddate = '2018-01-06'
;
SQL结束执行时间：20190814165232
SQL开始执行时间：20190814165232
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165232

20190814165232开始执行2018-01-07数据加载日志:
SQL开始执行时间：20190814165232




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165232
SQL开始执行时间：20190814165232
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-07'

;
SQL结束执行时间：20190814165235
SQL开始执行时间：20190814165235


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165235
SQL开始执行时间：20190814165235
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165237
SQL开始执行时间：20190814165237

delete from edw.checklist_sy where ddate = '2018-01-07'
;
SQL结束执行时间：20190814165237
SQL开始执行时间：20190814165237
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165237

20190814165237开始执行2018-01-08数据加载日志:
SQL开始执行时间：20190814165237




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165237
SQL开始执行时间：20190814165237
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-08'

;
SQL结束执行时间：20190814165241
SQL开始执行时间：20190814165241


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165241
SQL开始执行时间：20190814165241
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165258
SQL开始执行时间：20190814165258

delete from edw.checklist_sy where ddate = '2018-01-08'
;
SQL结束执行时间：20190814165258
SQL开始执行时间：20190814165258
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165258

20190814165259开始执行2018-01-09数据加载日志:
SQL开始执行时间：20190814165259




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165259
SQL开始执行时间：20190814165259
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-09'

;
SQL结束执行时间：20190814165302
SQL开始执行时间：20190814165302


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165302
SQL开始执行时间：20190814165302
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165329
SQL开始执行时间：20190814165329

delete from edw.checklist_sy where ddate = '2018-01-09'
;
SQL结束执行时间：20190814165329
SQL开始执行时间：20190814165329
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165330

20190814165330开始执行2018-01-10数据加载日志:
SQL开始执行时间：20190814165330




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165330
SQL开始执行时间：20190814165330
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-10'

;
SQL结束执行时间：20190814165333
SQL开始执行时间：20190814165333


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165333
SQL开始执行时间：20190814165333
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165352
SQL开始执行时间：20190814165352

delete from edw.checklist_sy where ddate = '2018-01-10'
;
SQL结束执行时间：20190814165352
SQL开始执行时间：20190814165352
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165352

20190814165353开始执行2018-01-11数据加载日志:
SQL开始执行时间：20190814165353




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165353
SQL开始执行时间：20190814165353
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-11'

;
SQL结束执行时间：20190814165356
SQL开始执行时间：20190814165356


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165356
SQL开始执行时间：20190814165356
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165416
SQL开始执行时间：20190814165416

delete from edw.checklist_sy where ddate = '2018-01-11'
;
SQL结束执行时间：20190814165416
SQL开始执行时间：20190814165416
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165416

20190814165416开始执行2018-01-12数据加载日志:
SQL开始执行时间：20190814165416




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165416
SQL开始执行时间：20190814165416
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-12'

;
SQL结束执行时间：20190814165420
SQL开始执行时间：20190814165420


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165420
SQL开始执行时间：20190814165420
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165434
SQL开始执行时间：20190814165434

delete from edw.checklist_sy where ddate = '2018-01-12'
;
SQL结束执行时间：20190814165434
SQL开始执行时间：20190814165434
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165435

20190814165435开始执行2018-01-13数据加载日志:
SQL开始执行时间：20190814165435




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165435
SQL开始执行时间：20190814165435
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-13'

;
SQL结束执行时间：20190814165438
SQL开始执行时间：20190814165438


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165438
SQL开始执行时间：20190814165438
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165440
SQL开始执行时间：20190814165440

delete from edw.checklist_sy where ddate = '2018-01-13'
;
SQL结束执行时间：20190814165440
SQL开始执行时间：20190814165440
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165440

20190814165441开始执行2018-01-14数据加载日志:
SQL开始执行时间：20190814165441




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165441
SQL开始执行时间：20190814165441
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-14'

;
SQL结束执行时间：20190814165444
SQL开始执行时间：20190814165444


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165444
SQL开始执行时间：20190814165444
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165444
SQL开始执行时间：20190814165444

delete from edw.checklist_sy where ddate = '2018-01-14'
;
SQL结束执行时间：20190814165444
SQL开始执行时间：20190814165444
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165444

20190814165444开始执行2018-01-15数据加载日志:
SQL开始执行时间：20190814165444




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165444
SQL开始执行时间：20190814165444
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-15'

;
SQL结束执行时间：20190814165448
SQL开始执行时间：20190814165448


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165448
SQL开始执行时间：20190814165448
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165506
SQL开始执行时间：20190814165506

delete from edw.checklist_sy where ddate = '2018-01-15'
;
SQL结束执行时间：20190814165506
SQL开始执行时间：20190814165506
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165507

20190814165507开始执行2018-01-16数据加载日志:
SQL开始执行时间：20190814165507




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165507
SQL开始执行时间：20190814165507
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-16'

;
SQL结束执行时间：20190814165511
SQL开始执行时间：20190814165511


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165511
SQL开始执行时间：20190814165511
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165532
SQL开始执行时间：20190814165532

delete from edw.checklist_sy where ddate = '2018-01-16'
;
SQL结束执行时间：20190814165533
SQL开始执行时间：20190814165533
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165533

20190814165533开始执行2018-01-17数据加载日志:
SQL开始执行时间：20190814165533




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165533
SQL开始执行时间：20190814165533
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-17'

;
SQL结束执行时间：20190814165537
SQL开始执行时间：20190814165537


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165537
SQL开始执行时间：20190814165537
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165559
SQL开始执行时间：20190814165559

delete from edw.checklist_sy where ddate = '2018-01-17'
;
SQL结束执行时间：20190814165559
SQL开始执行时间：20190814165559
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165600

20190814165600开始执行2018-01-18数据加载日志:
SQL开始执行时间：20190814165600




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165600
SQL开始执行时间：20190814165600
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-18'

;
SQL结束执行时间：20190814165604
SQL开始执行时间：20190814165604


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165604
SQL开始执行时间：20190814165604
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165626
SQL开始执行时间：20190814165626

delete from edw.checklist_sy where ddate = '2018-01-18'
;
SQL结束执行时间：20190814165626
SQL开始执行时间：20190814165626
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165627

20190814165627开始执行2018-01-19数据加载日志:
SQL开始执行时间：20190814165627




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165627
SQL开始执行时间：20190814165627
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-19'

;
SQL结束执行时间：20190814165630
SQL开始执行时间：20190814165630


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165630
SQL开始执行时间：20190814165630
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165645
SQL开始执行时间：20190814165645

delete from edw.checklist_sy where ddate = '2018-01-19'
;
SQL结束执行时间：20190814165645
SQL开始执行时间：20190814165645
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165645

20190814165645开始执行2018-01-20数据加载日志:
SQL开始执行时间：20190814165645




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165645
SQL开始执行时间：20190814165645
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-20'

;
SQL结束执行时间：20190814165649
SQL开始执行时间：20190814165649


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165649
SQL开始执行时间：20190814165649
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165650
SQL开始执行时间：20190814165650

delete from edw.checklist_sy where ddate = '2018-01-20'
;
SQL结束执行时间：20190814165650
SQL开始执行时间：20190814165650
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165651

20190814165651开始执行2018-01-21数据加载日志:
SQL开始执行时间：20190814165651




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165651
SQL开始执行时间：20190814165651
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-21'

;
SQL结束执行时间：20190814165654
SQL开始执行时间：20190814165654


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165654
SQL开始执行时间：20190814165654
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165655
SQL开始执行时间：20190814165655

delete from edw.checklist_sy where ddate = '2018-01-21'
;
SQL结束执行时间：20190814165655
SQL开始执行时间：20190814165655
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165655

20190814165655开始执行2018-01-22数据加载日志:
SQL开始执行时间：20190814165655




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165655
SQL开始执行时间：20190814165655
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-22'

;
SQL结束执行时间：20190814165658
SQL开始执行时间：20190814165658


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165658
SQL开始执行时间：20190814165658
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165715
SQL开始执行时间：20190814165715

delete from edw.checklist_sy where ddate = '2018-01-22'
;
SQL结束执行时间：20190814165715
SQL开始执行时间：20190814165715
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165716

20190814165716开始执行2018-01-23数据加载日志:
SQL开始执行时间：20190814165716




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165716
SQL开始执行时间：20190814165716
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-23'

;
SQL结束执行时间：20190814165719
SQL开始执行时间：20190814165719


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165719
SQL开始执行时间：20190814165719
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165747
SQL开始执行时间：20190814165747

delete from edw.checklist_sy where ddate = '2018-01-23'
;
SQL结束执行时间：20190814165747
SQL开始执行时间：20190814165747
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165748

20190814165748开始执行2018-01-24数据加载日志:
SQL开始执行时间：20190814165748




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165748
SQL开始执行时间：20190814165748
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-24'

;
SQL结束执行时间：20190814165751
SQL开始执行时间：20190814165751


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165751
SQL开始执行时间：20190814165751
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165813
SQL开始执行时间：20190814165813

delete from edw.checklist_sy where ddate = '2018-01-24'
;
SQL结束执行时间：20190814165813
SQL开始执行时间：20190814165813
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165814

20190814165814开始执行2018-01-25数据加载日志:
SQL开始执行时间：20190814165814




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165814
SQL开始执行时间：20190814165814
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-25'

;
SQL结束执行时间：20190814165817
SQL开始执行时间：20190814165817


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165817
SQL开始执行时间：20190814165817
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165838
SQL开始执行时间：20190814165838

delete from edw.checklist_sy where ddate = '2018-01-25'
;
SQL结束执行时间：20190814165838
SQL开始执行时间：20190814165838
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165839

20190814165839开始执行2018-01-26数据加载日志:
SQL开始执行时间：20190814165839




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165839
SQL开始执行时间：20190814165839
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-26'

;
SQL结束执行时间：20190814165842
SQL开始执行时间：20190814165842


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165842
SQL开始执行时间：20190814165842
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165854
SQL开始执行时间：20190814165854

delete from edw.checklist_sy where ddate = '2018-01-26'
;
SQL结束执行时间：20190814165854
SQL开始执行时间：20190814165854
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165854

20190814165854开始执行2018-01-27数据加载日志:
SQL开始执行时间：20190814165854




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165854
SQL开始执行时间：20190814165854
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-27'

;
SQL结束执行时间：20190814165858
SQL开始执行时间：20190814165858


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165858
SQL开始执行时间：20190814165858
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165900
SQL开始执行时间：20190814165900

delete from edw.checklist_sy where ddate = '2018-01-27'
;
SQL结束执行时间：20190814165900
SQL开始执行时间：20190814165900
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165900

20190814165900开始执行2018-01-28数据加载日志:
SQL开始执行时间：20190814165900




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165900
SQL开始执行时间：20190814165900
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-28'

;
SQL结束执行时间：20190814165904
SQL开始执行时间：20190814165904


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165904
SQL开始执行时间：20190814165904
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165904
SQL开始执行时间：20190814165904

delete from edw.checklist_sy where ddate = '2018-01-28'
;
SQL结束执行时间：20190814165905
SQL开始执行时间：20190814165905
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165905

20190814165905开始执行2018-01-29数据加载日志:
SQL开始执行时间：20190814165905




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165905
SQL开始执行时间：20190814165905
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-29'

;
SQL结束执行时间：20190814165908
SQL开始执行时间：20190814165908


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165908
SQL开始执行时间：20190814165908
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165927
SQL开始执行时间：20190814165927

delete from edw.checklist_sy where ddate = '2018-01-29'
;
SQL结束执行时间：20190814165927
SQL开始执行时间：20190814165927
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165927

20190814165927开始执行2018-01-30数据加载日志:
SQL开始执行时间：20190814165927




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165927
SQL开始执行时间：20190814165927
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-30'

;
SQL结束执行时间：20190814165931
SQL开始执行时间：20190814165931


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814165931
SQL开始执行时间：20190814165931
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814165957
SQL开始执行时间：20190814165957

delete from edw.checklist_sy where ddate = '2018-01-30'
;
SQL结束执行时间：20190814165957
SQL开始执行时间：20190814165957
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814165958

20190814165958开始执行2018-01-31数据加载日志:
SQL开始执行时间：20190814165958




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814165958
SQL开始执行时间：20190814165958
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-01-31'

;
SQL结束执行时间：20190814170001
SQL开始执行时间：20190814170001


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170001
SQL开始执行时间：20190814170001
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170021
SQL开始执行时间：20190814170021

delete from edw.checklist_sy where ddate = '2018-01-31'
;
SQL结束执行时间：20190814170021
SQL开始执行时间：20190814170021
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170022

20190814170022开始执行2018-02-01数据加载日志:
SQL开始执行时间：20190814170022




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170022
SQL开始执行时间：20190814170022
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-01'

;
SQL结束执行时间：20190814170025
SQL开始执行时间：20190814170025


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170025
SQL开始执行时间：20190814170025
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170045
SQL开始执行时间：20190814170045

delete from edw.checklist_sy where ddate = '2018-02-01'
;
SQL结束执行时间：20190814170045
SQL开始执行时间：20190814170045
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170046

20190814170046开始执行2018-02-02数据加载日志:
SQL开始执行时间：20190814170046




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170046
SQL开始执行时间：20190814170046
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-02'

;
SQL结束执行时间：20190814170050
SQL开始执行时间：20190814170050


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170050
SQL开始执行时间：20190814170050
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170103
SQL开始执行时间：20190814170103

delete from edw.checklist_sy where ddate = '2018-02-02'
;
SQL结束执行时间：20190814170103
SQL开始执行时间：20190814170103
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170104

20190814170104开始执行2018-02-03数据加载日志:
SQL开始执行时间：20190814170104




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170104
SQL开始执行时间：20190814170104
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-03'

;
SQL结束执行时间：20190814170108
SQL开始执行时间：20190814170108


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170108
SQL开始执行时间：20190814170108
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170112
SQL开始执行时间：20190814170112

delete from edw.checklist_sy where ddate = '2018-02-03'
;
SQL结束执行时间：20190814170112
SQL开始执行时间：20190814170112
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170112

20190814170112开始执行2018-02-04数据加载日志:
SQL开始执行时间：20190814170112




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170112
SQL开始执行时间：20190814170112
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-04'

;
SQL结束执行时间：20190814170116
SQL开始执行时间：20190814170116


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170116
SQL开始执行时间：20190814170116
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170117
SQL开始执行时间：20190814170117

delete from edw.checklist_sy where ddate = '2018-02-04'
;
SQL结束执行时间：20190814170117
SQL开始执行时间：20190814170117
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170117

20190814170118开始执行2018-02-05数据加载日志:
SQL开始执行时间：20190814170118




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170118
SQL开始执行时间：20190814170118
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-05'

;
SQL结束执行时间：20190814170122
SQL开始执行时间：20190814170122


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170122
SQL开始执行时间：20190814170122
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170136
SQL开始执行时间：20190814170136

delete from edw.checklist_sy where ddate = '2018-02-05'
;
SQL结束执行时间：20190814170136
SQL开始执行时间：20190814170136
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170137

20190814170137开始执行2018-02-06数据加载日志:
SQL开始执行时间：20190814170137




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170137
SQL开始执行时间：20190814170137
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-06'

;
SQL结束执行时间：20190814170142
SQL开始执行时间：20190814170142


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170142
SQL开始执行时间：20190814170142
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170208
SQL开始执行时间：20190814170208

delete from edw.checklist_sy where ddate = '2018-02-06'
;
SQL结束执行时间：20190814170208
SQL开始执行时间：20190814170208
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170209

20190814170209开始执行2018-02-07数据加载日志:
SQL开始执行时间：20190814170209




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170209
SQL开始执行时间：20190814170209
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-07'

;
SQL结束执行时间：20190814170215
SQL开始执行时间：20190814170215


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170215
SQL开始执行时间：20190814170215
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170240
SQL开始执行时间：20190814170240

delete from edw.checklist_sy where ddate = '2018-02-07'
;
SQL结束执行时间：20190814170240
SQL开始执行时间：20190814170240
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170241

20190814170241开始执行2018-02-08数据加载日志:
SQL开始执行时间：20190814170241




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170241
SQL开始执行时间：20190814170241
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-08'

;
SQL结束执行时间：20190814170247
SQL开始执行时间：20190814170247


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170247
SQL开始执行时间：20190814170247
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170307
SQL开始执行时间：20190814170307

delete from edw.checklist_sy where ddate = '2018-02-08'
;
SQL结束执行时间：20190814170307
SQL开始执行时间：20190814170307
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170307

20190814170308开始执行2018-02-09数据加载日志:
SQL开始执行时间：20190814170308




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170308
SQL开始执行时间：20190814170308
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-09'

;
SQL结束执行时间：20190814170313
SQL开始执行时间：20190814170313


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170313
SQL开始执行时间：20190814170313
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170328
SQL开始执行时间：20190814170328

delete from edw.checklist_sy where ddate = '2018-02-09'
;
SQL结束执行时间：20190814170328
SQL开始执行时间：20190814170328
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170329

20190814170329开始执行2018-02-10数据加载日志:
SQL开始执行时间：20190814170329




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170329
SQL开始执行时间：20190814170329
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-10'

;
SQL结束执行时间：20190814170334
SQL开始执行时间：20190814170334


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170334
SQL开始执行时间：20190814170334
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170339
SQL开始执行时间：20190814170339

delete from edw.checklist_sy where ddate = '2018-02-10'
;
SQL结束执行时间：20190814170339
SQL开始执行时间：20190814170339
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170339

20190814170339开始执行2018-02-11数据加载日志:
SQL开始执行时间：20190814170339




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170339
SQL开始执行时间：20190814170339
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-11'

;
SQL结束执行时间：20190814170344
SQL开始执行时间：20190814170344


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170344
SQL开始执行时间：20190814170344
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170355
SQL开始执行时间：20190814170355

delete from edw.checklist_sy where ddate = '2018-02-11'
;
SQL结束执行时间：20190814170355
SQL开始执行时间：20190814170355
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170356

20190814170356开始执行2018-02-12数据加载日志:
SQL开始执行时间：20190814170356




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170356
SQL开始执行时间：20190814170356
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-12'

;
SQL结束执行时间：20190814170401
SQL开始执行时间：20190814170401


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170401
SQL开始执行时间：20190814170401
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170430
SQL开始执行时间：20190814170430

delete from edw.checklist_sy where ddate = '2018-02-12'
;
SQL结束执行时间：20190814170430
SQL开始执行时间：20190814170430
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170432

20190814170432开始执行2018-02-13数据加载日志:
SQL开始执行时间：20190814170432




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170432
SQL开始执行时间：20190814170432
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-13'

;
SQL结束执行时间：20190814170437
SQL开始执行时间：20190814170437


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170437
SQL开始执行时间：20190814170437
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170459
SQL开始执行时间：20190814170459

delete from edw.checklist_sy where ddate = '2018-02-13'
;
SQL结束执行时间：20190814170459
SQL开始执行时间：20190814170459
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170500

20190814170500开始执行2018-02-14数据加载日志:
SQL开始执行时间：20190814170500




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170500
SQL开始执行时间：20190814170500
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-14'

;
SQL结束执行时间：20190814170505
SQL开始执行时间：20190814170505


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170505
SQL开始执行时间：20190814170505
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170517
SQL开始执行时间：20190814170517

delete from edw.checklist_sy where ddate = '2018-02-14'
;
SQL结束执行时间：20190814170518
SQL开始执行时间：20190814170518
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170518

20190814170518开始执行2018-02-15数据加载日志:
SQL开始执行时间：20190814170518




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170518
SQL开始执行时间：20190814170518
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-15'

;
SQL结束执行时间：20190814170523
SQL开始执行时间：20190814170523


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170523
SQL开始执行时间：20190814170523
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170524
SQL开始执行时间：20190814170524

delete from edw.checklist_sy where ddate = '2018-02-15'
;
SQL结束执行时间：20190814170525
SQL开始执行时间：20190814170525
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170525

20190814170525开始执行2018-02-16数据加载日志:
SQL开始执行时间：20190814170525




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170525
SQL开始执行时间：20190814170525
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-16'

;
SQL结束执行时间：20190814170528
SQL开始执行时间：20190814170528


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170528
SQL开始执行时间：20190814170528
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170529
SQL开始执行时间：20190814170529

delete from edw.checklist_sy where ddate = '2018-02-16'
;
SQL结束执行时间：20190814170529
SQL开始执行时间：20190814170529
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170529

20190814170529开始执行2018-02-17数据加载日志:
SQL开始执行时间：20190814170529




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170529
SQL开始执行时间：20190814170529
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-17'

;
SQL结束执行时间：20190814170532
SQL开始执行时间：20190814170532


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170532
SQL开始执行时间：20190814170532
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170533
SQL开始执行时间：20190814170533

delete from edw.checklist_sy where ddate = '2018-02-17'
;
SQL结束执行时间：20190814170533
SQL开始执行时间：20190814170533
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170533

20190814170533开始执行2018-02-18数据加载日志:
SQL开始执行时间：20190814170533




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170533
SQL开始执行时间：20190814170533
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-18'

;
SQL结束执行时间：20190814170536
SQL开始执行时间：20190814170536


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170536
SQL开始执行时间：20190814170536
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170538
SQL开始执行时间：20190814170538

delete from edw.checklist_sy where ddate = '2018-02-18'
;
SQL结束执行时间：20190814170538
SQL开始执行时间：20190814170538
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170538

20190814170538开始执行2018-02-19数据加载日志:
SQL开始执行时间：20190814170538




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170538
SQL开始执行时间：20190814170538
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-19'

;
SQL结束执行时间：20190814170541
SQL开始执行时间：20190814170541


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170541
SQL开始执行时间：20190814170541
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170543
SQL开始执行时间：20190814170543

delete from edw.checklist_sy where ddate = '2018-02-19'
;
SQL结束执行时间：20190814170543
SQL开始执行时间：20190814170543
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170543

20190814170543开始执行2018-02-20数据加载日志:
SQL开始执行时间：20190814170543




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170543
SQL开始执行时间：20190814170543
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-20'

;
SQL结束执行时间：20190814170547
SQL开始执行时间：20190814170547


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170547
SQL开始执行时间：20190814170547
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170552
SQL开始执行时间：20190814170552

delete from edw.checklist_sy where ddate = '2018-02-20'
;
SQL结束执行时间：20190814170552
SQL开始执行时间：20190814170552
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170552

20190814170552开始执行2018-02-21数据加载日志:
SQL开始执行时间：20190814170552




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170552
SQL开始执行时间：20190814170552
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-21'

;
SQL结束执行时间：20190814170556
SQL开始执行时间：20190814170556


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170556
SQL开始执行时间：20190814170556
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170600
SQL开始执行时间：20190814170600

delete from edw.checklist_sy where ddate = '2018-02-21'
;
SQL结束执行时间：20190814170600
SQL开始执行时间：20190814170600
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170601

20190814170601开始执行2018-02-22数据加载日志:
SQL开始执行时间：20190814170601




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170601
SQL开始执行时间：20190814170601
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-22'

;
SQL结束执行时间：20190814170604
SQL开始执行时间：20190814170604


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170604
SQL开始执行时间：20190814170604
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170617
SQL开始执行时间：20190814170617

delete from edw.checklist_sy where ddate = '2018-02-22'
;
SQL结束执行时间：20190814170617
SQL开始执行时间：20190814170617
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170618

20190814170618开始执行2018-02-23数据加载日志:
SQL开始执行时间：20190814170618




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170618
SQL开始执行时间：20190814170618
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-23'

;
SQL结束执行时间：20190814170621
SQL开始执行时间：20190814170621


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170621
SQL开始执行时间：20190814170621
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170638
SQL开始执行时间：20190814170638

delete from edw.checklist_sy where ddate = '2018-02-23'
;
SQL结束执行时间：20190814170638
SQL开始执行时间：20190814170638
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170639

20190814170639开始执行2018-02-24数据加载日志:
SQL开始执行时间：20190814170639




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170639
SQL开始执行时间：20190814170639
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-24'

;
SQL结束执行时间：20190814170642
SQL开始执行时间：20190814170642


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170642
SQL开始执行时间：20190814170642
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170652
SQL开始执行时间：20190814170652

delete from edw.checklist_sy where ddate = '2018-02-24'
;
SQL结束执行时间：20190814170652
SQL开始执行时间：20190814170652
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170653

20190814170653开始执行2018-02-25数据加载日志:
SQL开始执行时间：20190814170653




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170653
SQL开始执行时间：20190814170653
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-25'

;
SQL结束执行时间：20190814170656
SQL开始执行时间：20190814170656


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170656
SQL开始执行时间：20190814170656
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170657
SQL开始执行时间：20190814170657

delete from edw.checklist_sy where ddate = '2018-02-25'
;
SQL结束执行时间：20190814170657
SQL开始执行时间：20190814170657
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170658

20190814170658开始执行2018-02-26数据加载日志:
SQL开始执行时间：20190814170658




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170658
SQL开始执行时间：20190814170658
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-26'

;
SQL结束执行时间：20190814170701
SQL开始执行时间：20190814170701


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170701
SQL开始执行时间：20190814170701
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170721
SQL开始执行时间：20190814170721

delete from edw.checklist_sy where ddate = '2018-02-26'
;
SQL结束执行时间：20190814170721
SQL开始执行时间：20190814170721
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170721

20190814170722开始执行2018-02-27数据加载日志:
SQL开始执行时间：20190814170722




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170722
SQL开始执行时间：20190814170722
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-27'

;
SQL结束执行时间：20190814170725
SQL开始执行时间：20190814170725


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170725
SQL开始执行时间：20190814170725
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170750
SQL开始执行时间：20190814170750

delete from edw.checklist_sy where ddate = '2018-02-27'
;
SQL结束执行时间：20190814170750
SQL开始执行时间：20190814170750
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170751

20190814170751开始执行2018-02-28数据加载日志:
SQL开始执行时间：20190814170751




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170751
SQL开始执行时间：20190814170751
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-02-28'

;
SQL结束执行时间：20190814170754
SQL开始执行时间：20190814170754


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170754
SQL开始执行时间：20190814170754
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170815
SQL开始执行时间：20190814170815

delete from edw.checklist_sy where ddate = '2018-02-28'
;
SQL结束执行时间：20190814170815
SQL开始执行时间：20190814170815
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170816

20190814170816开始执行2018-03-01数据加载日志:
SQL开始执行时间：20190814170816




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170816
SQL开始执行时间：20190814170816
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-01'

;
SQL结束执行时间：20190814170819
SQL开始执行时间：20190814170819


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170819
SQL开始执行时间：20190814170819
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170838
SQL开始执行时间：20190814170838

delete from edw.checklist_sy where ddate = '2018-03-01'
;
SQL结束执行时间：20190814170838
SQL开始执行时间：20190814170838
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170839

20190814170839开始执行2018-03-02数据加载日志:
SQL开始执行时间：20190814170839




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170839
SQL开始执行时间：20190814170839
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-02'

;
SQL结束执行时间：20190814170843
SQL开始执行时间：20190814170843


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170843
SQL开始执行时间：20190814170843
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170859
SQL开始执行时间：20190814170859

delete from edw.checklist_sy where ddate = '2018-03-02'
;
SQL结束执行时间：20190814170859
SQL开始执行时间：20190814170859
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170900

20190814170900开始执行2018-03-03数据加载日志:
SQL开始执行时间：20190814170900




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170900
SQL开始执行时间：20190814170900
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-03'

;
SQL结束执行时间：20190814170903
SQL开始执行时间：20190814170903


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170903
SQL开始执行时间：20190814170903
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170906
SQL开始执行时间：20190814170906

delete from edw.checklist_sy where ddate = '2018-03-03'
;
SQL结束执行时间：20190814170906
SQL开始执行时间：20190814170906
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170906

20190814170906开始执行2018-03-04数据加载日志:
SQL开始执行时间：20190814170906




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170906
SQL开始执行时间：20190814170906
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-04'

;
SQL结束执行时间：20190814170909
SQL开始执行时间：20190814170909


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170909
SQL开始执行时间：20190814170909
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170910
SQL开始执行时间：20190814170910

delete from edw.checklist_sy where ddate = '2018-03-04'
;
SQL结束执行时间：20190814170910
SQL开始执行时间：20190814170910
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170910

20190814170911开始执行2018-03-05数据加载日志:
SQL开始执行时间：20190814170911




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170911
SQL开始执行时间：20190814170911
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-05'

;
SQL结束执行时间：20190814170914
SQL开始执行时间：20190814170914


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170914
SQL开始执行时间：20190814170914
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170930
SQL开始执行时间：20190814170930

delete from edw.checklist_sy where ddate = '2018-03-05'
;
SQL结束执行时间：20190814170930
SQL开始执行时间：20190814170930
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170930

20190814170931开始执行2018-03-06数据加载日志:
SQL开始执行时间：20190814170931




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170931
SQL开始执行时间：20190814170931
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-06'

;
SQL结束执行时间：20190814170934
SQL开始执行时间：20190814170934


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814170934
SQL开始执行时间：20190814170934
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814170956
SQL开始执行时间：20190814170956

delete from edw.checklist_sy where ddate = '2018-03-06'
;
SQL结束执行时间：20190814170957
SQL开始执行时间：20190814170957
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814170957

20190814170958开始执行2018-03-07数据加载日志:
SQL开始执行时间：20190814170958




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814170958
SQL开始执行时间：20190814170958
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-07'

;
SQL结束执行时间：20190814171001
SQL开始执行时间：20190814171001


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171001
SQL开始执行时间：20190814171001
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171023
SQL开始执行时间：20190814171023

delete from edw.checklist_sy where ddate = '2018-03-07'
;
SQL结束执行时间：20190814171023
SQL开始执行时间：20190814171023
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171024

20190814171024开始执行2018-03-08数据加载日志:
SQL开始执行时间：20190814171024




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171024
SQL开始执行时间：20190814171024
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-08'

;
SQL结束执行时间：20190814171028
SQL开始执行时间：20190814171028


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171028
SQL开始执行时间：20190814171028
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171049
SQL开始执行时间：20190814171049

delete from edw.checklist_sy where ddate = '2018-03-08'
;
SQL结束执行时间：20190814171050
SQL开始执行时间：20190814171050
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171050

20190814171051开始执行2018-03-09数据加载日志:
SQL开始执行时间：20190814171051




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171051
SQL开始执行时间：20190814171051
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-09'

;
SQL结束执行时间：20190814171054
SQL开始执行时间：20190814171054


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171054
SQL开始执行时间：20190814171054
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171108
SQL开始执行时间：20190814171108

delete from edw.checklist_sy where ddate = '2018-03-09'
;
SQL结束执行时间：20190814171109
SQL开始执行时间：20190814171109
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171109

20190814171109开始执行2018-03-10数据加载日志:
SQL开始执行时间：20190814171109




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171109
SQL开始执行时间：20190814171109
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-10'

;
SQL结束执行时间：20190814171112
SQL开始执行时间：20190814171112


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171112
SQL开始执行时间：20190814171112
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171113
SQL开始执行时间：20190814171113

delete from edw.checklist_sy where ddate = '2018-03-10'
;
SQL结束执行时间：20190814171113
SQL开始执行时间：20190814171113
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171114

20190814171114开始执行2018-03-11数据加载日志:
SQL开始执行时间：20190814171114




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171114
SQL开始执行时间：20190814171114
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-11'

;
SQL结束执行时间：20190814171117
SQL开始执行时间：20190814171117


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171117
SQL开始执行时间：20190814171117
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171118
SQL开始执行时间：20190814171118

delete from edw.checklist_sy where ddate = '2018-03-11'
;
SQL结束执行时间：20190814171118
SQL开始执行时间：20190814171118
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171118

20190814171118开始执行2018-03-12数据加载日志:
SQL开始执行时间：20190814171118




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171118
SQL开始执行时间：20190814171118
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-12'

;
SQL结束执行时间：20190814171121
SQL开始执行时间：20190814171121


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171121
SQL开始执行时间：20190814171121
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171143
SQL开始执行时间：20190814171143

delete from edw.checklist_sy where ddate = '2018-03-12'
;
SQL结束执行时间：20190814171144
SQL开始执行时间：20190814171144
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171145

20190814171145开始执行2018-03-13数据加载日志:
SQL开始执行时间：20190814171145




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171145
SQL开始执行时间：20190814171145
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-13'

;
SQL结束执行时间：20190814171148
SQL开始执行时间：20190814171148


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171148
SQL开始执行时间：20190814171148
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171214
SQL开始执行时间：20190814171214

delete from edw.checklist_sy where ddate = '2018-03-13'
;
SQL结束执行时间：20190814171214
SQL开始执行时间：20190814171214
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171215

20190814171215开始执行2018-03-14数据加载日志:
SQL开始执行时间：20190814171215




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171215
SQL开始执行时间：20190814171215
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-14'

;
SQL结束执行时间：20190814171218
SQL开始执行时间：20190814171218


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171218
SQL开始执行时间：20190814171218
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171239
SQL开始执行时间：20190814171239

delete from edw.checklist_sy where ddate = '2018-03-14'
;
SQL结束执行时间：20190814171240
SQL开始执行时间：20190814171240
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171240

20190814171241开始执行2018-03-15数据加载日志:
SQL开始执行时间：20190814171241




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171241
SQL开始执行时间：20190814171241
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-15'

;
SQL结束执行时间：20190814171244
SQL开始执行时间：20190814171244


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171244
SQL开始执行时间：20190814171244
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171302
SQL开始执行时间：20190814171302

delete from edw.checklist_sy where ddate = '2018-03-15'
;
SQL结束执行时间：20190814171302
SQL开始执行时间：20190814171302
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171303

20190814171303开始执行2018-03-16数据加载日志:
SQL开始执行时间：20190814171303




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171303
SQL开始执行时间：20190814171303
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-16'

;
SQL结束执行时间：20190814171307
SQL开始执行时间：20190814171307


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171307
SQL开始执行时间：20190814171307
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171321
SQL开始执行时间：20190814171321

delete from edw.checklist_sy where ddate = '2018-03-16'
;
SQL结束执行时间：20190814171322
SQL开始执行时间：20190814171322
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171322

20190814171322开始执行2018-03-17数据加载日志:
SQL开始执行时间：20190814171322




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171322
SQL开始执行时间：20190814171322
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-17'

;
SQL结束执行时间：20190814171326
SQL开始执行时间：20190814171326


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171326
SQL开始执行时间：20190814171326
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171327
SQL开始执行时间：20190814171327

delete from edw.checklist_sy where ddate = '2018-03-17'
;
SQL结束执行时间：20190814171328
SQL开始执行时间：20190814171328
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171328

20190814171328开始执行2018-03-18数据加载日志:
SQL开始执行时间：20190814171328




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171328
SQL开始执行时间：20190814171328
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-18'

;
SQL结束执行时间：20190814171331
SQL开始执行时间：20190814171331


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171331
SQL开始执行时间：20190814171331
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171332
SQL开始执行时间：20190814171332

delete from edw.checklist_sy where ddate = '2018-03-18'
;
SQL结束执行时间：20190814171332
SQL开始执行时间：20190814171332
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171332

20190814171332开始执行2018-03-19数据加载日志:
SQL开始执行时间：20190814171332




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171332
SQL开始执行时间：20190814171332
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-19'

;
SQL结束执行时间：20190814171336
SQL开始执行时间：20190814171336


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171336
SQL开始执行时间：20190814171336
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171355
SQL开始执行时间：20190814171355

delete from edw.checklist_sy where ddate = '2018-03-19'
;
SQL结束执行时间：20190814171356
SQL开始执行时间：20190814171356
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171356

20190814171357开始执行2018-03-20数据加载日志:
SQL开始执行时间：20190814171357




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171357
SQL开始执行时间：20190814171357
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-20'

;
SQL结束执行时间：20190814171400
SQL开始执行时间：20190814171400


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171400
SQL开始执行时间：20190814171400
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171421
SQL开始执行时间：20190814171421

delete from edw.checklist_sy where ddate = '2018-03-20'
;
SQL结束执行时间：20190814171421
SQL开始执行时间：20190814171421
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171422

20190814171422开始执行2018-03-21数据加载日志:
SQL开始执行时间：20190814171422




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171422
SQL开始执行时间：20190814171422
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-21'

;
SQL结束执行时间：20190814171425
SQL开始执行时间：20190814171425


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171425
SQL开始执行时间：20190814171425
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171445
SQL开始执行时间：20190814171445

delete from edw.checklist_sy where ddate = '2018-03-21'
;
SQL结束执行时间：20190814171445
SQL开始执行时间：20190814171445
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171446

20190814171446开始执行2018-03-22数据加载日志:
SQL开始执行时间：20190814171446




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171446
SQL开始执行时间：20190814171446
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-22'

;
SQL结束执行时间：20190814171450
SQL开始执行时间：20190814171450


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171450
SQL开始执行时间：20190814171450
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171510
SQL开始执行时间：20190814171510

delete from edw.checklist_sy where ddate = '2018-03-22'
;
SQL结束执行时间：20190814171510
SQL开始执行时间：20190814171510
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171511

20190814171511开始执行2018-03-23数据加载日志:
SQL开始执行时间：20190814171511




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171511
SQL开始执行时间：20190814171511
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-23'

;
SQL结束执行时间：20190814171515
SQL开始执行时间：20190814171515


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171515
SQL开始执行时间：20190814171515
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171527
SQL开始执行时间：20190814171527

delete from edw.checklist_sy where ddate = '2018-03-23'
;
SQL结束执行时间：20190814171527
SQL开始执行时间：20190814171527
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171528

20190814171528开始执行2018-03-24数据加载日志:
SQL开始执行时间：20190814171528




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171528
SQL开始执行时间：20190814171528
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-24'

;
SQL结束执行时间：20190814171531
SQL开始执行时间：20190814171531


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171531
SQL开始执行时间：20190814171531
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171533
SQL开始执行时间：20190814171533

delete from edw.checklist_sy where ddate = '2018-03-24'
;
SQL结束执行时间：20190814171533
SQL开始执行时间：20190814171533
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171533

20190814171533开始执行2018-03-25数据加载日志:
SQL开始执行时间：20190814171533




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171533
SQL开始执行时间：20190814171533
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-25'

;
SQL结束执行时间：20190814171537
SQL开始执行时间：20190814171537


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171537
SQL开始执行时间：20190814171537
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171537
SQL开始执行时间：20190814171537

delete from edw.checklist_sy where ddate = '2018-03-25'
;
SQL结束执行时间：20190814171537
SQL开始执行时间：20190814171537
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171537

20190814171538开始执行2018-03-26数据加载日志:
SQL开始执行时间：20190814171538




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171538
SQL开始执行时间：20190814171538
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-26'

;
SQL结束执行时间：20190814171541
SQL开始执行时间：20190814171541


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171541
SQL开始执行时间：20190814171541
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171559
SQL开始执行时间：20190814171559

delete from edw.checklist_sy where ddate = '2018-03-26'
;
SQL结束执行时间：20190814171559
SQL开始执行时间：20190814171559
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171600

20190814171600开始执行2018-03-27数据加载日志:
SQL开始执行时间：20190814171600




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171600
SQL开始执行时间：20190814171600
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-27'

;
SQL结束执行时间：20190814171603
SQL开始执行时间：20190814171603


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171603
SQL开始执行时间：20190814171603
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171625
SQL开始执行时间：20190814171625

delete from edw.checklist_sy where ddate = '2018-03-27'
;
SQL结束执行时间：20190814171625
SQL开始执行时间：20190814171625
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171626

20190814171626开始执行2018-03-28数据加载日志:
SQL开始执行时间：20190814171626




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171626
SQL开始执行时间：20190814171626
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-28'

;
SQL结束执行时间：20190814171630
SQL开始执行时间：20190814171630


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171630
SQL开始执行时间：20190814171630
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171654
SQL开始执行时间：20190814171654

delete from edw.checklist_sy where ddate = '2018-03-28'
;
SQL结束执行时间：20190814171655
SQL开始执行时间：20190814171655
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171655

20190814171656开始执行2018-03-29数据加载日志:
SQL开始执行时间：20190814171656




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171656
SQL开始执行时间：20190814171656
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-29'

;
SQL结束执行时间：20190814171659
SQL开始执行时间：20190814171659


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171659
SQL开始执行时间：20190814171659
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171717
SQL开始执行时间：20190814171717

delete from edw.checklist_sy where ddate = '2018-03-29'
;
SQL结束执行时间：20190814171717
SQL开始执行时间：20190814171717
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171718

20190814171718开始执行2018-03-30数据加载日志:
SQL开始执行时间：20190814171718




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171718
SQL开始执行时间：20190814171718
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-30'

;
SQL结束执行时间：20190814171721
SQL开始执行时间：20190814171721


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171721
SQL开始执行时间：20190814171721
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171734
SQL开始执行时间：20190814171734

delete from edw.checklist_sy where ddate = '2018-03-30'
;
SQL结束执行时间：20190814171734
SQL开始执行时间：20190814171734
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171734

20190814171734开始执行2018-03-31数据加载日志:
SQL开始执行时间：20190814171734




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171734
SQL开始执行时间：20190814171734
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-03-31'

;
SQL结束执行时间：20190814171738
SQL开始执行时间：20190814171738


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171738
SQL开始执行时间：20190814171738
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171738
SQL开始执行时间：20190814171738

delete from edw.checklist_sy where ddate = '2018-03-31'
;
SQL结束执行时间：20190814171739
SQL开始执行时间：20190814171739
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171739

20190814171739开始执行2018-04-01数据加载日志:
SQL开始执行时间：20190814171739




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171739
SQL开始执行时间：20190814171739
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-01'

;
SQL结束执行时间：20190814171742
SQL开始执行时间：20190814171742


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171742
SQL开始执行时间：20190814171742
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171743
SQL开始执行时间：20190814171743

delete from edw.checklist_sy where ddate = '2018-04-01'
;
SQL结束执行时间：20190814171743
SQL开始执行时间：20190814171743
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171743

20190814171743开始执行2018-04-02数据加载日志:
SQL开始执行时间：20190814171743




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171743
SQL开始执行时间：20190814171743
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-02'

;
SQL结束执行时间：20190814171747
SQL开始执行时间：20190814171747


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171747
SQL开始执行时间：20190814171747
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171805
SQL开始执行时间：20190814171805

delete from edw.checklist_sy where ddate = '2018-04-02'
;
SQL结束执行时间：20190814171805
SQL开始执行时间：20190814171805
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171806

20190814171806开始执行2018-04-03数据加载日志:
SQL开始执行时间：20190814171806




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171806
SQL开始执行时间：20190814171806
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-03'

;
SQL结束执行时间：20190814171809
SQL开始执行时间：20190814171809


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171809
SQL开始执行时间：20190814171809
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171835
SQL开始执行时间：20190814171835

delete from edw.checklist_sy where ddate = '2018-04-03'
;
SQL结束执行时间：20190814171836
SQL开始执行时间：20190814171836
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171837

20190814171837开始执行2018-04-04数据加载日志:
SQL开始执行时间：20190814171837




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171837
SQL开始执行时间：20190814171837
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-04'

;
SQL结束执行时间：20190814171840
SQL开始执行时间：20190814171840


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171840
SQL开始执行时间：20190814171840
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171857
SQL开始执行时间：20190814171857

delete from edw.checklist_sy where ddate = '2018-04-04'
;
SQL结束执行时间：20190814171857
SQL开始执行时间：20190814171857
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171858

20190814171858开始执行2018-04-05数据加载日志:
SQL开始执行时间：20190814171858




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171858
SQL开始执行时间：20190814171858
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-05'

;
SQL结束执行时间：20190814171901
SQL开始执行时间：20190814171901


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171901
SQL开始执行时间：20190814171901
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171905
SQL开始执行时间：20190814171905

delete from edw.checklist_sy where ddate = '2018-04-05'
;
SQL结束执行时间：20190814171905
SQL开始执行时间：20190814171905
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171905

20190814171905开始执行2018-04-06数据加载日志:
SQL开始执行时间：20190814171905




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171905
SQL开始执行时间：20190814171905
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-06'

;
SQL结束执行时间：20190814171909
SQL开始执行时间：20190814171909


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171909
SQL开始执行时间：20190814171909
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171914
SQL开始执行时间：20190814171914

delete from edw.checklist_sy where ddate = '2018-04-06'
;
SQL结束执行时间：20190814171914
SQL开始执行时间：20190814171914
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171915

20190814171915开始执行2018-04-07数据加载日志:
SQL开始执行时间：20190814171915




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171915
SQL开始执行时间：20190814171915
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-07'

;
SQL结束执行时间：20190814171918
SQL开始执行时间：20190814171918


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171918
SQL开始执行时间：20190814171918
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171920
SQL开始执行时间：20190814171920

delete from edw.checklist_sy where ddate = '2018-04-07'
;
SQL结束执行时间：20190814171920
SQL开始执行时间：20190814171920
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171920

20190814171921开始执行2018-04-08数据加载日志:
SQL开始执行时间：20190814171921




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171921
SQL开始执行时间：20190814171921
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-08'

;
SQL结束执行时间：20190814171924
SQL开始执行时间：20190814171924


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171924
SQL开始执行时间：20190814171924
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171933
SQL开始执行时间：20190814171933

delete from edw.checklist_sy where ddate = '2018-04-08'
;
SQL结束执行时间：20190814171934
SQL开始执行时间：20190814171934
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171934

20190814171934开始执行2018-04-09数据加载日志:
SQL开始执行时间：20190814171934




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171934
SQL开始执行时间：20190814171934
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-09'

;
SQL结束执行时间：20190814171938
SQL开始执行时间：20190814171938


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814171938
SQL开始执行时间：20190814171938
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814171958
SQL开始执行时间：20190814171958

delete from edw.checklist_sy where ddate = '2018-04-09'
;
SQL结束执行时间：20190814171958
SQL开始执行时间：20190814171958
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814171959

20190814171959开始执行2018-04-10数据加载日志:
SQL开始执行时间：20190814171959




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814171959
SQL开始执行时间：20190814171959
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-10'

;
SQL结束执行时间：20190814172002
SQL开始执行时间：20190814172002


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172002
SQL开始执行时间：20190814172002
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172023
SQL开始执行时间：20190814172023

delete from edw.checklist_sy where ddate = '2018-04-10'
;
SQL结束执行时间：20190814172023
SQL开始执行时间：20190814172023
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172024

20190814172024开始执行2018-04-11数据加载日志:
SQL开始执行时间：20190814172024




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172024
SQL开始执行时间：20190814172024
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-11'

;
SQL结束执行时间：20190814172028
SQL开始执行时间：20190814172028


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172028
SQL开始执行时间：20190814172028
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172049
SQL开始执行时间：20190814172049

delete from edw.checklist_sy where ddate = '2018-04-11'
;
SQL结束执行时间：20190814172050
SQL开始执行时间：20190814172050
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172051

20190814172051开始执行2018-04-12数据加载日志:
SQL开始执行时间：20190814172051




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172051
SQL开始执行时间：20190814172051
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-12'

;
SQL结束执行时间：20190814172054
SQL开始执行时间：20190814172054


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172054
SQL开始执行时间：20190814172054
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172110
SQL开始执行时间：20190814172110

delete from edw.checklist_sy where ddate = '2018-04-12'
;
SQL结束执行时间：20190814172110
SQL开始执行时间：20190814172110
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172111

20190814172111开始执行2018-04-13数据加载日志:
SQL开始执行时间：20190814172111




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172111
SQL开始执行时间：20190814172111
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-13'

;
SQL结束执行时间：20190814172114
SQL开始执行时间：20190814172114


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172114
SQL开始执行时间：20190814172114
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172128
SQL开始执行时间：20190814172128

delete from edw.checklist_sy where ddate = '2018-04-13'
;
SQL结束执行时间：20190814172128
SQL开始执行时间：20190814172128
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172129

20190814172129开始执行2018-04-14数据加载日志:
SQL开始执行时间：20190814172129




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172129
SQL开始执行时间：20190814172129
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-14'

;
SQL结束执行时间：20190814172132
SQL开始执行时间：20190814172132


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172132
SQL开始执行时间：20190814172132
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172133
SQL开始执行时间：20190814172133

delete from edw.checklist_sy where ddate = '2018-04-14'
;
SQL结束执行时间：20190814172133
SQL开始执行时间：20190814172133
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172134

20190814172134开始执行2018-04-15数据加载日志:
SQL开始执行时间：20190814172134




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172134
SQL开始执行时间：20190814172134
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-15'

;
SQL结束执行时间：20190814172137
SQL开始执行时间：20190814172137


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172137
SQL开始执行时间：20190814172137
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172138
SQL开始执行时间：20190814172138

delete from edw.checklist_sy where ddate = '2018-04-15'
;
SQL结束执行时间：20190814172138
SQL开始执行时间：20190814172138
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172138

20190814172138开始执行2018-04-16数据加载日志:
SQL开始执行时间：20190814172138




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172138
SQL开始执行时间：20190814172138
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-16'

;
SQL结束执行时间：20190814172141
SQL开始执行时间：20190814172141


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172141
SQL开始执行时间：20190814172141
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172200
SQL开始执行时间：20190814172200

delete from edw.checklist_sy where ddate = '2018-04-16'
;
SQL结束执行时间：20190814172200
SQL开始执行时间：20190814172200
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172201

20190814172201开始执行2018-04-17数据加载日志:
SQL开始执行时间：20190814172201




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172201
SQL开始执行时间：20190814172201
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-17'

;
SQL结束执行时间：20190814172205
SQL开始执行时间：20190814172205


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172205
SQL开始执行时间：20190814172205
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172228
SQL开始执行时间：20190814172228

delete from edw.checklist_sy where ddate = '2018-04-17'
;
SQL结束执行时间：20190814172229
SQL开始执行时间：20190814172229
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172229

20190814172230开始执行2018-04-18数据加载日志:
SQL开始执行时间：20190814172230




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172230
SQL开始执行时间：20190814172230
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-18'

;
SQL结束执行时间：20190814172233
SQL开始执行时间：20190814172233


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172233
SQL开始执行时间：20190814172233
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172254
SQL开始执行时间：20190814172254

delete from edw.checklist_sy where ddate = '2018-04-18'
;
SQL结束执行时间：20190814172254
SQL开始执行时间：20190814172254
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172255

20190814172255开始执行2018-04-19数据加载日志:
SQL开始执行时间：20190814172255




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172255
SQL开始执行时间：20190814172255
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-19'

;
SQL结束执行时间：20190814172258
SQL开始执行时间：20190814172258


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172258
SQL开始执行时间：20190814172258
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172316
SQL开始执行时间：20190814172316

delete from edw.checklist_sy where ddate = '2018-04-19'
;
SQL结束执行时间：20190814172316
SQL开始执行时间：20190814172316
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172317

20190814172317开始执行2018-04-20数据加载日志:
SQL开始执行时间：20190814172317




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172317
SQL开始执行时间：20190814172317
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-20'

;
SQL结束执行时间：20190814172320
SQL开始执行时间：20190814172320


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172320
SQL开始执行时间：20190814172320
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172333
SQL开始执行时间：20190814172333

delete from edw.checklist_sy where ddate = '2018-04-20'
;
SQL结束执行时间：20190814172333
SQL开始执行时间：20190814172333
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172334

20190814172334开始执行2018-04-21数据加载日志:
SQL开始执行时间：20190814172334




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172334
SQL开始执行时间：20190814172334
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-21'

;
SQL结束执行时间：20190814172337
SQL开始执行时间：20190814172337


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172337
SQL开始执行时间：20190814172337
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172338
SQL开始执行时间：20190814172338

delete from edw.checklist_sy where ddate = '2018-04-21'
;
SQL结束执行时间：20190814172338
SQL开始执行时间：20190814172338
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172338

20190814172339开始执行2018-04-22数据加载日志:
SQL开始执行时间：20190814172339




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172339
SQL开始执行时间：20190814172339
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-22'

;
SQL结束执行时间：20190814172342
SQL开始执行时间：20190814172342


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172342
SQL开始执行时间：20190814172342
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172342
SQL开始执行时间：20190814172342

delete from edw.checklist_sy where ddate = '2018-04-22'
;
SQL结束执行时间：20190814172342
SQL开始执行时间：20190814172342
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172343

20190814172343开始执行2018-04-23数据加载日志:
SQL开始执行时间：20190814172343




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172343
SQL开始执行时间：20190814172343
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-23'

;
SQL结束执行时间：20190814172346
SQL开始执行时间：20190814172346


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172346
SQL开始执行时间：20190814172346
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172407
SQL开始执行时间：20190814172407

delete from edw.checklist_sy where ddate = '2018-04-23'
;
SQL结束执行时间：20190814172407
SQL开始执行时间：20190814172407
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172408

20190814172408开始执行2018-04-24数据加载日志:
SQL开始执行时间：20190814172408




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172408
SQL开始执行时间：20190814172408
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-24'

;
SQL结束执行时间：20190814172411
SQL开始执行时间：20190814172411


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172411
SQL开始执行时间：20190814172411
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172433
SQL开始执行时间：20190814172433

delete from edw.checklist_sy where ddate = '2018-04-24'
;
SQL结束执行时间：20190814172433
SQL开始执行时间：20190814172433
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172434

20190814172434开始执行2018-04-25数据加载日志:
SQL开始执行时间：20190814172434




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172434
SQL开始执行时间：20190814172434
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-25'

;
SQL结束执行时间：20190814172437
SQL开始执行时间：20190814172437


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172437
SQL开始执行时间：20190814172437
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172456
SQL开始执行时间：20190814172456

delete from edw.checklist_sy where ddate = '2018-04-25'
;
SQL结束执行时间：20190814172456
SQL开始执行时间：20190814172456
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172457

20190814172457开始执行2018-04-26数据加载日志:
SQL开始执行时间：20190814172457




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172457
SQL开始执行时间：20190814172457
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-26'

;
SQL结束执行时间：20190814172500
SQL开始执行时间：20190814172500


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172500
SQL开始执行时间：20190814172500
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172520
SQL开始执行时间：20190814172520

delete from edw.checklist_sy where ddate = '2018-04-26'
;
SQL结束执行时间：20190814172521
SQL开始执行时间：20190814172521
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172522

20190814172522开始执行2018-04-27数据加载日志:
SQL开始执行时间：20190814172522




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172522
SQL开始执行时间：20190814172522
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-27'

;
SQL结束执行时间：20190814172526
SQL开始执行时间：20190814172526


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172526
SQL开始执行时间：20190814172526
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172543
SQL开始执行时间：20190814172543

delete from edw.checklist_sy where ddate = '2018-04-27'
;
SQL结束执行时间：20190814172543
SQL开始执行时间：20190814172543
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172544

20190814172544开始执行2018-04-28数据加载日志:
SQL开始执行时间：20190814172544




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172544
SQL开始执行时间：20190814172544
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-28'

;
SQL结束执行时间：20190814172547
SQL开始执行时间：20190814172547


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172547
SQL开始执行时间：20190814172547
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172554
SQL开始执行时间：20190814172554

delete from edw.checklist_sy where ddate = '2018-04-28'
;
SQL结束执行时间：20190814172554
SQL开始执行时间：20190814172554
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172554

20190814172554开始执行2018-04-29数据加载日志:
SQL开始执行时间：20190814172554




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172554
SQL开始执行时间：20190814172554
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-29'

;
SQL结束执行时间：20190814172558
SQL开始执行时间：20190814172558


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172558
SQL开始执行时间：20190814172558
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172559
SQL开始执行时间：20190814172559

delete from edw.checklist_sy where ddate = '2018-04-29'
;
SQL结束执行时间：20190814172559
SQL开始执行时间：20190814172559
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172559

20190814172600开始执行2018-04-30数据加载日志:
SQL开始执行时间：20190814172600




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172600
SQL开始执行时间：20190814172600
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-04-30'

;
SQL结束执行时间：20190814172604
SQL开始执行时间：20190814172604


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172604
SQL开始执行时间：20190814172604
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172609
SQL开始执行时间：20190814172609

delete from edw.checklist_sy where ddate = '2018-04-30'
;
SQL结束执行时间：20190814172609
SQL开始执行时间：20190814172609
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172610

20190814172610开始执行2018-05-01数据加载日志:
SQL开始执行时间：20190814172610




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172610
SQL开始执行时间：20190814172610
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-01'

;
SQL结束执行时间：20190814172614
SQL开始执行时间：20190814172614


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172614
SQL开始执行时间：20190814172614
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172617
SQL开始执行时间：20190814172617

delete from edw.checklist_sy where ddate = '2018-05-01'
;
SQL结束执行时间：20190814172617
SQL开始执行时间：20190814172617
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172618

20190814172618开始执行2018-05-02数据加载日志:
SQL开始执行时间：20190814172618




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172618
SQL开始执行时间：20190814172618
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-02'

;
SQL结束执行时间：20190814172622
SQL开始执行时间：20190814172622


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172622
SQL开始执行时间：20190814172622
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172640
SQL开始执行时间：20190814172640

delete from edw.checklist_sy where ddate = '2018-05-02'
;
SQL结束执行时间：20190814172640
SQL开始执行时间：20190814172640
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172641

20190814172641开始执行2018-05-03数据加载日志:
SQL开始执行时间：20190814172641




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172641
SQL开始执行时间：20190814172641
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-03'

;
SQL结束执行时间：20190814172645
SQL开始执行时间：20190814172645


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172645
SQL开始执行时间：20190814172645
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172709
SQL开始执行时间：20190814172709

delete from edw.checklist_sy where ddate = '2018-05-03'
;
SQL结束执行时间：20190814172709
SQL开始执行时间：20190814172709
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172710

20190814172710开始执行2018-05-04数据加载日志:
SQL开始执行时间：20190814172710




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172710
SQL开始执行时间：20190814172710
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-04'

;
SQL结束执行时间：20190814172713
SQL开始执行时间：20190814172713


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172713
SQL开始执行时间：20190814172713
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172729
SQL开始执行时间：20190814172729

delete from edw.checklist_sy where ddate = '2018-05-04'
;
SQL结束执行时间：20190814172729
SQL开始执行时间：20190814172729
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172730

20190814172730开始执行2018-05-05数据加载日志:
SQL开始执行时间：20190814172730




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172730
SQL开始执行时间：20190814172730
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-05'

;
SQL结束执行时间：20190814172733
SQL开始执行时间：20190814172733


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172733
SQL开始执行时间：20190814172733
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172736
SQL开始执行时间：20190814172736

delete from edw.checklist_sy where ddate = '2018-05-05'
;
SQL结束执行时间：20190814172737
SQL开始执行时间：20190814172737
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172737

20190814172737开始执行2018-05-06数据加载日志:
SQL开始执行时间：20190814172737




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172737
SQL开始执行时间：20190814172737
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-06'

;
SQL结束执行时间：20190814172740
SQL开始执行时间：20190814172740


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172740
SQL开始执行时间：20190814172740
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172741
SQL开始执行时间：20190814172741

delete from edw.checklist_sy where ddate = '2018-05-06'
;
SQL结束执行时间：20190814172741
SQL开始执行时间：20190814172741
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172741

20190814172741开始执行2018-05-07数据加载日志:
SQL开始执行时间：20190814172741




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172741
SQL开始执行时间：20190814172741
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-07'

;
SQL结束执行时间：20190814172745
SQL开始执行时间：20190814172745


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172745
SQL开始执行时间：20190814172745
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172804
SQL开始执行时间：20190814172804

delete from edw.checklist_sy where ddate = '2018-05-07'
;
SQL结束执行时间：20190814172804
SQL开始执行时间：20190814172804
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172805

20190814172805开始执行2018-05-08数据加载日志:
SQL开始执行时间：20190814172805




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172805
SQL开始执行时间：20190814172805
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-08'

;
SQL结束执行时间：20190814172808
SQL开始执行时间：20190814172808


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172808
SQL开始执行时间：20190814172808
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172832
SQL开始执行时间：20190814172832

delete from edw.checklist_sy where ddate = '2018-05-08'
;
SQL结束执行时间：20190814172833
SQL开始执行时间：20190814172833
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172833

20190814172834开始执行2018-05-09数据加载日志:
SQL开始执行时间：20190814172834




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172834
SQL开始执行时间：20190814172834
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-09'

;
SQL结束执行时间：20190814172837
SQL开始执行时间：20190814172837


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172837
SQL开始执行时间：20190814172837
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172854
SQL开始执行时间：20190814172854

delete from edw.checklist_sy where ddate = '2018-05-09'
;
SQL结束执行时间：20190814172854
SQL开始执行时间：20190814172854
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172855

20190814172855开始执行2018-05-10数据加载日志:
SQL开始执行时间：20190814172855




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172855
SQL开始执行时间：20190814172855
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-10'

;
SQL结束执行时间：20190814172858
SQL开始执行时间：20190814172858


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172858
SQL开始执行时间：20190814172858
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172915
SQL开始执行时间：20190814172915

delete from edw.checklist_sy where ddate = '2018-05-10'
;
SQL结束执行时间：20190814172915
SQL开始执行时间：20190814172915
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172916

20190814172916开始执行2018-05-11数据加载日志:
SQL开始执行时间：20190814172916




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172916
SQL开始执行时间：20190814172916
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-11'

;
SQL结束执行时间：20190814172919
SQL开始执行时间：20190814172919


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172919
SQL开始执行时间：20190814172919
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172933
SQL开始执行时间：20190814172933

delete from edw.checklist_sy where ddate = '2018-05-11'
;
SQL结束执行时间：20190814172934
SQL开始执行时间：20190814172934
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172934

20190814172934开始执行2018-05-12数据加载日志:
SQL开始执行时间：20190814172934




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172934
SQL开始执行时间：20190814172934
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-12'

;
SQL结束执行时间：20190814172938
SQL开始执行时间：20190814172938


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172938
SQL开始执行时间：20190814172938
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172938
SQL开始执行时间：20190814172938

delete from edw.checklist_sy where ddate = '2018-05-12'
;
SQL结束执行时间：20190814172938
SQL开始执行时间：20190814172938
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172939

20190814172939开始执行2018-05-13数据加载日志:
SQL开始执行时间：20190814172939




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172939
SQL开始执行时间：20190814172939
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-13'

;
SQL结束执行时间：20190814172942
SQL开始执行时间：20190814172942


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172942
SQL开始执行时间：20190814172942
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814172943
SQL开始执行时间：20190814172943

delete from edw.checklist_sy where ddate = '2018-05-13'
;
SQL结束执行时间：20190814172944
SQL开始执行时间：20190814172944
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814172944

20190814172944开始执行2018-05-14数据加载日志:
SQL开始执行时间：20190814172944




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814172944
SQL开始执行时间：20190814172944
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-14'

;
SQL结束执行时间：20190814172947
SQL开始执行时间：20190814172947


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814172947
SQL开始执行时间：20190814172947
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173007
SQL开始执行时间：20190814173007

delete from edw.checklist_sy where ddate = '2018-05-14'
;
SQL结束执行时间：20190814173007
SQL开始执行时间：20190814173007
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173008

20190814173008开始执行2018-05-15数据加载日志:
SQL开始执行时间：20190814173008




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173008
SQL开始执行时间：20190814173008
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-15'

;
SQL结束执行时间：20190814173012
SQL开始执行时间：20190814173012


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173012
SQL开始执行时间：20190814173012
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173032
SQL开始执行时间：20190814173032

delete from edw.checklist_sy where ddate = '2018-05-15'
;
SQL结束执行时间：20190814173032
SQL开始执行时间：20190814173032
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173033

20190814173033开始执行2018-05-16数据加载日志:
SQL开始执行时间：20190814173033




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173033
SQL开始执行时间：20190814173033
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-16'

;
SQL结束执行时间：20190814173036
SQL开始执行时间：20190814173036


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173036
SQL开始执行时间：20190814173036
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173057
SQL开始执行时间：20190814173057

delete from edw.checklist_sy where ddate = '2018-05-16'
;
SQL结束执行时间：20190814173057
SQL开始执行时间：20190814173057
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173058

20190814173058开始执行2018-05-17数据加载日志:
SQL开始执行时间：20190814173058




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173058
SQL开始执行时间：20190814173058
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-17'

;
SQL结束执行时间：20190814173102
SQL开始执行时间：20190814173102


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173102
SQL开始执行时间：20190814173102
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173123
SQL开始执行时间：20190814173123

delete from edw.checklist_sy where ddate = '2018-05-17'
;
SQL结束执行时间：20190814173124
SQL开始执行时间：20190814173124
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173125

20190814173125开始执行2018-05-18数据加载日志:
SQL开始执行时间：20190814173125




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173125
SQL开始执行时间：20190814173125
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-18'

;
SQL结束执行时间：20190814173128
SQL开始执行时间：20190814173128


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173128
SQL开始执行时间：20190814173128
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173139
SQL开始执行时间：20190814173139

delete from edw.checklist_sy where ddate = '2018-05-18'
;
SQL结束执行时间：20190814173139
SQL开始执行时间：20190814173139
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173139

20190814173140开始执行2018-05-19数据加载日志:
SQL开始执行时间：20190814173140




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173140
SQL开始执行时间：20190814173140
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-19'

;
SQL结束执行时间：20190814173143
SQL开始执行时间：20190814173143


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173143
SQL开始执行时间：20190814173143
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173144
SQL开始执行时间：20190814173144

delete from edw.checklist_sy where ddate = '2018-05-19'
;
SQL结束执行时间：20190814173144
SQL开始执行时间：20190814173144
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173144

20190814173145开始执行2018-05-20数据加载日志:
SQL开始执行时间：20190814173145




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173145
SQL开始执行时间：20190814173145
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-20'

;
SQL结束执行时间：20190814173148
SQL开始执行时间：20190814173148


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173148
SQL开始执行时间：20190814173148
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173149
SQL开始执行时间：20190814173149

delete from edw.checklist_sy where ddate = '2018-05-20'
;
SQL结束执行时间：20190814173149
SQL开始执行时间：20190814173149
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173149

20190814173149开始执行2018-05-21数据加载日志:
SQL开始执行时间：20190814173149




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173149
SQL开始执行时间：20190814173149
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-21'

;
SQL结束执行时间：20190814173153
SQL开始执行时间：20190814173153


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173153
SQL开始执行时间：20190814173153
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173210
SQL开始执行时间：20190814173210

delete from edw.checklist_sy where ddate = '2018-05-21'
;
SQL结束执行时间：20190814173211
SQL开始执行时间：20190814173211
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173211

20190814173211开始执行2018-05-22数据加载日志:
SQL开始执行时间：20190814173211




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173211
SQL开始执行时间：20190814173211
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-22'

;
SQL结束执行时间：20190814173215
SQL开始执行时间：20190814173215


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173215
SQL开始执行时间：20190814173215
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173237
SQL开始执行时间：20190814173237

delete from edw.checklist_sy where ddate = '2018-05-22'
;
SQL结束执行时间：20190814173237
SQL开始执行时间：20190814173237
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173238

20190814173238开始执行2018-05-23数据加载日志:
SQL开始执行时间：20190814173238




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173238
SQL开始执行时间：20190814173238
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-23'

;
SQL结束执行时间：20190814173241
SQL开始执行时间：20190814173241


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173241
SQL开始执行时间：20190814173241
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173303
SQL开始执行时间：20190814173303

delete from edw.checklist_sy where ddate = '2018-05-23'
;
SQL结束执行时间：20190814173303
SQL开始执行时间：20190814173303
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173304

20190814173304开始执行2018-05-24数据加载日志:
SQL开始执行时间：20190814173304




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173304
SQL开始执行时间：20190814173304
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-24'

;
SQL结束执行时间：20190814173308
SQL开始执行时间：20190814173308


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173308
SQL开始执行时间：20190814173308
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173323
SQL开始执行时间：20190814173323

delete from edw.checklist_sy where ddate = '2018-05-24'
;
SQL结束执行时间：20190814173323
SQL开始执行时间：20190814173323
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173324

20190814173324开始执行2018-05-25数据加载日志:
SQL开始执行时间：20190814173324




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173324
SQL开始执行时间：20190814173324
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-25'

;
SQL结束执行时间：20190814173327
SQL开始执行时间：20190814173327


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173327
SQL开始执行时间：20190814173327
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173341
SQL开始执行时间：20190814173341

delete from edw.checklist_sy where ddate = '2018-05-25'
;
SQL结束执行时间：20190814173342
SQL开始执行时间：20190814173342
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173342

20190814173342开始执行2018-05-26数据加载日志:
SQL开始执行时间：20190814173342




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173342
SQL开始执行时间：20190814173342
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-26'

;
SQL结束执行时间：20190814173346
SQL开始执行时间：20190814173346


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173346
SQL开始执行时间：20190814173346
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173347
SQL开始执行时间：20190814173347

delete from edw.checklist_sy where ddate = '2018-05-26'
;
SQL结束执行时间：20190814173347
SQL开始执行时间：20190814173347
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173347

20190814173348开始执行2018-05-27数据加载日志:
SQL开始执行时间：20190814173348




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173348
SQL开始执行时间：20190814173348
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-27'

;
SQL结束执行时间：20190814173351
SQL开始执行时间：20190814173351


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173351
SQL开始执行时间：20190814173351
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173351
SQL开始执行时间：20190814173351

delete from edw.checklist_sy where ddate = '2018-05-27'
;
SQL结束执行时间：20190814173351
SQL开始执行时间：20190814173351
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173351

20190814173351开始执行2018-05-28数据加载日志:
SQL开始执行时间：20190814173351




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173351
SQL开始执行时间：20190814173351
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-28'

;
SQL结束执行时间：20190814173354
SQL开始执行时间：20190814173354


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173354
SQL开始执行时间：20190814173354
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173410
SQL开始执行时间：20190814173410

delete from edw.checklist_sy where ddate = '2018-05-28'
;
SQL结束执行时间：20190814173410
SQL开始执行时间：20190814173410
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173411

20190814173411开始执行2018-05-29数据加载日志:
SQL开始执行时间：20190814173411




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173411
SQL开始执行时间：20190814173411
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-29'

;
SQL结束执行时间：20190814173415
SQL开始执行时间：20190814173415


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173415
SQL开始执行时间：20190814173415
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173435
SQL开始执行时间：20190814173435

delete from edw.checklist_sy where ddate = '2018-05-29'
;
SQL结束执行时间：20190814173435
SQL开始执行时间：20190814173435
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173436

20190814173436开始执行2018-05-30数据加载日志:
SQL开始执行时间：20190814173436




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173436
SQL开始执行时间：20190814173436
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-30'

;
SQL结束执行时间：20190814173440
SQL开始执行时间：20190814173440


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173440
SQL开始执行时间：20190814173440
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173500
SQL开始执行时间：20190814173500

delete from edw.checklist_sy where ddate = '2018-05-30'
;
SQL结束执行时间：20190814173500
SQL开始执行时间：20190814173500
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173501

20190814173501开始执行2018-05-31数据加载日志:
SQL开始执行时间：20190814173501




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173501
SQL开始执行时间：20190814173501
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-05-31'

;
SQL结束执行时间：20190814173504
SQL开始执行时间：20190814173504


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173504
SQL开始执行时间：20190814173504
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173522
SQL开始执行时间：20190814173522

delete from edw.checklist_sy where ddate = '2018-05-31'
;
SQL结束执行时间：20190814173522
SQL开始执行时间：20190814173522
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173523

20190814173523开始执行2018-06-01数据加载日志:
SQL开始执行时间：20190814173523




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173523
SQL开始执行时间：20190814173523
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-01'

;
SQL结束执行时间：20190814173526
SQL开始执行时间：20190814173526


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173526
SQL开始执行时间：20190814173526
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173539
SQL开始执行时间：20190814173539

delete from edw.checklist_sy where ddate = '2018-06-01'
;
SQL结束执行时间：20190814173540
SQL开始执行时间：20190814173540
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173540

20190814173540开始执行2018-06-02数据加载日志:
SQL开始执行时间：20190814173540




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173540
SQL开始执行时间：20190814173540
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-02'

;
SQL结束执行时间：20190814173544
SQL开始执行时间：20190814173544


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173544
SQL开始执行时间：20190814173544
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173544
SQL开始执行时间：20190814173544

delete from edw.checklist_sy where ddate = '2018-06-02'
;
SQL结束执行时间：20190814173545
SQL开始执行时间：20190814173545
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173545

20190814173545开始执行2018-06-03数据加载日志:
SQL开始执行时间：20190814173545




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173545
SQL开始执行时间：20190814173545
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-03'

;
SQL结束执行时间：20190814173548
SQL开始执行时间：20190814173548


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173548
SQL开始执行时间：20190814173548
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173549
SQL开始执行时间：20190814173549

delete from edw.checklist_sy where ddate = '2018-06-03'
;
SQL结束执行时间：20190814173549
SQL开始执行时间：20190814173549
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173549

20190814173549开始执行2018-06-04数据加载日志:
SQL开始执行时间：20190814173549




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173549
SQL开始执行时间：20190814173549
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-04'

;
SQL结束执行时间：20190814173553
SQL开始执行时间：20190814173553


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173553
SQL开始执行时间：20190814173553
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173608
SQL开始执行时间：20190814173608

delete from edw.checklist_sy where ddate = '2018-06-04'
;
SQL结束执行时间：20190814173608
SQL开始执行时间：20190814173608
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173609

20190814173609开始执行2018-06-05数据加载日志:
SQL开始执行时间：20190814173609




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173609
SQL开始执行时间：20190814173609
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-05'

;
SQL结束执行时间：20190814173612
SQL开始执行时间：20190814173612


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173612
SQL开始执行时间：20190814173612
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173632
SQL开始执行时间：20190814173632

delete from edw.checklist_sy where ddate = '2018-06-05'
;
SQL结束执行时间：20190814173632
SQL开始执行时间：20190814173632
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173633

20190814173633开始执行2018-06-06数据加载日志:
SQL开始执行时间：20190814173633




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173633
SQL开始执行时间：20190814173633
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-06'

;
SQL结束执行时间：20190814173636
SQL开始执行时间：20190814173636


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173636
SQL开始执行时间：20190814173636
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173655
SQL开始执行时间：20190814173655

delete from edw.checklist_sy where ddate = '2018-06-06'
;
SQL结束执行时间：20190814173655
SQL开始执行时间：20190814173655
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173656

20190814173656开始执行2018-06-07数据加载日志:
SQL开始执行时间：20190814173656




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173656
SQL开始执行时间：20190814173656
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-07'

;
SQL结束执行时间：20190814173659
SQL开始执行时间：20190814173659


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173659
SQL开始执行时间：20190814173659
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173719
SQL开始执行时间：20190814173719

delete from edw.checklist_sy where ddate = '2018-06-07'
;
SQL结束执行时间：20190814173720
SQL开始执行时间：20190814173720
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173720

20190814173720开始执行2018-06-08数据加载日志:
SQL开始执行时间：20190814173720




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173720
SQL开始执行时间：20190814173720
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-08'

;
SQL结束执行时间：20190814173724
SQL开始执行时间：20190814173724


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173724
SQL开始执行时间：20190814173724
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173737
SQL开始执行时间：20190814173737

delete from edw.checklist_sy where ddate = '2018-06-08'
;
SQL结束执行时间：20190814173738
SQL开始执行时间：20190814173738
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173738

20190814173739开始执行2018-06-09数据加载日志:
SQL开始执行时间：20190814173739




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173739
SQL开始执行时间：20190814173739
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-09'

;
SQL结束执行时间：20190814173742
SQL开始执行时间：20190814173742


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173742
SQL开始执行时间：20190814173742
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173743
SQL开始执行时间：20190814173743

delete from edw.checklist_sy where ddate = '2018-06-09'
;
SQL结束执行时间：20190814173743
SQL开始执行时间：20190814173743
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173744

20190814173744开始执行2018-06-10数据加载日志:
SQL开始执行时间：20190814173744




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173744
SQL开始执行时间：20190814173744
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-10'

;
SQL结束执行时间：20190814173747
SQL开始执行时间：20190814173747


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173747
SQL开始执行时间：20190814173747
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173747
SQL开始执行时间：20190814173747

delete from edw.checklist_sy where ddate = '2018-06-10'
;
SQL结束执行时间：20190814173748
SQL开始执行时间：20190814173748
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173748

20190814173748开始执行2018-06-11数据加载日志:
SQL开始执行时间：20190814173748




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173748
SQL开始执行时间：20190814173748
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-11'

;
SQL结束执行时间：20190814173751
SQL开始执行时间：20190814173751


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173751
SQL开始执行时间：20190814173751
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173809
SQL开始执行时间：20190814173809

delete from edw.checklist_sy where ddate = '2018-06-11'
;
SQL结束执行时间：20190814173809
SQL开始执行时间：20190814173809
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173810

20190814173810开始执行2018-06-12数据加载日志:
SQL开始执行时间：20190814173810




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173810
SQL开始执行时间：20190814173810
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-12'

;
SQL结束执行时间：20190814173813
SQL开始执行时间：20190814173813


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173813
SQL开始执行时间：20190814173813
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173834
SQL开始执行时间：20190814173834

delete from edw.checklist_sy where ddate = '2018-06-12'
;
SQL结束执行时间：20190814173834
SQL开始执行时间：20190814173834
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173835

20190814173835开始执行2018-06-13数据加载日志:
SQL开始执行时间：20190814173835




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173835
SQL开始执行时间：20190814173835
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-13'

;
SQL结束执行时间：20190814173839
SQL开始执行时间：20190814173839


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173839
SQL开始执行时间：20190814173839
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173859
SQL开始执行时间：20190814173859

delete from edw.checklist_sy where ddate = '2018-06-13'
;
SQL结束执行时间：20190814173900
SQL开始执行时间：20190814173900
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173901

20190814173901开始执行2018-06-14数据加载日志:
SQL开始执行时间：20190814173901




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173901
SQL开始执行时间：20190814173901
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-14'

;
SQL结束执行时间：20190814173904
SQL开始执行时间：20190814173904


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173904
SQL开始执行时间：20190814173904
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173920
SQL开始执行时间：20190814173920

delete from edw.checklist_sy where ddate = '2018-06-14'
;
SQL结束执行时间：20190814173920
SQL开始执行时间：20190814173920
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173921

20190814173921开始执行2018-06-15数据加载日志:
SQL开始执行时间：20190814173921




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173921
SQL开始执行时间：20190814173921
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-15'

;
SQL结束执行时间：20190814173924
SQL开始执行时间：20190814173924


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173924
SQL开始执行时间：20190814173924
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173937
SQL开始执行时间：20190814173937

delete from edw.checklist_sy where ddate = '2018-06-15'
;
SQL结束执行时间：20190814173937
SQL开始执行时间：20190814173937
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173938

20190814173938开始执行2018-06-16数据加载日志:
SQL开始执行时间：20190814173938




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173938
SQL开始执行时间：20190814173938
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-16'

;
SQL结束执行时间：20190814173941
SQL开始执行时间：20190814173941


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173941
SQL开始执行时间：20190814173941
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173942
SQL开始执行时间：20190814173942

delete from edw.checklist_sy where ddate = '2018-06-16'
;
SQL结束执行时间：20190814173942
SQL开始执行时间：20190814173942
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173943

20190814173943开始执行2018-06-17数据加载日志:
SQL开始执行时间：20190814173943




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173943
SQL开始执行时间：20190814173943
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-17'

;
SQL结束执行时间：20190814173946
SQL开始执行时间：20190814173946


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173946
SQL开始执行时间：20190814173946
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173946
SQL开始执行时间：20190814173946

delete from edw.checklist_sy where ddate = '2018-06-17'
;
SQL结束执行时间：20190814173947
SQL开始执行时间：20190814173947
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173947

20190814173947开始执行2018-06-18数据加载日志:
SQL开始执行时间：20190814173947




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173947
SQL开始执行时间：20190814173947
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-18'

;
SQL结束执行时间：20190814173950
SQL开始执行时间：20190814173950


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173950
SQL开始执行时间：20190814173950
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814173952
SQL开始执行时间：20190814173952

delete from edw.checklist_sy where ddate = '2018-06-18'
;
SQL结束执行时间：20190814173953
SQL开始执行时间：20190814173953
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814173953

20190814173953开始执行2018-06-19数据加载日志:
SQL开始执行时间：20190814173953




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814173953
SQL开始执行时间：20190814173953
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-19'

;
SQL结束执行时间：20190814173956
SQL开始执行时间：20190814173956


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814173956
SQL开始执行时间：20190814173956
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174013
SQL开始执行时间：20190814174013

delete from edw.checklist_sy where ddate = '2018-06-19'
;
SQL结束执行时间：20190814174014
SQL开始执行时间：20190814174014
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174015

20190814174015开始执行2018-06-20数据加载日志:
SQL开始执行时间：20190814174015




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174015
SQL开始执行时间：20190814174015
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-20'

;
SQL结束执行时间：20190814174018
SQL开始执行时间：20190814174018


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174018
SQL开始执行时间：20190814174018
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174043
SQL开始执行时间：20190814174043

delete from edw.checklist_sy where ddate = '2018-06-20'
;
SQL结束执行时间：20190814174043
SQL开始执行时间：20190814174043
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174044

20190814174044开始执行2018-06-21数据加载日志:
SQL开始执行时间：20190814174044




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174044
SQL开始执行时间：20190814174044
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-21'

;
SQL结束执行时间：20190814174048
SQL开始执行时间：20190814174048


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174048
SQL开始执行时间：20190814174048
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174110
SQL开始执行时间：20190814174110

delete from edw.checklist_sy where ddate = '2018-06-21'
;
SQL结束执行时间：20190814174111
SQL开始执行时间：20190814174111
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174112

20190814174112开始执行2018-06-22数据加载日志:
SQL开始执行时间：20190814174112




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174112
SQL开始执行时间：20190814174112
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-22'

;
SQL结束执行时间：20190814174115
SQL开始执行时间：20190814174115


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174115
SQL开始执行时间：20190814174115
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174127
SQL开始执行时间：20190814174127

delete from edw.checklist_sy where ddate = '2018-06-22'
;
SQL结束执行时间：20190814174127
SQL开始执行时间：20190814174127
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174128

20190814174128开始执行2018-06-23数据加载日志:
SQL开始执行时间：20190814174128




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174128
SQL开始执行时间：20190814174128
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-23'

;
SQL结束执行时间：20190814174131
SQL开始执行时间：20190814174131


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174131
SQL开始执行时间：20190814174131
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174133
SQL开始执行时间：20190814174133

delete from edw.checklist_sy where ddate = '2018-06-23'
;
SQL结束执行时间：20190814174134
SQL开始执行时间：20190814174134
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174134

20190814174134开始执行2018-06-24数据加载日志:
SQL开始执行时间：20190814174134




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174134
SQL开始执行时间：20190814174134
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-24'

;
SQL结束执行时间：20190814174137
SQL开始执行时间：20190814174137


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174137
SQL开始执行时间：20190814174137
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174138
SQL开始执行时间：20190814174138

delete from edw.checklist_sy where ddate = '2018-06-24'
;
SQL结束执行时间：20190814174138
SQL开始执行时间：20190814174138
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174138

20190814174139开始执行2018-06-25数据加载日志:
SQL开始执行时间：20190814174139




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174139
SQL开始执行时间：20190814174139
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-25'

;
SQL结束执行时间：20190814174142
SQL开始执行时间：20190814174142


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174142
SQL开始执行时间：20190814174142
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174159
SQL开始执行时间：20190814174159

delete from edw.checklist_sy where ddate = '2018-06-25'
;
SQL结束执行时间：20190814174159
SQL开始执行时间：20190814174159
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174200

20190814174200开始执行2018-06-26数据加载日志:
SQL开始执行时间：20190814174200




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174200
SQL开始执行时间：20190814174200
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-26'

;
SQL结束执行时间：20190814174204
SQL开始执行时间：20190814174204


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174204
SQL开始执行时间：20190814174204
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174225
SQL开始执行时间：20190814174225

delete from edw.checklist_sy where ddate = '2018-06-26'
;
SQL结束执行时间：20190814174225
SQL开始执行时间：20190814174225
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174226

20190814174226开始执行2018-06-27数据加载日志:
SQL开始执行时间：20190814174226




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174226
SQL开始执行时间：20190814174226
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-27'

;
SQL结束执行时间：20190814174229
SQL开始执行时间：20190814174229


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174229
SQL开始执行时间：20190814174229
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174248
SQL开始执行时间：20190814174248

delete from edw.checklist_sy where ddate = '2018-06-27'
;
SQL结束执行时间：20190814174249
SQL开始执行时间：20190814174249
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174250

20190814174250开始执行2018-06-28数据加载日志:
SQL开始执行时间：20190814174250




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174250
SQL开始执行时间：20190814174250
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-28'

;
SQL结束执行时间：20190814174253
SQL开始执行时间：20190814174253


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174253
SQL开始执行时间：20190814174253
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174308
SQL开始执行时间：20190814174308

delete from edw.checklist_sy where ddate = '2018-06-28'
;
SQL结束执行时间：20190814174309
SQL开始执行时间：20190814174309
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174309

20190814174309开始执行2018-06-29数据加载日志:
SQL开始执行时间：20190814174309




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174309
SQL开始执行时间：20190814174309
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-29'

;
SQL结束执行时间：20190814174313
SQL开始执行时间：20190814174313


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174313
SQL开始执行时间：20190814174313
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174327
SQL开始执行时间：20190814174327

delete from edw.checklist_sy where ddate = '2018-06-29'
;
SQL结束执行时间：20190814174328
SQL开始执行时间：20190814174328
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174328

20190814174328开始执行2018-06-30数据加载日志:
SQL开始执行时间：20190814174328




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174328
SQL开始执行时间：20190814174328
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-06-30'

;
SQL结束执行时间：20190814174332
SQL开始执行时间：20190814174332


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174332
SQL开始执行时间：20190814174332
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174334
SQL开始执行时间：20190814174334

delete from edw.checklist_sy where ddate = '2018-06-30'
;
SQL结束执行时间：20190814174334
SQL开始执行时间：20190814174334
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174334

20190814174334开始执行2018-07-01数据加载日志:
SQL开始执行时间：20190814174334




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174334
SQL开始执行时间：20190814174334
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-01'

;
SQL结束执行时间：20190814174338
SQL开始执行时间：20190814174338


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174338
SQL开始执行时间：20190814174338
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174339
SQL开始执行时间：20190814174339

delete from edw.checklist_sy where ddate = '2018-07-01'
;
SQL结束执行时间：20190814174339
SQL开始执行时间：20190814174339
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174339

20190814174339开始执行2018-07-02数据加载日志:
SQL开始执行时间：20190814174339




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174339
SQL开始执行时间：20190814174339
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-02'

;
SQL结束执行时间：20190814174343
SQL开始执行时间：20190814174343


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174343
SQL开始执行时间：20190814174343
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174404
SQL开始执行时间：20190814174404

delete from edw.checklist_sy where ddate = '2018-07-02'
;
SQL结束执行时间：20190814174404
SQL开始执行时间：20190814174404
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174405

20190814174405开始执行2018-07-03数据加载日志:
SQL开始执行时间：20190814174405




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174405
SQL开始执行时间：20190814174405
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-03'

;
SQL结束执行时间：20190814174408
SQL开始执行时间：20190814174408


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174408
SQL开始执行时间：20190814174408
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174429
SQL开始执行时间：20190814174429

delete from edw.checklist_sy where ddate = '2018-07-03'
;
SQL结束执行时间：20190814174430
SQL开始执行时间：20190814174430
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174431

20190814174431开始执行2018-07-04数据加载日志:
SQL开始执行时间：20190814174431




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174431
SQL开始执行时间：20190814174431
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-04'

;
SQL结束执行时间：20190814174434
SQL开始执行时间：20190814174434


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174434
SQL开始执行时间：20190814174434
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174454
SQL开始执行时间：20190814174454

delete from edw.checklist_sy where ddate = '2018-07-04'
;
SQL结束执行时间：20190814174454
SQL开始执行时间：20190814174454
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174455

20190814174455开始执行2018-07-05数据加载日志:
SQL开始执行时间：20190814174455




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174455
SQL开始执行时间：20190814174455
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-05'

;
SQL结束执行时间：20190814174459
SQL开始执行时间：20190814174459


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174459
SQL开始执行时间：20190814174459
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174515
SQL开始执行时间：20190814174515

delete from edw.checklist_sy where ddate = '2018-07-05'
;
SQL结束执行时间：20190814174516
SQL开始执行时间：20190814174516
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174516

20190814174516开始执行2018-07-06数据加载日志:
SQL开始执行时间：20190814174516




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174516
SQL开始执行时间：20190814174516
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-06'

;
SQL结束执行时间：20190814174520
SQL开始执行时间：20190814174520


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174520
SQL开始执行时间：20190814174520
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174534
SQL开始执行时间：20190814174534

delete from edw.checklist_sy where ddate = '2018-07-06'
;
SQL结束执行时间：20190814174535
SQL开始执行时间：20190814174535
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174536

20190814174536开始执行2018-07-07数据加载日志:
SQL开始执行时间：20190814174536




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174536
SQL开始执行时间：20190814174536
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-07'

;
SQL结束执行时间：20190814174539
SQL开始执行时间：20190814174539


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174539
SQL开始执行时间：20190814174539
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174539
SQL开始执行时间：20190814174539

delete from edw.checklist_sy where ddate = '2018-07-07'
;
SQL结束执行时间：20190814174540
SQL开始执行时间：20190814174540
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174540

20190814174540开始执行2018-07-08数据加载日志:
SQL开始执行时间：20190814174540




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174540
SQL开始执行时间：20190814174540
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-08'

;
SQL结束执行时间：20190814174543
SQL开始执行时间：20190814174543


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174543
SQL开始执行时间：20190814174543
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174544
SQL开始执行时间：20190814174544

delete from edw.checklist_sy where ddate = '2018-07-08'
;
SQL结束执行时间：20190814174544
SQL开始执行时间：20190814174544
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174544

20190814174544开始执行2018-07-09数据加载日志:
SQL开始执行时间：20190814174544




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174544
SQL开始执行时间：20190814174544
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-09'

;
SQL结束执行时间：20190814174548
SQL开始执行时间：20190814174548


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174548
SQL开始执行时间：20190814174548
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174607
SQL开始执行时间：20190814174607

delete from edw.checklist_sy where ddate = '2018-07-09'
;
SQL结束执行时间：20190814174607
SQL开始执行时间：20190814174607
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174608

20190814174608开始执行2018-07-10数据加载日志:
SQL开始执行时间：20190814174608




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174608
SQL开始执行时间：20190814174608
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-10'

;
SQL结束执行时间：20190814174611
SQL开始执行时间：20190814174611


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174611
SQL开始执行时间：20190814174611
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174631
SQL开始执行时间：20190814174631

delete from edw.checklist_sy where ddate = '2018-07-10'
;
SQL结束执行时间：20190814174632
SQL开始执行时间：20190814174632
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174633

20190814174633开始执行2018-07-11数据加载日志:
SQL开始执行时间：20190814174633




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174633
SQL开始执行时间：20190814174633
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-11'

;
SQL结束执行时间：20190814174636
SQL开始执行时间：20190814174636


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174636
SQL开始执行时间：20190814174636
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174655
SQL开始执行时间：20190814174655

delete from edw.checklist_sy where ddate = '2018-07-11'
;
SQL结束执行时间：20190814174655
SQL开始执行时间：20190814174655
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174656

20190814174656开始执行2018-07-12数据加载日志:
SQL开始执行时间：20190814174656




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174656
SQL开始执行时间：20190814174656
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-12'

;
SQL结束执行时间：20190814174659
SQL开始执行时间：20190814174659


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174659
SQL开始执行时间：20190814174659
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174719
SQL开始执行时间：20190814174719

delete from edw.checklist_sy where ddate = '2018-07-12'
;
SQL结束执行时间：20190814174719
SQL开始执行时间：20190814174719
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174720

20190814174720开始执行2018-07-13数据加载日志:
SQL开始执行时间：20190814174720




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174720
SQL开始执行时间：20190814174720
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-13'

;
SQL结束执行时间：20190814174723
SQL开始执行时间：20190814174723


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174723
SQL开始执行时间：20190814174723
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174735
SQL开始执行时间：20190814174735

delete from edw.checklist_sy where ddate = '2018-07-13'
;
SQL结束执行时间：20190814174735
SQL开始执行时间：20190814174735
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174736

20190814174736开始执行2018-07-14数据加载日志:
SQL开始执行时间：20190814174736




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174736
SQL开始执行时间：20190814174736
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-14'

;
SQL结束执行时间：20190814174739
SQL开始执行时间：20190814174739


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174739
SQL开始执行时间：20190814174739
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174740
SQL开始执行时间：20190814174740

delete from edw.checklist_sy where ddate = '2018-07-14'
;
SQL结束执行时间：20190814174740
SQL开始执行时间：20190814174740
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174740

20190814174740开始执行2018-07-15数据加载日志:
SQL开始执行时间：20190814174740




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174740
SQL开始执行时间：20190814174740
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-15'

;
SQL结束执行时间：20190814174744
SQL开始执行时间：20190814174744


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174744
SQL开始执行时间：20190814174744
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174744
SQL开始执行时间：20190814174744

delete from edw.checklist_sy where ddate = '2018-07-15'
;
SQL结束执行时间：20190814174744
SQL开始执行时间：20190814174744
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174744

20190814174744开始执行2018-07-16数据加载日志:
SQL开始执行时间：20190814174744




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174744
SQL开始执行时间：20190814174744
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-16'

;
SQL结束执行时间：20190814174747
SQL开始执行时间：20190814174747


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174747
SQL开始执行时间：20190814174747
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174806
SQL开始执行时间：20190814174806

delete from edw.checklist_sy where ddate = '2018-07-16'
;
SQL结束执行时间：20190814174806
SQL开始执行时间：20190814174806
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174807

20190814174807开始执行2018-07-17数据加载日志:
SQL开始执行时间：20190814174807




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174807
SQL开始执行时间：20190814174807
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-17'

;
SQL结束执行时间：20190814174810
SQL开始执行时间：20190814174810


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174810
SQL开始执行时间：20190814174810
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174831
SQL开始执行时间：20190814174831

delete from edw.checklist_sy where ddate = '2018-07-17'
;
SQL结束执行时间：20190814174831
SQL开始执行时间：20190814174831
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174832

20190814174832开始执行2018-07-18数据加载日志:
SQL开始执行时间：20190814174832




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174832
SQL开始执行时间：20190814174832
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-18'

;
SQL结束执行时间：20190814174836
SQL开始执行时间：20190814174836


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174836
SQL开始执行时间：20190814174836
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174859
SQL开始执行时间：20190814174859

delete from edw.checklist_sy where ddate = '2018-07-18'
;
SQL结束执行时间：20190814174859
SQL开始执行时间：20190814174859
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174900

20190814174900开始执行2018-07-19数据加载日志:
SQL开始执行时间：20190814174900




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174900
SQL开始执行时间：20190814174900
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-19'

;
SQL结束执行时间：20190814174904
SQL开始执行时间：20190814174904


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174904
SQL开始执行时间：20190814174904
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174925
SQL开始执行时间：20190814174925

delete from edw.checklist_sy where ddate = '2018-07-19'
;
SQL结束执行时间：20190814174925
SQL开始执行时间：20190814174925
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174926

20190814174926开始执行2018-07-20数据加载日志:
SQL开始执行时间：20190814174926




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174926
SQL开始执行时间：20190814174926
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-20'

;
SQL结束执行时间：20190814174929
SQL开始执行时间：20190814174929


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174929
SQL开始执行时间：20190814174929
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174941
SQL开始执行时间：20190814174941

delete from edw.checklist_sy where ddate = '2018-07-20'
;
SQL结束执行时间：20190814174941
SQL开始执行时间：20190814174941
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174942

20190814174942开始执行2018-07-21数据加载日志:
SQL开始执行时间：20190814174942




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174942
SQL开始执行时间：20190814174942
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-21'

;
SQL结束执行时间：20190814174945
SQL开始执行时间：20190814174945


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174945
SQL开始执行时间：20190814174945
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174946
SQL开始执行时间：20190814174946

delete from edw.checklist_sy where ddate = '2018-07-21'
;
SQL结束执行时间：20190814174947
SQL开始执行时间：20190814174947
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174947

20190814174947开始执行2018-07-22数据加载日志:
SQL开始执行时间：20190814174947




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174947
SQL开始执行时间：20190814174947
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-22'

;
SQL结束执行时间：20190814174950
SQL开始执行时间：20190814174950


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174951
SQL开始执行时间：20190814174951
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814174951
SQL开始执行时间：20190814174951

delete from edw.checklist_sy where ddate = '2018-07-22'
;
SQL结束执行时间：20190814174951
SQL开始执行时间：20190814174951
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814174951

20190814174951开始执行2018-07-23数据加载日志:
SQL开始执行时间：20190814174951




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814174951
SQL开始执行时间：20190814174951
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-23'

;
SQL结束执行时间：20190814174955
SQL开始执行时间：20190814174955


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814174955
SQL开始执行时间：20190814174955
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175014
SQL开始执行时间：20190814175014

delete from edw.checklist_sy where ddate = '2018-07-23'
;
SQL结束执行时间：20190814175015
SQL开始执行时间：20190814175015
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175015

20190814175015开始执行2018-07-24数据加载日志:
SQL开始执行时间：20190814175015




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175015
SQL开始执行时间：20190814175015
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-24'

;
SQL结束执行时间：20190814175019
SQL开始执行时间：20190814175019


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175019
SQL开始执行时间：20190814175019
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175037
SQL开始执行时间：20190814175037

delete from edw.checklist_sy where ddate = '2018-07-24'
;
SQL结束执行时间：20190814175038
SQL开始执行时间：20190814175038
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175039

20190814175039开始执行2018-07-25数据加载日志:
SQL开始执行时间：20190814175039




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175039
SQL开始执行时间：20190814175039
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-25'

;
SQL结束执行时间：20190814175042
SQL开始执行时间：20190814175042


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175042
SQL开始执行时间：20190814175042
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175106
SQL开始执行时间：20190814175106

delete from edw.checklist_sy where ddate = '2018-07-25'
;
SQL结束执行时间：20190814175106
SQL开始执行时间：20190814175106
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175107

20190814175107开始执行2018-07-26数据加载日志:
SQL开始执行时间：20190814175107




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175107
SQL开始执行时间：20190814175107
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-26'

;
SQL结束执行时间：20190814175111
SQL开始执行时间：20190814175111


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175111
SQL开始执行时间：20190814175111
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175127
SQL开始执行时间：20190814175127

delete from edw.checklist_sy where ddate = '2018-07-26'
;
SQL结束执行时间：20190814175128
SQL开始执行时间：20190814175128
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175128

20190814175128开始执行2018-07-27数据加载日志:
SQL开始执行时间：20190814175128




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175128
SQL开始执行时间：20190814175128
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-27'

;
SQL结束执行时间：20190814175132
SQL开始执行时间：20190814175132


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175132
SQL开始执行时间：20190814175132
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175146
SQL开始执行时间：20190814175146

delete from edw.checklist_sy where ddate = '2018-07-27'
;
SQL结束执行时间：20190814175147
SQL开始执行时间：20190814175147
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175147

20190814175147开始执行2018-07-28数据加载日志:
SQL开始执行时间：20190814175147




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175147
SQL开始执行时间：20190814175147
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-28'

;
SQL结束执行时间：20190814175151
SQL开始执行时间：20190814175151


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175151
SQL开始执行时间：20190814175151
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175152
SQL开始执行时间：20190814175152

delete from edw.checklist_sy where ddate = '2018-07-28'
;
SQL结束执行时间：20190814175152
SQL开始执行时间：20190814175152
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175153

20190814175153开始执行2018-07-29数据加载日志:
SQL开始执行时间：20190814175153




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175153
SQL开始执行时间：20190814175153
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-29'

;
SQL结束执行时间：20190814175156
SQL开始执行时间：20190814175156


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175156
SQL开始执行时间：20190814175156
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175157
SQL开始执行时间：20190814175157

delete from edw.checklist_sy where ddate = '2018-07-29'
;
SQL结束执行时间：20190814175158
SQL开始执行时间：20190814175158
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175158

20190814175158开始执行2018-07-30数据加载日志:
SQL开始执行时间：20190814175158




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175158
SQL开始执行时间：20190814175158
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-30'

;
SQL结束执行时间：20190814175201
SQL开始执行时间：20190814175201


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175201
SQL开始执行时间：20190814175201
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175220
SQL开始执行时间：20190814175220

delete from edw.checklist_sy where ddate = '2018-07-30'
;
SQL结束执行时间：20190814175220
SQL开始执行时间：20190814175220
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175221

20190814175221开始执行2018-07-31数据加载日志:
SQL开始执行时间：20190814175221




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175221
SQL开始执行时间：20190814175221
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-07-31'

;
SQL结束执行时间：20190814175224
SQL开始执行时间：20190814175224


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175224
SQL开始执行时间：20190814175224
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175246
SQL开始执行时间：20190814175246

delete from edw.checklist_sy where ddate = '2018-07-31'
;
SQL结束执行时间：20190814175247
SQL开始执行时间：20190814175247
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175247

20190814175248开始执行2018-08-01数据加载日志:
SQL开始执行时间：20190814175248




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175248
SQL开始执行时间：20190814175248
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-01'

;
SQL结束执行时间：20190814175251
SQL开始执行时间：20190814175251


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175251
SQL开始执行时间：20190814175251
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175312
SQL开始执行时间：20190814175312

delete from edw.checklist_sy where ddate = '2018-08-01'
;
SQL结束执行时间：20190814175312
SQL开始执行时间：20190814175312
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175313

20190814175313开始执行2018-08-02数据加载日志:
SQL开始执行时间：20190814175313




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175313
SQL开始执行时间：20190814175313
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-02'

;
SQL结束执行时间：20190814175316
SQL开始执行时间：20190814175316


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175316
SQL开始执行时间：20190814175316
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175335
SQL开始执行时间：20190814175335

delete from edw.checklist_sy where ddate = '2018-08-02'
;
SQL结束执行时间：20190814175335
SQL开始执行时间：20190814175335
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175336

20190814175336开始执行2018-08-03数据加载日志:
SQL开始执行时间：20190814175336




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175336
SQL开始执行时间：20190814175336
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-03'

;
SQL结束执行时间：20190814175340
SQL开始执行时间：20190814175340


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175340
SQL开始执行时间：20190814175340
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175354
SQL开始执行时间：20190814175354

delete from edw.checklist_sy where ddate = '2018-08-03'
;
SQL结束执行时间：20190814175355
SQL开始执行时间：20190814175355
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175355

20190814175355开始执行2018-08-04数据加载日志:
SQL开始执行时间：20190814175355




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175355
SQL开始执行时间：20190814175355
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-04'

;
SQL结束执行时间：20190814175359
SQL开始执行时间：20190814175359


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175359
SQL开始执行时间：20190814175359
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175401
SQL开始执行时间：20190814175401

delete from edw.checklist_sy where ddate = '2018-08-04'
;
SQL结束执行时间：20190814175402
SQL开始执行时间：20190814175402
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175402

20190814175402开始执行2018-08-05数据加载日志:
SQL开始执行时间：20190814175402




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175402
SQL开始执行时间：20190814175402
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-05'

;
SQL结束执行时间：20190814175405
SQL开始执行时间：20190814175405


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175405
SQL开始执行时间：20190814175405
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175406
SQL开始执行时间：20190814175406

delete from edw.checklist_sy where ddate = '2018-08-05'
;
SQL结束执行时间：20190814175407
SQL开始执行时间：20190814175407
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175407

20190814175407开始执行2018-08-06数据加载日志:
SQL开始执行时间：20190814175407




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175407
SQL开始执行时间：20190814175407
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-06'

;
SQL结束执行时间：20190814175410
SQL开始执行时间：20190814175410


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175410
SQL开始执行时间：20190814175410
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175428
SQL开始执行时间：20190814175428

delete from edw.checklist_sy where ddate = '2018-08-06'
;
SQL结束执行时间：20190814175429
SQL开始执行时间：20190814175429
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175430

20190814175430开始执行2018-08-07数据加载日志:
SQL开始执行时间：20190814175430




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175430
SQL开始执行时间：20190814175430
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-07'

;
SQL结束执行时间：20190814175433
SQL开始执行时间：20190814175433


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175433
SQL开始执行时间：20190814175433
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175454
SQL开始执行时间：20190814175454

delete from edw.checklist_sy where ddate = '2018-08-07'
;
SQL结束执行时间：20190814175455
SQL开始执行时间：20190814175455
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175456

20190814175456开始执行2018-08-08数据加载日志:
SQL开始执行时间：20190814175456




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175456
SQL开始执行时间：20190814175456
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-08'

;
SQL结束执行时间：20190814175459
SQL开始执行时间：20190814175459


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175459
SQL开始执行时间：20190814175459
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175523
SQL开始执行时间：20190814175523

delete from edw.checklist_sy where ddate = '2018-08-08'
;
SQL结束执行时间：20190814175524
SQL开始执行时间：20190814175524
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175525

20190814175525开始执行2018-08-09数据加载日志:
SQL开始执行时间：20190814175525




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175525
SQL开始执行时间：20190814175525
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-09'

;
SQL结束执行时间：20190814175528
SQL开始执行时间：20190814175528


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175528
SQL开始执行时间：20190814175528
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175546
SQL开始执行时间：20190814175546

delete from edw.checklist_sy where ddate = '2018-08-09'
;
SQL结束执行时间：20190814175546
SQL开始执行时间：20190814175546
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175547

20190814175547开始执行2018-08-10数据加载日志:
SQL开始执行时间：20190814175547




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175547
SQL开始执行时间：20190814175547
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-10'

;
SQL结束执行时间：20190814175551
SQL开始执行时间：20190814175551


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175551
SQL开始执行时间：20190814175551
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175605
SQL开始执行时间：20190814175605

delete from edw.checklist_sy where ddate = '2018-08-10'
;
SQL结束执行时间：20190814175605
SQL开始执行时间：20190814175605
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175606

20190814175606开始执行2018-08-11数据加载日志:
SQL开始执行时间：20190814175606




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175606
SQL开始执行时间：20190814175606
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-11'

;
SQL结束执行时间：20190814175609
SQL开始执行时间：20190814175609


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175609
SQL开始执行时间：20190814175609
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175610
SQL开始执行时间：20190814175610

delete from edw.checklist_sy where ddate = '2018-08-11'
;
SQL结束执行时间：20190814175611
SQL开始执行时间：20190814175611
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175611

20190814175611开始执行2018-08-12数据加载日志:
SQL开始执行时间：20190814175611




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175611
SQL开始执行时间：20190814175611
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-12'

;
SQL结束执行时间：20190814175614
SQL开始执行时间：20190814175614


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175614
SQL开始执行时间：20190814175614
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175614
SQL开始执行时间：20190814175614

delete from edw.checklist_sy where ddate = '2018-08-12'
;
SQL结束执行时间：20190814175615
SQL开始执行时间：20190814175615
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175615

20190814175615开始执行2018-08-13数据加载日志:
SQL开始执行时间：20190814175615




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175615
SQL开始执行时间：20190814175615
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-13'

;
SQL结束执行时间：20190814175619
SQL开始执行时间：20190814175619


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175619
SQL开始执行时间：20190814175619
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175638
SQL开始执行时间：20190814175638

delete from edw.checklist_sy where ddate = '2018-08-13'
;
SQL结束执行时间：20190814175638
SQL开始执行时间：20190814175638
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175639

20190814175639开始执行2018-08-14数据加载日志:
SQL开始执行时间：20190814175639




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175639
SQL开始执行时间：20190814175639
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-14'

;
SQL结束执行时间：20190814175643
SQL开始执行时间：20190814175643


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175643
SQL开始执行时间：20190814175643
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175704
SQL开始执行时间：20190814175704

delete from edw.checklist_sy where ddate = '2018-08-14'
;
SQL结束执行时间：20190814175705
SQL开始执行时间：20190814175705
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175706

20190814175706开始执行2018-08-15数据加载日志:
SQL开始执行时间：20190814175706




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175706
SQL开始执行时间：20190814175706
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-15'

;
SQL结束执行时间：20190814175709
SQL开始执行时间：20190814175709


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175709
SQL开始执行时间：20190814175709
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175728
SQL开始执行时间：20190814175728

delete from edw.checklist_sy where ddate = '2018-08-15'
;
SQL结束执行时间：20190814175729
SQL开始执行时间：20190814175729
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175729

20190814175729开始执行2018-08-16数据加载日志:
SQL开始执行时间：20190814175729




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175729
SQL开始执行时间：20190814175729
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-16'

;
SQL结束执行时间：20190814175733
SQL开始执行时间：20190814175733


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175733
SQL开始执行时间：20190814175733
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175750
SQL开始执行时间：20190814175750

delete from edw.checklist_sy where ddate = '2018-08-16'
;
SQL结束执行时间：20190814175750
SQL开始执行时间：20190814175750
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175751

20190814175751开始执行2018-08-17数据加载日志:
SQL开始执行时间：20190814175751




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175751
SQL开始执行时间：20190814175751
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-17'

;
SQL结束执行时间：20190814175754
SQL开始执行时间：20190814175754


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175754
SQL开始执行时间：20190814175754
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175805
SQL开始执行时间：20190814175805

delete from edw.checklist_sy where ddate = '2018-08-17'
;
SQL结束执行时间：20190814175805
SQL开始执行时间：20190814175805
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175806

20190814175806开始执行2018-08-18数据加载日志:
SQL开始执行时间：20190814175806




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175806
SQL开始执行时间：20190814175806
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-18'

;
SQL结束执行时间：20190814175809
SQL开始执行时间：20190814175809


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175809
SQL开始执行时间：20190814175809
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175811
SQL开始执行时间：20190814175811

delete from edw.checklist_sy where ddate = '2018-08-18'
;
SQL结束执行时间：20190814175811
SQL开始执行时间：20190814175811
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175811

20190814175811开始执行2018-08-19数据加载日志:
SQL开始执行时间：20190814175811




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175811
SQL开始执行时间：20190814175811
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-19'

;
SQL结束执行时间：20190814175815
SQL开始执行时间：20190814175815


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175815
SQL开始执行时间：20190814175815
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175815
SQL开始执行时间：20190814175815

delete from edw.checklist_sy where ddate = '2018-08-19'
;
SQL结束执行时间：20190814175816
SQL开始执行时间：20190814175816
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175816

20190814175816开始执行2018-08-20数据加载日志:
SQL开始执行时间：20190814175816




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175816
SQL开始执行时间：20190814175816
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-20'

;
SQL结束执行时间：20190814175819
SQL开始执行时间：20190814175819


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175819
SQL开始执行时间：20190814175819
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175836
SQL开始执行时间：20190814175836

delete from edw.checklist_sy where ddate = '2018-08-20'
;
SQL结束执行时间：20190814175837
SQL开始执行时间：20190814175837
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175837

20190814175838开始执行2018-08-21数据加载日志:
SQL开始执行时间：20190814175838




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175838
SQL开始执行时间：20190814175838
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-21'

;
SQL结束执行时间：20190814175841
SQL开始执行时间：20190814175841


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175841
SQL开始执行时间：20190814175841
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175908
SQL开始执行时间：20190814175908

delete from edw.checklist_sy where ddate = '2018-08-21'
;
SQL结束执行时间：20190814175908
SQL开始执行时间：20190814175908
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175909

20190814175909开始执行2018-08-22数据加载日志:
SQL开始执行时间：20190814175909




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175909
SQL开始执行时间：20190814175909
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-22'

;
SQL结束执行时间：20190814175913
SQL开始执行时间：20190814175913


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175913
SQL开始执行时间：20190814175913
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175934
SQL开始执行时间：20190814175934

delete from edw.checklist_sy where ddate = '2018-08-22'
;
SQL结束执行时间：20190814175934
SQL开始执行时间：20190814175934
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175935

20190814175935开始执行2018-08-23数据加载日志:
SQL开始执行时间：20190814175935




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175935
SQL开始执行时间：20190814175935
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-23'

;
SQL结束执行时间：20190814175939
SQL开始执行时间：20190814175939


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175939
SQL开始执行时间：20190814175939
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814175954
SQL开始执行时间：20190814175954

delete from edw.checklist_sy where ddate = '2018-08-23'
;
SQL结束执行时间：20190814175955
SQL开始执行时间：20190814175955
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814175955

20190814175955开始执行2018-08-24数据加载日志:
SQL开始执行时间：20190814175955




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814175955
SQL开始执行时间：20190814175955
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-24'

;
SQL结束执行时间：20190814175959
SQL开始执行时间：20190814175959


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814175959
SQL开始执行时间：20190814175959
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180011
SQL开始执行时间：20190814180011

delete from edw.checklist_sy where ddate = '2018-08-24'
;
SQL结束执行时间：20190814180012
SQL开始执行时间：20190814180012
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180013

20190814180013开始执行2018-08-25数据加载日志:
SQL开始执行时间：20190814180013




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180013
SQL开始执行时间：20190814180013
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-25'

;
SQL结束执行时间：20190814180016
SQL开始执行时间：20190814180016


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180016
SQL开始执行时间：20190814180016
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180017
SQL开始执行时间：20190814180017

delete from edw.checklist_sy where ddate = '2018-08-25'
;
SQL结束执行时间：20190814180018
SQL开始执行时间：20190814180018
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180018

20190814180018开始执行2018-08-26数据加载日志:
SQL开始执行时间：20190814180018




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180018
SQL开始执行时间：20190814180018
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-26'

;
SQL结束执行时间：20190814180021
SQL开始执行时间：20190814180021


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180021
SQL开始执行时间：20190814180021
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180022
SQL开始执行时间：20190814180022

delete from edw.checklist_sy where ddate = '2018-08-26'
;
SQL结束执行时间：20190814180022
SQL开始执行时间：20190814180022
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180023

20190814180023开始执行2018-08-27数据加载日志:
SQL开始执行时间：20190814180023




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180023
SQL开始执行时间：20190814180023
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-27'

;
SQL结束执行时间：20190814180026
SQL开始执行时间：20190814180026


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180026
SQL开始执行时间：20190814180026
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180046
SQL开始执行时间：20190814180046

delete from edw.checklist_sy where ddate = '2018-08-27'
;
SQL结束执行时间：20190814180047
SQL开始执行时间：20190814180047
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180047

20190814180048开始执行2018-08-28数据加载日志:
SQL开始执行时间：20190814180048




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180048
SQL开始执行时间：20190814180048
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-28'

;
SQL结束执行时间：20190814180051
SQL开始执行时间：20190814180051


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180051
SQL开始执行时间：20190814180051
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180111
SQL开始执行时间：20190814180111

delete from edw.checklist_sy where ddate = '2018-08-28'
;
SQL结束执行时间：20190814180112
SQL开始执行时间：20190814180112
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180113

20190814180113开始执行2018-08-29数据加载日志:
SQL开始执行时间：20190814180113




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180113
SQL开始执行时间：20190814180113
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-29'

;
SQL结束执行时间：20190814180116
SQL开始执行时间：20190814180116


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180116
SQL开始执行时间：20190814180116
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180138
SQL开始执行时间：20190814180138

delete from edw.checklist_sy where ddate = '2018-08-29'
;
SQL结束执行时间：20190814180139
SQL开始执行时间：20190814180139
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180140

20190814180140开始执行2018-08-30数据加载日志:
SQL开始执行时间：20190814180140




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180140
SQL开始执行时间：20190814180140
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-30'

;
SQL结束执行时间：20190814180143
SQL开始执行时间：20190814180143


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180143
SQL开始执行时间：20190814180143
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180201
SQL开始执行时间：20190814180201

delete from edw.checklist_sy where ddate = '2018-08-30'
;
SQL结束执行时间：20190814180202
SQL开始执行时间：20190814180202
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180203

20190814180203开始执行2018-08-31数据加载日志:
SQL开始执行时间：20190814180203




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180203
SQL开始执行时间：20190814180203
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-08-31'

;
SQL结束执行时间：20190814180206
SQL开始执行时间：20190814180206


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180206
SQL开始执行时间：20190814180206
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180218
SQL开始执行时间：20190814180218

delete from edw.checklist_sy where ddate = '2018-08-31'
;
SQL结束执行时间：20190814180219
SQL开始执行时间：20190814180219
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180220

20190814180220开始执行2018-09-01数据加载日志:
SQL开始执行时间：20190814180220




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180220
SQL开始执行时间：20190814180220
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-01'

;
SQL结束执行时间：20190814180223
SQL开始执行时间：20190814180223


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180223
SQL开始执行时间：20190814180223
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180223
SQL开始执行时间：20190814180223

delete from edw.checklist_sy where ddate = '2018-09-01'
;
SQL结束执行时间：20190814180224
SQL开始执行时间：20190814180224
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180224

20190814180224开始执行2018-09-02数据加载日志:
SQL开始执行时间：20190814180224




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180224
SQL开始执行时间：20190814180224
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-02'

;
SQL结束执行时间：20190814180227
SQL开始执行时间：20190814180227


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180227
SQL开始执行时间：20190814180227
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180228
SQL开始执行时间：20190814180228

delete from edw.checklist_sy where ddate = '2018-09-02'
;
SQL结束执行时间：20190814180229
SQL开始执行时间：20190814180229
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180229

20190814180229开始执行2018-09-03数据加载日志:
SQL开始执行时间：20190814180229




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180229
SQL开始执行时间：20190814180229
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-03'

;
SQL结束执行时间：20190814180232
SQL开始执行时间：20190814180232


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180232
SQL开始执行时间：20190814180232
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180251
SQL开始执行时间：20190814180251

delete from edw.checklist_sy where ddate = '2018-09-03'
;
SQL结束执行时间：20190814180252
SQL开始执行时间：20190814180252
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180252

20190814180253开始执行2018-09-04数据加载日志:
SQL开始执行时间：20190814180253




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180253
SQL开始执行时间：20190814180253
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-04'

;
SQL结束执行时间：20190814180256
SQL开始执行时间：20190814180256


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180256
SQL开始执行时间：20190814180256
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180318
SQL开始执行时间：20190814180318

delete from edw.checklist_sy where ddate = '2018-09-04'
;
SQL结束执行时间：20190814180319
SQL开始执行时间：20190814180319
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180320

20190814180320开始执行2018-09-05数据加载日志:
SQL开始执行时间：20190814180320




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180320
SQL开始执行时间：20190814180320
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-05'

;
SQL结束执行时间：20190814180323
SQL开始执行时间：20190814180323


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180323
SQL开始执行时间：20190814180323
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180345
SQL开始执行时间：20190814180345

delete from edw.checklist_sy where ddate = '2018-09-05'
;
SQL结束执行时间：20190814180346
SQL开始执行时间：20190814180346
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180347

20190814180347开始执行2018-09-06数据加载日志:
SQL开始执行时间：20190814180347




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180347
SQL开始执行时间：20190814180347
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-06'

;
SQL结束执行时间：20190814180350
SQL开始执行时间：20190814180350


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180350
SQL开始执行时间：20190814180350
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180409
SQL开始执行时间：20190814180409

delete from edw.checklist_sy where ddate = '2018-09-06'
;
SQL结束执行时间：20190814180410
SQL开始执行时间：20190814180410
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180411

20190814180411开始执行2018-09-07数据加载日志:
SQL开始执行时间：20190814180411




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180411
SQL开始执行时间：20190814180411
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-07'

;
SQL结束执行时间：20190814180414
SQL开始执行时间：20190814180414


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180414
SQL开始执行时间：20190814180414
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180427
SQL开始执行时间：20190814180427

delete from edw.checklist_sy where ddate = '2018-09-07'
;
SQL结束执行时间：20190814180428
SQL开始执行时间：20190814180428
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180428

20190814180429开始执行2018-09-08数据加载日志:
SQL开始执行时间：20190814180429




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180429
SQL开始执行时间：20190814180429
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-08'

;
SQL结束执行时间：20190814180432
SQL开始执行时间：20190814180432


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180432
SQL开始执行时间：20190814180432
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180433
SQL开始执行时间：20190814180433

delete from edw.checklist_sy where ddate = '2018-09-08'
;
SQL结束执行时间：20190814180433
SQL开始执行时间：20190814180433
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180434

20190814180434开始执行2018-09-09数据加载日志:
SQL开始执行时间：20190814180434




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180434
SQL开始执行时间：20190814180434
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-09'

;
SQL结束执行时间：20190814180437
SQL开始执行时间：20190814180437


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180437
SQL开始执行时间：20190814180437
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180438
SQL开始执行时间：20190814180438

delete from edw.checklist_sy where ddate = '2018-09-09'
;
SQL结束执行时间：20190814180438
SQL开始执行时间：20190814180438
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180439

20190814180439开始执行2018-09-10数据加载日志:
SQL开始执行时间：20190814180439




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180439
SQL开始执行时间：20190814180439
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-10'

;
SQL结束执行时间：20190814180442
SQL开始执行时间：20190814180442


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180442
SQL开始执行时间：20190814180442
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180502
SQL开始执行时间：20190814180502

delete from edw.checklist_sy where ddate = '2018-09-10'
;
SQL结束执行时间：20190814180503
SQL开始执行时间：20190814180503
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180503

20190814180504开始执行2018-09-11数据加载日志:
SQL开始执行时间：20190814180504




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180504
SQL开始执行时间：20190814180504
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-11'

;
SQL结束执行时间：20190814180507
SQL开始执行时间：20190814180507


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180507
SQL开始执行时间：20190814180507
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180526
SQL开始执行时间：20190814180526

delete from edw.checklist_sy where ddate = '2018-09-11'
;
SQL结束执行时间：20190814180527
SQL开始执行时间：20190814180527
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180528

20190814180528开始执行2018-09-12数据加载日志:
SQL开始执行时间：20190814180528




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180528
SQL开始执行时间：20190814180528
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-12'

;
SQL结束执行时间：20190814180531
SQL开始执行时间：20190814180531


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180531
SQL开始执行时间：20190814180531
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180553
SQL开始执行时间：20190814180553

delete from edw.checklist_sy where ddate = '2018-09-12'
;
SQL结束执行时间：20190814180553
SQL开始执行时间：20190814180553
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180554

20190814180554开始执行2018-09-13数据加载日志:
SQL开始执行时间：20190814180554




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180554
SQL开始执行时间：20190814180554
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-13'

;
SQL结束执行时间：20190814180558
SQL开始执行时间：20190814180558


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180558
SQL开始执行时间：20190814180558
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180618
SQL开始执行时间：20190814180618

delete from edw.checklist_sy where ddate = '2018-09-13'
;
SQL结束执行时间：20190814180618
SQL开始执行时间：20190814180618
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180619

20190814180619开始执行2018-09-14数据加载日志:
SQL开始执行时间：20190814180619




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180619
SQL开始执行时间：20190814180619
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-14'

;
SQL结束执行时间：20190814180622
SQL开始执行时间：20190814180622


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180622
SQL开始执行时间：20190814180622
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180635
SQL开始执行时间：20190814180635

delete from edw.checklist_sy where ddate = '2018-09-14'
;
SQL结束执行时间：20190814180636
SQL开始执行时间：20190814180636
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180636

20190814180636开始执行2018-09-15数据加载日志:
SQL开始执行时间：20190814180636




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180636
SQL开始执行时间：20190814180636
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-15'

;
SQL结束执行时间：20190814180640
SQL开始执行时间：20190814180640


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180640
SQL开始执行时间：20190814180640
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180640
SQL开始执行时间：20190814180640

delete from edw.checklist_sy where ddate = '2018-09-15'
;
SQL结束执行时间：20190814180641
SQL开始执行时间：20190814180641
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180641

20190814180641开始执行2018-09-16数据加载日志:
SQL开始执行时间：20190814180641




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180641
SQL开始执行时间：20190814180641
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-16'

;
SQL结束执行时间：20190814180644
SQL开始执行时间：20190814180644


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180644
SQL开始执行时间：20190814180644
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180644
SQL开始执行时间：20190814180644

delete from edw.checklist_sy where ddate = '2018-09-16'
;
SQL结束执行时间：20190814180645
SQL开始执行时间：20190814180645
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180645

20190814180645开始执行2018-09-17数据加载日志:
SQL开始执行时间：20190814180645




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180645
SQL开始执行时间：20190814180645
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-17'

;
SQL结束执行时间：20190814180649
SQL开始执行时间：20190814180649


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180649
SQL开始执行时间：20190814180649
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180709
SQL开始执行时间：20190814180709

delete from edw.checklist_sy where ddate = '2018-09-17'
;
SQL结束执行时间：20190814180710
SQL开始执行时间：20190814180710
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180711

20190814180711开始执行2018-09-18数据加载日志:
SQL开始执行时间：20190814180711




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180711
SQL开始执行时间：20190814180711
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-18'

;
SQL结束执行时间：20190814180714
SQL开始执行时间：20190814180714


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180714
SQL开始执行时间：20190814180714
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180734
SQL开始执行时间：20190814180734

delete from edw.checklist_sy where ddate = '2018-09-18'
;
SQL结束执行时间：20190814180734
SQL开始执行时间：20190814180734
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180735

20190814180735开始执行2018-09-19数据加载日志:
SQL开始执行时间：20190814180735




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180735
SQL开始执行时间：20190814180735
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-19'

;
SQL结束执行时间：20190814180739
SQL开始执行时间：20190814180739


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180739
SQL开始执行时间：20190814180739
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180759
SQL开始执行时间：20190814180759

delete from edw.checklist_sy where ddate = '2018-09-19'
;
SQL结束执行时间：20190814180759
SQL开始执行时间：20190814180759
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180800

20190814180800开始执行2018-09-20数据加载日志:
SQL开始执行时间：20190814180800




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180800
SQL开始执行时间：20190814180800
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-20'

;
SQL结束执行时间：20190814180804
SQL开始执行时间：20190814180804


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180804
SQL开始执行时间：20190814180804
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180821
SQL开始执行时间：20190814180821

delete from edw.checklist_sy where ddate = '2018-09-20'
;
SQL结束执行时间：20190814180821
SQL开始执行时间：20190814180821
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180822

20190814180822开始执行2018-09-21数据加载日志:
SQL开始执行时间：20190814180822




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180822
SQL开始执行时间：20190814180822
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-21'

;
SQL结束执行时间：20190814180826
SQL开始执行时间：20190814180826


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180826
SQL开始执行时间：20190814180826
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180840
SQL开始执行时间：20190814180840

delete from edw.checklist_sy where ddate = '2018-09-21'
;
SQL结束执行时间：20190814180840
SQL开始执行时间：20190814180840
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180841

20190814180841开始执行2018-09-22数据加载日志:
SQL开始执行时间：20190814180841




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180841
SQL开始执行时间：20190814180841
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-22'

;
SQL结束执行时间：20190814180844
SQL开始执行时间：20190814180844


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180844
SQL开始执行时间：20190814180844
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180845
SQL开始执行时间：20190814180845

delete from edw.checklist_sy where ddate = '2018-09-22'
;
SQL结束执行时间：20190814180845
SQL开始执行时间：20190814180845
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180846

20190814180846开始执行2018-09-23数据加载日志:
SQL开始执行时间：20190814180846




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180846
SQL开始执行时间：20190814180846
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-23'

;
SQL结束执行时间：20190814180849
SQL开始执行时间：20190814180849


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180849
SQL开始执行时间：20190814180849
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180850
SQL开始执行时间：20190814180850

delete from edw.checklist_sy where ddate = '2018-09-23'
;
SQL结束执行时间：20190814180850
SQL开始执行时间：20190814180850
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180850

20190814180851开始执行2018-09-24数据加载日志:
SQL开始执行时间：20190814180851




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180851
SQL开始执行时间：20190814180851
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-24'

;
SQL结束执行时间：20190814180854
SQL开始执行时间：20190814180854


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180854
SQL开始执行时间：20190814180854
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180855
SQL开始执行时间：20190814180855

delete from edw.checklist_sy where ddate = '2018-09-24'
;
SQL结束执行时间：20190814180856
SQL开始执行时间：20190814180856
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180856

20190814180856开始执行2018-09-25数据加载日志:
SQL开始执行时间：20190814180856




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180856
SQL开始执行时间：20190814180856
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-25'

;
SQL结束执行时间：20190814180900
SQL开始执行时间：20190814180900


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180900
SQL开始执行时间：20190814180900
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180917
SQL开始执行时间：20190814180917

delete from edw.checklist_sy where ddate = '2018-09-25'
;
SQL结束执行时间：20190814180918
SQL开始执行时间：20190814180918
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180919

20190814180919开始执行2018-09-26数据加载日志:
SQL开始执行时间：20190814180919




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180919
SQL开始执行时间：20190814180919
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-26'

;
SQL结束执行时间：20190814180922
SQL开始执行时间：20190814180922


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180922
SQL开始执行时间：20190814180922
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814180949
SQL开始执行时间：20190814180949

delete from edw.checklist_sy where ddate = '2018-09-26'
;
SQL结束执行时间：20190814180950
SQL开始执行时间：20190814180950
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814180951

20190814180951开始执行2018-09-27数据加载日志:
SQL开始执行时间：20190814180951




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814180951
SQL开始执行时间：20190814180951
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-27'

;
SQL结束执行时间：20190814180954
SQL开始执行时间：20190814180954


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814180954
SQL开始执行时间：20190814180954
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181014
SQL开始执行时间：20190814181014

delete from edw.checklist_sy where ddate = '2018-09-27'
;
SQL结束执行时间：20190814181015
SQL开始执行时间：20190814181015
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181015

20190814181016开始执行2018-09-28数据加载日志:
SQL开始执行时间：20190814181016




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181016
SQL开始执行时间：20190814181016
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-28'

;
SQL结束执行时间：20190814181019
SQL开始执行时间：20190814181019


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181019
SQL开始执行时间：20190814181019
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181038
SQL开始执行时间：20190814181038

delete from edw.checklist_sy where ddate = '2018-09-28'
;
SQL结束执行时间：20190814181039
SQL开始执行时间：20190814181039
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181040

20190814181040开始执行2018-09-29数据加载日志:
SQL开始执行时间：20190814181040




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181040
SQL开始执行时间：20190814181040
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-29'

;
SQL结束执行时间：20190814181043
SQL开始执行时间：20190814181043


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181043
SQL开始执行时间：20190814181043
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181056
SQL开始执行时间：20190814181056

delete from edw.checklist_sy where ddate = '2018-09-29'
;
SQL结束执行时间：20190814181057
SQL开始执行时间：20190814181057
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181057

20190814181058开始执行2018-09-30数据加载日志:
SQL开始执行时间：20190814181058




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181058
SQL开始执行时间：20190814181058
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-09-30'

;
SQL结束执行时间：20190814181101
SQL开始执行时间：20190814181101


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181101
SQL开始执行时间：20190814181101
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181109
SQL开始执行时间：20190814181109

delete from edw.checklist_sy where ddate = '2018-09-30'
;
SQL结束执行时间：20190814181110
SQL开始执行时间：20190814181110
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181110

20190814181110开始执行2018-10-01数据加载日志:
SQL开始执行时间：20190814181110




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181110
SQL开始执行时间：20190814181110
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-01'

;
SQL结束执行时间：20190814181113
SQL开始执行时间：20190814181113


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181113
SQL开始执行时间：20190814181113
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181115
SQL开始执行时间：20190814181115

delete from edw.checklist_sy where ddate = '2018-10-01'
;
SQL结束执行时间：20190814181116
SQL开始执行时间：20190814181116
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181116

20190814181116开始执行2018-10-02数据加载日志:
SQL开始执行时间：20190814181116




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181116
SQL开始执行时间：20190814181116
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-02'

;
SQL结束执行时间：20190814181119
SQL开始执行时间：20190814181119


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181119
SQL开始执行时间：20190814181119
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181120
SQL开始执行时间：20190814181120

delete from edw.checklist_sy where ddate = '2018-10-02'
;
SQL结束执行时间：20190814181121
SQL开始执行时间：20190814181121
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181121

20190814181121开始执行2018-10-03数据加载日志:
SQL开始执行时间：20190814181121




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181121
SQL开始执行时间：20190814181121
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-03'

;
SQL结束执行时间：20190814181124
SQL开始执行时间：20190814181124


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181124
SQL开始执行时间：20190814181124
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181127
SQL开始执行时间：20190814181127

delete from edw.checklist_sy where ddate = '2018-10-03'
;
SQL结束执行时间：20190814181127
SQL开始执行时间：20190814181127
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181128

20190814181128开始执行2018-10-04数据加载日志:
SQL开始执行时间：20190814181128




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181128
SQL开始执行时间：20190814181128
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-04'

;
SQL结束执行时间：20190814181131
SQL开始执行时间：20190814181131


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181131
SQL开始执行时间：20190814181131
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181139
SQL开始执行时间：20190814181139

delete from edw.checklist_sy where ddate = '2018-10-04'
;
SQL结束执行时间：20190814181140
SQL开始执行时间：20190814181140
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181141

20190814181141开始执行2018-10-05数据加载日志:
SQL开始执行时间：20190814181141




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181141
SQL开始执行时间：20190814181141
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-05'

;
SQL结束执行时间：20190814181144
SQL开始执行时间：20190814181144


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181144
SQL开始执行时间：20190814181144
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181152
SQL开始执行时间：20190814181152

delete from edw.checklist_sy where ddate = '2018-10-05'
;
SQL结束执行时间：20190814181152
SQL开始执行时间：20190814181152
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181153

20190814181153开始执行2018-10-06数据加载日志:
SQL开始执行时间：20190814181153




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181153
SQL开始执行时间：20190814181153
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-06'

;
SQL结束执行时间：20190814181156
SQL开始执行时间：20190814181156


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181156
SQL开始执行时间：20190814181156
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181157
SQL开始执行时间：20190814181157

delete from edw.checklist_sy where ddate = '2018-10-06'
;
SQL结束执行时间：20190814181158
SQL开始执行时间：20190814181158
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181158

20190814181158开始执行2018-10-07数据加载日志:
SQL开始执行时间：20190814181158




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181158
SQL开始执行时间：20190814181158
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-07'

;
SQL结束执行时间：20190814181201
SQL开始执行时间：20190814181201


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181201
SQL开始执行时间：20190814181201
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181202
SQL开始执行时间：20190814181202

delete from edw.checklist_sy where ddate = '2018-10-07'
;
SQL结束执行时间：20190814181202
SQL开始执行时间：20190814181202
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181203

20190814181203开始执行2018-10-08数据加载日志:
SQL开始执行时间：20190814181203




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181203
SQL开始执行时间：20190814181203
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-08'

;
SQL结束执行时间：20190814181206
SQL开始执行时间：20190814181206


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181206
SQL开始执行时间：20190814181206
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181219
SQL开始执行时间：20190814181219

delete from edw.checklist_sy where ddate = '2018-10-08'
;
SQL结束执行时间：20190814181220
SQL开始执行时间：20190814181220
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181221

20190814181221开始执行2018-10-09数据加载日志:
SQL开始执行时间：20190814181221




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181221
SQL开始执行时间：20190814181221
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-09'

;
SQL结束执行时间：20190814181224
SQL开始执行时间：20190814181224


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181224
SQL开始执行时间：20190814181224
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181244
SQL开始执行时间：20190814181244

delete from edw.checklist_sy where ddate = '2018-10-09'
;
SQL结束执行时间：20190814181244
SQL开始执行时间：20190814181244
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181245

20190814181245开始执行2018-10-10数据加载日志:
SQL开始执行时间：20190814181245




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181245
SQL开始执行时间：20190814181245
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-10'

;
SQL结束执行时间：20190814181249
SQL开始执行时间：20190814181249


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181249
SQL开始执行时间：20190814181249
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181307
SQL开始执行时间：20190814181307

delete from edw.checklist_sy where ddate = '2018-10-10'
;
SQL结束执行时间：20190814181308
SQL开始执行时间：20190814181308
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181309

20190814181309开始执行2018-10-11数据加载日志:
SQL开始执行时间：20190814181309




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181309
SQL开始执行时间：20190814181309
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-11'

;
SQL结束执行时间：20190814181312
SQL开始执行时间：20190814181312


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181312
SQL开始执行时间：20190814181312
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181333
SQL开始执行时间：20190814181333

delete from edw.checklist_sy where ddate = '2018-10-11'
;
SQL结束执行时间：20190814181334
SQL开始执行时间：20190814181334
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181334

20190814181335开始执行2018-10-12数据加载日志:
SQL开始执行时间：20190814181335




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181335
SQL开始执行时间：20190814181335
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-12'

;
SQL结束执行时间：20190814181338
SQL开始执行时间：20190814181338


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181338
SQL开始执行时间：20190814181338
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181353
SQL开始执行时间：20190814181353

delete from edw.checklist_sy where ddate = '2018-10-12'
;
SQL结束执行时间：20190814181353
SQL开始执行时间：20190814181353
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181354

20190814181354开始执行2018-10-13数据加载日志:
SQL开始执行时间：20190814181354




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181354
SQL开始执行时间：20190814181354
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-13'

;
SQL结束执行时间：20190814181357
SQL开始执行时间：20190814181357


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181357
SQL开始执行时间：20190814181357
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181358
SQL开始执行时间：20190814181358

delete from edw.checklist_sy where ddate = '2018-10-13'
;
SQL结束执行时间：20190814181358
SQL开始执行时间：20190814181358
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181358

20190814181359开始执行2018-10-14数据加载日志:
SQL开始执行时间：20190814181359




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181359
SQL开始执行时间：20190814181359
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-14'

;
SQL结束执行时间：20190814181402
SQL开始执行时间：20190814181402


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181402
SQL开始执行时间：20190814181402
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181402
SQL开始执行时间：20190814181402

delete from edw.checklist_sy where ddate = '2018-10-14'
;
SQL结束执行时间：20190814181403
SQL开始执行时间：20190814181403
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181403

20190814181403开始执行2018-10-15数据加载日志:
SQL开始执行时间：20190814181403




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181403
SQL开始执行时间：20190814181403
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-15'

;
SQL结束执行时间：20190814181406
SQL开始执行时间：20190814181406


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181406
SQL开始执行时间：20190814181406
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181426
SQL开始执行时间：20190814181426

delete from edw.checklist_sy where ddate = '2018-10-15'
;
SQL结束执行时间：20190814181426
SQL开始执行时间：20190814181426
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181427

20190814181427开始执行2018-10-16数据加载日志:
SQL开始执行时间：20190814181427




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181427
SQL开始执行时间：20190814181427
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-16'

;
SQL结束执行时间：20190814181431
SQL开始执行时间：20190814181431


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181431
SQL开始执行时间：20190814181431
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181454
SQL开始执行时间：20190814181454

delete from edw.checklist_sy where ddate = '2018-10-16'
;
SQL结束执行时间：20190814181454
SQL开始执行时间：20190814181454
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181455

20190814181455开始执行2018-10-17数据加载日志:
SQL开始执行时间：20190814181455




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181455
SQL开始执行时间：20190814181455
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-17'

;
SQL结束执行时间：20190814181459
SQL开始执行时间：20190814181459


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181459
SQL开始执行时间：20190814181459
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181521
SQL开始执行时间：20190814181521

delete from edw.checklist_sy where ddate = '2018-10-17'
;
SQL结束执行时间：20190814181522
SQL开始执行时间：20190814181522
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181523

20190814181523开始执行2018-10-18数据加载日志:
SQL开始执行时间：20190814181523




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181523
SQL开始执行时间：20190814181523
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-18'

;
SQL结束执行时间：20190814181526
SQL开始执行时间：20190814181526


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181526
SQL开始执行时间：20190814181526
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181544
SQL开始执行时间：20190814181544

delete from edw.checklist_sy where ddate = '2018-10-18'
;
SQL结束执行时间：20190814181544
SQL开始执行时间：20190814181544
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181545

20190814181545开始执行2018-10-19数据加载日志:
SQL开始执行时间：20190814181545




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181545
SQL开始执行时间：20190814181545
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-19'

;
SQL结束执行时间：20190814181549
SQL开始执行时间：20190814181549


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181549
SQL开始执行时间：20190814181549
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181604
SQL开始执行时间：20190814181604

delete from edw.checklist_sy where ddate = '2018-10-19'
;
SQL结束执行时间：20190814181605
SQL开始执行时间：20190814181605
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181605

20190814181606开始执行2018-10-20数据加载日志:
SQL开始执行时间：20190814181606




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181606
SQL开始执行时间：20190814181606
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-20'

;
SQL结束执行时间：20190814181609
SQL开始执行时间：20190814181609


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181609
SQL开始执行时间：20190814181609
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181610
SQL开始执行时间：20190814181610

delete from edw.checklist_sy where ddate = '2018-10-20'
;
SQL结束执行时间：20190814181611
SQL开始执行时间：20190814181611
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181611

20190814181611开始执行2018-10-21数据加载日志:
SQL开始执行时间：20190814181611




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181611
SQL开始执行时间：20190814181611
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-21'

;
SQL结束执行时间：20190814181614
SQL开始执行时间：20190814181614


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181614
SQL开始执行时间：20190814181614
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181615
SQL开始执行时间：20190814181615

delete from edw.checklist_sy where ddate = '2018-10-21'
;
SQL结束执行时间：20190814181615
SQL开始执行时间：20190814181615
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181615

20190814181616开始执行2018-10-22数据加载日志:
SQL开始执行时间：20190814181616




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181616
SQL开始执行时间：20190814181616
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-22'

;
SQL结束执行时间：20190814181619
SQL开始执行时间：20190814181619


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181619
SQL开始执行时间：20190814181619
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181635
SQL开始执行时间：20190814181635

delete from edw.checklist_sy where ddate = '2018-10-22'
;
SQL结束执行时间：20190814181636
SQL开始执行时间：20190814181636
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181636

20190814181636开始执行2018-10-23数据加载日志:
SQL开始执行时间：20190814181636




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181636
SQL开始执行时间：20190814181636
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-23'

;
SQL结束执行时间：20190814181640
SQL开始执行时间：20190814181640


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181640
SQL开始执行时间：20190814181640
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181704
SQL开始执行时间：20190814181704

delete from edw.checklist_sy where ddate = '2018-10-23'
;
SQL结束执行时间：20190814181704
SQL开始执行时间：20190814181704
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181705

20190814181705开始执行2018-10-24数据加载日志:
SQL开始执行时间：20190814181705




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181705
SQL开始执行时间：20190814181705
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-24'

;
SQL结束执行时间：20190814181709
SQL开始执行时间：20190814181709


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181709
SQL开始执行时间：20190814181709
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181727
SQL开始执行时间：20190814181727

delete from edw.checklist_sy where ddate = '2018-10-24'
;
SQL结束执行时间：20190814181728
SQL开始执行时间：20190814181728
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181728

20190814181729开始执行2018-10-25数据加载日志:
SQL开始执行时间：20190814181729




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181729
SQL开始执行时间：20190814181729
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-25'

;
SQL结束执行时间：20190814181732
SQL开始执行时间：20190814181732


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181732
SQL开始执行时间：20190814181732
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181751
SQL开始执行时间：20190814181751

delete from edw.checklist_sy where ddate = '2018-10-25'
;
SQL结束执行时间：20190814181752
SQL开始执行时间：20190814181752
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181753

20190814181753开始执行2018-10-26数据加载日志:
SQL开始执行时间：20190814181753




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181753
SQL开始执行时间：20190814181753
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-26'

;
SQL结束执行时间：20190814181756
SQL开始执行时间：20190814181756


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181756
SQL开始执行时间：20190814181756
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181807
SQL开始执行时间：20190814181807

delete from edw.checklist_sy where ddate = '2018-10-26'
;
SQL结束执行时间：20190814181808
SQL开始执行时间：20190814181808
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181809

20190814181809开始执行2018-10-27数据加载日志:
SQL开始执行时间：20190814181809




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181809
SQL开始执行时间：20190814181809
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-27'

;
SQL结束执行时间：20190814181812
SQL开始执行时间：20190814181812


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181812
SQL开始执行时间：20190814181812
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181812
SQL开始执行时间：20190814181812

delete from edw.checklist_sy where ddate = '2018-10-27'
;
SQL结束执行时间：20190814181813
SQL开始执行时间：20190814181813
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181813

20190814181813开始执行2018-10-28数据加载日志:
SQL开始执行时间：20190814181813




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181813
SQL开始执行时间：20190814181813
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-28'

;
SQL结束执行时间：20190814181816
SQL开始执行时间：20190814181816


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181816
SQL开始执行时间：20190814181816
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181817
SQL开始执行时间：20190814181817

delete from edw.checklist_sy where ddate = '2018-10-28'
;
SQL结束执行时间：20190814181817
SQL开始执行时间：20190814181817
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181818

20190814181818开始执行2018-10-29数据加载日志:
SQL开始执行时间：20190814181818




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181818
SQL开始执行时间：20190814181818
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-29'

;
SQL结束执行时间：20190814181821
SQL开始执行时间：20190814181821


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181821
SQL开始执行时间：20190814181821
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181839
SQL开始执行时间：20190814181839

delete from edw.checklist_sy where ddate = '2018-10-29'
;
SQL结束执行时间：20190814181840
SQL开始执行时间：20190814181840
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181841

20190814181841开始执行2018-10-30数据加载日志:
SQL开始执行时间：20190814181841




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181841
SQL开始执行时间：20190814181841
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-30'

;
SQL结束执行时间：20190814181844
SQL开始执行时间：20190814181844


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181844
SQL开始执行时间：20190814181844
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181907
SQL开始执行时间：20190814181907

delete from edw.checklist_sy where ddate = '2018-10-30'
;
SQL结束执行时间：20190814181908
SQL开始执行时间：20190814181908
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181909

20190814181909开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190814181909




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181909
SQL开始执行时间：20190814181909
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-10-31'

;
SQL结束执行时间：20190814181912
SQL开始执行时间：20190814181912


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181912
SQL开始执行时间：20190814181912
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181930
SQL开始执行时间：20190814181930

delete from edw.checklist_sy where ddate = '2018-10-31'
;
SQL结束执行时间：20190814181931
SQL开始执行时间：20190814181931
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181932

20190814181932开始执行2018-11-01数据加载日志:
SQL开始执行时间：20190814181932




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181932
SQL开始执行时间：20190814181932
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-01'

;
SQL结束执行时间：20190814181935
SQL开始执行时间：20190814181935


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181935
SQL开始执行时间：20190814181935
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814181951
SQL开始执行时间：20190814181951

delete from edw.checklist_sy where ddate = '2018-11-01'
;
SQL结束执行时间：20190814181952
SQL开始执行时间：20190814181952
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814181953

20190814181953开始执行2018-11-02数据加载日志:
SQL开始执行时间：20190814181953




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814181953
SQL开始执行时间：20190814181953
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-02'

;
SQL结束执行时间：20190814181956
SQL开始执行时间：20190814181956


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814181956
SQL开始执行时间：20190814181956
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182009
SQL开始执行时间：20190814182009

delete from edw.checklist_sy where ddate = '2018-11-02'
;
SQL结束执行时间：20190814182010
SQL开始执行时间：20190814182010
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182010

20190814182010开始执行2018-11-03数据加载日志:
SQL开始执行时间：20190814182010




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182010
SQL开始执行时间：20190814182010
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-03'

;
SQL结束执行时间：20190814182014
SQL开始执行时间：20190814182014


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182014
SQL开始执行时间：20190814182014
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182014
SQL开始执行时间：20190814182014

delete from edw.checklist_sy where ddate = '2018-11-03'
;
SQL结束执行时间：20190814182014
SQL开始执行时间：20190814182014
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182014

20190814182015开始执行2018-11-04数据加载日志:
SQL开始执行时间：20190814182015




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182015
SQL开始执行时间：20190814182015
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-04'

;
SQL结束执行时间：20190814182018
SQL开始执行时间：20190814182018


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182018
SQL开始执行时间：20190814182018
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182018
SQL开始执行时间：20190814182018

delete from edw.checklist_sy where ddate = '2018-11-04'
;
SQL结束执行时间：20190814182019
SQL开始执行时间：20190814182019
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182019

20190814182019开始执行2018-11-05数据加载日志:
SQL开始执行时间：20190814182019




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182019
SQL开始执行时间：20190814182019
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-05'

;
SQL结束执行时间：20190814182022
SQL开始执行时间：20190814182022


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182022
SQL开始执行时间：20190814182022
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182041
SQL开始执行时间：20190814182041

delete from edw.checklist_sy where ddate = '2018-11-05'
;
SQL结束执行时间：20190814182042
SQL开始执行时间：20190814182042
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182043

20190814182043开始执行2018-11-06数据加载日志:
SQL开始执行时间：20190814182043




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182043
SQL开始执行时间：20190814182043
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-06'

;
SQL结束执行时间：20190814182046
SQL开始执行时间：20190814182046


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182046
SQL开始执行时间：20190814182046
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182107
SQL开始执行时间：20190814182107

delete from edw.checklist_sy where ddate = '2018-11-06'
;
SQL结束执行时间：20190814182108
SQL开始执行时间：20190814182108
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182108

20190814182109开始执行2018-11-07数据加载日志:
SQL开始执行时间：20190814182109




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182109
SQL开始执行时间：20190814182109
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-07'

;
SQL结束执行时间：20190814182112
SQL开始执行时间：20190814182112


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182112
SQL开始执行时间：20190814182112
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182133
SQL开始执行时间：20190814182133

delete from edw.checklist_sy where ddate = '2018-11-07'
;
SQL结束执行时间：20190814182134
SQL开始执行时间：20190814182134
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182134

20190814182134开始执行2018-11-08数据加载日志:
SQL开始执行时间：20190814182134




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182134
SQL开始执行时间：20190814182134
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-08'

;
SQL结束执行时间：20190814182138
SQL开始执行时间：20190814182138


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182138
SQL开始执行时间：20190814182138
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182153
SQL开始执行时间：20190814182153

delete from edw.checklist_sy where ddate = '2018-11-08'
;
SQL结束执行时间：20190814182154
SQL开始执行时间：20190814182154
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182155

20190814182155开始执行2018-11-09数据加载日志:
SQL开始执行时间：20190814182155




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182155
SQL开始执行时间：20190814182155
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-09'

;
SQL结束执行时间：20190814182158
SQL开始执行时间：20190814182158


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182158
SQL开始执行时间：20190814182158
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182212
SQL开始执行时间：20190814182212

delete from edw.checklist_sy where ddate = '2018-11-09'
;
SQL结束执行时间：20190814182213
SQL开始执行时间：20190814182213
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182213

20190814182214开始执行2018-11-10数据加载日志:
SQL开始执行时间：20190814182214




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182214
SQL开始执行时间：20190814182214
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-10'

;
SQL结束执行时间：20190814182217
SQL开始执行时间：20190814182217


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182217
SQL开始执行时间：20190814182217
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182217
SQL开始执行时间：20190814182217

delete from edw.checklist_sy where ddate = '2018-11-10'
;
SQL结束执行时间：20190814182218
SQL开始执行时间：20190814182218
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182218

20190814182218开始执行2018-11-11数据加载日志:
SQL开始执行时间：20190814182218




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182218
SQL开始执行时间：20190814182218
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-11'

;
SQL结束执行时间：20190814182222
SQL开始执行时间：20190814182222


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182222
SQL开始执行时间：20190814182222
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182222
SQL开始执行时间：20190814182222

delete from edw.checklist_sy where ddate = '2018-11-11'
;
SQL结束执行时间：20190814182223
SQL开始执行时间：20190814182223
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182223

20190814182223开始执行2018-11-12数据加载日志:
SQL开始执行时间：20190814182223




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182223
SQL开始执行时间：20190814182223
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-12'

;
SQL结束执行时间：20190814182227
SQL开始执行时间：20190814182227


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182227
SQL开始执行时间：20190814182227
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182249
SQL开始执行时间：20190814182249

delete from edw.checklist_sy where ddate = '2018-11-12'
;
SQL结束执行时间：20190814182250
SQL开始执行时间：20190814182250
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182251

20190814182251开始执行2018-11-13数据加载日志:
SQL开始执行时间：20190814182251




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182251
SQL开始执行时间：20190814182251
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-13'

;
SQL结束执行时间：20190814182255
SQL开始执行时间：20190814182255


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182255
SQL开始执行时间：20190814182255
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182314
SQL开始执行时间：20190814182314

delete from edw.checklist_sy where ddate = '2018-11-13'
;
SQL结束执行时间：20190814182315
SQL开始执行时间：20190814182315
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182315

20190814182316开始执行2018-11-14数据加载日志:
SQL开始执行时间：20190814182316




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182316
SQL开始执行时间：20190814182316
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-14'

;
SQL结束执行时间：20190814182319
SQL开始执行时间：20190814182319


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182319
SQL开始执行时间：20190814182319
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182335
SQL开始执行时间：20190814182335

delete from edw.checklist_sy where ddate = '2018-11-14'
;
SQL结束执行时间：20190814182336
SQL开始执行时间：20190814182336
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182336

20190814182337开始执行2018-11-15数据加载日志:
SQL开始执行时间：20190814182337




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182337
SQL开始执行时间：20190814182337
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-15'

;
SQL结束执行时间：20190814182340
SQL开始执行时间：20190814182340


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182340
SQL开始执行时间：20190814182340
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182359
SQL开始执行时间：20190814182359

delete from edw.checklist_sy where ddate = '2018-11-15'
;
SQL结束执行时间：20190814182359
SQL开始执行时间：20190814182359
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182400

20190814182400开始执行2018-11-16数据加载日志:
SQL开始执行时间：20190814182400




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182400
SQL开始执行时间：20190814182400
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-16'

;
SQL结束执行时间：20190814182404
SQL开始执行时间：20190814182404


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182404
SQL开始执行时间：20190814182404
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182418
SQL开始执行时间：20190814182418

delete from edw.checklist_sy where ddate = '2018-11-16'
;
SQL结束执行时间：20190814182418
SQL开始执行时间：20190814182418
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182419

20190814182419开始执行2018-11-17数据加载日志:
SQL开始执行时间：20190814182419




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182419
SQL开始执行时间：20190814182419
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-17'

;
SQL结束执行时间：20190814182422
SQL开始执行时间：20190814182422


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182422
SQL开始执行时间：20190814182422
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182423
SQL开始执行时间：20190814182423

delete from edw.checklist_sy where ddate = '2018-11-17'
;
SQL结束执行时间：20190814182424
SQL开始执行时间：20190814182424
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182424

20190814182424开始执行2018-11-18数据加载日志:
SQL开始执行时间：20190814182424




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182424
SQL开始执行时间：20190814182424
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-18'

;
SQL结束执行时间：20190814182427
SQL开始执行时间：20190814182427


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182427
SQL开始执行时间：20190814182427
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182428
SQL开始执行时间：20190814182428

delete from edw.checklist_sy where ddate = '2018-11-18'
;
SQL结束执行时间：20190814182428
SQL开始执行时间：20190814182428
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182429

20190814182429开始执行2018-11-19数据加载日志:
SQL开始执行时间：20190814182429




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182429
SQL开始执行时间：20190814182429
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-19'

;
SQL结束执行时间：20190814182432
SQL开始执行时间：20190814182432


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182432
SQL开始执行时间：20190814182432
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182451
SQL开始执行时间：20190814182451

delete from edw.checklist_sy where ddate = '2018-11-19'
;
SQL结束执行时间：20190814182452
SQL开始执行时间：20190814182452
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182452

20190814182453开始执行2018-11-20数据加载日志:
SQL开始执行时间：20190814182453




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182453
SQL开始执行时间：20190814182453
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-20'

;
SQL结束执行时间：20190814182456
SQL开始执行时间：20190814182456


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182456
SQL开始执行时间：20190814182456
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182513
SQL开始执行时间：20190814182513

delete from edw.checklist_sy where ddate = '2018-11-20'
;
SQL结束执行时间：20190814182514
SQL开始执行时间：20190814182514
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182515

20190814182515开始执行2018-11-21数据加载日志:
SQL开始执行时间：20190814182515




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182515
SQL开始执行时间：20190814182515
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-21'

;
SQL结束执行时间：20190814182519
SQL开始执行时间：20190814182519


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182519
SQL开始执行时间：20190814182519
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182541
SQL开始执行时间：20190814182541

delete from edw.checklist_sy where ddate = '2018-11-21'
;
SQL结束执行时间：20190814182541
SQL开始执行时间：20190814182541
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182542

20190814182542开始执行2018-11-22数据加载日志:
SQL开始执行时间：20190814182542




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182542
SQL开始执行时间：20190814182542
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-22'

;
SQL结束执行时间：20190814182546
SQL开始执行时间：20190814182546


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182546
SQL开始执行时间：20190814182546
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182605
SQL开始执行时间：20190814182605

delete from edw.checklist_sy where ddate = '2018-11-22'
;
SQL结束执行时间：20190814182606
SQL开始执行时间：20190814182606
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182607

20190814182607开始执行2018-11-23数据加载日志:
SQL开始执行时间：20190814182607




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182607
SQL开始执行时间：20190814182607
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-23'

;
SQL结束执行时间：20190814182610
SQL开始执行时间：20190814182610


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182610
SQL开始执行时间：20190814182610
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182622
SQL开始执行时间：20190814182622

delete from edw.checklist_sy where ddate = '2018-11-23'
;
SQL结束执行时间：20190814182623
SQL开始执行时间：20190814182623
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182623

20190814182624开始执行2018-11-24数据加载日志:
SQL开始执行时间：20190814182624




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182624
SQL开始执行时间：20190814182624
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-24'

;
SQL结束执行时间：20190814182627
SQL开始执行时间：20190814182627


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182627
SQL开始执行时间：20190814182627
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182627
SQL开始执行时间：20190814182627

delete from edw.checklist_sy where ddate = '2018-11-24'
;
SQL结束执行时间：20190814182628
SQL开始执行时间：20190814182628
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182628

20190814182628开始执行2018-11-25数据加载日志:
SQL开始执行时间：20190814182628




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182628
SQL开始执行时间：20190814182628
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-25'

;
SQL结束执行时间：20190814182631
SQL开始执行时间：20190814182631


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182631
SQL开始执行时间：20190814182631
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182631
SQL开始执行时间：20190814182631

delete from edw.checklist_sy where ddate = '2018-11-25'
;
SQL结束执行时间：20190814182632
SQL开始执行时间：20190814182632
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182632

20190814182632开始执行2018-11-26数据加载日志:
SQL开始执行时间：20190814182632




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182632
SQL开始执行时间：20190814182632
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-26'

;
SQL结束执行时间：20190814182636
SQL开始执行时间：20190814182636


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182636
SQL开始执行时间：20190814182636
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182655
SQL开始执行时间：20190814182655

delete from edw.checklist_sy where ddate = '2018-11-26'
;
SQL结束执行时间：20190814182656
SQL开始执行时间：20190814182656
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182656

20190814182657开始执行2018-11-27数据加载日志:
SQL开始执行时间：20190814182657




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182657
SQL开始执行时间：20190814182657
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-27'

;
SQL结束执行时间：20190814182700
SQL开始执行时间：20190814182700


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182700
SQL开始执行时间：20190814182700
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182722
SQL开始执行时间：20190814182722

delete from edw.checklist_sy where ddate = '2018-11-27'
;
SQL结束执行时间：20190814182722
SQL开始执行时间：20190814182722
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182723

20190814182723开始执行2018-11-28数据加载日志:
SQL开始执行时间：20190814182723




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182723
SQL开始执行时间：20190814182723
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-28'

;
SQL结束执行时间：20190814182727
SQL开始执行时间：20190814182727


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182727
SQL开始执行时间：20190814182727
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182746
SQL开始执行时间：20190814182746

delete from edw.checklist_sy where ddate = '2018-11-28'
;
SQL结束执行时间：20190814182747
SQL开始执行时间：20190814182747
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182748

20190814182748开始执行2018-11-29数据加载日志:
SQL开始执行时间：20190814182748




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182748
SQL开始执行时间：20190814182748
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-29'

;
SQL结束执行时间：20190814182751
SQL开始执行时间：20190814182751


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182751
SQL开始执行时间：20190814182751
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182810
SQL开始执行时间：20190814182810

delete from edw.checklist_sy where ddate = '2018-11-29'
;
SQL结束执行时间：20190814182810
SQL开始执行时间：20190814182810
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182811

20190814182811开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190814182811




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182811
SQL开始执行时间：20190814182811
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-11-30'

;
SQL结束执行时间：20190814182815
SQL开始执行时间：20190814182815


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182815
SQL开始执行时间：20190814182815
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182829
SQL开始执行时间：20190814182829

delete from edw.checklist_sy where ddate = '2018-11-30'
;
SQL结束执行时间：20190814182830
SQL开始执行时间：20190814182830
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182830

20190814182830开始执行2018-12-01数据加载日志:
SQL开始执行时间：20190814182830




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182830
SQL开始执行时间：20190814182830
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-01'

;
SQL结束执行时间：20190814182834
SQL开始执行时间：20190814182834


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182834
SQL开始执行时间：20190814182834
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182834
SQL开始执行时间：20190814182834

delete from edw.checklist_sy where ddate = '2018-12-01'
;
SQL结束执行时间：20190814182835
SQL开始执行时间：20190814182835
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182835

20190814182835开始执行2018-12-02数据加载日志:
SQL开始执行时间：20190814182835




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182835
SQL开始执行时间：20190814182835
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-02'

;
SQL结束执行时间：20190814182839
SQL开始执行时间：20190814182839


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182839
SQL开始执行时间：20190814182839
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182839
SQL开始执行时间：20190814182839

delete from edw.checklist_sy where ddate = '2018-12-02'
;
SQL结束执行时间：20190814182840
SQL开始执行时间：20190814182840
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182840

20190814182840开始执行2018-12-03数据加载日志:
SQL开始执行时间：20190814182840




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182840
SQL开始执行时间：20190814182840
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-03'

;
SQL结束执行时间：20190814182844
SQL开始执行时间：20190814182844


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182844
SQL开始执行时间：20190814182844
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182904
SQL开始执行时间：20190814182904

delete from edw.checklist_sy where ddate = '2018-12-03'
;
SQL结束执行时间：20190814182905
SQL开始执行时间：20190814182905
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182906

20190814182906开始执行2018-12-04数据加载日志:
SQL开始执行时间：20190814182906




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182906
SQL开始执行时间：20190814182906
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-04'

;
SQL结束执行时间：20190814182909
SQL开始执行时间：20190814182909


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182909
SQL开始执行时间：20190814182909
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182928
SQL开始执行时间：20190814182928

delete from edw.checklist_sy where ddate = '2018-12-04'
;
SQL结束执行时间：20190814182929
SQL开始执行时间：20190814182929
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182929

20190814182930开始执行2018-12-05数据加载日志:
SQL开始执行时间：20190814182930




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182930
SQL开始执行时间：20190814182930
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-05'

;
SQL结束执行时间：20190814182933
SQL开始执行时间：20190814182933


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182933
SQL开始执行时间：20190814182933
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814182950
SQL开始执行时间：20190814182950

delete from edw.checklist_sy where ddate = '2018-12-05'
;
SQL结束执行时间：20190814182951
SQL开始执行时间：20190814182951
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814182952

20190814182952开始执行2018-12-06数据加载日志:
SQL开始执行时间：20190814182952




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814182952
SQL开始执行时间：20190814182952
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-06'

;
SQL结束执行时间：20190814182955
SQL开始执行时间：20190814182955


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814182955
SQL开始执行时间：20190814182955
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183015
SQL开始执行时间：20190814183015

delete from edw.checklist_sy where ddate = '2018-12-06'
;
SQL结束执行时间：20190814183015
SQL开始执行时间：20190814183015
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183016

20190814183016开始执行2018-12-07数据加载日志:
SQL开始执行时间：20190814183016




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183016
SQL开始执行时间：20190814183016
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-07'

;
SQL结束执行时间：20190814183020
SQL开始执行时间：20190814183020


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183020
SQL开始执行时间：20190814183020
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183033
SQL开始执行时间：20190814183033

delete from edw.checklist_sy where ddate = '2018-12-07'
;
SQL结束执行时间：20190814183034
SQL开始执行时间：20190814183034
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183034

20190814183034开始执行2018-12-08数据加载日志:
SQL开始执行时间：20190814183034




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183034
SQL开始执行时间：20190814183034
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-08'

;
SQL结束执行时间：20190814183038
SQL开始执行时间：20190814183038


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183038
SQL开始执行时间：20190814183038
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183038
SQL开始执行时间：20190814183038

delete from edw.checklist_sy where ddate = '2018-12-08'
;
SQL结束执行时间：20190814183039
SQL开始执行时间：20190814183039
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183039

20190814183039开始执行2018-12-09数据加载日志:
SQL开始执行时间：20190814183039




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183039
SQL开始执行时间：20190814183039
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-09'

;
SQL结束执行时间：20190814183042
SQL开始执行时间：20190814183042


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183042
SQL开始执行时间：20190814183042
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183042
SQL开始执行时间：20190814183042

delete from edw.checklist_sy where ddate = '2018-12-09'
;
SQL结束执行时间：20190814183043
SQL开始执行时间：20190814183043
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183043

20190814183044开始执行2018-12-10数据加载日志:
SQL开始执行时间：20190814183044




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183044
SQL开始执行时间：20190814183044
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-10'

;
SQL结束执行时间：20190814183047
SQL开始执行时间：20190814183047


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183047
SQL开始执行时间：20190814183047
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183106
SQL开始执行时间：20190814183106

delete from edw.checklist_sy where ddate = '2018-12-10'
;
SQL结束执行时间：20190814183107
SQL开始执行时间：20190814183107
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183108

20190814183108开始执行2018-12-11数据加载日志:
SQL开始执行时间：20190814183108




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183108
SQL开始执行时间：20190814183108
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-11'

;
SQL结束执行时间：20190814183112
SQL开始执行时间：20190814183112


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183112
SQL开始执行时间：20190814183112
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183134
SQL开始执行时间：20190814183134

delete from edw.checklist_sy where ddate = '2018-12-11'
;
SQL结束执行时间：20190814183135
SQL开始执行时间：20190814183135
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183136

20190814183136开始执行2018-12-12数据加载日志:
SQL开始执行时间：20190814183136




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183136
SQL开始执行时间：20190814183136
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-12'

;
SQL结束执行时间：20190814183139
SQL开始执行时间：20190814183139


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183139
SQL开始执行时间：20190814183139
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183159
SQL开始执行时间：20190814183159

delete from edw.checklist_sy where ddate = '2018-12-12'
;
SQL结束执行时间：20190814183159
SQL开始执行时间：20190814183159
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183200

20190814183200开始执行2018-12-13数据加载日志:
SQL开始执行时间：20190814183200




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183200
SQL开始执行时间：20190814183200
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-13'

;
SQL结束执行时间：20190814183204
SQL开始执行时间：20190814183204


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183204
SQL开始执行时间：20190814183204
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183220
SQL开始执行时间：20190814183220

delete from edw.checklist_sy where ddate = '2018-12-13'
;
SQL结束执行时间：20190814183221
SQL开始执行时间：20190814183221
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183222

20190814183222开始执行2018-12-14数据加载日志:
SQL开始执行时间：20190814183222




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183222
SQL开始执行时间：20190814183222
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-14'

;
SQL结束执行时间：20190814183225
SQL开始执行时间：20190814183225


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183225
SQL开始执行时间：20190814183225
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183237
SQL开始执行时间：20190814183237

delete from edw.checklist_sy where ddate = '2018-12-14'
;
SQL结束执行时间：20190814183238
SQL开始执行时间：20190814183238
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183238

20190814183238开始执行2018-12-15数据加载日志:
SQL开始执行时间：20190814183238




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183238
SQL开始执行时间：20190814183238
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-15'

;
SQL结束执行时间：20190814183242
SQL开始执行时间：20190814183242


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183242
SQL开始执行时间：20190814183242
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183242
SQL开始执行时间：20190814183242

delete from edw.checklist_sy where ddate = '2018-12-15'
;
SQL结束执行时间：20190814183243
SQL开始执行时间：20190814183243
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183243

20190814183243开始执行2018-12-16数据加载日志:
SQL开始执行时间：20190814183243




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183243
SQL开始执行时间：20190814183243
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-16'

;
SQL结束执行时间：20190814183246
SQL开始执行时间：20190814183246


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183246
SQL开始执行时间：20190814183246
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183246
SQL开始执行时间：20190814183246

delete from edw.checklist_sy where ddate = '2018-12-16'
;
SQL结束执行时间：20190814183247
SQL开始执行时间：20190814183247
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183247

20190814183247开始执行2018-12-17数据加载日志:
SQL开始执行时间：20190814183247




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183247
SQL开始执行时间：20190814183247
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-17'

;
SQL结束执行时间：20190814183251
SQL开始执行时间：20190814183251


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183251
SQL开始执行时间：20190814183251
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183310
SQL开始执行时间：20190814183310

delete from edw.checklist_sy where ddate = '2018-12-17'
;
SQL结束执行时间：20190814183311
SQL开始执行时间：20190814183311
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183312

20190814183312开始执行2018-12-18数据加载日志:
SQL开始执行时间：20190814183312




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183312
SQL开始执行时间：20190814183312
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-18'

;
SQL结束执行时间：20190814183315
SQL开始执行时间：20190814183315


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183315
SQL开始执行时间：20190814183315
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183338
SQL开始执行时间：20190814183338

delete from edw.checklist_sy where ddate = '2018-12-18'
;
SQL结束执行时间：20190814183338
SQL开始执行时间：20190814183338
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183339

20190814183339开始执行2018-12-19数据加载日志:
SQL开始执行时间：20190814183339




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183339
SQL开始执行时间：20190814183339
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-19'

;
SQL结束执行时间：20190814183343
SQL开始执行时间：20190814183343


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183343
SQL开始执行时间：20190814183343
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183405
SQL开始执行时间：20190814183405

delete from edw.checklist_sy where ddate = '2018-12-19'
;
SQL结束执行时间：20190814183406
SQL开始执行时间：20190814183406
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183407

20190814183407开始执行2018-12-20数据加载日志:
SQL开始执行时间：20190814183407




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183407
SQL开始执行时间：20190814183407
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-20'

;
SQL结束执行时间：20190814183411
SQL开始执行时间：20190814183411


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183411
SQL开始执行时间：20190814183411
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183424
SQL开始执行时间：20190814183424

delete from edw.checklist_sy where ddate = '2018-12-20'
;
SQL结束执行时间：20190814183425
SQL开始执行时间：20190814183425
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183426

20190814183426开始执行2018-12-21数据加载日志:
SQL开始执行时间：20190814183426




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183426
SQL开始执行时间：20190814183426
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-21'

;
SQL结束执行时间：20190814183429
SQL开始执行时间：20190814183429


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183429
SQL开始执行时间：20190814183429
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183440
SQL开始执行时间：20190814183440

delete from edw.checklist_sy where ddate = '2018-12-21'
;
SQL结束执行时间：20190814183441
SQL开始执行时间：20190814183441
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183441

20190814183441开始执行2018-12-22数据加载日志:
SQL开始执行时间：20190814183441




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183441
SQL开始执行时间：20190814183441
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-22'

;
SQL结束执行时间：20190814183445
SQL开始执行时间：20190814183445


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183445
SQL开始执行时间：20190814183445
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183445
SQL开始执行时间：20190814183445

delete from edw.checklist_sy where ddate = '2018-12-22'
;
SQL结束执行时间：20190814183446
SQL开始执行时间：20190814183446
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183446

20190814183446开始执行2018-12-23数据加载日志:
SQL开始执行时间：20190814183446




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183446
SQL开始执行时间：20190814183446
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-23'

;
SQL结束执行时间：20190814183450
SQL开始执行时间：20190814183450


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183450
SQL开始执行时间：20190814183450
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183450
SQL开始执行时间：20190814183450

delete from edw.checklist_sy where ddate = '2018-12-23'
;
SQL结束执行时间：20190814183451
SQL开始执行时间：20190814183451
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183451

20190814183452开始执行2018-12-24数据加载日志:
SQL开始执行时间：20190814183452




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183452
SQL开始执行时间：20190814183452
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-24'

;
SQL结束执行时间：20190814183455
SQL开始执行时间：20190814183455


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183455
SQL开始执行时间：20190814183455
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183509
SQL开始执行时间：20190814183509

delete from edw.checklist_sy where ddate = '2018-12-24'
;
SQL结束执行时间：20190814183510
SQL开始执行时间：20190814183510
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183510

20190814183511开始执行2018-12-25数据加载日志:
SQL开始执行时间：20190814183511




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183511
SQL开始执行时间：20190814183511
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-25'

;
SQL结束执行时间：20190814183514
SQL开始执行时间：20190814183514


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183514
SQL开始执行时间：20190814183514
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183535
SQL开始执行时间：20190814183535

delete from edw.checklist_sy where ddate = '2018-12-25'
;
SQL结束执行时间：20190814183536
SQL开始执行时间：20190814183536
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183536

20190814183537开始执行2018-12-26数据加载日志:
SQL开始执行时间：20190814183537




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183537
SQL开始执行时间：20190814183537
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-26'

;
SQL结束执行时间：20190814183540
SQL开始执行时间：20190814183540


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183540
SQL开始执行时间：20190814183540
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183600
SQL开始执行时间：20190814183600

delete from edw.checklist_sy where ddate = '2018-12-26'
;
SQL结束执行时间：20190814183601
SQL开始执行时间：20190814183601
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183601

20190814183601开始执行2018-12-27数据加载日志:
SQL开始执行时间：20190814183602




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183602
SQL开始执行时间：20190814183602
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-27'

;
SQL结束执行时间：20190814183605
SQL开始执行时间：20190814183605


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183605
SQL开始执行时间：20190814183605
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183621
SQL开始执行时间：20190814183621

delete from edw.checklist_sy where ddate = '2018-12-27'
;
SQL结束执行时间：20190814183621
SQL开始执行时间：20190814183621
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183622

20190814183622开始执行2018-12-28数据加载日志:
SQL开始执行时间：20190814183622




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183622
SQL开始执行时间：20190814183622
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-28'

;
SQL结束执行时间：20190814183626
SQL开始执行时间：20190814183626


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183626
SQL开始执行时间：20190814183626
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183639
SQL开始执行时间：20190814183639

delete from edw.checklist_sy where ddate = '2018-12-28'
;
SQL结束执行时间：20190814183640
SQL开始执行时间：20190814183640
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183641

20190814183641开始执行2018-12-29数据加载日志:
SQL开始执行时间：20190814183641




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183641
SQL开始执行时间：20190814183641
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-29'

;
SQL结束执行时间：20190814183644
SQL开始执行时间：20190814183644


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183644
SQL开始执行时间：20190814183644
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183657
SQL开始执行时间：20190814183657

delete from edw.checklist_sy where ddate = '2018-12-29'
;
SQL结束执行时间：20190814183658
SQL开始执行时间：20190814183658
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183659

20190814183659开始执行2018-12-30数据加载日志:
SQL开始执行时间：20190814183659




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183659
SQL开始执行时间：20190814183659
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-30'

;
SQL结束执行时间：20190814183702
SQL开始执行时间：20190814183702


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183702
SQL开始执行时间：20190814183702
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183702
SQL开始执行时间：20190814183702

delete from edw.checklist_sy where ddate = '2018-12-30'
;
SQL结束执行时间：20190814183703
SQL开始执行时间：20190814183703
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183703

20190814183703开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190814183703




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190814183703
SQL开始执行时间：20190814183703
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2018-12-31'

;
SQL结束执行时间：20190814183707
SQL开始执行时间：20190814183707


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190814183707
SQL开始执行时间：20190814183707
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190814183708
SQL开始执行时间：20190814183708

delete from edw.checklist_sy where ddate = '2018-12-31'
;
SQL结束执行时间：20190814183709
SQL开始执行时间：20190814183709
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190814183709

20190925112425开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190925112425




drop table if exists edw.checklist_sy_pre
;
SQL结束执行时间：20190925112425
SQL开始执行时间：20190925112425
create temporary table edw.checklist_sy_pre as
select * 
  from share.neo_amount_experiment_date 
 where experiment_date = '2019-09-25'

;
SQL结束执行时间：20190925112429
SQL开始执行时间：20190925112429


drop table if exists edw.mid1_checklist_sy
;
SQL结束执行时间：20190925112429
SQL开始执行时间：20190925112429
create temporary table edw.mid1_checklist_sy as
select a.conclusion
      ,a.experiment_date
      ,a.hospital
      ,case when b.ccusname is null then '请核查' else b.bi_cuscode end as company_id
      ,case when b.ccusname is null then '请核查' else b.bi_cusname end as company_exp
      ,a.collection_hospital
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cuscode end) else c.bi_cuscode end as bi_cuscode
      ,case when c.ccusname is null then (case when d.ccusname is null then '请核查' else d.bi_cusname end) else c.bi_cusname end as bi_cusname
      ,a.amount
      ,case when a.project = 'G6PD检测' then 'XS0104'
            when a.project = 'OHP检测' then 'XS0103'
            when a.project = 'PHE检测' then 'XS0106'
            when a.project = 'TSH检测' then 'XS0108'
            else 'XS0301' end as item_code
      ,case when a.project = 'G6PD检测' then 'G6PD'
            when a.project = 'OHP检测' then '17α-OH-P'
            when a.project = 'PHE检测' then 'PKU'
            when a.project = 'TSH检测' then 'TSH'
            else '串联试剂' end as item_name
  from edw.checklist_sy_pre a
  left join (select * from edw.dic_customer group by ccusname) b
    on a.hospital = b.ccusname
  left join (select * from edw.dic_customer group by ccusname) c
    on a.collection_hospital = c.ccusname
  left join (select * from edw.dic_customer group by ccusname) d
    on concat(a.hospital,'-',a.collection_hospital) = d.ccusname

;
SQL结束执行时间：20190925112429
SQL开始执行时间：20190925112429

delete from edw.checklist_sy where ddate = '2019-09-25'
;
SQL结束执行时间：20190925112431
SQL开始执行时间：20190925112431
insert into edw.checklist_sy
select c.province
      ,b.p_charge
      ,a.experiment_date
      ,a.hospital
      ,a.company_id
      ,a.company_exp
      ,a.experiment_date
      ,a.collection_hospital
      ,a.bi_cuscode
      ,a.bi_cusname
      ,a.item_code
      ,a.item_name
      ,d.business_class
      ,a.amount
      ,a.conclusion
      ,localtimestamp()
  from edw.mid1_checklist_sy a
  left join (select * from edw.map_cusitem_person group by ccuscode,item_code) b
    on a.bi_cuscode = b.ccuscode
   and a.item_code = b.item_code
  left join (select * from edw.map_customer group by bi_cuscode) c
    on a.bi_cuscode  = c.bi_cuscode
  left join (select * from edw.map_inventory group by item_code) d
    on a.item_code  = d.item_code

;
SQL结束执行时间：20190925112431
