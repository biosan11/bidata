
20190320085642开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190320085642


create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-20'
;
SQL结束执行时间：20190320085643
SQL开始执行时间：20190320085643

delete from edw.inventory where end_date >= '2019-03-20' and end_date < '3000-12-31'
;
SQL结束执行时间：20190320085643
SQL开始执行时间：20190320085643

UPDATE edw.inventory set end_date = '2019-03-20' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190320085643
SQL开始执行时间：20190320085643


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;

20190320090016开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190320090016


create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-18'
;
SQL结束执行时间：20190320090016
SQL开始执行时间：20190320090016

delete from edw.inventory where end_date >= '2019-03-18' and end_date < '3000-12-31'
;
SQL结束执行时间：20190320090016
SQL开始执行时间：20190320090016

UPDATE edw.inventory set end_date = '2019-03-18' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190320090018
SQL开始执行时间：20190320090018


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;

20190320090313开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190320090313


use edw
;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-20'
;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313

delete from edw.inventory where end_date >= '2019-03-20' and end_date < '3000-12-31'
;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313

UPDATE edw.inventory set end_date = '2019-03-20' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190320090313
SQL开始执行时间：20190320090313

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190320090313

20190321021500开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190321021500


use edw
;
SQL结束执行时间：20190321021500
SQL开始执行时间：20190321021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-21'
;
SQL结束执行时间：20190321021500
SQL开始执行时间：20190321021500

delete from edw.inventory where end_date >= '2019-03-21' and end_date < '3000-12-31'
;
SQL结束执行时间：20190321021500
SQL开始执行时间：20190321021500

UPDATE edw.inventory set end_date = '2019-03-21' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190321021501
SQL开始执行时间：20190321021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190321021501
SQL开始执行时间：20190321021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190321021501
SQL开始执行时间：20190321021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190321021501

20190322021500开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190322021500


use edw
;
SQL结束执行时间：20190322021500
SQL开始执行时间：20190322021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-22'
;
SQL结束执行时间：20190322021500
SQL开始执行时间：20190322021500

delete from edw.inventory where end_date >= '2019-03-22' and end_date < '3000-12-31'
;
SQL结束执行时间：20190322021500
SQL开始执行时间：20190322021500

UPDATE edw.inventory set end_date = '2019-03-22' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190322021501
SQL开始执行时间：20190322021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190322021501
SQL开始执行时间：20190322021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190322021501
SQL开始执行时间：20190322021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190322021501

20190323021500开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190323021500


use edw
;
SQL结束执行时间：20190323021500
SQL开始执行时间：20190323021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-23'
;
SQL结束执行时间：20190323021500
SQL开始执行时间：20190323021500

delete from edw.inventory where end_date >= '2019-03-23' and end_date < '3000-12-31'
;
SQL结束执行时间：20190323021500
SQL开始执行时间：20190323021500

UPDATE edw.inventory set end_date = '2019-03-23' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190323021501
SQL开始执行时间：20190323021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190323021501
SQL开始执行时间：20190323021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190323021501
SQL开始执行时间：20190323021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190323021501

20190324021500开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190324021500


use edw
;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-24'
;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500

delete from edw.inventory where end_date >= '2019-03-24' and end_date < '3000-12-31'
;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500

UPDATE edw.inventory set end_date = '2019-03-24' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190324021500
SQL开始执行时间：20190324021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190324021500

20190325021500开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190325021500


use edw
;
SQL结束执行时间：20190325021500
SQL开始执行时间：20190325021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-25'
;
SQL结束执行时间：20190325021500
SQL开始执行时间：20190325021500

delete from edw.inventory where end_date >= '2019-03-25' and end_date < '3000-12-31'
;
SQL结束执行时间：20190325021500
SQL开始执行时间：20190325021500

UPDATE edw.inventory set end_date = '2019-03-25' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190325021501
SQL开始执行时间：20190325021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190325021501
SQL开始执行时间：20190325021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190325021501
SQL开始执行时间：20190325021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190325021501

20190326021500开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190326021500


use edw
;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-26'
;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500

delete from edw.inventory where end_date >= '2019-03-26' and end_date < '3000-12-31'
;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500

UPDATE edw.inventory set end_date = '2019-03-26' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190326021500
SQL开始执行时间：20190326021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190326021500

20190327021500开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190327021500


use edw
;
SQL结束执行时间：20190327021500
SQL开始执行时间：20190327021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-27'
;
SQL结束执行时间：20190327021500
SQL开始执行时间：20190327021500

delete from edw.inventory where end_date >= '2019-03-27' and end_date < '3000-12-31'
;
SQL结束执行时间：20190327021500
SQL开始执行时间：20190327021500

UPDATE edw.inventory set end_date = '2019-03-27' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190327021501
SQL开始执行时间：20190327021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190327021501
SQL开始执行时间：20190327021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190327021501
SQL开始执行时间：20190327021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190327021501

20190328021500开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190328021500


use edw
;
SQL结束执行时间：20190328021500
SQL开始执行时间：20190328021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-28'
;
SQL结束执行时间：20190328021500
SQL开始执行时间：20190328021500

delete from edw.inventory where end_date >= '2019-03-28' and end_date < '3000-12-31'
;
SQL结束执行时间：20190328021500
SQL开始执行时间：20190328021500

UPDATE edw.inventory set end_date = '2019-03-28' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190328021501
SQL开始执行时间：20190328021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190328021501
SQL开始执行时间：20190328021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190328021501
SQL开始执行时间：20190328021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190328021501

20190329021500开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190329021500


use edw
;
SQL结束执行时间：20190329021500
SQL开始执行时间：20190329021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-29'
;
SQL结束执行时间：20190329021500
SQL开始执行时间：20190329021500

delete from edw.inventory where end_date >= '2019-03-29' and end_date < '3000-12-31'
;
SQL结束执行时间：20190329021501
SQL开始执行时间：20190329021501

UPDATE edw.inventory set end_date = '2019-03-29' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190329021501
SQL开始执行时间：20190329021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190329021501
SQL开始执行时间：20190329021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190329021501
SQL开始执行时间：20190329021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190329021501

20190330021500开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190330021500


use edw
;
SQL结束执行时间：20190330021500
SQL开始执行时间：20190330021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-30'
;
SQL结束执行时间：20190330021501
SQL开始执行时间：20190330021501

delete from edw.inventory where end_date >= '2019-03-30' and end_date < '3000-12-31'
;
SQL结束执行时间：20190330021501
SQL开始执行时间：20190330021501

UPDATE edw.inventory set end_date = '2019-03-30' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190330021501
SQL开始执行时间：20190330021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190330021501
SQL开始执行时间：20190330021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190330021501
SQL开始执行时间：20190330021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190330021501

20190331021500开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190331021500


use edw
;
SQL结束执行时间：20190331021500
SQL开始执行时间：20190331021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-03-31'
;
SQL结束执行时间：20190331021500
SQL开始执行时间：20190331021500

delete from edw.inventory where end_date >= '2019-03-31' and end_date < '3000-12-31'
;
SQL结束执行时间：20190331021500
SQL开始执行时间：20190331021500

UPDATE edw.inventory set end_date = '2019-03-31' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190331021501
SQL开始执行时间：20190331021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190331021501
SQL开始执行时间：20190331021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190331021501
SQL开始执行时间：20190331021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190331021501

20190401021500开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190401021500


use edw
;
SQL结束执行时间：20190401021500
SQL开始执行时间：20190401021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-01'
;
SQL结束执行时间：20190401021500
SQL开始执行时间：20190401021500

delete from edw.inventory where end_date >= '2019-04-01' and end_date < '3000-12-31'
;
SQL结束执行时间：20190401021500
SQL开始执行时间：20190401021500

UPDATE edw.inventory set end_date = '2019-04-01' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190401021501
SQL开始执行时间：20190401021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190401021501
SQL开始执行时间：20190401021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190401021501
SQL开始执行时间：20190401021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190401021501

20190402021500开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190402021500


use edw
;
SQL结束执行时间：20190402021500
SQL开始执行时间：20190402021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-02'
;
SQL结束执行时间：20190402021500
SQL开始执行时间：20190402021500

delete from edw.inventory where end_date >= '2019-04-02' and end_date < '3000-12-31'
;
SQL结束执行时间：20190402021500
SQL开始执行时间：20190402021500

UPDATE edw.inventory set end_date = '2019-04-02' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190402021501
SQL开始执行时间：20190402021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190402021501
SQL开始执行时间：20190402021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190402021501
SQL开始执行时间：20190402021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190402021501

20190403021500开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190403021500


use edw
;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-03'
;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500

delete from edw.inventory where end_date >= '2019-04-03' and end_date < '3000-12-31'
;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500

UPDATE edw.inventory set end_date = '2019-04-03' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190403021500
SQL开始执行时间：20190403021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190403021500

20190404021500开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190404021500


use edw
;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-04'
;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500

delete from edw.inventory where end_date >= '2019-04-04' and end_date < '3000-12-31'
;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500

UPDATE edw.inventory set end_date = '2019-04-04' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190404021500
SQL开始执行时间：20190404021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190404021500

20190405021500开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190405021500


use edw
;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-05'
;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500

delete from edw.inventory where end_date >= '2019-04-05' and end_date < '3000-12-31'
;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500

UPDATE edw.inventory set end_date = '2019-04-05' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190405021500
SQL开始执行时间：20190405021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190405021500

20190406021500开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190406021500


use edw
;
SQL结束执行时间：20190406021500
SQL开始执行时间：20190406021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-06'
;
SQL结束执行时间：20190406021500
SQL开始执行时间：20190406021500

delete from edw.inventory where end_date >= '2019-04-06' and end_date < '3000-12-31'
;
SQL结束执行时间：20190406021500
SQL开始执行时间：20190406021500

UPDATE edw.inventory set end_date = '2019-04-06' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190406021501
SQL开始执行时间：20190406021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190406021501
SQL开始执行时间：20190406021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190406021501
SQL开始执行时间：20190406021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190406021501

20190407021500开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190407021500


use edw
;
SQL结束执行时间：20190407021500
SQL开始执行时间：20190407021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-07'
;
SQL结束执行时间：20190407021500
SQL开始执行时间：20190407021500

delete from edw.inventory where end_date >= '2019-04-07' and end_date < '3000-12-31'
;
SQL结束执行时间：20190407021500
SQL开始执行时间：20190407021500

UPDATE edw.inventory set end_date = '2019-04-07' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190407021501
SQL开始执行时间：20190407021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190407021501
SQL开始执行时间：20190407021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190407021501
SQL开始执行时间：20190407021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190407021501

20190408021500开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190408021500


use edw
;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-08'
;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500

delete from edw.inventory where end_date >= '2019-04-08' and end_date < '3000-12-31'
;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500

UPDATE edw.inventory set end_date = '2019-04-08' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190408021500
SQL开始执行时间：20190408021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190408021500

20190409021500开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190409021500


use edw
;
SQL结束执行时间：20190409021500
SQL开始执行时间：20190409021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-09'
;
SQL结束执行时间：20190409021500
SQL开始执行时间：20190409021500

delete from edw.inventory where end_date >= '2019-04-09' and end_date < '3000-12-31'
;
SQL结束执行时间：20190409021500
SQL开始执行时间：20190409021500

UPDATE edw.inventory set end_date = '2019-04-09' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190409021501
SQL开始执行时间：20190409021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190409021501
SQL开始执行时间：20190409021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190409021501
SQL开始执行时间：20190409021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190409021501

20190410021500开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410021500


use edw
;
SQL结束执行时间：20190410021500
SQL开始执行时间：20190410021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-09'
;
SQL结束执行时间：20190410021500
SQL开始执行时间：20190410021500

delete from edw.inventory where end_date >= '2019-04-09' and end_date < '3000-12-31'
;
SQL结束执行时间：20190410021500
SQL开始执行时间：20190410021500

UPDATE edw.inventory set end_date = '2019-04-09' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190410021501
SQL开始执行时间：20190410021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190410021501
SQL开始执行时间：20190410021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190410021501
SQL开始执行时间：20190410021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190410021501

20190411021500开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411021500


use edw
;
SQL结束执行时间：20190411021500
SQL开始执行时间：20190411021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-10'
;
SQL结束执行时间：20190411021500
SQL开始执行时间：20190411021500

delete from edw.inventory where end_date >= '2019-04-10' and end_date < '3000-12-31'
;
SQL结束执行时间：20190411021500
SQL开始执行时间：20190411021500

UPDATE edw.inventory set end_date = '2019-04-10' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190411021502
SQL开始执行时间：20190411021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190411021502
SQL开始执行时间：20190411021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190411021502
SQL开始执行时间：20190411021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190411021502

20190412021500开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412021500


use edw
;
SQL结束执行时间：20190412021500
SQL开始执行时间：20190412021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-11'
;
SQL结束执行时间：20190412021500
SQL开始执行时间：20190412021500

delete from edw.inventory where end_date >= '2019-04-11' and end_date < '3000-12-31'
;
SQL结束执行时间：20190412021500
SQL开始执行时间：20190412021500

UPDATE edw.inventory set end_date = '2019-04-11' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190412021502
SQL开始执行时间：20190412021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190412021502
SQL开始执行时间：20190412021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190412021502
SQL开始执行时间：20190412021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190412021502

20190413021500开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413021500


use edw
;
SQL结束执行时间：20190413021500
SQL开始执行时间：20190413021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-12'
;
SQL结束执行时间：20190413021500
SQL开始执行时间：20190413021500

delete from edw.inventory where end_date >= '2019-04-12' and end_date < '3000-12-31'
;
SQL结束执行时间：20190413021500
SQL开始执行时间：20190413021500

UPDATE edw.inventory set end_date = '2019-04-12' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190413021502
SQL开始执行时间：20190413021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190413021502
SQL开始执行时间：20190413021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190413021502
SQL开始执行时间：20190413021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190413021502

20190414021500开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414021500


use edw
;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-13'
;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500

delete from edw.inventory where end_date >= '2019-04-13' and end_date < '3000-12-31'
;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500

UPDATE edw.inventory set end_date = '2019-04-13' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190414021500
SQL开始执行时间：20190414021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190414021500

20190415021500开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415021500


use edw
;
SQL结束执行时间：20190415021500
SQL开始执行时间：20190415021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-14'
;
SQL结束执行时间：20190415021500
SQL开始执行时间：20190415021500

delete from edw.inventory where end_date >= '2019-04-14' and end_date < '3000-12-31'
;
SQL结束执行时间：20190415021500
SQL开始执行时间：20190415021500

UPDATE edw.inventory set end_date = '2019-04-14' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190415021501
SQL开始执行时间：20190415021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190415021501
SQL开始执行时间：20190415021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190415021501
SQL开始执行时间：20190415021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190415021501

20190416021500开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416021500


use edw
;
SQL结束执行时间：20190416021500
SQL开始执行时间：20190416021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-15'
;
SQL结束执行时间：20190416021500
SQL开始执行时间：20190416021500

delete from edw.inventory where end_date >= '2019-04-15' and end_date < '3000-12-31'
;
SQL结束执行时间：20190416021500
SQL开始执行时间：20190416021500

UPDATE edw.inventory set end_date = '2019-04-15' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190416021501
SQL开始执行时间：20190416021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190416021501
SQL开始执行时间：20190416021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190416021501
SQL开始执行时间：20190416021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190416021501

20190417021500开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417021500


use edw
;
SQL结束执行时间：20190417021500
SQL开始执行时间：20190417021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-16'
;
SQL结束执行时间：20190417021501
SQL开始执行时间：20190417021501

delete from edw.inventory where end_date >= '2019-04-16' and end_date < '3000-12-31'
;
SQL结束执行时间：20190417021501
SQL开始执行时间：20190417021501

UPDATE edw.inventory set end_date = '2019-04-16' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190417021503
SQL开始执行时间：20190417021503


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190417021503
SQL开始执行时间：20190417021503
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190417021503
SQL开始执行时间：20190417021503

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190417021503

20190418021500开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418021500


use edw
;
SQL结束执行时间：20190418021500
SQL开始执行时间：20190418021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-17'
;
SQL结束执行时间：20190418021500
SQL开始执行时间：20190418021500

delete from edw.inventory where end_date >= '2019-04-17' and end_date < '3000-12-31'
;
SQL结束执行时间：20190418021500
SQL开始执行时间：20190418021500

UPDATE edw.inventory set end_date = '2019-04-17' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190418021502
SQL开始执行时间：20190418021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190418021502
SQL开始执行时间：20190418021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190418021502
SQL开始执行时间：20190418021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190418021502

20190419021500开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419021500


use edw
;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-18'
;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500

delete from edw.inventory where end_date >= '2019-04-18' and end_date < '3000-12-31'
;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500

UPDATE edw.inventory set end_date = '2019-04-18' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190419021500
SQL开始执行时间：20190419021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190419021500

20190420021500开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420021500


use edw
;
SQL结束执行时间：20190420021500
SQL开始执行时间：20190420021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-19'
;
SQL结束执行时间：20190420021500
SQL开始执行时间：20190420021500

delete from edw.inventory where end_date >= '2019-04-19' and end_date < '3000-12-31'
;
SQL结束执行时间：20190420021500
SQL开始执行时间：20190420021500

UPDATE edw.inventory set end_date = '2019-04-19' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190420021501
SQL开始执行时间：20190420021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190420021502
SQL开始执行时间：20190420021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190420021502
SQL开始执行时间：20190420021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190420021502

20190421021500开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421021500


use edw
;
SQL结束执行时间：20190421021500
SQL开始执行时间：20190421021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-20'
;
SQL结束执行时间：20190421021500
SQL开始执行时间：20190421021500

delete from edw.inventory where end_date >= '2019-04-20' and end_date < '3000-12-31'
;
SQL结束执行时间：20190421021500
SQL开始执行时间：20190421021500

UPDATE edw.inventory set end_date = '2019-04-20' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190421021501
SQL开始执行时间：20190421021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190421021501
SQL开始执行时间：20190421021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190421021501
SQL开始执行时间：20190421021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190421021501

20190422021500开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422021500


use edw
;
SQL结束执行时间：20190422021500
SQL开始执行时间：20190422021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-21'
;
SQL结束执行时间：20190422021500
SQL开始执行时间：20190422021500

delete from edw.inventory where end_date >= '2019-04-21' and end_date < '3000-12-31'
;
SQL结束执行时间：20190422021500
SQL开始执行时间：20190422021500

UPDATE edw.inventory set end_date = '2019-04-21' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190422021501
SQL开始执行时间：20190422021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190422021501
SQL开始执行时间：20190422021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190422021501
SQL开始执行时间：20190422021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190422021501

20190423021500开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423021500


use edw
;
SQL结束执行时间：20190423021500
SQL开始执行时间：20190423021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-22'
;
SQL结束执行时间：20190423021500
SQL开始执行时间：20190423021500

delete from edw.inventory where end_date >= '2019-04-22' and end_date < '3000-12-31'
;
SQL结束执行时间：20190423021500
SQL开始执行时间：20190423021500

UPDATE edw.inventory set end_date = '2019-04-22' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190423021712
SQL开始执行时间：20190423021712


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190423021712
SQL开始执行时间：20190423021712
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190423021712
SQL开始执行时间：20190423021712

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190423021713

20190424021500开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424021500


use edw
;
SQL结束执行时间：20190424021500
SQL开始执行时间：20190424021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-23'
;
SQL结束执行时间：20190424021500
SQL开始执行时间：20190424021500

delete from edw.inventory where end_date >= '2019-04-23' and end_date < '3000-12-31'
;
SQL结束执行时间：20190424021500
SQL开始执行时间：20190424021500

UPDATE edw.inventory set end_date = '2019-04-23' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190424021502
SQL开始执行时间：20190424021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190424021502
SQL开始执行时间：20190424021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190424021502
SQL开始执行时间：20190424021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190424021502

20190425021501开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425021501


use edw
;
SQL结束执行时间：20190425021501
SQL开始执行时间：20190425021501
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-24'
;
SQL结束执行时间：20190425021501
SQL开始执行时间：20190425021501

delete from edw.inventory where end_date >= '2019-04-24' and end_date < '3000-12-31'
;
SQL结束执行时间：20190425021501
SQL开始执行时间：20190425021501

UPDATE edw.inventory set end_date = '2019-04-24' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190425021502
SQL开始执行时间：20190425021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190425021502
SQL开始执行时间：20190425021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190425021502
SQL开始执行时间：20190425021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190425021502

20190426021500开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426021500


use edw
;
SQL结束执行时间：20190426021500
SQL开始执行时间：20190426021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-25'
;
SQL结束执行时间：20190426021500
SQL开始执行时间：20190426021500

delete from edw.inventory where end_date >= '2019-04-25' and end_date < '3000-12-31'
;
SQL结束执行时间：20190426021500
SQL开始执行时间：20190426021500

UPDATE edw.inventory set end_date = '2019-04-25' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190426021502
SQL开始执行时间：20190426021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190426021502
SQL开始执行时间：20190426021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190426021502
SQL开始执行时间：20190426021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190426021502

20190427021500开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427021500


use edw
;
SQL结束执行时间：20190427021500
SQL开始执行时间：20190427021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-26'
;
SQL结束执行时间：20190427021500
SQL开始执行时间：20190427021500

delete from edw.inventory where end_date >= '2019-04-26' and end_date < '3000-12-31'
;
SQL结束执行时间：20190427021500
SQL开始执行时间：20190427021500

UPDATE edw.inventory set end_date = '2019-04-26' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190427021502
SQL开始执行时间：20190427021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190427021502
SQL开始执行时间：20190427021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190427021502
SQL开始执行时间：20190427021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190427021502

20190428021500开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428021500


use edw
;
SQL结束执行时间：20190428021500
SQL开始执行时间：20190428021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-27'
;
SQL结束执行时间：20190428021500
SQL开始执行时间：20190428021500

delete from edw.inventory where end_date >= '2019-04-27' and end_date < '3000-12-31'
;
SQL结束执行时间：20190428021500
SQL开始执行时间：20190428021500

UPDATE edw.inventory set end_date = '2019-04-27' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190428021501
SQL开始执行时间：20190428021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190428021501
SQL开始执行时间：20190428021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190428021501
SQL开始执行时间：20190428021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190428021501

20190429021500开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429021500


use edw
;
SQL结束执行时间：20190429021500
SQL开始执行时间：20190429021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-28'
;
SQL结束执行时间：20190429021500
SQL开始执行时间：20190429021500

delete from edw.inventory where end_date >= '2019-04-28' and end_date < '3000-12-31'
;
SQL结束执行时间：20190429021500
SQL开始执行时间：20190429021500

UPDATE edw.inventory set end_date = '2019-04-28' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190429021502
SQL开始执行时间：20190429021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190429021502
SQL开始执行时间：20190429021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190429021502
SQL开始执行时间：20190429021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190429021502

20190430021500开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430021500


use edw
;
SQL结束执行时间：20190430021500
SQL开始执行时间：20190430021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-29'
;
SQL结束执行时间：20190430021500
SQL开始执行时间：20190430021500

delete from edw.inventory where end_date >= '2019-04-29' and end_date < '3000-12-31'
;
SQL结束执行时间：20190430021500
SQL开始执行时间：20190430021500

UPDATE edw.inventory set end_date = '2019-04-29' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190430021501
SQL开始执行时间：20190430021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190430021501
SQL开始执行时间：20190430021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190430021501
SQL开始执行时间：20190430021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190430021501

20190501021500开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501021500


use edw
;
SQL结束执行时间：20190501021500
SQL开始执行时间：20190501021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-04-30'
;
SQL结束执行时间：20190501021500
SQL开始执行时间：20190501021500

delete from edw.inventory where end_date >= '2019-04-30' and end_date < '3000-12-31'
;
SQL结束执行时间：20190501021500
SQL开始执行时间：20190501021500

UPDATE edw.inventory set end_date = '2019-04-30' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190501021514
SQL开始执行时间：20190501021514


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190501021514
SQL开始执行时间：20190501021514
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190501021514
SQL开始执行时间：20190501021514

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190501021514

20190502021500开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502021500


use edw
;
SQL结束执行时间：20190502021500
SQL开始执行时间：20190502021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-01'
;
SQL结束执行时间：20190502021500
SQL开始执行时间：20190502021500

delete from edw.inventory where end_date >= '2019-05-01' and end_date < '3000-12-31'
;
SQL结束执行时间：20190502021500
SQL开始执行时间：20190502021500

UPDATE edw.inventory set end_date = '2019-05-01' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190502021501
SQL开始执行时间：20190502021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190502021501
SQL开始执行时间：20190502021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190502021501
SQL开始执行时间：20190502021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190502021501

20190503021500开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503021500


use edw
;
SQL结束执行时间：20190503021500
SQL开始执行时间：20190503021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-02'
;
SQL结束执行时间：20190503021500
SQL开始执行时间：20190503021500

delete from edw.inventory where end_date >= '2019-05-02' and end_date < '3000-12-31'
;
SQL结束执行时间：20190503021500
SQL开始执行时间：20190503021500

UPDATE edw.inventory set end_date = '2019-05-02' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190503021501
SQL开始执行时间：20190503021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190503021501
SQL开始执行时间：20190503021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190503021501
SQL开始执行时间：20190503021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190503021501

20190504021501开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504021501


use edw
;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-03'
;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501

delete from edw.inventory where end_date >= '2019-05-03' and end_date < '3000-12-31'
;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501

UPDATE edw.inventory set end_date = '2019-05-03' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190504021501
SQL开始执行时间：20190504021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190504021501

20190505021500开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505021500


use edw
;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-04'
;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500

delete from edw.inventory where end_date >= '2019-05-04' and end_date < '3000-12-31'
;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500

UPDATE edw.inventory set end_date = '2019-05-04' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190505021500
SQL开始执行时间：20190505021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190505021500

20190506021500开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506021500


use edw
;
SQL结束执行时间：20190506021500
SQL开始执行时间：20190506021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-05'
;
SQL结束执行时间：20190506021500
SQL开始执行时间：20190506021500

delete from edw.inventory where end_date >= '2019-05-05' and end_date < '3000-12-31'
;
SQL结束执行时间：20190506021500
SQL开始执行时间：20190506021500

UPDATE edw.inventory set end_date = '2019-05-05' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190506021501
SQL开始执行时间：20190506021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190506021501
SQL开始执行时间：20190506021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190506021501
SQL开始执行时间：20190506021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190506021501

20190507021500开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507021500


use edw
;
SQL结束执行时间：20190507021500
SQL开始执行时间：20190507021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-06'
;
SQL结束执行时间：20190507021500
SQL开始执行时间：20190507021500

delete from edw.inventory where end_date >= '2019-05-06' and end_date < '3000-12-31'
;
SQL结束执行时间：20190507021500
SQL开始执行时间：20190507021500

UPDATE edw.inventory set end_date = '2019-05-06' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190507021501
SQL开始执行时间：20190507021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190507021501
SQL开始执行时间：20190507021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190507021501
SQL开始执行时间：20190507021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190507021501

20190508021500开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508021500


use edw
;
SQL结束执行时间：20190508021500
SQL开始执行时间：20190508021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-07'
;
SQL结束执行时间：20190508021500
SQL开始执行时间：20190508021500

delete from edw.inventory where end_date >= '2019-05-07' and end_date < '3000-12-31'
;
SQL结束执行时间：20190508021501
SQL开始执行时间：20190508021501

UPDATE edw.inventory set end_date = '2019-05-07' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190508021502
SQL开始执行时间：20190508021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190508021502
SQL开始执行时间：20190508021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190508021502
SQL开始执行时间：20190508021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190508021502

20190510021500开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510021500


use edw
;
SQL结束执行时间：20190510021500
SQL开始执行时间：20190510021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-09'
;
SQL结束执行时间：20190510021500
SQL开始执行时间：20190510021500

delete from edw.inventory where end_date >= '2019-05-09' and end_date < '3000-12-31'
;
SQL结束执行时间：20190510021501
SQL开始执行时间：20190510021501

UPDATE edw.inventory set end_date = '2019-05-09' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190510021502
SQL开始执行时间：20190510021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190510021502
SQL开始执行时间：20190510021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190510021502
SQL开始执行时间：20190510021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190510021502

20190511021500开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511021500


use edw
;
SQL结束执行时间：20190511021500
SQL开始执行时间：20190511021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-10'
;
SQL结束执行时间：20190511021500
SQL开始执行时间：20190511021500

delete from edw.inventory where end_date >= '2019-05-10' and end_date < '3000-12-31'
;
SQL结束执行时间：20190511021500
SQL开始执行时间：20190511021500

UPDATE edw.inventory set end_date = '2019-05-10' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190511021501
SQL开始执行时间：20190511021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190511021501
SQL开始执行时间：20190511021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190511021501
SQL开始执行时间：20190511021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190511021501

20190512021500开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512021500


use edw
;
SQL结束执行时间：20190512021500
SQL开始执行时间：20190512021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-11'
;
SQL结束执行时间：20190512021500
SQL开始执行时间：20190512021500

delete from edw.inventory where end_date >= '2019-05-11' and end_date < '3000-12-31'
;
SQL结束执行时间：20190512021501
SQL开始执行时间：20190512021501

UPDATE edw.inventory set end_date = '2019-05-11' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190512021501
SQL开始执行时间：20190512021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190512021501
SQL开始执行时间：20190512021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190512021501
SQL开始执行时间：20190512021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190512021501

20190513021500开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513021500


use edw
;
SQL结束执行时间：20190513021500
SQL开始执行时间：20190513021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-12'
;
SQL结束执行时间：20190513021500
SQL开始执行时间：20190513021500

delete from edw.inventory where end_date >= '2019-05-12' and end_date < '3000-12-31'
;
SQL结束执行时间：20190513021500
SQL开始执行时间：20190513021500

UPDATE edw.inventory set end_date = '2019-05-12' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190513021501
SQL开始执行时间：20190513021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190513021501
SQL开始执行时间：20190513021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190513021501
SQL开始执行时间：20190513021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190513021501

20190514021500开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514021500


use edw
;
SQL结束执行时间：20190514021500
SQL开始执行时间：20190514021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-13'
;
SQL结束执行时间：20190514021500
SQL开始执行时间：20190514021500

delete from edw.inventory where end_date >= '2019-05-13' and end_date < '3000-12-31'
;
SQL结束执行时间：20190514021501
SQL开始执行时间：20190514021501

UPDATE edw.inventory set end_date = '2019-05-13' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190514021502
SQL开始执行时间：20190514021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190514021502
SQL开始执行时间：20190514021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190514021502
SQL开始执行时间：20190514021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190514021502

20190515021500开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515021500


use edw
;
SQL结束执行时间：20190515021500
SQL开始执行时间：20190515021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-14'
;
SQL结束执行时间：20190515021500
SQL开始执行时间：20190515021500

delete from edw.inventory where end_date >= '2019-05-14' and end_date < '3000-12-31'
;
SQL结束执行时间：20190515021500
SQL开始执行时间：20190515021500

UPDATE edw.inventory set end_date = '2019-05-14' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190515021502
SQL开始执行时间：20190515021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190515021502
SQL开始执行时间：20190515021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190515021502
SQL开始执行时间：20190515021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190515021502

20190516021500开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516021500


use edw
;
SQL结束执行时间：20190516021500
SQL开始执行时间：20190516021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-15'
;
SQL结束执行时间：20190516021501
SQL开始执行时间：20190516021501

delete from edw.inventory where end_date >= '2019-05-15' and end_date < '3000-12-31'
;
SQL结束执行时间：20190516021501
SQL开始执行时间：20190516021501

UPDATE edw.inventory set end_date = '2019-05-15' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190516021501
SQL开始执行时间：20190516021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190516021501
SQL开始执行时间：20190516021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190516021501
SQL开始执行时间：20190516021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190516021502

20190517021500开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517021500


use edw
;
SQL结束执行时间：20190517021500
SQL开始执行时间：20190517021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-16'
;
SQL结束执行时间：20190517021501
SQL开始执行时间：20190517021501

delete from edw.inventory where end_date >= '2019-05-16' and end_date < '3000-12-31'
;
SQL结束执行时间：20190517021501
SQL开始执行时间：20190517021501

UPDATE edw.inventory set end_date = '2019-05-16' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190517021505
SQL开始执行时间：20190517021505


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190517021505
SQL开始执行时间：20190517021505
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190517021505
SQL开始执行时间：20190517021505

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190517021505

20190518021500开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518021500


use edw
;
SQL结束执行时间：20190518021500
SQL开始执行时间：20190518021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-17'
;
SQL结束执行时间：20190518021500
SQL开始执行时间：20190518021500

delete from edw.inventory where end_date >= '2019-05-17' and end_date < '3000-12-31'
;
SQL结束执行时间：20190518021500
SQL开始执行时间：20190518021500

UPDATE edw.inventory set end_date = '2019-05-17' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190518021501
SQL开始执行时间：20190518021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190518021501
SQL开始执行时间：20190518021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190518021501
SQL开始执行时间：20190518021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190518021501

20190519021500开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519021500


use edw
;
SQL结束执行时间：20190519021500
SQL开始执行时间：20190519021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-18'
;
SQL结束执行时间：20190519021500
SQL开始执行时间：20190519021500

delete from edw.inventory where end_date >= '2019-05-18' and end_date < '3000-12-31'
;
SQL结束执行时间：20190519021500
SQL开始执行时间：20190519021500

UPDATE edw.inventory set end_date = '2019-05-18' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190519021501
SQL开始执行时间：20190519021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190519021501
SQL开始执行时间：20190519021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190519021501
SQL开始执行时间：20190519021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190519021501

20190520021500开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520021500


use edw
;
SQL结束执行时间：20190520021500
SQL开始执行时间：20190520021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-19'
;
SQL结束执行时间：20190520021500
SQL开始执行时间：20190520021500

delete from edw.inventory where end_date >= '2019-05-19' and end_date < '3000-12-31'
;
SQL结束执行时间：20190520021500
SQL开始执行时间：20190520021500

UPDATE edw.inventory set end_date = '2019-05-19' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190520021501
SQL开始执行时间：20190520021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190520021501
SQL开始执行时间：20190520021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190520021501
SQL开始执行时间：20190520021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190520021501

20190521021500开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521021500


use edw
;
SQL结束执行时间：20190521021500
SQL开始执行时间：20190521021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-20'
;
SQL结束执行时间：20190521021500
SQL开始执行时间：20190521021500

delete from edw.inventory where end_date >= '2019-05-20' and end_date < '3000-12-31'
;
SQL结束执行时间：20190521021500
SQL开始执行时间：20190521021500

UPDATE edw.inventory set end_date = '2019-05-20' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190521021503
SQL开始执行时间：20190521021503


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190521021503
SQL开始执行时间：20190521021503
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190521021503
SQL开始执行时间：20190521021503

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190521021503

20190522021500开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522021500


use edw
;
SQL结束执行时间：20190522021500
SQL开始执行时间：20190522021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-21'
;
SQL结束执行时间：20190522021500
SQL开始执行时间：20190522021500

delete from edw.inventory where end_date >= '2019-05-21' and end_date < '3000-12-31'
;
SQL结束执行时间：20190522021500
SQL开始执行时间：20190522021500

UPDATE edw.inventory set end_date = '2019-05-21' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190522021502
SQL开始执行时间：20190522021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190522021502
SQL开始执行时间：20190522021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190522021502
SQL开始执行时间：20190522021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190522021502

20190523021500开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523021500


use edw
;
SQL结束执行时间：20190523021500
SQL开始执行时间：20190523021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-22'
;
SQL结束执行时间：20190523021500
SQL开始执行时间：20190523021500

delete from edw.inventory where end_date >= '2019-05-22' and end_date < '3000-12-31'
;
SQL结束执行时间：20190523021501
SQL开始执行时间：20190523021501

UPDATE edw.inventory set end_date = '2019-05-22' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190523021502
SQL开始执行时间：20190523021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190523021502
SQL开始执行时间：20190523021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190523021502
SQL开始执行时间：20190523021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190523021502

20190524021500开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524021500


use edw
;
SQL结束执行时间：20190524021500
SQL开始执行时间：20190524021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-23'
;
SQL结束执行时间：20190524021500
SQL开始执行时间：20190524021500

delete from edw.inventory where end_date >= '2019-05-23' and end_date < '3000-12-31'
;
SQL结束执行时间：20190524021500
SQL开始执行时间：20190524021500

UPDATE edw.inventory set end_date = '2019-05-23' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190524021502
SQL开始执行时间：20190524021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190524021502
SQL开始执行时间：20190524021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190524021502
SQL开始执行时间：20190524021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190524021502

20190525021500开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525021500


use edw
;
SQL结束执行时间：20190525021500
SQL开始执行时间：20190525021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-24'
;
SQL结束执行时间：20190525021501
SQL开始执行时间：20190525021501

delete from edw.inventory where end_date >= '2019-05-24' and end_date < '3000-12-31'
;
SQL结束执行时间：20190525021501
SQL开始执行时间：20190525021501

UPDATE edw.inventory set end_date = '2019-05-24' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190525021848
SQL开始执行时间：20190525021848


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190525021848
SQL开始执行时间：20190525021848
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190525021848
SQL开始执行时间：20190525021848

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190525021848

20190526021500开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526021500


use edw
;
SQL结束执行时间：20190526021500
SQL开始执行时间：20190526021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-25'
;
SQL结束执行时间：20190526021500
SQL开始执行时间：20190526021500

delete from edw.inventory where end_date >= '2019-05-25' and end_date < '3000-12-31'
;
SQL结束执行时间：20190526021500
SQL开始执行时间：20190526021500

UPDATE edw.inventory set end_date = '2019-05-25' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190526021501
SQL开始执行时间：20190526021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190526021501
SQL开始执行时间：20190526021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190526021501
SQL开始执行时间：20190526021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190526021501

20190527021500开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527021500


use edw
;
SQL结束执行时间：20190527021500
SQL开始执行时间：20190527021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-26'
;
SQL结束执行时间：20190527021500
SQL开始执行时间：20190527021500

delete from edw.inventory where end_date >= '2019-05-26' and end_date < '3000-12-31'
;
SQL结束执行时间：20190527021501
SQL开始执行时间：20190527021501

UPDATE edw.inventory set end_date = '2019-05-26' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190527021501
SQL开始执行时间：20190527021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190527021501
SQL开始执行时间：20190527021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190527021501
SQL开始执行时间：20190527021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190527021501

20190528021500开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528021500


use edw
;
SQL结束执行时间：20190528021500
SQL开始执行时间：20190528021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-27'
;
SQL结束执行时间：20190528021500
SQL开始执行时间：20190528021500

delete from edw.inventory where end_date >= '2019-05-27' and end_date < '3000-12-31'
;
SQL结束执行时间：20190528021500
SQL开始执行时间：20190528021500

UPDATE edw.inventory set end_date = '2019-05-27' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190528021501
SQL开始执行时间：20190528021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190528021501
SQL开始执行时间：20190528021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190528021501
SQL开始执行时间：20190528021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190528021501

20190529021500开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529021500


use edw
;
SQL结束执行时间：20190529021500
SQL开始执行时间：20190529021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-28'
;
SQL结束执行时间：20190529021500
SQL开始执行时间：20190529021500

delete from edw.inventory where end_date >= '2019-05-28' and end_date < '3000-12-31'
;
SQL结束执行时间：20190529021500
SQL开始执行时间：20190529021500

UPDATE edw.inventory set end_date = '2019-05-28' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190529021501
SQL开始执行时间：20190529021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190529021501
SQL开始执行时间：20190529021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190529021501
SQL开始执行时间：20190529021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190529021501

20190530021500开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530021500


use edw
;
SQL结束执行时间：20190530021500
SQL开始执行时间：20190530021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-29'
;
SQL结束执行时间：20190530021501
SQL开始执行时间：20190530021501

delete from edw.inventory where end_date >= '2019-05-29' and end_date < '3000-12-31'
;
SQL结束执行时间：20190530021501
SQL开始执行时间：20190530021501

UPDATE edw.inventory set end_date = '2019-05-29' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190530021502
SQL开始执行时间：20190530021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190530021502
SQL开始执行时间：20190530021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190530021502
SQL开始执行时间：20190530021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190530021502

20190531021500开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531021500


use edw
;
SQL结束执行时间：20190531021500
SQL开始执行时间：20190531021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-30'
;
SQL结束执行时间：20190531021500
SQL开始执行时间：20190531021500

delete from edw.inventory where end_date >= '2019-05-30' and end_date < '3000-12-31'
;
SQL结束执行时间：20190531021500
SQL开始执行时间：20190531021500

UPDATE edw.inventory set end_date = '2019-05-30' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190531021502
SQL开始执行时间：20190531021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190531021502
SQL开始执行时间：20190531021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190531021502
SQL开始执行时间：20190531021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190531021502

20190601021500开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601021500


use edw
;
SQL结束执行时间：20190601021500
SQL开始执行时间：20190601021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-05-31'
;
SQL结束执行时间：20190601021501
SQL开始执行时间：20190601021501

delete from edw.inventory where end_date >= '2019-05-31' and end_date < '3000-12-31'
;
SQL结束执行时间：20190601021501
SQL开始执行时间：20190601021501

UPDATE edw.inventory set end_date = '2019-05-31' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190601021501
SQL开始执行时间：20190601021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190601021501
SQL开始执行时间：20190601021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190601021501
SQL开始执行时间：20190601021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190601021502

20190602021500开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602021500


use edw
;
SQL结束执行时间：20190602021500
SQL开始执行时间：20190602021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-01'
;
SQL结束执行时间：20190602021500
SQL开始执行时间：20190602021500

delete from edw.inventory where end_date >= '2019-06-01' and end_date < '3000-12-31'
;
SQL结束执行时间：20190602021501
SQL开始执行时间：20190602021501

UPDATE edw.inventory set end_date = '2019-06-01' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190602021501
SQL开始执行时间：20190602021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190602021501
SQL开始执行时间：20190602021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190602021501
SQL开始执行时间：20190602021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190602021501

20190603021500开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603021500


use edw
;
SQL结束执行时间：20190603021500
SQL开始执行时间：20190603021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-02'
;
SQL结束执行时间：20190603021500
SQL开始执行时间：20190603021500

delete from edw.inventory where end_date >= '2019-06-02' and end_date < '3000-12-31'
;
SQL结束执行时间：20190603021500
SQL开始执行时间：20190603021500

UPDATE edw.inventory set end_date = '2019-06-02' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190603021501
SQL开始执行时间：20190603021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190603021501
SQL开始执行时间：20190603021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190603021501
SQL开始执行时间：20190603021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190603021501

20190604021500开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604021500


use edw
;
SQL结束执行时间：20190604021500
SQL开始执行时间：20190604021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-03'
;
SQL结束执行时间：20190604021500
SQL开始执行时间：20190604021500

delete from edw.inventory where end_date >= '2019-06-03' and end_date < '3000-12-31'
;
SQL结束执行时间：20190604021500
SQL开始执行时间：20190604021500

UPDATE edw.inventory set end_date = '2019-06-03' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190604021501
SQL开始执行时间：20190604021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190604021501
SQL开始执行时间：20190604021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190604021501
SQL开始执行时间：20190604021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190604021502

20190605021500开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605021500


use edw
;
SQL结束执行时间：20190605021500
SQL开始执行时间：20190605021500
create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-04'
;
SQL结束执行时间：20190605021500
SQL开始执行时间：20190605021500

delete from edw.inventory where end_date >= '2019-06-04' and end_date < '3000-12-31'
;
SQL结束执行时间：20190605021500
SQL开始执行时间：20190605021500

UPDATE edw.inventory set end_date = '2019-06-04' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190605021504
SQL开始执行时间：20190605021504


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190605021504
SQL开始执行时间：20190605021504
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join edw.dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190605021504
SQL开始执行时间：20190605021504

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190605021504

20190606021500开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606021500


create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-05'
;
SQL结束执行时间：20190606021500
SQL开始执行时间：20190606021500

delete from edw.inventory where end_date >= '2019-06-05' and end_date < '3000-12-31'
;
SQL结束执行时间：20190606021500
SQL开始执行时间：20190606021500

UPDATE edw.inventory set end_date = '2019-06-05' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190606021501
SQL开始执行时间：20190606021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;

20190606085956开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606085956


create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-05'
;
SQL结束执行时间：20190606085956
SQL开始执行时间：20190606085956

delete from edw.inventory where end_date >= '2019-06-05' and end_date < '3000-12-31'
;
SQL结束执行时间：20190606085956
SQL开始执行时间：20190606085956

UPDATE edw.inventory set end_date = '2019-06-05' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190606085957
SQL开始执行时间：20190606085957


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190606085957
SQL开始执行时间：20190606085957
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190606085957
SQL开始执行时间：20190606085957

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190606085957

20190607021500开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607021500



use edw
;
SQL结束执行时间：20190607021500
SQL开始执行时间：20190607021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-06'
;
SQL结束执行时间：20190607021500
SQL开始执行时间：20190607021500

delete from edw.inventory where end_date >= '2019-06-06' and end_date < '3000-12-31'
;
SQL结束执行时间：20190607021500
SQL开始执行时间：20190607021500

UPDATE edw.inventory set end_date = '2019-06-06' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190607021502
SQL开始执行时间：20190607021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190607021502
SQL开始执行时间：20190607021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190607021502
SQL开始执行时间：20190607021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190607021502

20190608021500开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608021500



use edw
;
SQL结束执行时间：20190608021500
SQL开始执行时间：20190608021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-07'
;
SQL结束执行时间：20190608021500
SQL开始执行时间：20190608021500

delete from edw.inventory where end_date >= '2019-06-07' and end_date < '3000-12-31'
;
SQL结束执行时间：20190608021500
SQL开始执行时间：20190608021500

UPDATE edw.inventory set end_date = '2019-06-07' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190608021501
SQL开始执行时间：20190608021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190608021501
SQL开始执行时间：20190608021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190608021501
SQL开始执行时间：20190608021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190608021501

20190609021500开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609021500



use edw
;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-08'
;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500

delete from edw.inventory where end_date >= '2019-06-08' and end_date < '3000-12-31'
;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500

UPDATE edw.inventory set end_date = '2019-06-08' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190609021500
SQL开始执行时间：20190609021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190609021500

20190610021500开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610021500



use edw
;
SQL结束执行时间：20190610021500
SQL开始执行时间：20190610021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-09'
;
SQL结束执行时间：20190610021500
SQL开始执行时间：20190610021500

delete from edw.inventory where end_date >= '2019-06-09' and end_date < '3000-12-31'
;
SQL结束执行时间：20190610021500
SQL开始执行时间：20190610021500

UPDATE edw.inventory set end_date = '2019-06-09' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190610021501
SQL开始执行时间：20190610021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190610021501
SQL开始执行时间：20190610021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190610021501
SQL开始执行时间：20190610021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190610021501

20190611021500开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611021500



use edw
;
SQL结束执行时间：20190611021500
SQL开始执行时间：20190611021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-10'
;
SQL结束执行时间：20190611021500
SQL开始执行时间：20190611021500

delete from edw.inventory where end_date >= '2019-06-10' and end_date < '3000-12-31'
;
SQL结束执行时间：20190611021500
SQL开始执行时间：20190611021500

UPDATE edw.inventory set end_date = '2019-06-10' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190611021501
SQL开始执行时间：20190611021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190611021501
SQL开始执行时间：20190611021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190611021501
SQL开始执行时间：20190611021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190611021501

20190612021500开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612021500



use edw
;
SQL结束执行时间：20190612021500
SQL开始执行时间：20190612021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-11'
;
SQL结束执行时间：20190612021500
SQL开始执行时间：20190612021500

delete from edw.inventory where end_date >= '2019-06-11' and end_date < '3000-12-31'
;
SQL结束执行时间：20190612021500
SQL开始执行时间：20190612021500

UPDATE edw.inventory set end_date = '2019-06-11' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190612021502
SQL开始执行时间：20190612021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190612021502
SQL开始执行时间：20190612021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190612021502
SQL开始执行时间：20190612021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190612021502

20190613021500开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613021500



use edw
;
SQL结束执行时间：20190613021500
SQL开始执行时间：20190613021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-12'
;
SQL结束执行时间：20190613021500
SQL开始执行时间：20190613021500

delete from edw.inventory where end_date >= '2019-06-12' and end_date < '3000-12-31'
;
SQL结束执行时间：20190613021500
SQL开始执行时间：20190613021500

UPDATE edw.inventory set end_date = '2019-06-12' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190613021502
SQL开始执行时间：20190613021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190613021502
SQL开始执行时间：20190613021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190613021502
SQL开始执行时间：20190613021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190613021502

20190614021500开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614021500



use edw
;
SQL结束执行时间：20190614021500
SQL开始执行时间：20190614021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-13'
;
SQL结束执行时间：20190614021500
SQL开始执行时间：20190614021500

delete from edw.inventory where end_date >= '2019-06-13' and end_date < '3000-12-31'
;
SQL结束执行时间：20190614021500
SQL开始执行时间：20190614021500

UPDATE edw.inventory set end_date = '2019-06-13' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190614021502
SQL开始执行时间：20190614021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190614021502
SQL开始执行时间：20190614021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190614021502
SQL开始执行时间：20190614021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190614021502

20190615021500开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615021500



use edw
;
SQL结束执行时间：20190615021500
SQL开始执行时间：20190615021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-14'
;
SQL结束执行时间：20190615021500
SQL开始执行时间：20190615021500

delete from edw.inventory where end_date >= '2019-06-14' and end_date < '3000-12-31'
;
SQL结束执行时间：20190615021500
SQL开始执行时间：20190615021500

UPDATE edw.inventory set end_date = '2019-06-14' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190615021503
SQL开始执行时间：20190615021503


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190615021503
SQL开始执行时间：20190615021503
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190615021503
SQL开始执行时间：20190615021503

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190615021503

20190616021500开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616021500



use edw
;
SQL结束执行时间：20190616021500
SQL开始执行时间：20190616021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-15'
;
SQL结束执行时间：20190616021500
SQL开始执行时间：20190616021500

delete from edw.inventory where end_date >= '2019-06-15' and end_date < '3000-12-31'
;
SQL结束执行时间：20190616021500
SQL开始执行时间：20190616021500

UPDATE edw.inventory set end_date = '2019-06-15' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190616021501
SQL开始执行时间：20190616021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190616021501
SQL开始执行时间：20190616021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190616021501
SQL开始执行时间：20190616021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190616021501

20190617021500开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617021500



use edw
;
SQL结束执行时间：20190617021500
SQL开始执行时间：20190617021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-16'
;
SQL结束执行时间：20190617021500
SQL开始执行时间：20190617021500

delete from edw.inventory where end_date >= '2019-06-16' and end_date < '3000-12-31'
;
SQL结束执行时间：20190617021500
SQL开始执行时间：20190617021500

UPDATE edw.inventory set end_date = '2019-06-16' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190617021501
SQL开始执行时间：20190617021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190617021501
SQL开始执行时间：20190617021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190617021501
SQL开始执行时间：20190617021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190617021501

20190618021500开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618021500



use edw
;
SQL结束执行时间：20190618021500
SQL开始执行时间：20190618021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-17'
;
SQL结束执行时间：20190618021500
SQL开始执行时间：20190618021500

delete from edw.inventory where end_date >= '2019-06-17' and end_date < '3000-12-31'
;
SQL结束执行时间：20190618021500
SQL开始执行时间：20190618021500

UPDATE edw.inventory set end_date = '2019-06-17' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190618021501
SQL开始执行时间：20190618021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190618021501
SQL开始执行时间：20190618021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190618021501
SQL开始执行时间：20190618021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190618021501

20190619021500开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619021500



use edw
;
SQL结束执行时间：20190619021500
SQL开始执行时间：20190619021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-18'
;
SQL结束执行时间：20190619021500
SQL开始执行时间：20190619021500

delete from edw.inventory where end_date >= '2019-06-18' and end_date < '3000-12-31'
;
SQL结束执行时间：20190619021500
SQL开始执行时间：20190619021500

UPDATE edw.inventory set end_date = '2019-06-18' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190619021502
SQL开始执行时间：20190619021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190619021502
SQL开始执行时间：20190619021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190619021502
SQL开始执行时间：20190619021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190619021502

20190620021500开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620021500



use edw
;
SQL结束执行时间：20190620021500
SQL开始执行时间：20190620021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-19'
;
SQL结束执行时间：20190620021500
SQL开始执行时间：20190620021500

delete from edw.inventory where end_date >= '2019-06-19' and end_date < '3000-12-31'
;
SQL结束执行时间：20190620021500
SQL开始执行时间：20190620021500

UPDATE edw.inventory set end_date = '2019-06-19' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190620021501
SQL开始执行时间：20190620021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190620021501
SQL开始执行时间：20190620021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190620021501
SQL开始执行时间：20190620021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190620021501

20190621021500开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621021500



use edw
;
SQL结束执行时间：20190621021500
SQL开始执行时间：20190621021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-20'
;
SQL结束执行时间：20190621021500
SQL开始执行时间：20190621021500

delete from edw.inventory where end_date >= '2019-06-20' and end_date < '3000-12-31'
;
SQL结束执行时间：20190621021500
SQL开始执行时间：20190621021500

UPDATE edw.inventory set end_date = '2019-06-20' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190621021501
SQL开始执行时间：20190621021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190621021501
SQL开始执行时间：20190621021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190621021501
SQL开始执行时间：20190621021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190621021501

20190622021500开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622021500



use edw
;
SQL结束执行时间：20190622021500
SQL开始执行时间：20190622021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-21'
;
SQL结束执行时间：20190622021500
SQL开始执行时间：20190622021500

delete from edw.inventory where end_date >= '2019-06-21' and end_date < '3000-12-31'
;
SQL结束执行时间：20190622021500
SQL开始执行时间：20190622021500

UPDATE edw.inventory set end_date = '2019-06-21' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190622021501
SQL开始执行时间：20190622021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190622021501
SQL开始执行时间：20190622021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190622021501
SQL开始执行时间：20190622021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190622021501

20190623021500开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623021500



use edw
;
SQL结束执行时间：20190623021500
SQL开始执行时间：20190623021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-22'
;
SQL结束执行时间：20190623021500
SQL开始执行时间：20190623021500

delete from edw.inventory where end_date >= '2019-06-22' and end_date < '3000-12-31'
;
SQL结束执行时间：20190623021501
SQL开始执行时间：20190623021501

UPDATE edw.inventory set end_date = '2019-06-22' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190623021501
SQL开始执行时间：20190623021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190623021501
SQL开始执行时间：20190623021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190623021501
SQL开始执行时间：20190623021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190623021501

20190624021500开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624021500



use edw
;
SQL结束执行时间：20190624021500
SQL开始执行时间：20190624021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-23'
;
SQL结束执行时间：20190624021501
SQL开始执行时间：20190624021501

delete from edw.inventory where end_date >= '2019-06-23' and end_date < '3000-12-31'
;
SQL结束执行时间：20190624021501
SQL开始执行时间：20190624021501

UPDATE edw.inventory set end_date = '2019-06-23' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190624021501
SQL开始执行时间：20190624021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190624021501
SQL开始执行时间：20190624021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190624021501
SQL开始执行时间：20190624021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190624021501

20190625021500开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625021500



use edw
;
SQL结束执行时间：20190625021500
SQL开始执行时间：20190625021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-24'
;
SQL结束执行时间：20190625021500
SQL开始执行时间：20190625021500

delete from edw.inventory where end_date >= '2019-06-24' and end_date < '3000-12-31'
;
SQL结束执行时间：20190625021500
SQL开始执行时间：20190625021500

UPDATE edw.inventory set end_date = '2019-06-24' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190625021502
SQL开始执行时间：20190625021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190625021502
SQL开始执行时间：20190625021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190625021502
SQL开始执行时间：20190625021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190625021502

20190626021500开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626021500



use edw
;
SQL结束执行时间：20190626021500
SQL开始执行时间：20190626021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-25'
;
SQL结束执行时间：20190626021500
SQL开始执行时间：20190626021500

delete from edw.inventory where end_date >= '2019-06-25' and end_date < '3000-12-31'
;
SQL结束执行时间：20190626021500
SQL开始执行时间：20190626021500

UPDATE edw.inventory set end_date = '2019-06-25' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190626021502
SQL开始执行时间：20190626021502


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190626021502
SQL开始执行时间：20190626021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190626021502
SQL开始执行时间：20190626021502

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190626021502

20190627021500开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627021500



use edw
;
SQL结束执行时间：20190627021500
SQL开始执行时间：20190627021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-26'
;
SQL结束执行时间：20190627021500
SQL开始执行时间：20190627021500

delete from edw.inventory where end_date >= '2019-06-26' and end_date < '3000-12-31'
;
SQL结束执行时间：20190627021500
SQL开始执行时间：20190627021500

UPDATE edw.inventory set end_date = '2019-06-26' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190627021501
SQL开始执行时间：20190627021501


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190627021501
SQL开始执行时间：20190627021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190627021501
SQL开始执行时间：20190627021501

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190627021501

20190628021500开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628021500



use edw
;
SQL结束执行时间：20190628021500
SQL开始执行时间：20190628021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a
 where left(a.dmodifydate,10) >= '2019-06-27'
;
SQL结束执行时间：20190628021500
SQL开始执行时间：20190628021500

delete from edw.inventory where end_date >= '2019-06-27' and end_date < '3000-12-31'
;
SQL结束执行时间：20190628021501
SQL开始执行时间：20190628021501

UPDATE edw.inventory set end_date = '2019-06-27' where cinvcode in (select cinvcode from edw.inventory_pre)
;
SQL结束执行时间：20190628021505
SQL开始执行时间：20190628021505


insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db in('UFDATA_111_2018','UFDATA_118_2018','UFDATA_123_2018','UFDATA_168_2018','UFDATA_168_2019','UFDATA_333_2018','UFDATA_666_2018','UFDATA_169_2018')

;
SQL结束执行时间：20190628021505
SQL开始执行时间：20190628021505
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on a.db = b.db
   and a.cinvcode = b.cinvcode
 where a.db in('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190628021505
SQL开始执行时间：20190628021505

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190628021505

20190629021500开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629021500



use edw
;
SQL结束执行时间：20190629021500
SQL开始执行时间：20190629021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190629021501
SQL开始执行时间：20190629021501




truncate table edw.inventory
;
SQL结束执行时间：20190629021501
SQL开始执行时间：20190629021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190629021501
SQL开始执行时间：20190629021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190629021517
SQL开始执行时间：20190629021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190629021517

20190630021500开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630021500



use edw
;
SQL结束执行时间：20190630021500
SQL开始执行时间：20190630021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190630021501
SQL开始执行时间：20190630021501




truncate table edw.inventory
;
SQL结束执行时间：20190630021501
SQL开始执行时间：20190630021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190630021501
SQL开始执行时间：20190630021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190630021517
SQL开始执行时间：20190630021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190630021517

20190701021500开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701021500



use edw
;
SQL结束执行时间：20190701021500
SQL开始执行时间：20190701021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190701021501
SQL开始执行时间：20190701021501




truncate table edw.inventory
;
SQL结束执行时间：20190701021501
SQL开始执行时间：20190701021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190701021501
SQL开始执行时间：20190701021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190701021516
SQL开始执行时间：20190701021516

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190701021517

20190702021500开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702021500



use edw
;
SQL结束执行时间：20190702021500
SQL开始执行时间：20190702021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190702021501
SQL开始执行时间：20190702021501




truncate table edw.inventory
;
SQL结束执行时间：20190702021501
SQL开始执行时间：20190702021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190702021502
SQL开始执行时间：20190702021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190702021516
SQL开始执行时间：20190702021516

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190702021517

20190703021500开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703021500



use edw
;
SQL结束执行时间：20190703021500
SQL开始执行时间：20190703021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190703021501
SQL开始执行时间：20190703021501




truncate table edw.inventory
;
SQL结束执行时间：20190703021501
SQL开始执行时间：20190703021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190703021501
SQL开始执行时间：20190703021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190703021516
SQL开始执行时间：20190703021516

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190703021517

20190704021500开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704021500



use edw
;
SQL结束执行时间：20190704021500
SQL开始执行时间：20190704021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190704021501
SQL开始执行时间：20190704021501




truncate table edw.inventory
;
SQL结束执行时间：20190704021501
SQL开始执行时间：20190704021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode,db,bi_cinvcode,bi_cinvname) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190704021502
SQL开始执行时间：20190704021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190704021517
SQL开始执行时间：20190704021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190704021517

20190705021500开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705021500



use edw
;
SQL结束执行时间：20190705021500
SQL开始执行时间：20190705021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190705021501
SQL开始执行时间：20190705021501




truncate table edw.inventory
;
SQL结束执行时间：20190705021501
SQL开始执行时间：20190705021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190705021501
SQL开始执行时间：20190705021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190705021517
SQL开始执行时间：20190705021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190705021517

20190706021500开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706021500



use edw
;
SQL结束执行时间：20190706021500
SQL开始执行时间：20190706021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190706021501
SQL开始执行时间：20190706021501




truncate table edw.inventory
;
SQL结束执行时间：20190706021501
SQL开始执行时间：20190706021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190706021501
SQL开始执行时间：20190706021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190706021517
SQL开始执行时间：20190706021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190706021517

20190707021500开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707021500



use edw
;
SQL结束执行时间：20190707021500
SQL开始执行时间：20190707021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190707021501
SQL开始执行时间：20190707021501




truncate table edw.inventory
;
SQL结束执行时间：20190707021501
SQL开始执行时间：20190707021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190707021501
SQL开始执行时间：20190707021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190707021517
SQL开始执行时间：20190707021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190707021517

20190708021500开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708021500



use edw
;
SQL结束执行时间：20190708021500
SQL开始执行时间：20190708021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190708021501
SQL开始执行时间：20190708021501




truncate table edw.inventory
;
SQL结束执行时间：20190708021501
SQL开始执行时间：20190708021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190708021501
SQL开始执行时间：20190708021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190708021517
SQL开始执行时间：20190708021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190708021517

20190709021500开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709021500



use edw
;
SQL结束执行时间：20190709021500
SQL开始执行时间：20190709021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190709021501
SQL开始执行时间：20190709021501




truncate table edw.inventory
;
SQL结束执行时间：20190709021501
SQL开始执行时间：20190709021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190709021502
SQL开始执行时间：20190709021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190709021518
SQL开始执行时间：20190709021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190709021518

20190710021500开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710021500



use edw
;
SQL结束执行时间：20190710021500
SQL开始执行时间：20190710021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190710021501
SQL开始执行时间：20190710021501




truncate table edw.inventory
;
SQL结束执行时间：20190710021501
SQL开始执行时间：20190710021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190710021502
SQL开始执行时间：20190710021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190710021517
SQL开始执行时间：20190710021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190710021518

20190711021500开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711021500



use edw
;
SQL结束执行时间：20190711021500
SQL开始执行时间：20190711021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190711021501
SQL开始执行时间：20190711021501




truncate table edw.inventory
;
SQL结束执行时间：20190711021501
SQL开始执行时间：20190711021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190711021501
SQL开始执行时间：20190711021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190711021517
SQL开始执行时间：20190711021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190711021517

20190712021500开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712021500



use edw
;
SQL结束执行时间：20190712021500
SQL开始执行时间：20190712021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190712021501
SQL开始执行时间：20190712021501




truncate table edw.inventory
;
SQL结束执行时间：20190712021501
SQL开始执行时间：20190712021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190712021501
SQL开始执行时间：20190712021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190712021517
SQL开始执行时间：20190712021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190712021518

20190713021500开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713021500



use edw
;
SQL结束执行时间：20190713021500
SQL开始执行时间：20190713021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190713021501
SQL开始执行时间：20190713021501




truncate table edw.inventory
;
SQL结束执行时间：20190713021501
SQL开始执行时间：20190713021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190713021502
SQL开始执行时间：20190713021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190713021517
SQL开始执行时间：20190713021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190713021518

20190714021500开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714021500



use edw
;
SQL结束执行时间：20190714021500
SQL开始执行时间：20190714021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190714021501
SQL开始执行时间：20190714021501




truncate table edw.inventory
;
SQL结束执行时间：20190714021501
SQL开始执行时间：20190714021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190714021501
SQL开始执行时间：20190714021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190714021517
SQL开始执行时间：20190714021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190714021517

20190715021500开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715021500



use edw
;
SQL结束执行时间：20190715021500
SQL开始执行时间：20190715021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190715021501
SQL开始执行时间：20190715021501




truncate table edw.inventory
;
SQL结束执行时间：20190715021501
SQL开始执行时间：20190715021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190715021501
SQL开始执行时间：20190715021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190715021517
SQL开始执行时间：20190715021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190715021518

20190716021500开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716021500



use edw
;
SQL结束执行时间：20190716021500
SQL开始执行时间：20190716021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190716021501
SQL开始执行时间：20190716021501




truncate table edw.inventory
;
SQL结束执行时间：20190716021501
SQL开始执行时间：20190716021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190716021501
SQL开始执行时间：20190716021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190716021517
SQL开始执行时间：20190716021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190716021517

20190717021500开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717021500



use edw
;
SQL结束执行时间：20190717021500
SQL开始执行时间：20190717021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190717021501
SQL开始执行时间：20190717021501




truncate table edw.inventory
;
SQL结束执行时间：20190717021501
SQL开始执行时间：20190717021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190717021501
SQL开始执行时间：20190717021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190717021517
SQL开始执行时间：20190717021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190717021517

20190718021500开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718021500



use edw
;
SQL结束执行时间：20190718021500
SQL开始执行时间：20190718021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190718021501
SQL开始执行时间：20190718021501




truncate table edw.inventory
;
SQL结束执行时间：20190718021501
SQL开始执行时间：20190718021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190718021502
SQL开始执行时间：20190718021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190718021517
SQL开始执行时间：20190718021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190718021518

20190719021500开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719021500



use edw
;
SQL结束执行时间：20190719021500
SQL开始执行时间：20190719021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190719021501
SQL开始执行时间：20190719021501




truncate table edw.inventory
;
SQL结束执行时间：20190719021501
SQL开始执行时间：20190719021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190719021501
SQL开始执行时间：20190719021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190719021517
SQL开始执行时间：20190719021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190719021517

20190720021500开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720021500



use edw
;
SQL结束执行时间：20190720021500
SQL开始执行时间：20190720021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190720021501
SQL开始执行时间：20190720021501




truncate table edw.inventory
;
SQL结束执行时间：20190720021501
SQL开始执行时间：20190720021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190720021501
SQL开始执行时间：20190720021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190720021517
SQL开始执行时间：20190720021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190720021518

20190721021501开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721021501



use edw
;
SQL结束执行时间：20190721021501
SQL开始执行时间：20190721021501

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190721021501
SQL开始执行时间：20190721021501




truncate table edw.inventory
;
SQL结束执行时间：20190721021501
SQL开始执行时间：20190721021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190721021502
SQL开始执行时间：20190721021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190721021517
SQL开始执行时间：20190721021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190721021518

20190722021500开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722021500



use edw
;
SQL结束执行时间：20190722021500
SQL开始执行时间：20190722021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190722021501
SQL开始执行时间：20190722021501




truncate table edw.inventory
;
SQL结束执行时间：20190722021501
SQL开始执行时间：20190722021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190722021501
SQL开始执行时间：20190722021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190722021517
SQL开始执行时间：20190722021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190722021517

20190723021500开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723021500



use edw
;
SQL结束执行时间：20190723021500
SQL开始执行时间：20190723021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190723021501
SQL开始执行时间：20190723021501




truncate table edw.inventory
;
SQL结束执行时间：20190723021501
SQL开始执行时间：20190723021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190723021501
SQL开始执行时间：20190723021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190723021517
SQL开始执行时间：20190723021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190723021517

20190724021500开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724021500



use edw
;
SQL结束执行时间：20190724021500
SQL开始执行时间：20190724021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190724021501
SQL开始执行时间：20190724021501




truncate table edw.inventory
;
SQL结束执行时间：20190724021501
SQL开始执行时间：20190724021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190724021501
SQL开始执行时间：20190724021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190724021517
SQL开始执行时间：20190724021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190724021517

20190725021501开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725021501



use edw
;
SQL结束执行时间：20190725021501
SQL开始执行时间：20190725021501

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190725021502
SQL开始执行时间：20190725021502




truncate table edw.inventory
;
SQL结束执行时间：20190725021502
SQL开始执行时间：20190725021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190725021502
SQL开始执行时间：20190725021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190725021517
SQL开始执行时间：20190725021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190725021518

20190726021500开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726021500



use edw
;
SQL结束执行时间：20190726021500
SQL开始执行时间：20190726021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190726021501
SQL开始执行时间：20190726021501




truncate table edw.inventory
;
SQL结束执行时间：20190726021501
SQL开始执行时间：20190726021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190726021501
SQL开始执行时间：20190726021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190726021517
SQL开始执行时间：20190726021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190726021517

20190727021500开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727021500



use edw
;
SQL结束执行时间：20190727021500
SQL开始执行时间：20190727021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190727021501
SQL开始执行时间：20190727021501




truncate table edw.inventory
;
SQL结束执行时间：20190727021501
SQL开始执行时间：20190727021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190727021502
SQL开始执行时间：20190727021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190727021517
SQL开始执行时间：20190727021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190727021518

20190728021500开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728021500



use edw
;
SQL结束执行时间：20190728021500
SQL开始执行时间：20190728021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190728021501
SQL开始执行时间：20190728021501




truncate table edw.inventory
;
SQL结束执行时间：20190728021501
SQL开始执行时间：20190728021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190728021502
SQL开始执行时间：20190728021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190728021517
SQL开始执行时间：20190728021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190728021518

20190729021500开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729021500



use edw
;
SQL结束执行时间：20190729021500
SQL开始执行时间：20190729021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190729021501
SQL开始执行时间：20190729021501




truncate table edw.inventory
;
SQL结束执行时间：20190729021501
SQL开始执行时间：20190729021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190729021501
SQL开始执行时间：20190729021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190729021517
SQL开始执行时间：20190729021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190729021518

20190730021500开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730021500



use edw
;
SQL结束执行时间：20190730021500
SQL开始执行时间：20190730021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190730021501
SQL开始执行时间：20190730021501




truncate table edw.inventory
;
SQL结束执行时间：20190730021501
SQL开始执行时间：20190730021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190730021501
SQL开始执行时间：20190730021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190730021518
SQL开始执行时间：20190730021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190730021518

20190731021500开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731021500



use edw
;
SQL结束执行时间：20190731021500
SQL开始执行时间：20190731021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190731021501
SQL开始执行时间：20190731021501




truncate table edw.inventory
;
SQL结束执行时间：20190731021501
SQL开始执行时间：20190731021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190731021501
SQL开始执行时间：20190731021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190731021518
SQL开始执行时间：20190731021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190731021518

20190801021500开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801021500



use edw
;
SQL结束执行时间：20190801021500
SQL开始执行时间：20190801021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190801021501
SQL开始执行时间：20190801021501




truncate table edw.inventory
;
SQL结束执行时间：20190801021501
SQL开始执行时间：20190801021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190801021501
SQL开始执行时间：20190801021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190801021517
SQL开始执行时间：20190801021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190801021518

20190802021500开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802021500



use edw
;
SQL结束执行时间：20190802021500
SQL开始执行时间：20190802021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190802021501
SQL开始执行时间：20190802021501




truncate table edw.inventory
;
SQL结束执行时间：20190802021501
SQL开始执行时间：20190802021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190802021502
SQL开始执行时间：20190802021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190802021517
SQL开始执行时间：20190802021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190802021518

20190803021500开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803021500



use edw
;
SQL结束执行时间：20190803021500
SQL开始执行时间：20190803021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190803021501
SQL开始执行时间：20190803021501




truncate table edw.inventory
;
SQL结束执行时间：20190803021501
SQL开始执行时间：20190803021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190803021501
SQL开始执行时间：20190803021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190803021518
SQL开始执行时间：20190803021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190803021518

20190804021500开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804021500



use edw
;
SQL结束执行时间：20190804021500
SQL开始执行时间：20190804021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190804021501
SQL开始执行时间：20190804021501




truncate table edw.inventory
;
SQL结束执行时间：20190804021501
SQL开始执行时间：20190804021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190804021501
SQL开始执行时间：20190804021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190804021517
SQL开始执行时间：20190804021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190804021518

20190805021500开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805021500



use edw
;
SQL结束执行时间：20190805021500
SQL开始执行时间：20190805021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190805021501
SQL开始执行时间：20190805021501




truncate table edw.inventory
;
SQL结束执行时间：20190805021501
SQL开始执行时间：20190805021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190805021501
SQL开始执行时间：20190805021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190805021517
SQL开始执行时间：20190805021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190805021518

20190806021500开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806021500



use edw
;
SQL结束执行时间：20190806021500
SQL开始执行时间：20190806021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190806021501
SQL开始执行时间：20190806021501




truncate table edw.inventory
;
SQL结束执行时间：20190806021501
SQL开始执行时间：20190806021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190806021501
SQL开始执行时间：20190806021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190806021517
SQL开始执行时间：20190806021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190806021517

20190807021500开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807021500



use edw
;
SQL结束执行时间：20190807021500
SQL开始执行时间：20190807021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190807021501
SQL开始执行时间：20190807021501




truncate table edw.inventory
;
SQL结束执行时间：20190807021501
SQL开始执行时间：20190807021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190807021501
SQL开始执行时间：20190807021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190807021517
SQL开始执行时间：20190807021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190807021518

20190808021500开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808021500



use edw
;
SQL结束执行时间：20190808021500
SQL开始执行时间：20190808021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190808021501
SQL开始执行时间：20190808021501




truncate table edw.inventory
;
SQL结束执行时间：20190808021501
SQL开始执行时间：20190808021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190808021501
SQL开始执行时间：20190808021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190808021517
SQL开始执行时间：20190808021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190808021517

20190809021500开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809021500



use edw
;
SQL结束执行时间：20190809021500
SQL开始执行时间：20190809021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190809021501
SQL开始执行时间：20190809021501




truncate table edw.inventory
;
SQL结束执行时间：20190809021501
SQL开始执行时间：20190809021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190809021501
SQL开始执行时间：20190809021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190809021517
SQL开始执行时间：20190809021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190809021517

20190810021500开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810021500



use edw
;
SQL结束执行时间：20190810021500
SQL开始执行时间：20190810021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190810021501
SQL开始执行时间：20190810021501




truncate table edw.inventory
;
SQL结束执行时间：20190810021501
SQL开始执行时间：20190810021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190810021501
SQL开始执行时间：20190810021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190810021518
SQL开始执行时间：20190810021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190810021518

20190811021500开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811021500



use edw
;
SQL结束执行时间：20190811021500
SQL开始执行时间：20190811021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190811021501
SQL开始执行时间：20190811021501




truncate table edw.inventory
;
SQL结束执行时间：20190811021501
SQL开始执行时间：20190811021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190811021501
SQL开始执行时间：20190811021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190811021518
SQL开始执行时间：20190811021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190811021518

20190812021500开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812021500



use edw
;
SQL结束执行时间：20190812021500
SQL开始执行时间：20190812021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190812021501
SQL开始执行时间：20190812021501




truncate table edw.inventory
;
SQL结束执行时间：20190812021501
SQL开始执行时间：20190812021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190812021501
SQL开始执行时间：20190812021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190812021518
SQL开始执行时间：20190812021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190812021518

20190813021500开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813021500



use edw
;
SQL结束执行时间：20190813021500
SQL开始执行时间：20190813021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190813021501
SQL开始执行时间：20190813021501




truncate table edw.inventory
;
SQL结束执行时间：20190813021501
SQL开始执行时间：20190813021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190813021502
SQL开始执行时间：20190813021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190813021518
SQL开始执行时间：20190813021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190813021518

20190814021500开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814021500



use edw
;
SQL结束执行时间：20190814021500
SQL开始执行时间：20190814021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190814021501
SQL开始执行时间：20190814021501




truncate table edw.inventory
;
SQL结束执行时间：20190814021501
SQL开始执行时间：20190814021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190814021501
SQL开始执行时间：20190814021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190814021517
SQL开始执行时间：20190814021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190814021517

20190815021500开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815021500



use edw
;
SQL结束执行时间：20190815021500
SQL开始执行时间：20190815021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190815021501
SQL开始执行时间：20190815021501




truncate table edw.inventory
;
SQL结束执行时间：20190815021501
SQL开始执行时间：20190815021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190815021501
SQL开始执行时间：20190815021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190815021517
SQL开始执行时间：20190815021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190815021517

20190816021500开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816021500



use edw
;
SQL结束执行时间：20190816021500
SQL开始执行时间：20190816021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190816021501
SQL开始执行时间：20190816021501




truncate table edw.inventory
;
SQL结束执行时间：20190816021501
SQL开始执行时间：20190816021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190816021501
SQL开始执行时间：20190816021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190816021517
SQL开始执行时间：20190816021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190816021517

20190817021500开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817021500



use edw
;
SQL结束执行时间：20190817021500
SQL开始执行时间：20190817021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190817021501
SQL开始执行时间：20190817021501




truncate table edw.inventory
;
SQL结束执行时间：20190817021501
SQL开始执行时间：20190817021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190817021501
SQL开始执行时间：20190817021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190817021517
SQL开始执行时间：20190817021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190817021518

20190818021500开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818021500



use edw
;
SQL结束执行时间：20190818021500
SQL开始执行时间：20190818021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190818021501
SQL开始执行时间：20190818021501




truncate table edw.inventory
;
SQL结束执行时间：20190818021501
SQL开始执行时间：20190818021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190818021501
SQL开始执行时间：20190818021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190818021517
SQL开始执行时间：20190818021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190818021518

20190819021500开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819021500



use edw
;
SQL结束执行时间：20190819021500
SQL开始执行时间：20190819021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190819021501
SQL开始执行时间：20190819021501




truncate table edw.inventory
;
SQL结束执行时间：20190819021501
SQL开始执行时间：20190819021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190819021502
SQL开始执行时间：20190819021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190819021518
SQL开始执行时间：20190819021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190819021518

20190820021500开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820021500



use edw
;
SQL结束执行时间：20190820021500
SQL开始执行时间：20190820021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190820021501
SQL开始执行时间：20190820021501




truncate table edw.inventory
;
SQL结束执行时间：20190820021501
SQL开始执行时间：20190820021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190820021501
SQL开始执行时间：20190820021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190820021517
SQL开始执行时间：20190820021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190820021518

20190821021500开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821021500



use edw
;
SQL结束执行时间：20190821021500
SQL开始执行时间：20190821021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190821021501
SQL开始执行时间：20190821021501




truncate table edw.inventory
;
SQL结束执行时间：20190821021501
SQL开始执行时间：20190821021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190821021502
SQL开始执行时间：20190821021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190821021518
SQL开始执行时间：20190821021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190821021518

20190822021500开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822021500



use edw
;
SQL结束执行时间：20190822021500
SQL开始执行时间：20190822021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190822021501
SQL开始执行时间：20190822021501




truncate table edw.inventory
;
SQL结束执行时间：20190822021501
SQL开始执行时间：20190822021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190822021501
SQL开始执行时间：20190822021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190822021518
SQL开始执行时间：20190822021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190822021518

20190823021500开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823021500



use edw
;
SQL结束执行时间：20190823021500
SQL开始执行时间：20190823021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190823021501
SQL开始执行时间：20190823021501




truncate table edw.inventory
;
SQL结束执行时间：20190823021501
SQL开始执行时间：20190823021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190823021501
SQL开始执行时间：20190823021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190823021517
SQL开始执行时间：20190823021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190823021518

20190824021500开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824021500



use edw
;
SQL结束执行时间：20190824021500
SQL开始执行时间：20190824021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190824021501
SQL开始执行时间：20190824021501




truncate table edw.inventory
;
SQL结束执行时间：20190824021501
SQL开始执行时间：20190824021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190824021501
SQL开始执行时间：20190824021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190824021517
SQL开始执行时间：20190824021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190824021518

20190825021500开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825021500



use edw
;
SQL结束执行时间：20190825021500
SQL开始执行时间：20190825021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190825021501
SQL开始执行时间：20190825021501




truncate table edw.inventory
;
SQL结束执行时间：20190825021501
SQL开始执行时间：20190825021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190825021501
SQL开始执行时间：20190825021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190825021517
SQL开始执行时间：20190825021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190825021518

20190826021500开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826021500



use edw
;
SQL结束执行时间：20190826021500
SQL开始执行时间：20190826021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190826021501
SQL开始执行时间：20190826021501




truncate table edw.inventory
;
SQL结束执行时间：20190826021501
SQL开始执行时间：20190826021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190826021501
SQL开始执行时间：20190826021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190826021517
SQL开始执行时间：20190826021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190826021518

20190827021500开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827021500



use edw
;
SQL结束执行时间：20190827021500
SQL开始执行时间：20190827021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190827021500
SQL开始执行时间：20190827021500




truncate table edw.inventory
;
SQL结束执行时间：20190827021500
SQL开始执行时间：20190827021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190827021500
SQL开始执行时间：20190827021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190827021500
SQL开始执行时间：20190827021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190827021500

20190828021500开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828021500



use edw
;
SQL结束执行时间：20190828021500
SQL开始执行时间：20190828021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190828021501
SQL开始执行时间：20190828021501




truncate table edw.inventory
;
SQL结束执行时间：20190828021501
SQL开始执行时间：20190828021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190828021502
SQL开始执行时间：20190828021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190828021518
SQL开始执行时间：20190828021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190828021519

20190829021501开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829021501



use edw
;
SQL结束执行时间：20190829021501
SQL开始执行时间：20190829021501

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190829021502
SQL开始执行时间：20190829021502




truncate table edw.inventory
;
SQL结束执行时间：20190829021502
SQL开始执行时间：20190829021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190829021502
SQL开始执行时间：20190829021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190829021518
SQL开始执行时间：20190829021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190829021518

20190830021500开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830021500



use edw
;
SQL结束执行时间：20190830021500
SQL开始执行时间：20190830021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190830021501
SQL开始执行时间：20190830021501




truncate table edw.inventory
;
SQL结束执行时间：20190830021501
SQL开始执行时间：20190830021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190830021501
SQL开始执行时间：20190830021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190830021517
SQL开始执行时间：20190830021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190830021518

20190831021500开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831021500



use edw
;
SQL结束执行时间：20190831021500
SQL开始执行时间：20190831021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190831021501
SQL开始执行时间：20190831021501




truncate table edw.inventory
;
SQL结束执行时间：20190831021501
SQL开始执行时间：20190831021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190831021501
SQL开始执行时间：20190831021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190831021517
SQL开始执行时间：20190831021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190831021518

20190901021500开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901021500



use edw
;
SQL结束执行时间：20190901021500
SQL开始执行时间：20190901021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190901021501
SQL开始执行时间：20190901021501




truncate table edw.inventory
;
SQL结束执行时间：20190901021501
SQL开始执行时间：20190901021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190901021501
SQL开始执行时间：20190901021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190901021517
SQL开始执行时间：20190901021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190901021517

20190902021500开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902021500



use edw
;
SQL结束执行时间：20190902021500
SQL开始执行时间：20190902021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190902021501
SQL开始执行时间：20190902021501




truncate table edw.inventory
;
SQL结束执行时间：20190902021501
SQL开始执行时间：20190902021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190902021501
SQL开始执行时间：20190902021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190902021517
SQL开始执行时间：20190902021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190902021518

20190903021500开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903021500



use edw
;
SQL结束执行时间：20190903021500
SQL开始执行时间：20190903021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190903021501
SQL开始执行时间：20190903021501




truncate table edw.inventory
;
SQL结束执行时间：20190903021501
SQL开始执行时间：20190903021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190903021501
SQL开始执行时间：20190903021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190903021517
SQL开始执行时间：20190903021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190903021518

20190904021500开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904021500



use edw
;
SQL结束执行时间：20190904021500
SQL开始执行时间：20190904021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190904021500
SQL开始执行时间：20190904021500




truncate table edw.inventory
;
SQL结束执行时间：20190904021500
SQL开始执行时间：20190904021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190904021500
SQL开始执行时间：20190904021500
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190904021500
SQL开始执行时间：20190904021500

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190904021500

20190905021500开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905021500



use edw
;
SQL结束执行时间：20190905021500
SQL开始执行时间：20190905021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190905021501
SQL开始执行时间：20190905021501




truncate table edw.inventory
;
SQL结束执行时间：20190905021501
SQL开始执行时间：20190905021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190905021502
SQL开始执行时间：20190905021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190905021518
SQL开始执行时间：20190905021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190905021518

20190906021500开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906021500



use edw
;
SQL结束执行时间：20190906021500
SQL开始执行时间：20190906021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190906021501
SQL开始执行时间：20190906021501




truncate table edw.inventory
;
SQL结束执行时间：20190906021501
SQL开始执行时间：20190906021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190906021502
SQL开始执行时间：20190906021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190906021518
SQL开始执行时间：20190906021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190906021518

20190907021500开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907021500



use edw
;
SQL结束执行时间：20190907021500
SQL开始执行时间：20190907021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190907021501
SQL开始执行时间：20190907021501




truncate table edw.inventory
;
SQL结束执行时间：20190907021501
SQL开始执行时间：20190907021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190907021501
SQL开始执行时间：20190907021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190907021517
SQL开始执行时间：20190907021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190907021518

20190908021500开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908021500



use edw
;
SQL结束执行时间：20190908021500
SQL开始执行时间：20190908021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190908021501
SQL开始执行时间：20190908021501




truncate table edw.inventory
;
SQL结束执行时间：20190908021501
SQL开始执行时间：20190908021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190908021501
SQL开始执行时间：20190908021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190908021518
SQL开始执行时间：20190908021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190908021518

20190909021500开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909021500



use edw
;
SQL结束执行时间：20190909021500
SQL开始执行时间：20190909021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190909021501
SQL开始执行时间：20190909021501




truncate table edw.inventory
;
SQL结束执行时间：20190909021501
SQL开始执行时间：20190909021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190909021501
SQL开始执行时间：20190909021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190909021517
SQL开始执行时间：20190909021517

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190909021518

20190910021500开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910021500



use edw
;
SQL结束执行时间：20190910021500
SQL开始执行时间：20190910021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190910021501
SQL开始执行时间：20190910021501




truncate table edw.inventory
;
SQL结束执行时间：20190910021501
SQL开始执行时间：20190910021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190910021502
SQL开始执行时间：20190910021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190910021518
SQL开始执行时间：20190910021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190910021518

20190911021500开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911021500



use edw
;
SQL结束执行时间：20190911021500
SQL开始执行时间：20190911021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190911021501
SQL开始执行时间：20190911021501




truncate table edw.inventory
;
SQL结束执行时间：20190911021501
SQL开始执行时间：20190911021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190911021501
SQL开始执行时间：20190911021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190911021518
SQL开始执行时间：20190911021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190911021519

20190912021500开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912021500



use edw
;
SQL结束执行时间：20190912021500
SQL开始执行时间：20190912021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190912021501
SQL开始执行时间：20190912021501




truncate table edw.inventory
;
SQL结束执行时间：20190912021501
SQL开始执行时间：20190912021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190912021502
SQL开始执行时间：20190912021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190912021518
SQL开始执行时间：20190912021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190912021518

20190913021500开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913021500



use edw
;
SQL结束执行时间：20190913021500
SQL开始执行时间：20190913021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190913021501
SQL开始执行时间：20190913021501




truncate table edw.inventory
;
SQL结束执行时间：20190913021501
SQL开始执行时间：20190913021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190913021501
SQL开始执行时间：20190913021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190913021518
SQL开始执行时间：20190913021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190913021518

20190914021500开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914021500



use edw
;
SQL结束执行时间：20190914021500
SQL开始执行时间：20190914021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190914021501
SQL开始执行时间：20190914021501




truncate table edw.inventory
;
SQL结束执行时间：20190914021501
SQL开始执行时间：20190914021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190914021501
SQL开始执行时间：20190914021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190914021518
SQL开始执行时间：20190914021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190914021519

20190915021500开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915021500



use edw
;
SQL结束执行时间：20190915021500
SQL开始执行时间：20190915021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190915021501
SQL开始执行时间：20190915021501




truncate table edw.inventory
;
SQL结束执行时间：20190915021501
SQL开始执行时间：20190915021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190915021501
SQL开始执行时间：20190915021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190915021518
SQL开始执行时间：20190915021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190915021519

20190916021500开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916021500



use edw
;
SQL结束执行时间：20190916021500
SQL开始执行时间：20190916021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190916021501
SQL开始执行时间：20190916021501




truncate table edw.inventory
;
SQL结束执行时间：20190916021501
SQL开始执行时间：20190916021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190916021502
SQL开始执行时间：20190916021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190916021518
SQL开始执行时间：20190916021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190916021519

20190917021500开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917021500



use edw
;
SQL结束执行时间：20190917021500
SQL开始执行时间：20190917021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190917021501
SQL开始执行时间：20190917021501




truncate table edw.inventory
;
SQL结束执行时间：20190917021501
SQL开始执行时间：20190917021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190917021502
SQL开始执行时间：20190917021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190917021518
SQL开始执行时间：20190917021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190917021519

20190918021500开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918021500



use edw
;
SQL结束执行时间：20190918021500
SQL开始执行时间：20190918021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190918021501
SQL开始执行时间：20190918021501




truncate table edw.inventory
;
SQL结束执行时间：20190918021501
SQL开始执行时间：20190918021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190918021501
SQL开始执行时间：20190918021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190918021518
SQL开始执行时间：20190918021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190918021519

20190919021500开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919021500



use edw
;
SQL结束执行时间：20190919021500
SQL开始执行时间：20190919021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190919021501
SQL开始执行时间：20190919021501




truncate table edw.inventory
;
SQL结束执行时间：20190919021501
SQL开始执行时间：20190919021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190919021502
SQL开始执行时间：20190919021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190919021518
SQL开始执行时间：20190919021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190919021519

20190920021500开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920021500



use edw
;
SQL结束执行时间：20190920021500
SQL开始执行时间：20190920021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190920021501
SQL开始执行时间：20190920021501




truncate table edw.inventory
;
SQL结束执行时间：20190920021501
SQL开始执行时间：20190920021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190920021502
SQL开始执行时间：20190920021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190920021518
SQL开始执行时间：20190920021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190920021519

20190921021500开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921021500



use edw
;
SQL结束执行时间：20190921021500
SQL开始执行时间：20190921021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190921021501
SQL开始执行时间：20190921021501




truncate table edw.inventory
;
SQL结束执行时间：20190921021501
SQL开始执行时间：20190921021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190921021501
SQL开始执行时间：20190921021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190921021518
SQL开始执行时间：20190921021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190921021519

20190922021500开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922021500



use edw
;
SQL结束执行时间：20190922021500
SQL开始执行时间：20190922021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190922021501
SQL开始执行时间：20190922021501




truncate table edw.inventory
;
SQL结束执行时间：20190922021501
SQL开始执行时间：20190922021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190922021501
SQL开始执行时间：20190922021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190922021518
SQL开始执行时间：20190922021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190922021518

20190923021500开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923021500



use edw
;
SQL结束执行时间：20190923021500
SQL开始执行时间：20190923021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190923021501
SQL开始执行时间：20190923021501




truncate table edw.inventory
;
SQL结束执行时间：20190923021501
SQL开始执行时间：20190923021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190923021501
SQL开始执行时间：20190923021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190923021518
SQL开始执行时间：20190923021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190923021518

20190924021500开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924021500



use edw
;
SQL结束执行时间：20190924021500
SQL开始执行时间：20190924021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190924021501
SQL开始执行时间：20190924021501




truncate table edw.inventory
;
SQL结束执行时间：20190924021501
SQL开始执行时间：20190924021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190924021501
SQL开始执行时间：20190924021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190924021518
SQL开始执行时间：20190924021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190924021519

20190925021500开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925021500



use edw
;
SQL结束执行时间：20190925021500
SQL开始执行时间：20190925021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190925021501
SQL开始执行时间：20190925021501




truncate table edw.inventory
;
SQL结束执行时间：20190925021501
SQL开始执行时间：20190925021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190925021502
SQL开始执行时间：20190925021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190925021519
SQL开始执行时间：20190925021519

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190925021519

20190926021500开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926021500



use edw
;
SQL结束执行时间：20190926021500
SQL开始执行时间：20190926021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190926021501
SQL开始执行时间：20190926021501




truncate table edw.inventory
;
SQL结束执行时间：20190926021501
SQL开始执行时间：20190926021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190926021501
SQL开始执行时间：20190926021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190926021519
SQL开始执行时间：20190926021519

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190926021519

20190927021501开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927021501



use edw
;
SQL结束执行时间：20190927021501
SQL开始执行时间：20190927021501

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190927021502
SQL开始执行时间：20190927021502




truncate table edw.inventory
;
SQL结束执行时间：20190927021502
SQL开始执行时间：20190927021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190927021502
SQL开始执行时间：20190927021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190927021519
SQL开始执行时间：20190927021519

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190927021520

20190928021500开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928021500



use edw
;
SQL结束执行时间：20190928021500
SQL开始执行时间：20190928021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190928021501
SQL开始执行时间：20190928021501




truncate table edw.inventory
;
SQL结束执行时间：20190928021501
SQL开始执行时间：20190928021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190928021501
SQL开始执行时间：20190928021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190928021519
SQL开始执行时间：20190928021519

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190928021519

20190929021500开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929021500



use edw
;
SQL结束执行时间：20190929021500
SQL开始执行时间：20190929021500

create temporary table edw.inventory_pre as
select *
  from ufdata.inventory a

;
SQL结束执行时间：20190929021501
SQL开始执行时间：20190929021501




truncate table edw.inventory
;
SQL结束执行时间：20190929021501
SQL开始执行时间：20190929021501
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvcode end
      ,case when b.cinvcode is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join (select cinvcode,db,bi_cinvcode,bi_cinvname from dic_inventory group by cinvcode) b
    on a.cinvcode = b.cinvcode
 where a.db not in ('UFDATA_222_2018','UFDATA_222_2019', 'UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190929021502
SQL开始执行时间：20190929021502
insert into edw.inventory
select a.db
      ,a.cinvcode
      ,a.cinvname
      ,case when b.db is null then '请核查' else b.bi_cinvcode end
      ,case when b.db is null then '请核查' else b.bi_cinvname end
      ,a.cinvstd
      ,a.cinvdefine8
      ,a.cinvdefine9
      ,a.cinvdefine13
      ,a.cinvdefine5
      ,a.cinvccode
      ,a.cvencode
      ,a.bsale
      ,a.dsdate
      ,a.dedate
      ,a.cmodifyperson
      ,a.dmodifydate
      ,a.cinvdefine7
      ,'3000-12-31'
      ,localtimestamp()
  from edw.inventory_pre a
  left join dic_inventory b
    on left(a.db,10) = left(b.db,10)
   and a.cinvcode = b.cinvcode
 where a.db in ('UFDATA_222_2018','UFDATA_222_2019','UFDATA_588_2019','UFDATA_889_2019','UFDATA_588_2018','UFDATA_889_2018')

;
SQL结束执行时间：20190929021518
SQL开始执行时间：20190929021518

update edw.map_inventory a
inner join (select * from edw.dic_inventory group by bi_cinvcode) b
  on a.bi_cinvcode = b.bi_cinvcode
inner join (select * from edw.inventory_pre group by cinvcode) c
  on b.cinvcode = c.cinvcode
set a.specification_type = c.cinvstd
   ,a.start_date = c.dsdate
   ,a.end_date = c.dedate
   ,a.product = c.cinvccode
   ,a.cinvbrand = c.cinvdefine5
   ,a.itax = c.itaxrate
   ,a.latest_cost = c.iinvncost

;
SQL结束执行时间：20190929021519
