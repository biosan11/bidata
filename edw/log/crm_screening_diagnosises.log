
20190220102623开始执行2019-01-19数据加载日志:
SQL开始执行时间：20190220102623

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where (left(a.createdon,10) = '2019-01-19' or left(a.modifiedon,10) = '2019-01-19')
;
SQL结束执行时间：20190220102623
SQL开始执行时间：20190220102623

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190220102623
SQL开始执行时间：20190220102623

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid

;
SQL结束执行时间：20190220102623

20190221030009开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190221030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where (left(a.createdon,10) >= '2019-02-20' or left(a.modifiedon,10) >= '2019-02-20')
;
SQL结束执行时间：20190221030009
SQL开始执行时间：20190221030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190221030010
SQL开始执行时间：20190221030010

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid

;
SQL结束执行时间：20190221030010

20190222030010开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190222030010

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-21' or left(a.modifiedon,10) >= '2019-02-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190222030010
SQL开始执行时间：20190222030010

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190222030010
SQL开始执行时间：20190222030010

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190222030010

20190223030009开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190223030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-22' or left(a.modifiedon,10) >= '2019-02-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190223030009
SQL开始执行时间：20190223030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190223030010
SQL开始执行时间：20190223030010

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190223030012

20190224030009开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190224030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-23' or left(a.modifiedon,10) >= '2019-02-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190224030009
SQL开始执行时间：20190224030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190224030009
SQL开始执行时间：20190224030009

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190224030009

20190225030009开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190225030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-24' or left(a.modifiedon,10) >= '2019-02-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190225030009
SQL开始执行时间：20190225030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190225030009
SQL开始执行时间：20190225030009

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190225030009

20190226030030开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190226030030

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-25' or left(a.modifiedon,10) >= '2019-02-25'))
   and a.statecode = '0'
;
SQL结束执行时间：20190226030030
SQL开始执行时间：20190226030030

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190226030030
SQL开始执行时间：20190226030030

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190226030030

20190227030009开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190227030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-26' or left(a.modifiedon,10) >= '2019-02-26'))
   and a.statecode = '0'
;
SQL结束执行时间：20190227030009
SQL开始执行时间：20190227030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190227030009
SQL开始执行时间：20190227030009

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190227030010

20190228030010开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190228030010

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-27' or left(a.modifiedon,10) >= '2019-02-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190228030010
SQL开始执行时间：20190228030010

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190228030010
SQL开始执行时间：20190228030010

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190228030010

20190301030009开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301030009

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-02-28' or left(a.modifiedon,10) >= '2019-02-28'))
   and a.statecode = '0'
;
SQL结束执行时间：20190301030009
SQL开始执行时间：20190301030009

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190301030010
SQL开始执行时间：20190301030010

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null

;
SQL结束执行时间：20190301030010

20190304102842开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304102842

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190304102842
SQL开始执行时间：20190304102842

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190304102842
SQL开始执行时间：20190304102842

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190304102842

20190305030034开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305030034

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-04' or left(a.modifiedon,10) >= '2019-03-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190305030035
SQL开始执行时间：20190305030035

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190305030035
SQL开始执行时间：20190305030035

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190305030035

20190306030157开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-05' or left(a.modifiedon,10) >= '2019-03-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190306030157
SQL开始执行时间：20190306030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190306030157
SQL开始执行时间：20190306030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190306030158

20190307030157开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-06' or left(a.modifiedon,10) >= '2019-03-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190307030157
SQL开始执行时间：20190307030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190307030158
SQL开始执行时间：20190307030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190307030158

20190308030159开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308030159

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-07' or left(a.modifiedon,10) >= '2019-03-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190308030159
SQL开始执行时间：20190308030159

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190308030159
SQL开始执行时间：20190308030159

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190308030200

20190309030156开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-08' or left(a.modifiedon,10) >= '2019-03-08'))
   and a.statecode = '0'
;
SQL结束执行时间：20190309030156
SQL开始执行时间：20190309030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190309030156
SQL开始执行时间：20190309030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190309030157

20190310030158开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-09' or left(a.modifiedon,10) >= '2019-03-09'))
   and a.statecode = '0'
;
SQL结束执行时间：20190310030158
SQL开始执行时间：20190310030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190310030158
SQL开始执行时间：20190310030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190310030159

20190311030156开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-10' or left(a.modifiedon,10) >= '2019-03-10'))
   and a.statecode = '0'
;
SQL结束执行时间：20190311030156
SQL开始执行时间：20190311030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190311030156
SQL开始执行时间：20190311030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190311030156

20190312030158开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-11' or left(a.modifiedon,10) >= '2019-03-11'))
   and a.statecode = '0'
;
SQL结束执行时间：20190312030158
SQL开始执行时间：20190312030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190312030158
SQL开始执行时间：20190312030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190312030159

20190313030156开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-12' or left(a.modifiedon,10) >= '2019-03-12'))
   and a.statecode = '0'
;
SQL结束执行时间：20190313030156
SQL开始执行时间：20190313030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190313030156
SQL开始执行时间：20190313030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190313030157

20190314030157开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-13' or left(a.modifiedon,10) >= '2019-03-13'))
   and a.statecode = '0'
;
SQL结束执行时间：20190314030158
SQL开始执行时间：20190314030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190314030158
SQL开始执行时间：20190314030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190314030158

20190315030156开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-14' or left(a.modifiedon,10) >= '2019-03-14'))
   and a.statecode = '0'
;
SQL结束执行时间：20190315030156
SQL开始执行时间：20190315030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190315030156
SQL开始执行时间：20190315030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190315030157

20190316030156开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-15' or left(a.modifiedon,10) >= '2019-03-15'))
   and a.statecode = '0'
;
SQL结束执行时间：20190316030156
SQL开始执行时间：20190316030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190316030200
SQL开始执行时间：20190316030200

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190316030208

20190317030200开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317030200

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-16' or left(a.modifiedon,10) >= '2019-03-16'))
   and a.statecode = '0'
;
SQL结束执行时间：20190317030200
SQL开始执行时间：20190317030200

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190317030200
SQL开始执行时间：20190317030200

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190317030200

20190318030156开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-17' or left(a.modifiedon,10) >= '2019-03-17'))
   and a.statecode = '0'
;
SQL结束执行时间：20190318030156
SQL开始执行时间：20190318030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190318030156
SQL开始执行时间：20190318030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190318030156

20190319030156开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-18' or left(a.modifiedon,10) >= '2019-03-18'))
   and a.statecode = '0'
;
SQL结束执行时间：20190319030156
SQL开始执行时间：20190319030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190319030156
SQL开始执行时间：20190319030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190319030157

20190320030156开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-19' or left(a.modifiedon,10) >= '2019-03-19'))
   and a.statecode = '0'
;
SQL结束执行时间：20190320030156
SQL开始执行时间：20190320030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190320030156
SQL开始执行时间：20190320030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190320030156

20190321030200开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321030200

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-20' or left(a.modifiedon,10) >= '2019-03-20'))
   and a.statecode = '0'
;
SQL结束执行时间：20190321030200
SQL开始执行时间：20190321030200

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190321030200
SQL开始执行时间：20190321030200

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190321030200

20190322030157开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-21' or left(a.modifiedon,10) >= '2019-03-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190322030157
SQL开始执行时间：20190322030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190322030157
SQL开始执行时间：20190322030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190322030157

20190323030157开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-22' or left(a.modifiedon,10) >= '2019-03-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190323030157
SQL开始执行时间：20190323030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190323030158
SQL开始执行时间：20190323030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190323030158

20190324030157开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-23' or left(a.modifiedon,10) >= '2019-03-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190324030157
SQL开始执行时间：20190324030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190324030157
SQL开始执行时间：20190324030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190324030157

20190325030158开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-24' or left(a.modifiedon,10) >= '2019-03-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190325030158
SQL开始执行时间：20190325030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190325030158
SQL开始执行时间：20190325030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190325030158

20190326030156开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-25' or left(a.modifiedon,10) >= '2019-03-25'))
   and a.statecode = '0'
;
SQL结束执行时间：20190326030156
SQL开始执行时间：20190326030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190326030156
SQL开始执行时间：20190326030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190326030157

20190327030156开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-26' or left(a.modifiedon,10) >= '2019-03-26'))
   and a.statecode = '0'
;
SQL结束执行时间：20190327030156
SQL开始执行时间：20190327030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190327030156
SQL开始执行时间：20190327030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190327030156

20190328030158开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-27' or left(a.modifiedon,10) >= '2019-03-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190328030158
SQL开始执行时间：20190328030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190328030158
SQL开始执行时间：20190328030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190328030158

20190329030157开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-28' or left(a.modifiedon,10) >= '2019-03-28'))
   and a.statecode = '0'
;
SQL结束执行时间：20190329030157
SQL开始执行时间：20190329030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190329030157
SQL开始执行时间：20190329030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190329030157

20190330030157开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-29' or left(a.modifiedon,10) >= '2019-03-29'))
   and a.statecode = '0'
;
SQL结束执行时间：20190330030157
SQL开始执行时间：20190330030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190330030157
SQL开始执行时间：20190330030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190330030158

20190331030156开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-30' or left(a.modifiedon,10) >= '2019-03-30'))
   and a.statecode = '0'
;
SQL结束执行时间：20190331030157
SQL开始执行时间：20190331030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190331030157
SQL开始执行时间：20190331030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190331030157

20190401030156开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401030156

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-03-31' or left(a.modifiedon,10) >= '2019-03-31'))
   and a.statecode = '0'
;
SQL结束执行时间：20190401030156
SQL开始执行时间：20190401030156

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190401030156
SQL开始执行时间：20190401030156

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190401030156

20190402030158开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-01' or left(a.modifiedon,10) >= '2019-04-01'))
   and a.statecode = '0'
;
SQL结束执行时间：20190402030158
SQL开始执行时间：20190402030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190402030158
SQL开始执行时间：20190402030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190402030158

20190403030157开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-02' or left(a.modifiedon,10) >= '2019-04-02'))
   and a.statecode = '0'
;
SQL结束执行时间：20190403030158
SQL开始执行时间：20190403030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190403030158
SQL开始执行时间：20190403030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190403030159

20190404030158开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-03' or left(a.modifiedon,10) >= '2019-04-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190404030158
SQL开始执行时间：20190404030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190404030159
SQL开始执行时间：20190404030159

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190404030159

20190405030159开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405030159

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-04' or left(a.modifiedon,10) >= '2019-04-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190405030200
SQL开始执行时间：20190405030200

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190405030200
SQL开始执行时间：20190405030200

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190405030201

20190406030159开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406030159

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-05' or left(a.modifiedon,10) >= '2019-04-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190406030159
SQL开始执行时间：20190406030159

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190406030159
SQL开始执行时间：20190406030159

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190406030159

20190407030158开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407030158

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-06' or left(a.modifiedon,10) >= '2019-04-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190407030158
SQL开始执行时间：20190407030158

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190407030158
SQL开始执行时间：20190407030158

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190407030158

20190408030157开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408030157

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-07' or left(a.modifiedon,10) >= '2019-04-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190408030157
SQL开始执行时间：20190408030157

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190408030157
SQL开始执行时间：20190408030157

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190408030157

20190409030047开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where ((left(a.createdon,10) >= '2019-04-08' or left(a.modifiedon,10) >= '2019-04-08'))
   and a.statecode = '0'
;
SQL结束执行时间：20190409030047
SQL开始执行时间：20190409030047

delete from edw.crm_screening_diagnosises where screening_diagnosis_id in (select new_name from ufdata.crm_new_screening_diagnosises_pre)
;
SQL结束执行时间：20190409030047
SQL开始执行时间：20190409030047

insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190409030049

20190410030046开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190410030046
SQL开始执行时间：20190410030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190410030046
SQL开始执行时间：20190410030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190410030133

20190412030045开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412030045

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190412030046
SQL开始执行时间：20190412030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190412030046
SQL开始执行时间：20190412030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190412030133

20190413030045开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413030045

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190413030045
SQL开始执行时间：20190413030045


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190413030045
SQL开始执行时间：20190413030045
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190413030133

20190414030046开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190414030047
SQL开始执行时间：20190414030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190414030047
SQL开始执行时间：20190414030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190414030136

20190415030046开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190415030046
SQL开始执行时间：20190415030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190415030046
SQL开始执行时间：20190415030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190415030135

20190416030047开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190416030047
SQL开始执行时间：20190416030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190416030047
SQL开始执行时间：20190416030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190416030137

20190417030046开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190417030046
SQL开始执行时间：20190417030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190417030046
SQL开始执行时间：20190417030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190417030136

20190418030048开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190418030048
SQL开始执行时间：20190418030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190418030048
SQL开始执行时间：20190418030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190418030138

20190419030051开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190419030051
SQL开始执行时间：20190419030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190419030051
SQL开始执行时间：20190419030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190419030141

20190420030046开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190420030046
SQL开始执行时间：20190420030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190420030046
SQL开始执行时间：20190420030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190420030136

20190421030047开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190421030047
SQL开始执行时间：20190421030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190421030047
SQL开始执行时间：20190421030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190421030138

20190422030047开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190422030048
SQL开始执行时间：20190422030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190422030048
SQL开始执行时间：20190422030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190422030139

20190423030047开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190423030047
SQL开始执行时间：20190423030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190423030047
SQL开始执行时间：20190423030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190423030138

20190424030048开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190424030048
SQL开始执行时间：20190424030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190424030048
SQL开始执行时间：20190424030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190424030139

20190425030048开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190425030048
SQL开始执行时间：20190425030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190425030048
SQL开始执行时间：20190425030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190425030140

20190426030048开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190426030048
SQL开始执行时间：20190426030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190426030048
SQL开始执行时间：20190426030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190426030141

20190427030047开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190427030047
SQL开始执行时间：20190427030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190427030047
SQL开始执行时间：20190427030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190427030140

20190428030048开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190428030049
SQL开始执行时间：20190428030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190428030049
SQL开始执行时间：20190428030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190428030142

20190429030047开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190429030048
SQL开始执行时间：20190429030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190429030048
SQL开始执行时间：20190429030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190429030141

20190430030047开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190430030047
SQL开始执行时间：20190430030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190430030047
SQL开始执行时间：20190430030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190430030140

20190501030046开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190501030046
SQL开始执行时间：20190501030046


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190501030046
SQL开始执行时间：20190501030046
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190501030144

20190502030048开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190502030048
SQL开始执行时间：20190502030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190502030048
SQL开始执行时间：20190502030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190502030147

20190503030047开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190503030048
SQL开始执行时间：20190503030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190503030048
SQL开始执行时间：20190503030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190503030147

20190504030046开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504030046

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190504030047
SQL开始执行时间：20190504030047


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190504030047
SQL开始执行时间：20190504030047
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190504030147

20190505030048开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190505030048
SQL开始执行时间：20190505030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190505030048
SQL开始执行时间：20190505030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190505030149

20190506030049开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190506030049
SQL开始执行时间：20190506030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190506030049
SQL开始执行时间：20190506030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190506030152

20190507030047开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190507030048
SQL开始执行时间：20190507030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190507030048
SQL开始执行时间：20190507030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190507030151

20190508030047开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508030047

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190508030048
SQL开始执行时间：20190508030048


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190508030048
SQL开始执行时间：20190508030048
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190508030151

20190510030058开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510030058

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190510030058
SQL开始执行时间：20190510030058


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190510030058
SQL开始执行时间：20190510030058
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190510030202

20190511030049开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190511030049
SQL开始执行时间：20190511030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190511030049
SQL开始执行时间：20190511030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190511030154

20190512030049开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190512030049
SQL开始执行时间：20190512030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190512030049
SQL开始执行时间：20190512030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190512030154

20190513030048开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190513030049
SQL开始执行时间：20190513030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190513030049
SQL开始执行时间：20190513030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190513030154

20190514030053开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514030053

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190514030053
SQL开始执行时间：20190514030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190514030053
SQL开始执行时间：20190514030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190514030200

20190515030051开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190515030051
SQL开始执行时间：20190515030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190515030051
SQL开始执行时间：20190515030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190515030158

20190516030049开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190516030049
SQL开始执行时间：20190516030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190516030049
SQL开始执行时间：20190516030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190516030156

20190517030049开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190517030050
SQL开始执行时间：20190517030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190517030050
SQL开始执行时间：20190517030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190517030156

20190518030049开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190518030050
SQL开始执行时间：20190518030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190518030050
SQL开始执行时间：20190518030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190518030155

20190519030049开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190519030049
SQL开始执行时间：20190519030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190519030049
SQL开始执行时间：20190519030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190519030155

20190520030054开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520030054

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190520030054
SQL开始执行时间：20190520030054


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190520030054
SQL开始执行时间：20190520030054
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190520030200

20190521030048开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521030048

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190521030049
SQL开始执行时间：20190521030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190521030049
SQL开始执行时间：20190521030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190521030156

20190522030049开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190522030049
SQL开始执行时间：20190522030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190522030049
SQL开始执行时间：20190522030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190522030156

20190523030049开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190523030049
SQL开始执行时间：20190523030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190523030049
SQL开始执行时间：20190523030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190523030156

20190524030049开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190524030049
SQL开始执行时间：20190524030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190524030049
SQL开始执行时间：20190524030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190524030156

20190525030049开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190525030050
SQL开始执行时间：20190525030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190525030050
SQL开始执行时间：20190525030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190525030156

20190526030049开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190526030050
SQL开始执行时间：20190526030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190526030050
SQL开始执行时间：20190526030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190526030157

20190527030051开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190527030051
SQL开始执行时间：20190527030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190527030051
SQL开始执行时间：20190527030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190527030158

20190528030051开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190528030051
SQL开始执行时间：20190528030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190528030051
SQL开始执行时间：20190528030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190528030157

20190529030050开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190529030051
SQL开始执行时间：20190529030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190529030051
SQL开始执行时间：20190529030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190529030200

20190530030051开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190530030051
SQL开始执行时间：20190530030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190530030051
SQL开始执行时间：20190530030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190530030157

20190531030050开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190531030050
SQL开始执行时间：20190531030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190531030050
SQL开始执行时间：20190531030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190531030158

20190601030051开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190601030051
SQL开始执行时间：20190601030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190601030052
SQL开始执行时间：20190601030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190601030200

20190602030050开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190602030051
SQL开始执行时间：20190602030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190602030051
SQL开始执行时间：20190602030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190602030158

20190603030056开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603030056

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190603030056
SQL开始执行时间：20190603030056


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190603030056
SQL开始执行时间：20190603030056
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190603030204

20190604030050开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190604030050
SQL开始执行时间：20190604030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190604030050
SQL开始执行时间：20190604030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190604030200

20190605030050开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190605030050
SQL开始执行时间：20190605030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190605030050
SQL开始执行时间：20190605030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190605030159

20190606030049开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190606030050
SQL开始执行时间：20190606030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190606030050
SQL开始执行时间：20190606030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,a.new_start_time
      ,a.new_finish_time
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190606030159

20190607030050开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190607030050
SQL开始执行时间：20190607030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190607030050
SQL开始执行时间：20190607030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190607030204

20190608030051开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190608030051
SQL开始执行时间：20190608030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190608030051
SQL开始执行时间：20190608030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190608030206

20190609030050开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190609030050
SQL开始执行时间：20190609030050


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190609030050
SQL开始执行时间：20190609030050
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190609030207

20190610030049开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610030049

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190610030049
SQL开始执行时间：20190610030049


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190610030049
SQL开始执行时间：20190610030049
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190610030205

20190611030051开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190611030051
SQL开始执行时间：20190611030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190611030051
SQL开始执行时间：20190611030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190611030206

20190612030051开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612030051

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190612030052
SQL开始执行时间：20190612030052


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190612030052
SQL开始执行时间：20190612030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190612030206

20190613030050开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613030050

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190613030051
SQL开始执行时间：20190613030051


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190613030051
SQL开始执行时间：20190613030051
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190613030206

20190614030053开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614030053

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190614030053
SQL开始执行时间：20190614030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190614030053
SQL开始执行时间：20190614030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190614030210

20190615030054开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615030054

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190615030054
SQL开始执行时间：20190615030054


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190615030054
SQL开始执行时间：20190615030054
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190615030210

20190616030053开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616030053

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190616030053
SQL开始执行时间：20190616030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190616030053
SQL开始执行时间：20190616030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190616030210

20190617030052开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190617030053
SQL开始执行时间：20190617030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190617030053
SQL开始执行时间：20190617030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190617030210

20190618030052开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190618030053
SQL开始执行时间：20190618030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190618030053
SQL开始执行时间：20190618030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190618030209

20190619030052开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190619030052
SQL开始执行时间：20190619030052


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190619030052
SQL开始执行时间：20190619030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190619030209

20190620030055开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620030055

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190620030056
SQL开始执行时间：20190620030056


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190620030056
SQL开始执行时间：20190620030056
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190620030212

20190621030052开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190621030052
SQL开始执行时间：20190621030052


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190621030052
SQL开始执行时间：20190621030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190621030208

20190622030053开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622030053

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190622030053
SQL开始执行时间：20190622030053


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190622030053
SQL开始执行时间：20190622030053
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190622030210

20190623030052开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190623030052
SQL开始执行时间：20190623030052


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190623030052
SQL开始执行时间：20190623030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190623030209

20190624030052开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624030052

create temporary table ufdata.crm_new_screening_diagnosises_pre as
select * 
  from ufdata.crm_new_screening_diagnosises a
 where a.statecode = '0'
;
SQL结束执行时间：20190624030052
SQL开始执行时间：20190624030052


truncate table edw.crm_screening_diagnosises
;
SQL结束执行时间：20190624030052
SQL开始执行时间：20190624030052
insert into edw.crm_screening_diagnosises
select i.new_num
      ,i.name
      ,f.lastname as ownerid
      ,c.name as new_area
      ,b.new_name as new_province
      ,d.new_name as new_city
      ,e.new_name as new_county
      ,a.new_labs
      ,a.new_site
      ,a.new_diagnosisid_organization
      ,a.new_name as screening_diagnosis_id
      ,k.new_name as id
      ,k.new_number_of_reagents
      ,date_add(a.new_start_time, interval 8 hour)
      ,date_add(a.new_finish_time, interval 8 hour)
      ,l.item_name as item_dl
      ,m.item_name as item_xl
      ,n.item_name as item_mx
      ,k.new_biosan
      ,k.new_competitor_number
      ,o.name as jzds_name
      ,case when k._new_testing_organization_value = 'd12b7e3a-356a-e811-80c6-0050569a5e34' then '安致'
            when k._new_testing_organization_value = 'e487b0f9-f454-e811-80cb-005056a0fd6d' then '贝康'
            when k._new_testing_organization_value = '82806821-f554-e811-80cb-005056a0fd6d' then '甄元'
            when k._new_testing_organization_value = 'e687b0f9-f454-e811-80cb-005056a0fd6d' then '华大'
            when k._new_testing_organization_value is null then null
            else '请修改代码' end as testing_organization_three
      ,case when k._new_testing_organization_value is null then '自建'
            else '外送' end as hzfs
      ,k.new_cszh
      ,g.lastname as createdby
      ,a.createdon
      ,h.lastname as modifiedby
      ,j.lastname as modifiedonbehalfby
      ,a.modifiedon
  from ufdata.crm_new_screening_diagnosises_pre a
  left join ufdata.crm_accounts i
    on a.new_account = i.accountid
	left join ufdata.crm_sales_areas b
	  on a.new_province = b.new_siteid
	left join edw.dic_crm c
	  on a.new_area = c.id
	left join ufdata.crm_sales_areas d
	  on a.new_city = d.new_siteid
	left join ufdata.crm_sales_areas e
	  on a.new_county = e.new_siteid
	left join ufdata.crm_systemusers f
	  on a.ownerid = f.ownerid
	left join ufdata.crm_systemusers g
	  on a.createdby = g.ownerid
	left join ufdata.crm_systemusers h
	  on a.modifiedby = h.ownerid
	left join ufdata.crm_systemusers j
	  on a.modifiedonbehalfby = j.ownerid
	left join ufdata.crm_new_screening_subgs k
	  on a.new_screening_diagnosisid = k._new_screening_diagnosis_value
	left join edw.dic_item_crm l
	  on k._new_type1_value = l.item_code
	left join edw.dic_item_crm m
	  on k._new_type2_value = m.item_code
	left join edw.dic_item_crm n
	  on k._new_type3_value = n.item_code
	left join ufdata.crm_competitors o
	  on k._new_competitor_value = o.competitorid
 where k._new_screening_diagnosis_value is not null
   and k.statecode = '0'

;
SQL结束执行时间：20190624030210
