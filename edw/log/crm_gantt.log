
20190301135202开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190301135202
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-08-27' or left(a.modifiedon,10) >= '2019-08-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190301135202
SQL开始执行时间：20190301135202

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190301135202
SQL开始执行时间：20190301135202

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid

;
SQL结束执行时间：20190301135202
SQL开始执行时间：20190301135202

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190301135202

20190301140213开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190301140213
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-02-27' or left(a.modifiedon,10) >= '2019-02-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190301140213
SQL开始执行时间：20190301140213

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190301140213
SQL开始执行时间：20190301140213

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid

;
SQL结束执行时间：20190301140213
SQL开始执行时间：20190301140213

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190301140213

20190304102842开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304102842
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190304102842
SQL开始执行时间：20190304102842

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190304102842
SQL开始执行时间：20190304102842

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid

;
SQL结束执行时间：20190304102842
SQL开始执行时间：20190304102842

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190304102843

20190305030034开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305030034
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-04' or left(a.modifiedon,10) >= '2019-03-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190305030035
SQL开始执行时间：20190305030035

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190305030035
SQL开始执行时间：20190305030035

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid

;
SQL结束执行时间：20190305030036
SQL开始执行时间：20190305030036

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190305030036

20190306030157开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-05' or left(a.modifiedon,10) >= '2019-03-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190306030157
SQL开始执行时间：20190306030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190306030159
SQL开始执行时间：20190306030159

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190306030159
SQL开始执行时间：20190306030159

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190306030159

20190307030157开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-06' or left(a.modifiedon,10) >= '2019-03-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190307030158
SQL开始执行时间：20190307030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190307030158
SQL开始执行时间：20190307030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190307030158
SQL开始执行时间：20190307030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190307030158

20190308030159开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308030159
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-07' or left(a.modifiedon,10) >= '2019-03-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190308030159
SQL开始执行时间：20190308030159

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190308030200
SQL开始执行时间：20190308030200

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190308030200
SQL开始执行时间：20190308030200

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190308030200

20190309030156开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-08' or left(a.modifiedon,10) >= '2019-03-08'))
   and a.statecode = '0'
;
SQL结束执行时间：20190309030156
SQL开始执行时间：20190309030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190309030158
SQL开始执行时间：20190309030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190309030158
SQL开始执行时间：20190309030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190309030158

20190310030158开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-09' or left(a.modifiedon,10) >= '2019-03-09'))
   and a.statecode = '0'
;
SQL结束执行时间：20190310030158
SQL开始执行时间：20190310030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190310030200
SQL开始执行时间：20190310030200

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190310030200
SQL开始执行时间：20190310030200

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190310030200

20190311030156开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-10' or left(a.modifiedon,10) >= '2019-03-10'))
   and a.statecode = '0'
;
SQL结束执行时间：20190311030156
SQL开始执行时间：20190311030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190311030157
SQL开始执行时间：20190311030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190311030157
SQL开始执行时间：20190311030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190311030157

20190312030158开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-11' or left(a.modifiedon,10) >= '2019-03-11'))
   and a.statecode = '0'
;
SQL结束执行时间：20190312030159
SQL开始执行时间：20190312030159

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190312030201
SQL开始执行时间：20190312030201

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190312030201
SQL开始执行时间：20190312030201

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190312030201

20190313030156开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-12' or left(a.modifiedon,10) >= '2019-03-12'))
   and a.statecode = '0'
;
SQL结束执行时间：20190313030157
SQL开始执行时间：20190313030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190313030157
SQL开始执行时间：20190313030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190313030157
SQL开始执行时间：20190313030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190313030157

20190314030157开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-13' or left(a.modifiedon,10) >= '2019-03-13'))
   and a.statecode = '0'
;
SQL结束执行时间：20190314030158
SQL开始执行时间：20190314030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190314030158
SQL开始执行时间：20190314030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190314030158
SQL开始执行时间：20190314030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190314030158

20190315030156开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-14' or left(a.modifiedon,10) >= '2019-03-14'))
   and a.statecode = '0'
;
SQL结束执行时间：20190315030157
SQL开始执行时间：20190315030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190315030157
SQL开始执行时间：20190315030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190315030157
SQL开始执行时间：20190315030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190315030157

20190316030156开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-15' or left(a.modifiedon,10) >= '2019-03-15'))
   and a.statecode = '0'
;
SQL结束执行时间：20190316030156
SQL开始执行时间：20190316030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190316030158
SQL开始执行时间：20190316030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190316030158
SQL开始执行时间：20190316030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190316030158

20190317030200开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317030200
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-16' or left(a.modifiedon,10) >= '2019-03-16'))
   and a.statecode = '0'
;
SQL结束执行时间：20190317030200
SQL开始执行时间：20190317030200

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190317030200
SQL开始执行时间：20190317030200

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190317030200
SQL开始执行时间：20190317030200

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190317030200

20190318030156开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-17' or left(a.modifiedon,10) >= '2019-03-17'))
   and a.statecode = '0'
;
SQL结束执行时间：20190318030156
SQL开始执行时间：20190318030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190318030157
SQL开始执行时间：20190318030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190318030157
SQL开始执行时间：20190318030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190318030157

20190319030156开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-18' or left(a.modifiedon,10) >= '2019-03-18'))
   and a.statecode = '0'
;
SQL结束执行时间：20190319030156
SQL开始执行时间：20190319030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190319030157
SQL开始执行时间：20190319030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190319030157
SQL开始执行时间：20190319030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190319030157

20190320030156开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-19' or left(a.modifiedon,10) >= '2019-03-19'))
   and a.statecode = '0'
;
SQL结束执行时间：20190320030156
SQL开始执行时间：20190320030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190320030156
SQL开始执行时间：20190320030156

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190320030156
SQL开始执行时间：20190320030156

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190320030156

20190321030200开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321030200
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-20' or left(a.modifiedon,10) >= '2019-03-20'))
   and a.statecode = '0'
;
SQL结束执行时间：20190321030200
SQL开始执行时间：20190321030200

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190321030200
SQL开始执行时间：20190321030200

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190321030200
SQL开始执行时间：20190321030200

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190321030200

20190322030157开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-21' or left(a.modifiedon,10) >= '2019-03-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190322030157
SQL开始执行时间：20190322030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190322030158
SQL开始执行时间：20190322030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190322030158
SQL开始执行时间：20190322030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190322030158

20190323030157开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-22' or left(a.modifiedon,10) >= '2019-03-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190323030158
SQL开始执行时间：20190323030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190323030158
SQL开始执行时间：20190323030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190323030158
SQL开始执行时间：20190323030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190323030158

20190324030157开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-23' or left(a.modifiedon,10) >= '2019-03-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190324030157
SQL开始执行时间：20190324030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190324030157
SQL开始执行时间：20190324030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190324030157
SQL开始执行时间：20190324030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190324030157

20190325030158开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-24' or left(a.modifiedon,10) >= '2019-03-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190325030158
SQL开始执行时间：20190325030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190325030158
SQL开始执行时间：20190325030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190325030158
SQL开始执行时间：20190325030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190325030158

20190326030156开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-25' or left(a.modifiedon,10) >= '2019-03-25'))
   and a.statecode = '0'
;
SQL结束执行时间：20190326030156
SQL开始执行时间：20190326030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190326030157
SQL开始执行时间：20190326030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190326030157
SQL开始执行时间：20190326030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190326030157

20190327030156开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-26' or left(a.modifiedon,10) >= '2019-03-26'))
   and a.statecode = '0'
;
SQL结束执行时间：20190327030156
SQL开始执行时间：20190327030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190327030157
SQL开始执行时间：20190327030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190327030157
SQL开始执行时间：20190327030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190327030157

20190328030158开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-27' or left(a.modifiedon,10) >= '2019-03-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190328030158
SQL开始执行时间：20190328030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190328030158
SQL开始执行时间：20190328030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190328030158
SQL开始执行时间：20190328030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190328030158

20190329030157开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-28' or left(a.modifiedon,10) >= '2019-03-28'))
   and a.statecode = '0'
;
SQL结束执行时间：20190329030157
SQL开始执行时间：20190329030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190329030157
SQL开始执行时间：20190329030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190329030157
SQL开始执行时间：20190329030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190329030157

20190330030157开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-29' or left(a.modifiedon,10) >= '2019-03-29'))
   and a.statecode = '0'
;
SQL结束执行时间：20190330030157
SQL开始执行时间：20190330030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190330030158
SQL开始执行时间：20190330030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190330030158
SQL开始执行时间：20190330030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190330030158

20190331030156开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-30' or left(a.modifiedon,10) >= '2019-03-30'))
   and a.statecode = '0'
;
SQL结束执行时间：20190331030157
SQL开始执行时间：20190331030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190331030157
SQL开始执行时间：20190331030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190331030157
SQL开始执行时间：20190331030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190331030157

20190401030156开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401030156
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-03-31' or left(a.modifiedon,10) >= '2019-03-31'))
   and a.statecode = '0'
;
SQL结束执行时间：20190401030156
SQL开始执行时间：20190401030156

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190401030157
SQL开始执行时间：20190401030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190401030157
SQL开始执行时间：20190401030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190401030157

20190402030158开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-01' or left(a.modifiedon,10) >= '2019-04-01'))
   and a.statecode = '0'
;
SQL结束执行时间：20190402030158
SQL开始执行时间：20190402030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190402030158
SQL开始执行时间：20190402030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190402030158
SQL开始执行时间：20190402030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190402030158

20190403030157开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-02' or left(a.modifiedon,10) >= '2019-04-02'))
   and a.statecode = '0'
;
SQL结束执行时间：20190403030158
SQL开始执行时间：20190403030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190403030158
SQL开始执行时间：20190403030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190403030158
SQL开始执行时间：20190403030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190403030158

20190404030158开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-03' or left(a.modifiedon,10) >= '2019-04-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190404030159
SQL开始执行时间：20190404030159

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190404030159
SQL开始执行时间：20190404030159

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190404030159
SQL开始执行时间：20190404030159

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190404030159

20190405030159开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405030159
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-04' or left(a.modifiedon,10) >= '2019-04-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190405030200
SQL开始执行时间：20190405030200

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190405030200
SQL开始执行时间：20190405030200

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190405030200
SQL开始执行时间：20190405030200

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190405030200

20190406030159开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406030159
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-05' or left(a.modifiedon,10) >= '2019-04-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190406030159
SQL开始执行时间：20190406030159

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190406030159
SQL开始执行时间：20190406030159

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190406030159
SQL开始执行时间：20190406030159

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190406030159

20190407030158开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407030158
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-06' or left(a.modifiedon,10) >= '2019-04-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190407030158
SQL开始执行时间：20190407030158

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190407030158
SQL开始执行时间：20190407030158

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190407030158
SQL开始执行时间：20190407030158

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190407030158

20190408030157开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408030157
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-07' or left(a.modifiedon,10) >= '2019-04-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190408030157
SQL开始执行时间：20190408030157

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190408030157
SQL开始执行时间：20190408030157

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190408030157
SQL开始执行时间：20190408030157

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190408030157

20190409030047开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-08' or left(a.modifiedon,10) >= '2019-04-08'))
   and a.statecode = '0'
;
SQL结束执行时间：20190409030047
SQL开始执行时间：20190409030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190409030047
SQL开始执行时间：20190409030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190409030047
SQL开始执行时间：20190409030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190409030047

20190410030046开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-09' or left(a.modifiedon,10) >= '2019-04-09'))
   and a.statecode = '0'
;
SQL结束执行时间：20190410030046
SQL开始执行时间：20190410030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190410030046
SQL开始执行时间：20190410030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190410030046
SQL开始执行时间：20190410030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190410030046

20190412030045开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412030045
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-11' or left(a.modifiedon,10) >= '2019-04-11'))
   and a.statecode = '0'
;
SQL结束执行时间：20190412030045
SQL开始执行时间：20190412030045

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190412030046
SQL开始执行时间：20190412030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190412030046
SQL开始执行时间：20190412030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190412030046

20190413030045开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413030045
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-12' or left(a.modifiedon,10) >= '2019-04-12'))
   and a.statecode = '0'
;
SQL结束执行时间：20190413030045
SQL开始执行时间：20190413030045

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190413030045
SQL开始执行时间：20190413030045

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190413030045
SQL开始执行时间：20190413030045

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190413030045

20190414030046开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-13' or left(a.modifiedon,10) >= '2019-04-13'))
   and a.statecode = '0'
;
SQL结束执行时间：20190414030046
SQL开始执行时间：20190414030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190414030047
SQL开始执行时间：20190414030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190414030047
SQL开始执行时间：20190414030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190414030047

20190415030046开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-14' or left(a.modifiedon,10) >= '2019-04-14'))
   and a.statecode = '0'
;
SQL结束执行时间：20190415030046
SQL开始执行时间：20190415030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190415030046
SQL开始执行时间：20190415030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190415030046
SQL开始执行时间：20190415030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190415030046

20190416030047开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-15' or left(a.modifiedon,10) >= '2019-04-15'))
   and a.statecode = '0'
;
SQL结束执行时间：20190416030047
SQL开始执行时间：20190416030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190416030047
SQL开始执行时间：20190416030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190416030047
SQL开始执行时间：20190416030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190416030047

20190417030046开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-16' or left(a.modifiedon,10) >= '2019-04-16'))
   and a.statecode = '0'
;
SQL结束执行时间：20190417030046
SQL开始执行时间：20190417030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190417030046
SQL开始执行时间：20190417030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190417030046
SQL开始执行时间：20190417030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190417030046

20190418030048开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-17' or left(a.modifiedon,10) >= '2019-04-17'))
   and a.statecode = '0'
;
SQL结束执行时间：20190418030048
SQL开始执行时间：20190418030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190418030048
SQL开始执行时间：20190418030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190418030048
SQL开始执行时间：20190418030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190418030048

20190419030051开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-18' or left(a.modifiedon,10) >= '2019-04-18'))
   and a.statecode = '0'
;
SQL结束执行时间：20190419030051
SQL开始执行时间：20190419030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190419030051
SQL开始执行时间：20190419030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190419030052
SQL开始执行时间：20190419030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190419030052

20190420030046开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-19' or left(a.modifiedon,10) >= '2019-04-19'))
   and a.statecode = '0'
;
SQL结束执行时间：20190420030046
SQL开始执行时间：20190420030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190420030046
SQL开始执行时间：20190420030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190420030046
SQL开始执行时间：20190420030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190420030046

20190421030047开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-20' or left(a.modifiedon,10) >= '2019-04-20'))
   and a.statecode = '0'
;
SQL结束执行时间：20190421030047
SQL开始执行时间：20190421030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190421030047
SQL开始执行时间：20190421030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190421030047
SQL开始执行时间：20190421030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190421030047

20190422030047开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-21' or left(a.modifiedon,10) >= '2019-04-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190422030047
SQL开始执行时间：20190422030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190422030048
SQL开始执行时间：20190422030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190422030048
SQL开始执行时间：20190422030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190422030048

20190423030047开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-22' or left(a.modifiedon,10) >= '2019-04-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190423030047
SQL开始执行时间：20190423030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190423030047
SQL开始执行时间：20190423030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190423030048
SQL开始执行时间：20190423030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190423030048

20190424030048开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-23' or left(a.modifiedon,10) >= '2019-04-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190424030048
SQL开始执行时间：20190424030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190424030048
SQL开始执行时间：20190424030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190424030048
SQL开始执行时间：20190424030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190424030048

20190425030048开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-24' or left(a.modifiedon,10) >= '2019-04-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190425030048
SQL开始执行时间：20190425030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190425030048
SQL开始执行时间：20190425030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190425030048
SQL开始执行时间：20190425030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190425030048

20190426030048开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-25' or left(a.modifiedon,10) >= '2019-04-25'))
   and a.statecode = '0'
;
SQL结束执行时间：20190426030048
SQL开始执行时间：20190426030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190426030048
SQL开始执行时间：20190426030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190426030048
SQL开始执行时间：20190426030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190426030048

20190427030047开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-26' or left(a.modifiedon,10) >= '2019-04-26'))
   and a.statecode = '0'
;
SQL结束执行时间：20190427030047
SQL开始执行时间：20190427030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190427030047
SQL开始执行时间：20190427030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190427030047
SQL开始执行时间：20190427030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190427030047

20190428030048开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-27' or left(a.modifiedon,10) >= '2019-04-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190428030048
SQL开始执行时间：20190428030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190428030049
SQL开始执行时间：20190428030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190428030049
SQL开始执行时间：20190428030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190428030049

20190429030047开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-28' or left(a.modifiedon,10) >= '2019-04-28'))
   and a.statecode = '0'
;
SQL结束执行时间：20190429030047
SQL开始执行时间：20190429030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190429030048
SQL开始执行时间：20190429030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190429030048
SQL开始执行时间：20190429030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190429030048

20190430030047开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-29' or left(a.modifiedon,10) >= '2019-04-29'))
   and a.statecode = '0'
;
SQL结束执行时间：20190430030047
SQL开始执行时间：20190430030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190430030047
SQL开始执行时间：20190430030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190430030047
SQL开始执行时间：20190430030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190430030047

20190501030046开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-04-30' or left(a.modifiedon,10) >= '2019-04-30'))
   and a.statecode = '0'
;
SQL结束执行时间：20190501030046
SQL开始执行时间：20190501030046

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190501030046
SQL开始执行时间：20190501030046

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190501030046
SQL开始执行时间：20190501030046

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190501030046

20190502030048开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-01' or left(a.modifiedon,10) >= '2019-05-01'))
   and a.statecode = '0'
;
SQL结束执行时间：20190502030048
SQL开始执行时间：20190502030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190502030048
SQL开始执行时间：20190502030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190502030048
SQL开始执行时间：20190502030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190502030048

20190503030048开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-02' or left(a.modifiedon,10) >= '2019-05-02'))
   and a.statecode = '0'
;
SQL结束执行时间：20190503030048
SQL开始执行时间：20190503030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190503030048
SQL开始执行时间：20190503030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190503030048
SQL开始执行时间：20190503030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190503030048

20190504030046开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504030046
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-03' or left(a.modifiedon,10) >= '2019-05-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190504030047
SQL开始执行时间：20190504030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190504030047
SQL开始执行时间：20190504030047

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190504030047
SQL开始执行时间：20190504030047

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190504030047

20190505030048开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-04' or left(a.modifiedon,10) >= '2019-05-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190505030048
SQL开始执行时间：20190505030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190505030048
SQL开始执行时间：20190505030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190505030048
SQL开始执行时间：20190505030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190505030048

20190506030049开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-05' or left(a.modifiedon,10) >= '2019-05-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190506030049
SQL开始执行时间：20190506030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190506030049
SQL开始执行时间：20190506030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190506030049
SQL开始执行时间：20190506030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190506030049

20190507030047开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-06' or left(a.modifiedon,10) >= '2019-05-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190507030047
SQL开始执行时间：20190507030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190507030048
SQL开始执行时间：20190507030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190507030048
SQL开始执行时间：20190507030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190507030048

20190508030047开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508030047
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-07' or left(a.modifiedon,10) >= '2019-05-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190508030047
SQL开始执行时间：20190508030047

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190508030048
SQL开始执行时间：20190508030048

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190508030048
SQL开始执行时间：20190508030048

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190508030048

20190510030058开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510030058
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-09' or left(a.modifiedon,10) >= '2019-05-09'))
   and a.statecode = '0'
;
SQL结束执行时间：20190510030058
SQL开始执行时间：20190510030058

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190510030058
SQL开始执行时间：20190510030058

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190510030058
SQL开始执行时间：20190510030058

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190510030058

20190511030049开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-10' or left(a.modifiedon,10) >= '2019-05-10'))
   and a.statecode = '0'
;
SQL结束执行时间：20190511030049
SQL开始执行时间：20190511030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190511030049
SQL开始执行时间：20190511030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190511030050
SQL开始执行时间：20190511030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190511030050

20190512030049开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-11' or left(a.modifiedon,10) >= '2019-05-11'))
   and a.statecode = '0'
;
SQL结束执行时间：20190512030049
SQL开始执行时间：20190512030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190512030049
SQL开始执行时间：20190512030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190512030049
SQL开始执行时间：20190512030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190512030049

20190513030048开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-12' or left(a.modifiedon,10) >= '2019-05-12'))
   and a.statecode = '0'
;
SQL结束执行时间：20190513030048
SQL开始执行时间：20190513030048

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190513030049
SQL开始执行时间：20190513030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190513030049
SQL开始执行时间：20190513030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190513030049

20190514030053开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514030053
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-13' or left(a.modifiedon,10) >= '2019-05-13'))
   and a.statecode = '0'
;
SQL结束执行时间：20190514030053
SQL开始执行时间：20190514030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190514030053
SQL开始执行时间：20190514030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190514030053
SQL开始执行时间：20190514030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190514030053

20190515030051开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-14' or left(a.modifiedon,10) >= '2019-05-14'))
   and a.statecode = '0'
;
SQL结束执行时间：20190515030051
SQL开始执行时间：20190515030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190515030051
SQL开始执行时间：20190515030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190515030051
SQL开始执行时间：20190515030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190515030051

20190516030049开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-15' or left(a.modifiedon,10) >= '2019-05-15'))
   and a.statecode = '0'
;
SQL结束执行时间：20190516030049
SQL开始执行时间：20190516030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190516030049
SQL开始执行时间：20190516030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190516030050
SQL开始执行时间：20190516030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190516030050

20190517030049开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-16' or left(a.modifiedon,10) >= '2019-05-16'))
   and a.statecode = '0'
;
SQL结束执行时间：20190517030050
SQL开始执行时间：20190517030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190517030050
SQL开始执行时间：20190517030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190517030050
SQL开始执行时间：20190517030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190517030050

20190518030049开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-17' or left(a.modifiedon,10) >= '2019-05-17'))
   and a.statecode = '0'
;
SQL结束执行时间：20190518030050
SQL开始执行时间：20190518030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190518030050
SQL开始执行时间：20190518030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190518030050
SQL开始执行时间：20190518030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190518030050

20190519030049开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-18' or left(a.modifiedon,10) >= '2019-05-18'))
   and a.statecode = '0'
;
SQL结束执行时间：20190519030049
SQL开始执行时间：20190519030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190519030049
SQL开始执行时间：20190519030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190519030049
SQL开始执行时间：20190519030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190519030049

20190520030054开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520030054
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-19' or left(a.modifiedon,10) >= '2019-05-19'))
   and a.statecode = '0'
;
SQL结束执行时间：20190520030054
SQL开始执行时间：20190520030054

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190520030054
SQL开始执行时间：20190520030054

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190520030054
SQL开始执行时间：20190520030054

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190520030054

20190521030048开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521030048
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-20' or left(a.modifiedon,10) >= '2019-05-20'))
   and a.statecode = '0'
;
SQL结束执行时间：20190521030049
SQL开始执行时间：20190521030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190521030049
SQL开始执行时间：20190521030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190521030049
SQL开始执行时间：20190521030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190521030049

20190522030049开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-21' or left(a.modifiedon,10) >= '2019-05-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190522030049
SQL开始执行时间：20190522030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190522030049
SQL开始执行时间：20190522030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190522030049
SQL开始执行时间：20190522030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190522030049

20190523030049开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-22' or left(a.modifiedon,10) >= '2019-05-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190523030049
SQL开始执行时间：20190523030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190523030049
SQL开始执行时间：20190523030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190523030049
SQL开始执行时间：20190523030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190523030049

20190524030049开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-23' or left(a.modifiedon,10) >= '2019-05-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190524030049
SQL开始执行时间：20190524030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190524030049
SQL开始执行时间：20190524030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190524030049
SQL开始执行时间：20190524030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190524030049

20190525030049开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-24' or left(a.modifiedon,10) >= '2019-05-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190525030049
SQL开始执行时间：20190525030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190525030050
SQL开始执行时间：20190525030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190525030050
SQL开始执行时间：20190525030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190525030050

20190526030049开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-25' or left(a.modifiedon,10) >= '2019-05-25'))
   and a.statecode = '0'
;
SQL结束执行时间：20190526030049
SQL开始执行时间：20190526030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190526030050
SQL开始执行时间：20190526030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190526030050
SQL开始执行时间：20190526030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190526030050

20190527030051开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-26' or left(a.modifiedon,10) >= '2019-05-26'))
   and a.statecode = '0'
;
SQL结束执行时间：20190527030051
SQL开始执行时间：20190527030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190527030051
SQL开始执行时间：20190527030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190527030051
SQL开始执行时间：20190527030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190527030051

20190528030051开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-27' or left(a.modifiedon,10) >= '2019-05-27'))
   and a.statecode = '0'
;
SQL结束执行时间：20190528030051
SQL开始执行时间：20190528030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190528030051
SQL开始执行时间：20190528030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190528030051
SQL开始执行时间：20190528030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190528030051

20190529030050开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-28' or left(a.modifiedon,10) >= '2019-05-28'))
   and a.statecode = '0'
;
SQL结束执行时间：20190529030051
SQL开始执行时间：20190529030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190529030051
SQL开始执行时间：20190529030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190529030051
SQL开始执行时间：20190529030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190529030051

20190530030051开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-29' or left(a.modifiedon,10) >= '2019-05-29'))
   and a.statecode = '0'
;
SQL结束执行时间：20190530030051
SQL开始执行时间：20190530030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190530030051
SQL开始执行时间：20190530030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190530030051
SQL开始执行时间：20190530030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190530030051

20190531030050开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-30' or left(a.modifiedon,10) >= '2019-05-30'))
   and a.statecode = '0'
;
SQL结束执行时间：20190531030050
SQL开始执行时间：20190531030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190531030050
SQL开始执行时间：20190531030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190531030050
SQL开始执行时间：20190531030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190531030050

20190601030051开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-05-31' or left(a.modifiedon,10) >= '2019-05-31'))
   and a.statecode = '0'
;
SQL结束执行时间：20190601030051
SQL开始执行时间：20190601030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190601030052
SQL开始执行时间：20190601030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190601030052
SQL开始执行时间：20190601030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190601030052

20190602030050开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-01' or left(a.modifiedon,10) >= '2019-06-01'))
   and a.statecode = '0'
;
SQL结束执行时间：20190602030050
SQL开始执行时间：20190602030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190602030051
SQL开始执行时间：20190602030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190602030051
SQL开始执行时间：20190602030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190602030051

20190603030056开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603030056
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-02' or left(a.modifiedon,10) >= '2019-06-02'))
   and a.statecode = '0'
;
SQL结束执行时间：20190603030056
SQL开始执行时间：20190603030056

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190603030056
SQL开始执行时间：20190603030056

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190603030056
SQL开始执行时间：20190603030056

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190603030056

20190604030050开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-03' or left(a.modifiedon,10) >= '2019-06-03'))
   and a.statecode = '0'
;
SQL结束执行时间：20190604030050
SQL开始执行时间：20190604030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190604030050
SQL开始执行时间：20190604030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190604030051
SQL开始执行时间：20190604030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190604030051

20190605030050开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-04' or left(a.modifiedon,10) >= '2019-06-04'))
   and a.statecode = '0'
;
SQL结束执行时间：20190605030050
SQL开始执行时间：20190605030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190605030050
SQL开始执行时间：20190605030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190605030050
SQL开始执行时间：20190605030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190605030050

20190606030049开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-05' or left(a.modifiedon,10) >= '2019-06-05'))
   and a.statecode = '0'
;
SQL结束执行时间：20190606030050
SQL开始执行时间：20190606030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190606030050
SQL开始执行时间：20190606030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190606030050
SQL开始执行时间：20190606030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190606030050

20190607030050开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-06' or left(a.modifiedon,10) >= '2019-06-06'))
   and a.statecode = '0'
;
SQL结束执行时间：20190607030050
SQL开始执行时间：20190607030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190607030050
SQL开始执行时间：20190607030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190607030050
SQL开始执行时间：20190607030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190607030050

20190608030051开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-07' or left(a.modifiedon,10) >= '2019-06-07'))
   and a.statecode = '0'
;
SQL结束执行时间：20190608030051
SQL开始执行时间：20190608030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190608030051
SQL开始执行时间：20190608030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190608030051
SQL开始执行时间：20190608030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190608030051

20190609030050开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-08' or left(a.modifiedon,10) >= '2019-06-08'))
   and a.statecode = '0'
;
SQL结束执行时间：20190609030050
SQL开始执行时间：20190609030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190609030050
SQL开始执行时间：20190609030050

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190609030050
SQL开始执行时间：20190609030050

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190609030050

20190610030049开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610030049
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-09' or left(a.modifiedon,10) >= '2019-06-09'))
   and a.statecode = '0'
;
SQL结束执行时间：20190610030049
SQL开始执行时间：20190610030049

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190610030049
SQL开始执行时间：20190610030049

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190610030049
SQL开始执行时间：20190610030049

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190610030049

20190611030051开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-10' or left(a.modifiedon,10) >= '2019-06-10'))
   and a.statecode = '0'
;
SQL结束执行时间：20190611030051
SQL开始执行时间：20190611030051

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190611030051
SQL开始执行时间：20190611030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190611030051
SQL开始执行时间：20190611030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190611030051

20190612030051开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612030051
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-11' or left(a.modifiedon,10) >= '2019-06-11'))
   and a.statecode = '0'
;
SQL结束执行时间：20190612030052
SQL开始执行时间：20190612030052

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190612030052
SQL开始执行时间：20190612030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190612030052
SQL开始执行时间：20190612030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190612030052

20190613030050开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613030050
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-12' or left(a.modifiedon,10) >= '2019-06-12'))
   and a.statecode = '0'
;
SQL结束执行时间：20190613030050
SQL开始执行时间：20190613030050

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190613030051
SQL开始执行时间：20190613030051

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190613030051
SQL开始执行时间：20190613030051

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190613030051

20190614030053开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614030053
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-13' or left(a.modifiedon,10) >= '2019-06-13'))
   and a.statecode = '0'
;
SQL结束执行时间：20190614030053
SQL开始执行时间：20190614030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190614030053
SQL开始执行时间：20190614030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190614030053
SQL开始执行时间：20190614030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190614030053

20190615030054开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615030054
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-14' or left(a.modifiedon,10) >= '2019-06-14'))
   and a.statecode = '0'
;
SQL结束执行时间：20190615030054
SQL开始执行时间：20190615030054

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190615030054
SQL开始执行时间：20190615030054

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190615030054
SQL开始执行时间：20190615030054

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190615030054

20190616030053开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616030053
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-15' or left(a.modifiedon,10) >= '2019-06-15'))
   and a.statecode = '0'
;
SQL结束执行时间：20190616030053
SQL开始执行时间：20190616030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190616030053
SQL开始执行时间：20190616030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190616030053
SQL开始执行时间：20190616030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190616030053

20190617030052开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-16' or left(a.modifiedon,10) >= '2019-06-16'))
   and a.statecode = '0'
;
SQL结束执行时间：20190617030053
SQL开始执行时间：20190617030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190617030053
SQL开始执行时间：20190617030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190617030053
SQL开始执行时间：20190617030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190617030053

20190618030052开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-17' or left(a.modifiedon,10) >= '2019-06-17'))
   and a.statecode = '0'
;
SQL结束执行时间：20190618030053
SQL开始执行时间：20190618030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190618030053
SQL开始执行时间：20190618030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190618030053
SQL开始执行时间：20190618030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190618030053

20190619030052开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-18' or left(a.modifiedon,10) >= '2019-06-18'))
   and a.statecode = '0'
;
SQL结束执行时间：20190619030052
SQL开始执行时间：20190619030052

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190619030052
SQL开始执行时间：20190619030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190619030052
SQL开始执行时间：20190619030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190619030052

20190620030055开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620030055
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-19' or left(a.modifiedon,10) >= '2019-06-19'))
   and a.statecode = '0'
;
SQL结束执行时间：20190620030056
SQL开始执行时间：20190620030056

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190620030056
SQL开始执行时间：20190620030056

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190620030056
SQL开始执行时间：20190620030056

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190620030056

20190621030052开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-20' or left(a.modifiedon,10) >= '2019-06-20'))
   and a.statecode = '0'
;
SQL结束执行时间：20190621030052
SQL开始执行时间：20190621030052

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190621030052
SQL开始执行时间：20190621030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190621030052
SQL开始执行时间：20190621030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190621030052

20190622030053开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622030053
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-21' or left(a.modifiedon,10) >= '2019-06-21'))
   and a.statecode = '0'
;
SQL结束执行时间：20190622030053
SQL开始执行时间：20190622030053

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190622030053
SQL开始执行时间：20190622030053

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190622030053
SQL开始执行时间：20190622030053

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190622030053

20190623030052开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-22' or left(a.modifiedon,10) >= '2019-06-22'))
   and a.statecode = '0'
;
SQL结束执行时间：20190623030052
SQL开始执行时间：20190623030052

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190623030052
SQL开始执行时间：20190623030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190623030052
SQL开始执行时间：20190623030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190623030052

20190624030052开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624030052
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-23' or left(a.modifiedon,10) >= '2019-06-23'))
   and a.statecode = '0'
;
SQL结束执行时间：20190624030052
SQL开始执行时间：20190624030052

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190624030052
SQL开始执行时间：20190624030052

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190624030052
SQL开始执行时间：20190624030052

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190624030052

20190625030041开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625030041
create temporary table edw.crm_gantt_pre as
select * 
  from ufdata.crm_item_gantt a
 where ((left(a.createdon,10) >= '2019-06-24' or left(a.modifiedon,10) >= '2019-06-24'))
   and a.statecode = '0'
;
SQL结束执行时间：20190625030041
SQL开始执行时间：20190625030041

delete from edw.crm_gantt where new_sales_planid in (select new_sales_planid from edw.crm_gantt_pre)
;
SQL结束执行时间：20190625030041
SQL开始执行时间：20190625030041

create temporary table edw.crm_gantt_pre2 as
select a.new_sales_planid
      ,c.new_num as ccus_code
      ,c.name as ccus_name
      ,case when a.new_years = '1' then '2018' else '2019' end as  new_years
      ,a.new_months
      ,c.new_area
      ,c.new_province
      ,c.new_city
      ,c.new_county
      ,d.new_project_num
      ,d.name as new_project_name
      ,d.new_open_date
      ,case when a.new_type = '3' then '上量' when a.new_type = '1' then '项目入院' else '城市学科建设' end as new_type
      ,case when a.new_business_type = '100000000' then '产品类'
            when a.new_business_type = '100000001' then 'LDT'
            when a.new_business_type = '100000002' then '服务类'
            else '未知' end as new_business_type
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,case when d.new_opp_statecode = '1' then '正在进行' 
            when d.new_opp_statecode = '2' then '暂停'
            else '未知' end as new_opp_statecode
      ,case when d.new_importance = 'True' then '是' 
            when d.new_importance = 'False' then '否'
            else '未知' end as new_importance
      ,h.lastname as new_audit
      ,i.lastname as ownerid
      ,a.new_to_do
      ,a.new_done
      ,case when a.new_alert = '1' then '正常'
            when a.new_alert = '2' then '推迟'
            when a.new_alert = '3' then '提前'
            else '未知' end as new_alert
      ,case when a.new_point = '100' then '0'
            when a.new_point = '101' then '-1'
            when a.new_point = '102' then '-2'
            when a.new_point = '103' then '-3'
            when a.new_point = '3' then '3'
            when a.new_point = '4' then '3+'
            else '未知' end as new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,k.lastname as modifiedby
      ,a.createdon
      ,j.lastname as createdby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
  from edw.crm_gantt_pre a
  left join ufdata.crm_accounts b
    on a._new_account_value = b.accountid
  left join edw.crm_accounts c
    on b.new_num = c.new_num
  left join ufdata.crm_gantt_opportunities d
    on a._new_opportunity_value = d.opportunityid
	left join edw.dic_item_crm e
	  on d._new_class_value = e.item_code
	left join edw.dic_item_crm f
	  on d._new_category_value = f.item_code
	left join edw.dic_item_crm g
	  on d._new_descrp_value = g.item_code
  left join ufdata.crm_systemusers h
    on a._new_audit_value = h.ownerid
  left join ufdata.crm_systemusers i
    on a._ownerid_value = i.ownerid
  left join ufdata.crm_systemusers j
    on a._modifiedby_value = j.ownerid
  left join ufdata.crm_systemusers k
    on a._createdby_value = k.ownerid
 where d.statecode = '0'

;
SQL结束执行时间：20190625030041
SQL开始执行时间：20190625030041

insert into edw.crm_gantt
select a.new_sales_planid
      ,a.new_years
      ,a.new_months
      ,a.ccus_code
      ,a.ccus_name
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_open_date
      ,a.new_type
      ,a.new_business_type
      ,a.new_project_num
      ,a.new_project_name
      ,a.new_opp_statecode
      ,a.new_importance
      ,a.new_audit
      ,a.ownerid
      ,a.new_to_do
      ,a.new_done
      ,a.new_alert
      ,a.new_point
      ,a.new_solution10
      ,a.new_solution1
      ,a.new_progress1
      ,a.createdby
      ,a.createdon
      ,a.modifiedby
      ,a.modifiedon
      ,a.statecode
      ,a.statuscode
 from edw.crm_gantt_pre2 a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.ccus_code = c.ccuscode

;
SQL结束执行时间：20190625030041
