
20190624170759开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190624170759

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190624170759
SQL开始执行时间：20190624170759
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code

;
SQL结束执行时间：20190624170800
SQL开始执行时间：20190624170800


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190624170800
SQL开始执行时间：20190624170800
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as custcode
      ,a.name as custname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190624170800

20190625030040开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190625030040
SQL开始执行时间：20190625030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code

;
SQL结束执行时间：20190625030042
SQL开始执行时间：20190625030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190625030042
SQL开始执行时间：20190625030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as custcode
      ,a.name as custname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190625030042

20190626030044开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190626030044
SQL开始执行时间：20190626030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code

;
SQL结束执行时间：20190626030046
SQL开始执行时间：20190626030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190626030046
SQL开始执行时间：20190626030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as custcode
      ,a.name as custname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190626030046

20190627030040开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190627030040
SQL开始执行时间：20190627030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190627030042
SQL开始执行时间：20190627030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190627030042
SQL开始执行时间：20190627030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190627030042

20190628030041开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190628030041
SQL开始执行时间：20190628030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190628030043
SQL开始执行时间：20190628030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190628030043
SQL开始执行时间：20190628030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190628030043

20190629030041开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190629030041
SQL开始执行时间：20190629030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190629030043
SQL开始执行时间：20190629030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190629030043
SQL开始执行时间：20190629030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190629030043

20190630030040开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190630030040
SQL开始执行时间：20190630030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190630030042
SQL开始执行时间：20190630030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190630030042
SQL开始执行时间：20190630030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190630030042

20190701030042开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190701030042
SQL开始执行时间：20190701030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190701030044
SQL开始执行时间：20190701030044


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190701030044
SQL开始执行时间：20190701030044
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190701030044

20190702030045开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702030045
SQL开始执行时间：20190702030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702030047
SQL开始执行时间：20190702030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702030047
SQL开始执行时间：20190702030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702030047

20190702091032开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702091032

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702091032
SQL开始执行时间：20190702091032
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702091034
SQL开始执行时间：20190702091034


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702091034
SQL开始执行时间：20190702091034
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702091034

20190702091240开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702091240

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702091240
SQL开始执行时间：20190702091240
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702091242
SQL开始执行时间：20190702091242


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702091242
SQL开始执行时间：20190702091242
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702091242

20190702174325开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702174325

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702174325
SQL开始执行时间：20190702174325
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702174327
SQL开始执行时间：20190702174327


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702174327
SQL开始执行时间：20190702174327
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702174327

20190702174358开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702174358

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702174358
SQL开始执行时间：20190702174358
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702174400
SQL开始执行时间：20190702174400


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702174400
SQL开始执行时间：20190702174400
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702174400

20190702174810开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702174810

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702174810
SQL开始执行时间：20190702174810
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702174812
SQL开始执行时间：20190702174812


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702174812
SQL开始执行时间：20190702174812
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702174812

20190702175014开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702175014

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702175014
SQL开始执行时间：20190702175014
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702175016
SQL开始执行时间：20190702175016


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702175016
SQL开始执行时间：20190702175016
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702175016

20190702175457开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702175457

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190702175457
SQL开始执行时间：20190702175457
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190702175458
SQL开始执行时间：20190702175458


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190702175458
SQL开始执行时间：20190702175458
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190702175458

20190703030040开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190703030040
SQL开始执行时间：20190703030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190703030042
SQL开始执行时间：20190703030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190703030042
SQL开始执行时间：20190703030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190703030042

20190704030040开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190704030040
SQL开始执行时间：20190704030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190704030042
SQL开始执行时间：20190704030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190704030042
SQL开始执行时间：20190704030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190704030042

20190705030041开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190705030041
SQL开始执行时间：20190705030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190705030043
SQL开始执行时间：20190705030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190705030043
SQL开始执行时间：20190705030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190705030043

20190706030043开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706030043

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190706030043
SQL开始执行时间：20190706030043
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190706030044
SQL开始执行时间：20190706030044


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190706030044
SQL开始执行时间：20190706030044
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190706030045

20190707030042开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190707030042
SQL开始执行时间：20190707030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190707030043
SQL开始执行时间：20190707030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190707030043
SQL开始执行时间：20190707030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190707030044

20190708030041开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190708030041
SQL开始执行时间：20190708030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190708030042
SQL开始执行时间：20190708030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190708030043
SQL开始执行时间：20190708030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190708030043

20190709030041开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190709030041
SQL开始执行时间：20190709030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190709030043
SQL开始执行时间：20190709030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190709030043
SQL开始执行时间：20190709030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190709030043

20190710030042开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190710030042
SQL开始执行时间：20190710030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190710030044
SQL开始执行时间：20190710030044


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190710030044
SQL开始执行时间：20190710030044
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190710030044

20190711030041开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190711030041
SQL开始执行时间：20190711030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190711030043
SQL开始执行时间：20190711030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190711030043
SQL开始执行时间：20190711030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190711030043

20190712030041开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190712030041
SQL开始执行时间：20190712030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190712030043
SQL开始执行时间：20190712030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190712030043
SQL开始执行时间：20190712030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190712030043

20190713030041开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190713030041
SQL开始执行时间：20190713030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190713030043
SQL开始执行时间：20190713030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190713030043
SQL开始执行时间：20190713030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190713030043

20190716030042开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190716030042
SQL开始执行时间：20190716030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190716030044
SQL开始执行时间：20190716030044


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190716030044
SQL开始执行时间：20190716030044
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190716030044

20190717030042开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190717030042
SQL开始执行时间：20190717030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190717030043
SQL开始执行时间：20190717030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190717030043
SQL开始执行时间：20190717030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190717030043

20190718030041开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190718030041
SQL开始执行时间：20190718030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190718030043
SQL开始执行时间：20190718030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190718030043
SQL开始执行时间：20190718030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190718030043

20190719030044开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190719030044
SQL开始执行时间：20190719030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190719030046
SQL开始执行时间：20190719030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190719030046
SQL开始执行时间：20190719030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190719030046

20190720030041开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190720030041
SQL开始执行时间：20190720030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190720030042
SQL开始执行时间：20190720030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190720030042
SQL开始执行时间：20190720030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190720030042

20190721030040开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190721030040
SQL开始执行时间：20190721030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190721030041
SQL开始执行时间：20190721030041


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190721030041
SQL开始执行时间：20190721030041
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190721030041

20190722030042开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722030042

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190722030042
SQL开始执行时间：20190722030042
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190722030043
SQL开始执行时间：20190722030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190722030043
SQL开始执行时间：20190722030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190722030044

20190723030041开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723030041

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190723030041
SQL开始执行时间：20190723030041
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190723030043
SQL开始执行时间：20190723030043


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190723030043
SQL开始执行时间：20190723030043
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190723030043

20190724030040开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724030040

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190724030040
SQL开始执行时间：20190724030040
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190724030042
SQL开始执行时间：20190724030042


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190724030042
SQL开始执行时间：20190724030042
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190724030042

20190725030047开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190725030047
SQL开始执行时间：20190725030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190725030048
SQL开始执行时间：20190725030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190725030048
SQL开始执行时间：20190725030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190725030048

20190726030044开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190726030044
SQL开始执行时间：20190726030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190726030045
SQL开始执行时间：20190726030045


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190726030045
SQL开始执行时间：20190726030045
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190726030046

20190726085326开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726085326

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190726085326
SQL开始执行时间：20190726085326
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190726085328
SQL开始执行时间：20190726085328


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190726085328
SQL开始执行时间：20190726085328
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190726085328

20190727030044开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190727030044
SQL开始执行时间：20190727030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190727030046
SQL开始执行时间：20190727030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190727030046
SQL开始执行时间：20190727030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190727030046

20190728030044开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190728030044
SQL开始执行时间：20190728030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190728030045
SQL开始执行时间：20190728030045


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190728030045
SQL开始执行时间：20190728030045
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190728030045

20190729030044开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190729030044
SQL开始执行时间：20190729030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190729030045
SQL开始执行时间：20190729030045


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190729030045
SQL开始执行时间：20190729030045
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190729030045

20190729111013开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111013

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190729111013
SQL开始执行时间：20190729111013
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190729111014
SQL开始执行时间：20190729111014


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190729111014
SQL开始执行时间：20190729111014
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190729111014

20190729133109开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729133109

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190729133109
SQL开始执行时间：20190729133109
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190729133111
SQL开始执行时间：20190729133111


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190729133111
SQL开始执行时间：20190729133111
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190729133111

20190730030045开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190730030045
SQL开始执行时间：20190730030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190730030047
SQL开始执行时间：20190730030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190730030047
SQL开始执行时间：20190730030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190730030047

20190730090413开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730090413

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190730090413
SQL开始执行时间：20190730090413
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190730090415
SQL开始执行时间：20190730090415


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190730090415
SQL开始执行时间：20190730090415
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190730090415

20190730094028开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730094028

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190730094028
SQL开始执行时间：20190730094028
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190730094029
SQL开始执行时间：20190730094029


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190730094029
SQL开始执行时间：20190730094029
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190730094030

20190731030049开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731030049

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190731030049
SQL开始执行时间：20190731030049
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190731030051
SQL开始执行时间：20190731030051


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190731030051
SQL开始执行时间：20190731030051
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190731030051

20190731103034开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190731103034

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190731103034
SQL开始执行时间：20190731103034
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190731103036
SQL开始执行时间：20190731103036


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190731103036
SQL开始执行时间：20190731103036
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190731103036

20190801091151开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801091151

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190801091151
SQL开始执行时间：20190801091151
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190801091152
SQL开始执行时间：20190801091152


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190801091152
SQL开始执行时间：20190801091152
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190801091152

20190802030044开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190802030044
SQL开始执行时间：20190802030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190802030045
SQL开始执行时间：20190802030045


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190802030045
SQL开始执行时间：20190802030045
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190802030046

20190803030044开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190803030045
SQL开始执行时间：20190803030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190803030046
SQL开始执行时间：20190803030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190803030046
SQL开始执行时间：20190803030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190803030046

20190804030045开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190804030045
SQL开始执行时间：20190804030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190804030046
SQL开始执行时间：20190804030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190804030046
SQL开始执行时间：20190804030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190804030046

20190805030045开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190805030045
SQL开始执行时间：20190805030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190805030047
SQL开始执行时间：20190805030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190805030047
SQL开始执行时间：20190805030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190805030047

20190806030045开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190806030045
SQL开始执行时间：20190806030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190806030047
SQL开始执行时间：20190806030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190806030047
SQL开始执行时间：20190806030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190806030047

20190807030045开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190807030045
SQL开始执行时间：20190807030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190807030047
SQL开始执行时间：20190807030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190807030047
SQL开始执行时间：20190807030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190807030047

20190808030045开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190808030045
SQL开始执行时间：20190808030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190808030047
SQL开始执行时间：20190808030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190808030047
SQL开始执行时间：20190808030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190808030047

20190809030044开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190809030044
SQL开始执行时间：20190809030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190809030046
SQL开始执行时间：20190809030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190809030046
SQL开始执行时间：20190809030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190809030046

20190810030046开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190810030047
SQL开始执行时间：20190810030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190810030048
SQL开始执行时间：20190810030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190810030048
SQL开始执行时间：20190810030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190810030049

20190811030046开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190811030046
SQL开始执行时间：20190811030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190811030048
SQL开始执行时间：20190811030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190811030048
SQL开始执行时间：20190811030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190811030048

20190812030045开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190812030045
SQL开始执行时间：20190812030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190812030047
SQL开始执行时间：20190812030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190812030047
SQL开始执行时间：20190812030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190812030047

20190813030045开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190813030045
SQL开始执行时间：20190813030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190813030047
SQL开始执行时间：20190813030047


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190813030047
SQL开始执行时间：20190813030047
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190813030047

20190814030044开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190814030044
SQL开始执行时间：20190814030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190814030046
SQL开始执行时间：20190814030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190814030046
SQL开始执行时间：20190814030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190814030046

20190815030046开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190815030046
SQL开始执行时间：20190815030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190815030048
SQL开始执行时间：20190815030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190815030048
SQL开始执行时间：20190815030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190815030048

20190816030044开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190816030044
SQL开始执行时间：20190816030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190816030046
SQL开始执行时间：20190816030046


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190816030046
SQL开始执行时间：20190816030046
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190816030046

20190817030046开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190817030046
SQL开始执行时间：20190817030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190817030048
SQL开始执行时间：20190817030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190817030048
SQL开始执行时间：20190817030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190817030048

20190820091705开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820091705

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190820091705
SQL开始执行时间：20190820091705
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190820091707
SQL开始执行时间：20190820091707


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190820091707
SQL开始执行时间：20190820091707
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190820091707

20190821030046开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190821030046
SQL开始执行时间：20190821030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190821030048
SQL开始执行时间：20190821030048


drop table if exists edw.crm_sale_screenings
;
SQL结束执行时间：20190821030048
SQL开始执行时间：20190821030048
create table edw.crm_sale_screenings as 
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190821030048

20190822030046开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190822030046
SQL开始执行时间：20190822030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190822030048
SQL开始执行时间：20190822030048


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190822030048
SQL开始执行时间：20190822030048
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190822030048

20190822170332开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822170332

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190822170332
SQL开始执行时间：20190822170332
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190822170355
SQL开始执行时间：20190822170355


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190822170355
SQL开始执行时间：20190822170355
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190822170356

20190823030045开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190823030045
SQL开始执行时间：20190823030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190823030047
SQL开始执行时间：20190823030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190823030047
SQL开始执行时间：20190823030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190823030047

20190824030044开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190824030044
SQL开始执行时间：20190824030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190824030046
SQL开始执行时间：20190824030046


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190824030046
SQL开始执行时间：20190824030046
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190824030046

20190825030045开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190825030045
SQL开始执行时间：20190825030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190825030047
SQL开始执行时间：20190825030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190825030047
SQL开始执行时间：20190825030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190825030047

20190826030045开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190826030045
SQL开始执行时间：20190826030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190826030047
SQL开始执行时间：20190826030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190826030047
SQL开始执行时间：20190826030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190826030047

20190827030045开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190827030045
SQL开始执行时间：20190827030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190827030047
SQL开始执行时间：20190827030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190827030047
SQL开始执行时间：20190827030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190827030047

20190828030044开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828030044

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190828030044
SQL开始执行时间：20190828030044
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190828030046
SQL开始执行时间：20190828030046


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190828030046
SQL开始执行时间：20190828030046
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190828030046

20190829030049开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829030049

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190829030049
SQL开始执行时间：20190829030049
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190829030051
SQL开始执行时间：20190829030051


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190829030051
SQL开始执行时间：20190829030051
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190829030051

20190830030045开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190830030045
SQL开始执行时间：20190830030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190830030047
SQL开始执行时间：20190830030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190830030047
SQL开始执行时间：20190830030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190830030047

20190831030045开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190831030045
SQL开始执行时间：20190831030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190831030047
SQL开始执行时间：20190831030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190831030047
SQL开始执行时间：20190831030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190831030047

20190901030047开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190901030047
SQL开始执行时间：20190901030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190901030049
SQL开始执行时间：20190901030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190901030050
SQL开始执行时间：20190901030050
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190901030050

20190902030046开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190902030046
SQL开始执行时间：20190902030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190902030048
SQL开始执行时间：20190902030048


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190902030048
SQL开始执行时间：20190902030048
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190902030048

20190903030045开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903030045

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190903030045
SQL开始执行时间：20190903030045
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190903030047
SQL开始执行时间：20190903030047


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190903030047
SQL开始执行时间：20190903030047
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190903030047

20190904030047开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190904030047
SQL开始执行时间：20190904030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190904030049
SQL开始执行时间：20190904030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190904030049
SQL开始执行时间：20190904030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190904030049

20190905030046开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905030046

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190905030046
SQL开始执行时间：20190905030046
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190905030048
SQL开始执行时间：20190905030048


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190905030048
SQL开始执行时间：20190905030048
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190905030048

20190906030047开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190906030047
SQL开始执行时间：20190906030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190906030049
SQL开始执行时间：20190906030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190906030049
SQL开始执行时间：20190906030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190906030049

20190906171331开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906171331

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190906171331
SQL开始执行时间：20190906171331
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190906171332
SQL开始执行时间：20190906171332


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190906171332
SQL开始执行时间：20190906171332
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190906171333

20190907030047开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190907030047
SQL开始执行时间：20190907030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190907030049
SQL开始执行时间：20190907030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190907030049
SQL开始执行时间：20190907030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190907030050

20190908030047开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190908030047
SQL开始执行时间：20190908030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190908030049
SQL开始执行时间：20190908030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190908030049
SQL开始执行时间：20190908030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190908030049

20190909030047开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190909030047
SQL开始执行时间：20190909030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190909030049
SQL开始执行时间：20190909030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190909030049
SQL开始执行时间：20190909030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190909030049

20190910030047开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190910030047
SQL开始执行时间：20190910030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190910030049
SQL开始执行时间：20190910030049


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190910030049
SQL开始执行时间：20190910030049
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190910030049

20190911030048开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911030048

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190911030048
SQL开始执行时间：20190911030048
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190911030058
SQL开始执行时间：20190911030058


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190911030058
SQL开始执行时间：20190911030058
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190911030058

20190911163302开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911163302

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190911163302
SQL开始执行时间：20190911163302
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190911163306
SQL开始执行时间：20190911163306


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190911163306
SQL开始执行时间：20190911163306
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190911163306

20190912030047开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912030047

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190912030047
SQL开始执行时间：20190912030047
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190912030055
SQL开始执行时间：20190912030055


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190912030055
SQL开始执行时间：20190912030055
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190912030055

20190913030054开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913030054

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190913030054
SQL开始执行时间：20190913030054
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190913030056
SQL开始执行时间：20190913030056


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190913030056
SQL开始执行时间：20190913030056
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190913030056

20190914030049开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914030049

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190914030049
SQL开始执行时间：20190914030049
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190914030051
SQL开始执行时间：20190914030051


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190914030051
SQL开始执行时间：20190914030051
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190914030051

20190915030049开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915030049

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190915030049
SQL开始执行时间：20190915030049
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190915030051
SQL开始执行时间：20190915030051


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190915030051
SQL开始执行时间：20190915030051
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190915030051

20190916030050开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916030050

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190916030050
SQL开始执行时间：20190916030050
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190916030052
SQL开始执行时间：20190916030052


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190916030052
SQL开始执行时间：20190916030052
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190916030052

20190917030052开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917030052

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190917030052
SQL开始执行时间：20190917030052
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190917030054
SQL开始执行时间：20190917030054


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190917030054
SQL开始执行时间：20190917030054
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190917030054

20190918030051开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918030051

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190918030051
SQL开始执行时间：20190918030051
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190918030053
SQL开始执行时间：20190918030053


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190918030053
SQL开始执行时间：20190918030053
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190918030053

20190919030050开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919030050

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190919030050
SQL开始执行时间：20190919030050
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190919030052
SQL开始执行时间：20190919030052


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190919030052
SQL开始执行时间：20190919030052
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190919030052

20190920030050开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920030050

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190920030050
SQL开始执行时间：20190920030050
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190920030052
SQL开始执行时间：20190920030052


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190920030052
SQL开始执行时间：20190920030052
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190920030052

20190921030051开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921030051

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190921030051
SQL开始执行时间：20190921030051
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190921030053
SQL开始执行时间：20190921030053


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190921030053
SQL开始执行时间：20190921030053
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190921030053

20190922030052开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922030052

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190922030052
SQL开始执行时间：20190922030052
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190922030054
SQL开始执行时间：20190922030054


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190922030054
SQL开始执行时间：20190922030054
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190922030054

20190923030049开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923030049

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190923030049
SQL开始执行时间：20190923030049
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190923030051
SQL开始执行时间：20190923030051


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190923030051
SQL开始执行时间：20190923030051
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190923030051

20190924030051开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924030051

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190924030051
SQL开始执行时间：20190924030051
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190924030053
SQL开始执行时间：20190924030053


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190924030053
SQL开始执行时间：20190924030053
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190924030053

20190925030052开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925030052

drop table if exists edw.crm_sale_screenings_pre
;
SQL结束执行时间：20190925030052
SQL开始执行时间：20190925030052
create temporary table edw.crm_sale_screenings_pre as
select d.new_area
      ,d.new_province
      ,d.new_city
      ,d.new_county
      ,b.lastname
      ,2019 as year_
      ,case when new_fangshi = 0 then '自建' else '外送' end as hzfs
      ,d.new_num
      ,d.name
      ,e.item_name as item_dl
      ,f.item_name as item_xl
      ,g.item_name as item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,localtimestamp() as sys_time
  from ufdata.crm_new_sale_screenings a
  left join ufdata.crm_systemusers b
    on a.ownerid = b.ownerid
  left join ufdata.crm_accounts c
    on a.new_account = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
  left join edw.dic_item_crm e
    on a.new_type1 = e.item_code
  left join edw.dic_item_crm f
    on a.new_type2 = f.item_code
  left join edw.dic_item_crm g
    on a.new_type3 = g.item_code
 where a.statecode = '0'

;
SQL结束执行时间：20190925030053
SQL开始执行时间：20190925030053


truncate table edw.crm_sale_screenings
;
SQL结束执行时间：20190925030053
SQL开始执行时间：20190925030053
insert into edw.crm_sale_screenings
select new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.lastname
      ,a.year_
      ,a.hzfs
      ,a.new_num as cuscode
      ,a.name as cusname
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null and a.new_num is not null then '请核查' else c.bi_cusname end as bi_cusname
      ,case when b.level_three is null then '请核查' else b.item_code end as item_code
      ,case when b.level_three is null then '请核查' else b.level_three end as item_name
      ,a.item_dl
      ,a.item_xl
      ,a.item_mx
      ,a.new_january
      ,a.new_february
      ,a.new_march
      ,a.new_april
      ,a.new_may
      ,a.new_june
      ,a.new_july
      ,a.new_august
      ,a.new_september
      ,a.new_october
      ,a.new_november
      ,a.new_december
      ,a.sys_time
  from edw.crm_sale_screenings_pre a
 left join (select * from edw.map_item group by level_three) b
   on a.item_mx = b.level_three
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.new_num = c.ccuscode

;
SQL结束执行时间：20190925030053
