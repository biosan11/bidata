
20190807112511å¼€å§‹æ‰§è¡Œ2019-08-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112511

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112511
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112511
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112511
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112511

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112511
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112511
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then '·¢Æğ'
            when m.currentnodetype = '1' then 'ÉóºË'
            when m.currentnodetype = '2' then 'ÉóºË'
            when m.currentnodetype = '3' then '¹éµµ'
            else 'Î´Öª' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'ÇëºË²é' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'ÇëºË²é' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ÆÆËğ'
            when a.tuihuolx = '1' then 'ÖÊÁ¿'
            when a.tuihuolx = '2' then 'ÆäËû'
            else 'Î´Öª' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'ÇëºË²é' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'ÇëºË²é' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;

20190807112624å¼€å§‹æ‰§è¡Œ2019-08-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112624

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112624
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112624
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112624
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112624

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112624
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807112624
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807112628

20190807140238å¼€å§‹æ‰§è¡Œ2019-08-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807140238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807140238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807140238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807140238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807140238

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807140238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807140238
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807140242

20190808004236å¼€å§‹æ‰§è¡Œ2019-08-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808004240

20190809004236å¼€å§‹æ‰§è¡Œ2019-08-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809004240

20190810004238å¼€å§‹æ‰§è¡Œ2019-08-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810004238

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810004238
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810004243

20190811004239å¼€å§‹æ‰§è¡Œ2019-08-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811004239

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811004239
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811004239
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811004239
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811004239

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811004239
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811004239
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811004243

20190812004238å¼€å§‹æ‰§è¡Œ2019-08-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812004238

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812004238
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812004242

20190813004236å¼€å§‹æ‰§è¡Œ2019-08-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813004241

20190814004236å¼€å§‹æ‰§è¡Œ2019-08-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814004240

20190815004236å¼€å§‹æ‰§è¡Œ2019-08-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815004240

20190816004237å¼€å§‹æ‰§è¡Œ2019-08-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816004237

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816004237
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816004241

20190817004236å¼€å§‹æ‰§è¡Œ2019-08-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817004240

20190818004236å¼€å§‹æ‰§è¡Œ2019-08-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818004236

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818004236
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818004241

20190819004237å¼€å§‹æ‰§è¡Œ2019-08-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819004238

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819004238
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819004242

20190820004237å¼€å§‹æ‰§è¡Œ2019-08-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820004237

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820004237
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820004242

20190821004237å¼€å§‹æ‰§è¡Œ2019-08-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821004237

drop table if exists edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821004237
create table edw.oa_outdepot_back as
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821004241

20190822004237å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822004241

20190823004237å¼€å§‹æ‰§è¡Œ2019-08-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823004242

20190824004237å¼€å§‹æ‰§è¡Œ2019-08-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824004241

20190825004237å¼€å§‹æ‰§è¡Œ2019-08-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825004242

20190826004237å¼€å§‹æ‰§è¡Œ2019-08-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826004242

20190827004238å¼€å§‹æ‰§è¡Œ2019-08-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827004243

20190828004238å¼€å§‹æ‰§è¡Œ2019-08-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828004243

20190829004237å¼€å§‹æ‰§è¡Œ2019-08-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829004242

20190830004238å¼€å§‹æ‰§è¡Œ2019-08-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830004243

20190831004237å¼€å§‹æ‰§è¡Œ2019-08-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831004242

20190901004237å¼€å§‹æ‰§è¡Œ2019-08-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901004241

20190902004237å¼€å§‹æ‰§è¡Œ2019-09-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902004241

20190903004238å¼€å§‹æ‰§è¡Œ2019-09-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903004242

20190904004237å¼€å§‹æ‰§è¡Œ2019-09-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904004242

20190905004236å¼€å§‹æ‰§è¡Œ2019-09-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905004241

20190906004236å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906004241

20190907004237å¼€å§‹æ‰§è¡Œ2019-09-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907004241

20190908004236å¼€å§‹æ‰§è¡Œ2019-09-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908004241

20190909004236å¼€å§‹æ‰§è¡Œ2019-09-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909004241

20190910004236å¼€å§‹æ‰§è¡Œ2019-09-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910004240

20190911004235å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911004235

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911004235
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911004235
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911004235
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911004235

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911004235
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911004235
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911004240

20190912004236å¼€å§‹æ‰§è¡Œ2019-09-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912004240

20190913004236å¼€å§‹æ‰§è¡Œ2019-09-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913004241

20190914004237å¼€å§‹æ‰§è¡Œ2019-09-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914004242

20190915004237å¼€å§‹æ‰§è¡Œ2019-09-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915004242

20190916004237å¼€å§‹æ‰§è¡Œ2019-09-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916004242

20190917004236å¼€å§‹æ‰§è¡Œ2019-09-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917004241

20190918004237å¼€å§‹æ‰§è¡Œ2019-09-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918004242

20190919004236å¼€å§‹æ‰§è¡Œ2019-09-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919004236

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919004236
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919004236

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919004236
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919004236
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919004241

20190920004237å¼€å§‹æ‰§è¡Œ2019-09-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920004243

20190921004237å¼€å§‹æ‰§è¡Œ2019-09-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921004241

20190922004237å¼€å§‹æ‰§è¡Œ2019-09-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922004242

20190923004237å¼€å§‹æ‰§è¡Œ2019-09-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923004237

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923004237
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923004242

20190924004237å¼€å§‹æ‰§è¡Œ2019-09-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924004237

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924004237
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924004237
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924004243

20190925004238å¼€å§‹æ‰§è¡Œ2019-09-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925004238

drop table if exists ufdata.oa_formtable_main_6_pre
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925004238
create temporary table ufdata.oa_formtable_main_6_pre as
select a.id
      ,a.kehumc
      ,b.selectname
  from ufdata.oa_formtable_main_6 a
  left join (select selectname,selectvalue from ufdata.oa_workflow_selectitem where fieldid = 8985) b
    on a.suozaisf = b.selectvalue
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925004238

truncate table edw.oa_outdepot_back
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925004238
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925004238
insert into edw.oa_outdepot_back
select a.id
      ,a.liuchengbh
      ,case when m.currentnodetype = '0' then 'å‘èµ·'
            when m.currentnodetype = '1' then 'å®¡æ ¸'
            when m.currentnodetype = '2' then 'å®¡æ ¸'
            when m.currentnodetype = '3' then 'å½’æ¡£'
            else 'æœªçŸ¥' end as lc_state
      ,a.shenqingrq
      ,d.subcompanyname as cohr
      ,e.departmentname as dept_name
      ,f.kehumc as ccusname
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cuscode end as bi_cuscode
      ,case when h.ccusname is null and f.kehumc is not null then 'è¯·æ ¸æŸ¥' else h.bi_cusname end as bi_cusname
      ,c.lastname as person
      ,case when a.tuihuolx = '0' then 'ç ´æŸ'
            when a.tuihuolx = '1' then 'è´¨é‡'
            when a.tuihuolx = '2' then 'å…¶ä»–'
            else 'æœªçŸ¥' end as tuihuolx
      ,b.huohao
      ,b.shul
      ,b.tuihuoyy
      ,g.chanpinbh
      ,g.chanpinmc
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvcode end as bi_cinvcode
      ,case when i.cinvname is null and g.chanpinmc is not null then 'è¯·æ ¸æŸ¥' else i.bi_cinvname end as bi_cinvname
  from ufdata.oa_formtable_main_170 a
  left join ufdata.oa_formtable_main_170_dt1 b
    on a.id = b.mainid
  left join ufdata.oa_hrmresource c
    on a.shenqingr = c.id
  left join ufdata.oa_hrmsubcompany d
    on a.shenqingrgs = d.id
  left join ufdata.oa_hrmdepartment e
    on a.shenqingrbm = e.id
  left join ufdata.oa_formtable_main_6_pre f
    on a.kehumc2 = f.id
  left join ufdata.oa_uf_chanpinku g
    on b.id = g.id
  left join (select * from edw.dic_customer group by ccusname) h
    on f.kehumc = h.ccusname
  left join (select * from edw.dic_inventory group by cinvname) i
    on g.chanpinmc = i.cinvname
	left join (select * from ufdata.oa_workflow_requestbase group by requestid) m
	  on a.requestid = m.requestid

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925004243
