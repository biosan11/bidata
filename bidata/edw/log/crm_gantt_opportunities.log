
20190625161303开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190625161303

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190625161303
SQL开始执行时间：20190625161303
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190625161303
SQL开始执行时间：20190625161303

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190625161303
SQL开始执行时间：20190625161303
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190625161304

20190626030044开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190626030044
SQL开始执行时间：20190626030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190626030045
SQL开始执行时间：20190626030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190626030045
SQL开始执行时间：20190626030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190626030045

20190627030040开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190627030040
SQL开始执行时间：20190627030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190627030040
SQL开始执行时间：20190627030040

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190627030040
SQL开始执行时间：20190627030040
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190627030040

20190628030041开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190628030041
SQL开始执行时间：20190628030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190628030042
SQL开始执行时间：20190628030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190628030042
SQL开始执行时间：20190628030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190628030042

20190629030041开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190629030041
SQL开始执行时间：20190629030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190629030042
SQL开始执行时间：20190629030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190629030042
SQL开始执行时间：20190629030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190629030042

20190630030040开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190630030040
SQL开始执行时间：20190630030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190630030041
SQL开始执行时间：20190630030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190630030041
SQL开始执行时间：20190630030041
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190630030041

20190701030042开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190701030042
SQL开始执行时间：20190701030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190701030042
SQL开始执行时间：20190701030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190701030042
SQL开始执行时间：20190701030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190701030043

20190702030045开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190702030045
SQL开始执行时间：20190702030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190702030045
SQL开始执行时间：20190702030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190702030045
SQL开始执行时间：20190702030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190702030045

20190702091032开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702091032

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190702091032
SQL开始执行时间：20190702091032
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190702091033
SQL开始执行时间：20190702091033

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190702091033
SQL开始执行时间：20190702091033
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190702091033

20190702091240开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702091240

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190702091240
SQL开始执行时间：20190702091240
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190702091241
SQL开始执行时间：20190702091241

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190702091241
SQL开始执行时间：20190702091241
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190702091241

20190703030040开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190703030040
SQL开始执行时间：20190703030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190703030041
SQL开始执行时间：20190703030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190703030041
SQL开始执行时间：20190703030041
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190703030041

20190704030040开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190704030040
SQL开始执行时间：20190704030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190704030040
SQL开始执行时间：20190704030040

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190704030040
SQL开始执行时间：20190704030040
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190704030041

20190705030041开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190705030041
SQL开始执行时间：20190705030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190705030042
SQL开始执行时间：20190705030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190705030042
SQL开始执行时间：20190705030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190705030042

20190706030043开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706030043

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190706030043
SQL开始执行时间：20190706030043
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190706030043
SQL开始执行时间：20190706030043

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190706030043
SQL开始执行时间：20190706030043
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190706030043

20190707030042开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190707030042
SQL开始执行时间：20190707030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190707030042
SQL开始执行时间：20190707030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190707030042
SQL开始执行时间：20190707030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190707030042

20190708030041开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190708030041
SQL开始执行时间：20190708030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190708030041
SQL开始执行时间：20190708030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190708030041
SQL开始执行时间：20190708030041
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190708030041

20190709030041开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190709030041
SQL开始执行时间：20190709030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190709030041
SQL开始执行时间：20190709030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190709030042
SQL开始执行时间：20190709030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190709030042

20190710030042开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190710030042
SQL开始执行时间：20190710030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190710030043
SQL开始执行时间：20190710030043

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190710030043
SQL开始执行时间：20190710030043
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190710030043

20190711030041开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190711030041
SQL开始执行时间：20190711030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190711030042
SQL开始执行时间：20190711030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190711030042
SQL开始执行时间：20190711030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190711030042

20190712030041开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190712030041
SQL开始执行时间：20190712030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190712030042
SQL开始执行时间：20190712030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190712030042
SQL开始执行时间：20190712030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190712030042

20190713030041开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190713030041
SQL开始执行时间：20190713030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190713030042
SQL开始执行时间：20190713030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190713030042
SQL开始执行时间：20190713030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190713030042

20190716030042开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190716030042
SQL开始执行时间：20190716030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190716030043
SQL开始执行时间：20190716030043

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190716030043
SQL开始执行时间：20190716030043
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190716030043

20190717030042开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190717030042
SQL开始执行时间：20190717030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190717030042
SQL开始执行时间：20190717030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190717030042
SQL开始执行时间：20190717030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190717030042

20190718030041开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190718030041
SQL开始执行时间：20190718030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190718030042
SQL开始执行时间：20190718030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190718030042
SQL开始执行时间：20190718030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190718030042

20190719030044开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190719030044
SQL开始执行时间：20190719030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190719030045
SQL开始执行时间：20190719030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190719030045
SQL开始执行时间：20190719030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190719030045

20190720030041开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190720030041
SQL开始执行时间：20190720030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190720030041
SQL开始执行时间：20190720030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190720030041
SQL开始执行时间：20190720030041
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190720030041

20190721030040开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190721030040
SQL开始执行时间：20190721030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190721030040
SQL开始执行时间：20190721030040

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190721030040
SQL开始执行时间：20190721030040
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190721030040

20190722030042开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722030042

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190722030042
SQL开始执行时间：20190722030042
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190722030042
SQL开始执行时间：20190722030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190722030042
SQL开始执行时间：20190722030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190722030042

20190723030041开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723030041

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190723030041
SQL开始执行时间：20190723030041
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190723030042
SQL开始执行时间：20190723030042

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190723030042
SQL开始执行时间：20190723030042
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190723030042

20190724030040开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724030040

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190724030040
SQL开始执行时间：20190724030040
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190724030041
SQL开始执行时间：20190724030041

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190724030041
SQL开始执行时间：20190724030041
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190724030041

20190725030047开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190725030047
SQL开始执行时间：20190725030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190725030047
SQL开始执行时间：20190725030047

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190725030047
SQL开始执行时间：20190725030047
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190725030047

20190726030044开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190726030044
SQL开始执行时间：20190726030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190726030044
SQL开始执行时间：20190726030044

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190726030044
SQL开始执行时间：20190726030044
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190726030045

20190727030044开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190727030044
SQL开始执行时间：20190727030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190727030045
SQL开始执行时间：20190727030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190727030045
SQL开始执行时间：20190727030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190727030045

20190728030044开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190728030044
SQL开始执行时间：20190728030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190728030044
SQL开始执行时间：20190728030044

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190728030044
SQL开始执行时间：20190728030044
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190728030044

20190729030044开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190729030044
SQL开始执行时间：20190729030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190729030044
SQL开始执行时间：20190729030044

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190729030044
SQL开始执行时间：20190729030044
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190729030044

20190730030045开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190730030045
SQL开始执行时间：20190730030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190730030046
SQL开始执行时间：20190730030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190730030046
SQL开始执行时间：20190730030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190730030046

20190731030049开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190731030049
SQL开始执行时间：20190731030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190731030050
SQL开始执行时间：20190731030050

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190731030050
SQL开始执行时间：20190731030050
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190731030050

20190801091151开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801091151

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190801091151
SQL开始执行时间：20190801091151
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190801091151
SQL开始执行时间：20190801091151

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190801091151
SQL开始执行时间：20190801091151
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190801091151

20190802030044开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190802030044
SQL开始执行时间：20190802030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190802030044
SQL开始执行时间：20190802030044

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190802030044
SQL开始执行时间：20190802030044
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190802030044

20190803030045开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190803030045
SQL开始执行时间：20190803030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190803030045
SQL开始执行时间：20190803030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190803030045
SQL开始执行时间：20190803030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190803030045

20190804030045开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190804030045
SQL开始执行时间：20190804030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190804030045
SQL开始执行时间：20190804030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190804030045
SQL开始执行时间：20190804030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190804030045

20190805030045开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190805030045
SQL开始执行时间：20190805030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190805030046
SQL开始执行时间：20190805030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190805030046
SQL开始执行时间：20190805030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190805030046

20190806030045开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190806030045
SQL开始执行时间：20190806030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190806030046
SQL开始执行时间：20190806030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190806030046
SQL开始执行时间：20190806030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190806030046

20190807030045开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190807030045
SQL开始执行时间：20190807030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190807030046
SQL开始执行时间：20190807030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190807030046
SQL开始执行时间：20190807030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190807030046

20190808030045开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190808030045
SQL开始执行时间：20190808030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190808030046
SQL开始执行时间：20190808030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190808030046
SQL开始执行时间：20190808030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190808030046

20190809030044开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190809030044
SQL开始执行时间：20190809030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190809030045
SQL开始执行时间：20190809030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190809030045
SQL开始执行时间：20190809030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190809030045

20190810030047开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190810030047
SQL开始执行时间：20190810030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190810030047
SQL开始执行时间：20190810030047

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190810030047
SQL开始执行时间：20190810030047
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190810030048

20190811030046开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190811030046
SQL开始执行时间：20190811030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190811030048
SQL开始执行时间：20190811030048

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190811030048
SQL开始执行时间：20190811030048
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190811030048

20190812030045开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190812030045
SQL开始执行时间：20190812030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190812030046
SQL开始执行时间：20190812030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190812030046
SQL开始执行时间：20190812030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190812030046

20190813030045开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190813030045
SQL开始执行时间：20190813030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190813030046
SQL开始执行时间：20190813030046

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190813030046
SQL开始执行时间：20190813030046
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190813030046

20190814030044开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190814030044
SQL开始执行时间：20190814030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190814030045
SQL开始执行时间：20190814030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190814030045
SQL开始执行时间：20190814030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190814030045

20190815030046开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190815030046
SQL开始执行时间：20190815030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190815030047
SQL开始执行时间：20190815030047

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190815030047
SQL开始执行时间：20190815030047
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190815030047

20190816030044开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190816030044
SQL开始执行时间：20190816030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190816030045
SQL开始执行时间：20190816030045

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190816030045
SQL开始执行时间：20190816030045
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190816030045

20190817030046开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190817030046
SQL开始执行时间：20190817030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190817030047
SQL开始执行时间：20190817030047

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190817030047
SQL开始执行时间：20190817030047
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190817030047

20190820091705开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820091705

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190820091705
SQL开始执行时间：20190820091705
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190820091706
SQL开始执行时间：20190820091706

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190820091706
SQL开始执行时间：20190820091706
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190820091707

20190821030046开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190821030046
SQL开始执行时间：20190821030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190821030047
SQL开始执行时间：20190821030047

drop table if exists edw.crm_gantt_opportunities
;
SQL结束执行时间：20190821030047
SQL开始执行时间：20190821030047
create table edw.crm_gantt_opportunities as
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190821030047

20190822030046开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190822030046
SQL开始执行时间：20190822030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190822030047
SQL开始执行时间：20190822030047

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190822030047
SQL开始执行时间：20190822030047
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190822030047

20190822170332开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822170332

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190822170332
SQL开始执行时间：20190822170332
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190822170355
SQL开始执行时间：20190822170355

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190822170355
SQL开始执行时间：20190822170355
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190822170355

20190823030045开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190823030045
SQL开始执行时间：20190823030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190823030046
SQL开始执行时间：20190823030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190823030046
SQL开始执行时间：20190823030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190823030046

20190824030044开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190824030044
SQL开始执行时间：20190824030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190824030045
SQL开始执行时间：20190824030045

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190824030045
SQL开始执行时间：20190824030045
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190824030046

20190825030045开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190825030045
SQL开始执行时间：20190825030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190825030046
SQL开始执行时间：20190825030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190825030046
SQL开始执行时间：20190825030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190825030046

20190826030045开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190826030045
SQL开始执行时间：20190826030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190826030046
SQL开始执行时间：20190826030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190826030046
SQL开始执行时间：20190826030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190826030046

20190827030045开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190827030045
SQL开始执行时间：20190827030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190827030046
SQL开始执行时间：20190827030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190827030046
SQL开始执行时间：20190827030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190827030046

20190828030044开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828030044

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190828030044
SQL开始执行时间：20190828030044
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190828030045
SQL开始执行时间：20190828030045

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190828030045
SQL开始执行时间：20190828030045
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190828030045

20190829030049开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190829030049
SQL开始执行时间：20190829030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190829030050
SQL开始执行时间：20190829030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190829030050
SQL开始执行时间：20190829030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190829030050

20190830030045开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190830030045
SQL开始执行时间：20190830030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190830030046
SQL开始执行时间：20190830030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190830030046
SQL开始执行时间：20190830030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190830030046

20190831030045开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190831030045
SQL开始执行时间：20190831030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190831030046
SQL开始执行时间：20190831030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190831030046
SQL开始执行时间：20190831030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190831030046

20190901030047开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190901030047
SQL开始执行时间：20190901030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190901030049
SQL开始执行时间：20190901030049

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190901030049
SQL开始执行时间：20190901030049
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190901030049

20190902030046开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190902030046
SQL开始执行时间：20190902030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190902030048
SQL开始执行时间：20190902030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190902030048
SQL开始执行时间：20190902030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190902030048

20190903030045开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903030045

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190903030045
SQL开始执行时间：20190903030045
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190903030046
SQL开始执行时间：20190903030046

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190903030046
SQL开始执行时间：20190903030046
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190903030046

20190904030047开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190904030047
SQL开始执行时间：20190904030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190904030048
SQL开始执行时间：20190904030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190904030048
SQL开始执行时间：20190904030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190904030048

20190905030046开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905030046

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190905030046
SQL开始执行时间：20190905030046
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190905030047
SQL开始执行时间：20190905030047

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190905030047
SQL开始执行时间：20190905030047
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190905030047

20190906030047开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190906030047
SQL开始执行时间：20190906030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190906030048
SQL开始执行时间：20190906030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190906030048
SQL开始执行时间：20190906030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190906030048

20190906171331开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906171331

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190906171331
SQL开始执行时间：20190906171331
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190906171332
SQL开始执行时间：20190906171332

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190906171332
SQL开始执行时间：20190906171332
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190906171332

20190907030047开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190907030047
SQL开始执行时间：20190907030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190907030049
SQL开始执行时间：20190907030049

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190907030049
SQL开始执行时间：20190907030049
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190907030049

20190908030047开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190908030047
SQL开始执行时间：20190908030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190908030048
SQL开始执行时间：20190908030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190908030048
SQL开始执行时间：20190908030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190908030048

20190909030047开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190909030047
SQL开始执行时间：20190909030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190909030048
SQL开始执行时间：20190909030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190909030048
SQL开始执行时间：20190909030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190909030049

20190910030047开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190910030047
SQL开始执行时间：20190910030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190910030048
SQL开始执行时间：20190910030048

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190910030048
SQL开始执行时间：20190910030048
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190910030048

20190911030048开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911030048

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190911030048
SQL开始执行时间：20190911030048
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190911030057
SQL开始执行时间：20190911030057

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190911030057
SQL开始执行时间：20190911030057
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190911030057

20190911163302开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911163302

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190911163302
SQL开始执行时间：20190911163302
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190911163305
SQL开始执行时间：20190911163305

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190911163305
SQL开始执行时间：20190911163305
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190911163305

20190912030047开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912030047

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190912030047
SQL开始执行时间：20190912030047
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190912030054
SQL开始执行时间：20190912030054

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190912030054
SQL开始执行时间：20190912030054
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190912030054

20190913030054开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913030054

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190913030054
SQL开始执行时间：20190913030054
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190913030055
SQL开始执行时间：20190913030055

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190913030055
SQL开始执行时间：20190913030055
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190913030055

20190914030049开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190914030049
SQL开始执行时间：20190914030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190914030050
SQL开始执行时间：20190914030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190914030050
SQL开始执行时间：20190914030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190914030050

20190915030049开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190915030049
SQL开始执行时间：20190915030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190915030050
SQL开始执行时间：20190915030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190915030050
SQL开始执行时间：20190915030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190915030050

20190916030050开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916030050

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190916030050
SQL开始执行时间：20190916030050
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190916030051
SQL开始执行时间：20190916030051

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190916030051
SQL开始执行时间：20190916030051
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190916030051

20190917030052开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917030052

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190917030052
SQL开始执行时间：20190917030052
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190917030053
SQL开始执行时间：20190917030053

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190917030053
SQL开始执行时间：20190917030053
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190917030053

20190918030051开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918030051

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190918030051
SQL开始执行时间：20190918030051
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190918030052
SQL开始执行时间：20190918030052

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190918030052
SQL开始执行时间：20190918030052
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190918030052

20190919030050开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919030050

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190919030050
SQL开始执行时间：20190919030050
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190919030051
SQL开始执行时间：20190919030051

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190919030051
SQL开始执行时间：20190919030051
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190919030051

20190920030050开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920030050

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190920030050
SQL开始执行时间：20190920030050
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190920030051
SQL开始执行时间：20190920030051

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190920030051
SQL开始执行时间：20190920030051
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190920030051

20190921030051开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921030051

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190921030051
SQL开始执行时间：20190921030051
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190921030052
SQL开始执行时间：20190921030052

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190921030052
SQL开始执行时间：20190921030052
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190921030052

20190922030052开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922030052

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190922030052
SQL开始执行时间：20190922030052
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190922030053
SQL开始执行时间：20190922030053

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190922030053
SQL开始执行时间：20190922030053
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190922030053

20190923030049开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190923030049
SQL开始执行时间：20190923030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190923030050
SQL开始执行时间：20190923030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190923030050
SQL开始执行时间：20190923030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190923030050

20190924030051开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924030051

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190924030051
SQL开始执行时间：20190924030051
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190924030052
SQL开始执行时间：20190924030052

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190924030052
SQL开始执行时间：20190924030052
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190924030052

20190925030052开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925030052

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190925030052
SQL开始执行时间：20190925030052
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190925030052
SQL开始执行时间：20190925030052

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190925030052
SQL开始执行时间：20190925030052
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190925030053

20190926030049开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926030049

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190926030049
SQL开始执行时间：20190926030049
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190926030050
SQL开始执行时间：20190926030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190926030050
SQL开始执行时间：20190926030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190926030050

20190927030050开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927030050

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190927030050
SQL开始执行时间：20190927030050
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190927030050
SQL开始执行时间：20190927030050

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190927030050
SQL开始执行时间：20190927030050
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190927030051

20190928030050开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928030050

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190928030050
SQL开始执行时间：20190928030050
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190928030051
SQL开始执行时间：20190928030051

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190928030051
SQL开始执行时间：20190928030051
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190928030051

20190929030051开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929030051

drop table if exists edw.crm_gantt_opportunities_pre
;
SQL结束执行时间：20190929030051
SQL开始执行时间：20190929030051
create temporary table edw.crm_gantt_opportunities_pre as
select
a.opportunityid
,d.new_area
,d.new_province
,d.new_city
,d.new_county
,d.new_num as cuscode
,d.name as cusname
,a.new_project_num
,a.name
,a.new_importance
,case when a.new_type = '3' then '上量' 
      when a.new_type = '1' then '项目入院' 
      else '城市学科建设' end as new_type
,case when a.new_business_type = '100000000' then '产品类'
      when a.new_business_type = '100000001' then 'LDT'
      when a.new_business_type = '100000002' then '服务类'
      else '未知' end as new_business_type
,date_add(a.new_open_date, interval 8 hour) as new_open_date
,b.lastname as ownerid
,a.budgetamount_base
,a.finaldecisiondate
,a.estimatedclosedate
  from ufdata.crm_gantt_opportunities a
  left join ufdata.crm_systemusers b
    on a._ownerid_value = b.ownerid
  left join ufdata.crm_accounts c
    on a._parentaccountid_value = c.accountid
  left join edw.crm_accounts d
    on c.new_num = d.new_num
 where a.statecode = '0'
   and a.stageid is null
 
;
SQL结束执行时间：20190929030052
SQL开始执行时间：20190929030052

truncate table edw.crm_gantt_opportunities
;
SQL结束执行时间：20190929030052
SQL开始执行时间：20190929030052
insert into edw.crm_gantt_opportunities
select a.opportunityid
      ,a.new_area
      ,a.new_province
      ,a.new_city
      ,a.new_county
      ,a.cuscode
      ,a.cusname
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cuscode end as bi_cuscode
      ,case when c.bi_cuscode is null then '请核查' else c.bi_cusname end as bi_cusname
      ,a.new_project_num
      ,a.name
      ,a.new_importance
      ,a.new_type
      ,a.new_business_type
      ,a.new_open_date
      ,a.ownerid
      ,a.budgetamount_base
      ,a.finaldecisiondate
      ,a.estimatedclosedate
      ,'已开启' as state
      ,'正在进行' as status
      ,localtimestamp() as sys_time
  from edw.crm_gantt_opportunities_pre a
 left join (select * from edw.dic_customer group by ccuscode) c
   on a.cuscode = c.ccuscode

;
SQL结束执行时间：20190929030052
