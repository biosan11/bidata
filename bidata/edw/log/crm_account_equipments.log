
20190301140203å¼€å§‹æ‰§è¡Œ2019-02-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140203
create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-02-01' or left(a.modifiedon,10) >= '2019-02-01'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301140203
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140203

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301140204
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140204

create table  edw.crm_account_equipments as
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'Õı³£'
            when a.new_use_mode = 2 then 'Í£ÓÃ'
            when a.new_use_mode = 3 then '¼Æ»®²É¹º'
            when a.new_use_mode = 4 then 'ÅàÑµ»ú'
            when a.new_use_mode = 5 then '±¸ÓÃ'
            when a.new_use_mode = 6 then '»ØÊÕ'
            when a.new_use_mode = 7 then '±¨·Ï'
       else 'Î´Öª×´Ì¬' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;

20190301140315å¼€å§‹æ‰§è¡Œ2019-02-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140315
create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-02-01' or left(a.modifiedon,10) >= '2019-02-01'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301140315
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140315

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301140315
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140315

drop table if exists edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301140315
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301140315
create table  edw.crm_account_equipments as
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'Õı³£'
            when a.new_use_mode = 2 then 'Í£ÓÃ'
            when a.new_use_mode = 3 then '¼Æ»®²É¹º'
            when a.new_use_mode = 4 then 'ÅàÑµ»ú'
            when a.new_use_mode = 5 then '±¸ÓÃ'
            when a.new_use_mode = 6 then '»ØÊÕ'
            when a.new_use_mode = 7 then '±¨·Ï'
       else 'Î´Öª×´Ì¬' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;

20190304102842å¼€å§‹æ‰§è¡Œ2019-03-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304102842
create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304102842
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304102842

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;

20190304103313å¼€å§‹æ‰§è¡Œ2019-03-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103313
create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304103314
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103314

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;

20190304103520å¼€å§‹æ‰§è¡Œ2019-03-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103520


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304103520
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103520

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;

20190304103806å¼€å§‹æ‰§è¡Œ2019-03-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103806


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-03' or left(a.modifiedon,10) >= '2019-03-03'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304103806
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103806

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304103806
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304103806

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'Õı³£'
            when a.new_use_mode = 2 then 'Í£ÓÃ'
            when a.new_use_mode = 3 then '¼Æ»®²É¹º'
            when a.new_use_mode = 4 then 'ÅàÑµ»ú'
            when a.new_use_mode = 5 then '±¸ÓÃ'
            when a.new_use_mode = 6 then '»ØÊÕ'
            when a.new_use_mode = 7 then '±¨·Ï'
       else 'Î´Öª×´Ì¬' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304103806

20190305030034å¼€å§‹æ‰§è¡Œ2019-03-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305030034


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-04' or left(a.modifiedon,10) >= '2019-03-04'))

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305030035
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305030035

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305030035
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305030035

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305030039

20190306030157å¼€å§‹æ‰§è¡Œ2019-03-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-05' or left(a.modifiedon,10) >= '2019-03-05'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306030157

;

20190306090007å¼€å§‹æ‰§è¡Œ2019-03-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306090007


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-05' or left(a.modifiedon,10) >= '2019-03-05'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306090008
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306090008

;

20190306090143å¼€å§‹æ‰§è¡Œ2019-03-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306090143


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-05' or left(a.modifiedon,10) >= '2019-03-05'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306090143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306090143

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306090143
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306090143

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306090147

20190307030157å¼€å§‹æ‰§è¡Œ2019-03-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-06' or left(a.modifiedon,10) >= '2019-03-06'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307030202

20190308030159å¼€å§‹æ‰§è¡Œ2019-03-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308030159


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-07' or left(a.modifiedon,10) >= '2019-03-07'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308030159

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308030200

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308030203

20190309030156å¼€å§‹æ‰§è¡Œ2019-03-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-08' or left(a.modifiedon,10) >= '2019-03-08'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309030200

20190310030158å¼€å§‹æ‰§è¡Œ2019-03-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-09' or left(a.modifiedon,10) >= '2019-03-09'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310030159

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310030202

20190311030156å¼€å§‹æ‰§è¡Œ2019-03-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-10' or left(a.modifiedon,10) >= '2019-03-10'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311030201

20190312030158å¼€å§‹æ‰§è¡Œ2019-03-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-11' or left(a.modifiedon,10) >= '2019-03-11'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312030159

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312030159

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312030203

20190313030156å¼€å§‹æ‰§è¡Œ2019-03-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-12' or left(a.modifiedon,10) >= '2019-03-12'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313030201

20190314030158å¼€å§‹æ‰§è¡Œ2019-03-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-13' or left(a.modifiedon,10) >= '2019-03-13'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314030202

20190315030156å¼€å§‹æ‰§è¡Œ2019-03-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-14' or left(a.modifiedon,10) >= '2019-03-14'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315030157

20190316030156å¼€å§‹æ‰§è¡Œ2019-03-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-15' or left(a.modifiedon,10) >= '2019-03-15'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316030201

20190317030200å¼€å§‹æ‰§è¡Œ2019-03-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317030200


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-16' or left(a.modifiedon,10) >= '2019-03-16'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317030200

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317030200

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317030200

20190318030156å¼€å§‹æ‰§è¡Œ2019-03-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-17' or left(a.modifiedon,10) >= '2019-03-17'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318030156

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318030156

20190319030156å¼€å§‹æ‰§è¡Œ2019-03-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-18' or left(a.modifiedon,10) >= '2019-03-18'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319030156

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319030156

20190320030156å¼€å§‹æ‰§è¡Œ2019-03-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-19' or left(a.modifiedon,10) >= '2019-03-19'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320030156

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320030156

20190321030200å¼€å§‹æ‰§è¡Œ2019-03-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321030200


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-20' or left(a.modifiedon,10) >= '2019-03-20'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321030200

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321030200

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321030200

20190322030157å¼€å§‹æ‰§è¡Œ2019-03-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-21' or left(a.modifiedon,10) >= '2019-03-21'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322030157

20190323030157å¼€å§‹æ‰§è¡Œ2019-03-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-22' or left(a.modifiedon,10) >= '2019-03-22'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323030202

20190324030157å¼€å§‹æ‰§è¡Œ2019-03-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-23' or left(a.modifiedon,10) >= '2019-03-23'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324030157

20190325030158å¼€å§‹æ‰§è¡Œ2019-03-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-24' or left(a.modifiedon,10) >= '2019-03-24'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325030158

20190326030156å¼€å§‹æ‰§è¡Œ2019-03-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-25' or left(a.modifiedon,10) >= '2019-03-25'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326030156

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326030156

20190327030156å¼€å§‹æ‰§è¡Œ2019-03-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-26' or left(a.modifiedon,10) >= '2019-03-26'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327030156

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327030156

20190328030158å¼€å§‹æ‰§è¡Œ2019-03-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-27' or left(a.modifiedon,10) >= '2019-03-27'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328030201

20190329030157å¼€å§‹æ‰§è¡Œ2019-03-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-28' or left(a.modifiedon,10) >= '2019-03-28'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329030200

20190330030157å¼€å§‹æ‰§è¡Œ2019-03-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-29' or left(a.modifiedon,10) >= '2019-03-29'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330030201

20190331030156å¼€å§‹æ‰§è¡Œ2019-03-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-30' or left(a.modifiedon,10) >= '2019-03-30'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331030200

20190401030156å¼€å§‹æ‰§è¡Œ2019-03-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401030156


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-03-31' or left(a.modifiedon,10) >= '2019-03-31'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401030156
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401030156

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401030200

20190402030158å¼€å§‹æ‰§è¡Œ2019-04-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-01' or left(a.modifiedon,10) >= '2019-04-01'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402030201

20190403030157å¼€å§‹æ‰§è¡Œ2019-04-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-02' or left(a.modifiedon,10) >= '2019-04-02'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403030201

20190404030158å¼€å§‹æ‰§è¡Œ2019-04-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404030158


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-03' or left(a.modifiedon,10) >= '2019-04-03'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404030159

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404030159

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404030202

20190405030200å¼€å§‹æ‰§è¡Œ2019-04-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405030200


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-04' or left(a.modifiedon,10) >= '2019-04-04'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405030200

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405030200
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405030200

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405030203

20190406030159å¼€å§‹æ‰§è¡Œ2019-04-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406030159


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-05' or left(a.modifiedon,10) >= '2019-04-05'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406030159

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406030159
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406030159

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406030203

20190407030157å¼€å§‹æ‰§è¡Œ2019-04-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-06' or left(a.modifiedon,10) >= '2019-04-06'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407030158

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407030158
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407030158

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407030201

20190408030157å¼€å§‹æ‰§è¡Œ2019-04-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408030157


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-07' or left(a.modifiedon,10) >= '2019-04-07'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408030157

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408030157
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408030157

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408030200

20190409030047å¼€å§‹æ‰§è¡Œ2019-04-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-08' or left(a.modifiedon,10) >= '2019-04-08'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409030051

20190410030046å¼€å§‹æ‰§è¡Œ2019-04-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-09' or left(a.modifiedon,10) >= '2019-04-09'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410030046

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410030049

20190412030045å¼€å§‹æ‰§è¡Œ2019-04-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-11' or left(a.modifiedon,10) >= '2019-04-11'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412030046

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412030049

20190413030045å¼€å§‹æ‰§è¡Œ2019-04-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-12' or left(a.modifiedon,10) >= '2019-04-12'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030045

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413030045

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413030049

20190414030046å¼€å§‹æ‰§è¡Œ2019-04-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-13' or left(a.modifiedon,10) >= '2019-04-13'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414030047

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414030050

20190415030046å¼€å§‹æ‰§è¡Œ2019-04-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-14' or left(a.modifiedon,10) >= '2019-04-14'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415030046

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415030049

20190416030047å¼€å§‹æ‰§è¡Œ2019-04-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-15' or left(a.modifiedon,10) >= '2019-04-15'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416030051

20190417030045å¼€å§‹æ‰§è¡Œ2019-04-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-16' or left(a.modifiedon,10) >= '2019-04-16'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417030046

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417030049

20190418030048å¼€å§‹æ‰§è¡Œ2019-04-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-17' or left(a.modifiedon,10) >= '2019-04-17'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418030052

20190419030051å¼€å§‹æ‰§è¡Œ2019-04-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-18' or left(a.modifiedon,10) >= '2019-04-18'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030052

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419030052

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419030055

20190420030046å¼€å§‹æ‰§è¡Œ2019-04-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-19' or left(a.modifiedon,10) >= '2019-04-19'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420030047

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420030050

20190421030047å¼€å§‹æ‰§è¡Œ2019-04-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-20' or left(a.modifiedon,10) >= '2019-04-20'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421030047

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421030050

20190422030047å¼€å§‹æ‰§è¡Œ2019-04-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-21' or left(a.modifiedon,10) >= '2019-04-21'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422030051

20190423030047å¼€å§‹æ‰§è¡Œ2019-04-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-22' or left(a.modifiedon,10) >= '2019-04-22'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423030051

20190424030048å¼€å§‹æ‰§è¡Œ2019-04-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-23' or left(a.modifiedon,10) >= '2019-04-23'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424030049

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424030052

20190425030048å¼€å§‹æ‰§è¡Œ2019-04-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-24' or left(a.modifiedon,10) >= '2019-04-24'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425030051

20190426030048å¼€å§‹æ‰§è¡Œ2019-04-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-25' or left(a.modifiedon,10) >= '2019-04-25'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426030052

20190427030047å¼€å§‹æ‰§è¡Œ2019-04-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-26' or left(a.modifiedon,10) >= '2019-04-26'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427030052

20190428030048å¼€å§‹æ‰§è¡Œ2019-04-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-27' or left(a.modifiedon,10) >= '2019-04-27'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428030049

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428030052

20190429030047å¼€å§‹æ‰§è¡Œ2019-04-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-28' or left(a.modifiedon,10) >= '2019-04-28'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429030051

20190430030047å¼€å§‹æ‰§è¡Œ2019-04-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-29' or left(a.modifiedon,10) >= '2019-04-29'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430030051

20190501030046å¼€å§‹æ‰§è¡Œ2019-04-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-04-30' or left(a.modifiedon,10) >= '2019-04-30'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030046

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501030047

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501030050

20190502030048å¼€å§‹æ‰§è¡Œ2019-05-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-05-01' or left(a.modifiedon,10) >= '2019-05-01'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502030052

20190503030047å¼€å§‹æ‰§è¡Œ2019-05-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-05-02' or left(a.modifiedon,10) >= '2019-05-02'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503030051

20190504030047å¼€å§‹æ‰§è¡Œ2019-05-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-05-03' or left(a.modifiedon,10) >= '2019-05-03'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030047

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504030047

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504030051

20190505030048å¼€å§‹æ‰§è¡Œ2019-05-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where ((left(a.createdon,10) >= '2019-05-04' or left(a.modifiedon,10) >= '2019-05-04'))
   and a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030048

delete from edw.crm_account_equipments where new_account_equipmentid in (select new_account_equipmentid from edw.crm_account_equipments_pre)
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505030048

insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505030052

20190506030049å¼€å§‹æ‰§è¡Œ2019-05-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506030053

20190507030047å¼€å§‹æ‰§è¡Œ2019-05-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030048


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507030048
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507030052

20190508030047å¼€å§‹æ‰§è¡Œ2019-05-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508030051

20190510030058å¼€å§‹æ‰§è¡Œ2019-05-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030058


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030058


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510030058
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510030102

20190511030049å¼€å§‹æ‰§è¡Œ2019-05-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511030053

20190512030049å¼€å§‹æ‰§è¡Œ2019-05-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512030053

20190513030048å¼€å§‹æ‰§è¡Œ2019-05-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030048


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513030048
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513030053

20190514030053å¼€å§‹æ‰§è¡Œ2019-05-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030053


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514030057

20190515030051å¼€å§‹æ‰§è¡Œ2019-05-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515030055

20190516030049å¼€å§‹æ‰§è¡Œ2019-05-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516030054

20190517030050å¼€å§‹æ‰§è¡Œ2019-05-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517030054

20190518030050å¼€å§‹æ‰§è¡Œ2019-05-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518030054

20190519030049å¼€å§‹æ‰§è¡Œ2019-05-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519030053

20190520030054å¼€å§‹æ‰§è¡Œ2019-05-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030054


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030054


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520030054
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520030058

20190521030048å¼€å§‹æ‰§è¡Œ2019-05-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521030053

20190522030049å¼€å§‹æ‰§è¡Œ2019-05-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522030053

20190523030049å¼€å§‹æ‰§è¡Œ2019-05-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523030054

20190524030049å¼€å§‹æ‰§è¡Œ2019-05-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524030053

20190525030049å¼€å§‹æ‰§è¡Œ2019-05-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525030054

20190526030049å¼€å§‹æ‰§è¡Œ2019-05-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526030054

20190527030051å¼€å§‹æ‰§è¡Œ2019-05-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527030055

20190528030051å¼€å§‹æ‰§è¡Œ2019-05-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528030055

20190529030050å¼€å§‹æ‰§è¡Œ2019-05-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529030055

20190530030051å¼€å§‹æ‰§è¡Œ2019-05-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530030055

20190531030050å¼€å§‹æ‰§è¡Œ2019-05-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531030054

20190601030051å¼€å§‹æ‰§è¡Œ2019-05-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601030056

20190602030050å¼€å§‹æ‰§è¡Œ2019-06-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602030055

20190603030056å¼€å§‹æ‰§è¡Œ2019-06-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030056


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030056


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603030056
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603030100

20190604030050å¼€å§‹æ‰§è¡Œ2019-06-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604030055

20190605030050å¼€å§‹æ‰§è¡Œ2019-06-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605030054

20190606030049å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606030054

20190607030050å¼€å§‹æ‰§è¡Œ2019-06-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607030054

20190608030051å¼€å§‹æ‰§è¡Œ2019-06-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608030055

20190609030050å¼€å§‹æ‰§è¡Œ2019-06-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609030054

20190610030049å¼€å§‹æ‰§è¡Œ2019-06-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610030053

20190611030051å¼€å§‹æ‰§è¡Œ2019-06-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611030055

20190612030051å¼€å§‹æ‰§è¡Œ2019-06-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612030056

20190613030050å¼€å§‹æ‰§è¡Œ2019-06-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613030055

20190614030053å¼€å§‹æ‰§è¡Œ2019-06-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030053


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614030058

20190615030054å¼€å§‹æ‰§è¡Œ2019-06-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030054


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030054


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615030054
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615030058

20190616030053å¼€å§‹æ‰§è¡Œ2019-06-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030053


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616030057

20190617030052å¼€å§‹æ‰§è¡Œ2019-06-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617030057

20190618030052å¼€å§‹æ‰§è¡Œ2019-06-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618030057

20190619030052å¼€å§‹æ‰§è¡Œ2019-06-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619030057

20190620030055å¼€å§‹æ‰§è¡Œ2019-06-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030055


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030056


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620030056
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620030100

20190621030052å¼€å§‹æ‰§è¡Œ2019-06-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621030057

20190622030053å¼€å§‹æ‰§è¡Œ2019-06-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030053


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030053


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030053
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622030053
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622030057

20190623030052å¼€å§‹æ‰§è¡Œ2019-06-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623030056

20190624030052å¼€å§‹æ‰§è¡Œ2019-06-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624030057

20190625030041å¼€å§‹æ‰§è¡Œ2019-06-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625030045

20190626030044å¼€å§‹æ‰§è¡Œ2019-06-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626030049

20190627030040å¼€å§‹æ‰§è¡Œ2019-06-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030040


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627030040
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627030044

20190628030041å¼€å§‹æ‰§è¡Œ2019-06-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628030046

20190629030041å¼€å§‹æ‰§è¡Œ2019-06-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629030046

20190630030040å¼€å§‹æ‰§è¡Œ2019-06-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030040


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630030045

20190701030042å¼€å§‹æ‰§è¡Œ2019-06-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701030046

20190702030045å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702030049

20190702091032å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091032


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091032
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091032


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091032
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091032
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091037

20190702091240å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091240


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091241
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091241


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091241
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702091241
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702091245

20190703030040å¼€å§‹æ‰§è¡Œ2019-07-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703030045

20190704030040å¼€å§‹æ‰§è¡Œ2019-07-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030040


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704030040
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704030044

20190705030041å¼€å§‹æ‰§è¡Œ2019-07-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705030046

20190706030043å¼€å§‹æ‰§è¡Œ2019-07-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030043


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030043
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030043


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030043
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706030043
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706030047

20190707030042å¼€å§‹æ‰§è¡Œ2019-07-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707030047

20190708030041å¼€å§‹æ‰§è¡Œ2019-07-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708030045

20190709030041å¼€å§‹æ‰§è¡Œ2019-07-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709030046

20190710030042å¼€å§‹æ‰§è¡Œ2019-07-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030043
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030043


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030043
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710030043
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710030047

20190711030041å¼€å§‹æ‰§è¡Œ2019-07-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711030046

20190712030041å¼€å§‹æ‰§è¡Œ2019-07-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712030046

20190713030041å¼€å§‹æ‰§è¡Œ2019-07-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713030046

20190716030042å¼€å§‹æ‰§è¡Œ2019-07-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716030047

20190717030042å¼€å§‹æ‰§è¡Œ2019-07-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717030047

20190718030041å¼€å§‹æ‰§è¡Œ2019-07-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718030046

20190719030044å¼€å§‹æ‰§è¡Œ2019-07-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719030049

20190720030041å¼€å§‹æ‰§è¡Œ2019-07-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030041


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030041
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190720030041
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190720030045

20190721030040å¼€å§‹æ‰§è¡Œ2019-07-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030040


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190721030040
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190721030044

20190722030042å¼€å§‹æ‰§è¡Œ2019-07-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030042


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722030047

20190723030041å¼€å§‹æ‰§è¡Œ2019-07-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030041


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030042


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030042
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723030042
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723030046

20190724030040å¼€å§‹æ‰§è¡Œ2019-07-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030040


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030040


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030040
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724030040
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,a.new_name
      ,a.new_product_name
      ,f.new_num as custcode
      ,f.name as custname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724030045

20190725030047å¼€å§‹æ‰§è¡Œ2019-07-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030057

update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP160'
      ,bi_cinvname = 'Victor'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725030059

20190726030044å¼€å§‹æ‰§è¡Œ2019-07-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726030056

20190727030044å¼€å§‹æ‰§è¡Œ2019-07-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727030056

20190728030044å¼€å§‹æ‰§è¡Œ2019-07-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030054


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030054

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728030054


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728030056

20190729030044å¼€å§‹æ‰§è¡Œ2019-07-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030054


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030054

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729030054


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729030056

20190730030045å¼€å§‹æ‰§è¡Œ2019-07-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730030058

20190731030049å¼€å§‹æ‰§è¡Œ2019-07-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030059


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030059

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731030059


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731030101

20190801091151å¼€å§‹æ‰§è¡Œ2019-07-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091151


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091151


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091151
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091201


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091201

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091201
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801091201


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801091203

20190802030044å¼€å§‹æ‰§è¡Œ2019-08-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030054


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030054

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802030054


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802030056

20190803030044å¼€å§‹æ‰§è¡Œ2019-08-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803030058

20190804030045å¼€å§‹æ‰§è¡Œ2019-08-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804030057

20190805030045å¼€å§‹æ‰§è¡Œ2019-08-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805030058

20190806030045å¼€å§‹æ‰§è¡Œ2019-08-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806030057

20190807030045å¼€å§‹æ‰§è¡Œ2019-08-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807030058

20190808030045å¼€å§‹æ‰§è¡Œ2019-08-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808030058

20190809030044å¼€å§‹æ‰§è¡Œ2019-08-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809030056

20190810030046å¼€å§‹æ‰§è¡Œ2019-08-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810030059

20190811030046å¼€å§‹æ‰§è¡Œ2019-08-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811030059

20190812030045å¼€å§‹æ‰§è¡Œ2019-08-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812030057

20190812085646å¼€å§‹æ‰§è¡Œ2019-08-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085646


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085647
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085647


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085647
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085647
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085657
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085657


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085657
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085657

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085657
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812085657


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812085659

20190813030045å¼€å§‹æ‰§è¡Œ2019-08-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813030057

20190814030044å¼€å§‹æ‰§è¡Œ2019-08-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814030057

20190815030046å¼€å§‹æ‰§è¡Œ2019-08-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815030059

20190816030044å¼€å§‹æ‰§è¡Œ2019-08-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816030056

20190817030046å¼€å§‹æ‰§è¡Œ2019-08-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817030059

20190819142416å¼€å§‹æ‰§è¡Œ2019-08-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142416


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142416
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142416


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142416
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142416
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142427
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142427


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142427
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142427

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142427
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819142427


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819142429

20190820091705å¼€å§‹æ‰§è¡Œ2019-08-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091705


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091706
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091706


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091706
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091706
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091716
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091716


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091716
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091716

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091716
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820091716


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820091718

20190821030046å¼€å§‹æ‰§è¡Œ2019-08-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821030058

20190822030046å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822030059

20190822170332å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170332


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170332
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170332


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170332
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170332
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170403
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170403


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170403
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170403

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170403
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822170403


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822170405

20190823030045å¼€å§‹æ‰§è¡Œ2019-08-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823030058

20190824030044å¼€å§‹æ‰§è¡Œ2019-08-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824030057

20190825030045å¼€å§‹æ‰§è¡Œ2019-08-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825030058

20190826030045å¼€å§‹æ‰§è¡Œ2019-08-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826030057

20190827030045å¼€å§‹æ‰§è¡Œ2019-08-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827030058

20190828030044å¼€å§‹æ‰§è¡Œ2019-08-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030044


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030044


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030044
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030055


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030055

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030055
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828030055


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828030056

20190829030049å¼€å§‹æ‰§è¡Œ2019-08-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030101


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030101

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829030101


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829030102

20190830030045å¼€å§‹æ‰§è¡Œ2019-08-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830030058

20190831030045å¼€å§‹æ‰§è¡Œ2019-08-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030056


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030056

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030056
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831030056


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831030058

20190901030047å¼€å§‹æ‰§è¡Œ2019-08-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030048


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030048
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901030100

20190902030046å¼€å§‹æ‰§è¡Œ2019-09-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902030059

20190903030045å¼€å§‹æ‰§è¡Œ2019-09-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903030045


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903030045


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903030045
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903030045
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;

20190903084633å¼€å§‹æ‰§è¡Œ2019-09-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084633


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084633
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084633


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084633
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084633
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084643
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084643


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084643
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084643

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084643
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084643


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084645
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903084645

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903084646

20190904030047å¼€å§‹æ‰§è¡Œ2019-09-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030059
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904030059

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904030100

20190905030046å¼€å§‹æ‰§è¡Œ2019-09-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030046


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030046


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030046
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030046
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030057


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030057

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030057


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030057
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905030057

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905030058

20190906030047å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906030100

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906030101

20190906171331å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171331


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171331
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171331


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171331
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171331
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171342
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171342


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171342
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171342

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171342
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171342


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171344
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906171344

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906171344

20190907030047å¼€å§‹æ‰§è¡Œ2019-09-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030048


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030048
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907030100

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907030101

20190908030047å¼€å§‹æ‰§è¡Œ2019-09-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908030100

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908030101

20190909030047å¼€å§‹æ‰§è¡Œ2019-09-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909030100

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909030100

20190910030047å¼€å§‹æ‰§è¡Œ2019-09-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030058


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030058

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030058
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030058


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910030100

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910030101

20190911030048å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030048


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030048


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030048
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030048
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030105


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030105

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030105


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911030107

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911030108

20190911163303å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163303


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163303
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163303


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163303
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163303
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163314
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163314


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163314
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163314

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163314
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163314


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163316
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911163316

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911163316

20190912030047å¼€å§‹æ‰§è¡Œ2019-09-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030047


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030047


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030047
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030047
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912030104

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912030105

20190913030054å¼€å§‹æ‰§è¡Œ2019-09-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030054


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030054


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030054
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030054
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030105


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030105

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030105


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913030107

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913030108

20190914030049å¼€å§‹æ‰§è¡Œ2019-09-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030100


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030100

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030100


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914030102

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914030103

20190915030049å¼€å§‹æ‰§è¡Œ2019-09-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030100


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030100

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030100


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915030102

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915030103

20190916030050å¼€å§‹æ‰§è¡Œ2019-09-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030101


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030101

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030101


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916030103

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916030104

20190917030052å¼€å§‹æ‰§è¡Œ2019-09-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917030105

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917030106

20190918030051å¼€å§‹æ‰§è¡Œ2019-09-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918030104

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918030105

20190919030050å¼€å§‹æ‰§è¡Œ2019-09-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030101


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030101

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030101
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030101


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919030103

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919030104

20190920030050å¼€å§‹æ‰§è¡Œ2019-09-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030050


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030050


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030050
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030102


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030102

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030102


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920030104

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920030105

20190921030051å¼€å§‹æ‰§è¡Œ2019-09-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030102


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030102

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030102


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030104
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921030104

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921030105

20190922030052å¼€å§‹æ‰§è¡Œ2019-09-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922030105

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922030106

20190923030049å¼€å§‹æ‰§è¡Œ2019-09-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030049


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030049


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030049
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030049
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030100


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030100

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030100
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030100


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030102
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923030102

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923030103

20190924030051å¼€å§‹æ‰§è¡Œ2019-09-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030051


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030051


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030051
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030051
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924030105

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924030106

20190925030052å¼€å§‹æ‰§è¡Œ2019-09-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030052


create temporary table edw.crm_account_equipments_pre as
select * 
  from ufdata.crm_account_equipments a
 where a.statecode = '0'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030052


truncate table edw.crm_account_equipments
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030052
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030052
insert into edw.crm_account_equipments
select a.new_account_equipmentid
      ,null
      ,a.new_name
      ,j.new_code as new_product_code
      ,a.new_product_name
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvcode end as bi_cinvcode
      ,case when h.cinvname is null then 'è¯·æ ¸æŸ¥' else h.bi_cinvname end as bi_cinvname
      ,f.new_num as custcode
      ,f.name as custname
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cuscode end as bi_cuscode
      ,case when f.name is not null and i.ccusname is null then 'è¯·æ ¸æŸ¥' else i.bi_cusname end as bi_cusname
      ,g.new_area
      ,a.new_model
      ,case when a.new_use_mode = 1 then 'æ­£å¸¸'
            when a.new_use_mode = 2 then 'åœç”¨'
            when a.new_use_mode = 3 then 'è®¡åˆ’é‡‡è´­'
            when a.new_use_mode = 4 then 'åŸ¹è®­æœº'
            when a.new_use_mode = 5 then 'å¤‡ç”¨'
            when a.new_use_mode = 6 then 'å›æ”¶'
            when a.new_use_mode = 7 then 'æŠ¥åºŸ'
       else 'æœªçŸ¥çŠ¶æ€' end as use_mode
      ,a.new_equipment_type
      ,b.lastname as owner
      ,a.new_trademark
      ,a.new_prod_brand
      ,a.new_prod_id
      ,a.new_installation_date
      ,a._new_account_equipment_value
      ,a.new_host_guarantee
      ,a.new_instrument_nature
      ,a.new_administrative_office
      ,a.new_supplier
      ,a.new_service_cycle
      ,a.modifiedon
      ,d.lastname as modifiedby
      ,a.new_reception_time
      ,a.new_manufacturedate
      ,a.createdon
      ,d.lastname as createdby
      ,a.new_original_date
      ,a.new_expiration_date
      ,a.new_brand
      ,a.new_remark
      ,d.lastname as setupby
      ,a._new_work_order_value
      ,a.new_upkeep
      ,a.new_lastyear_check
      ,a.new_avg_breakdown
      ,a._new_open_project_value
      ,a.new_main
      ,a.new_competitor
      ,a.statecode
      ,a.new_service_time
      ,null
      ,localtimestamp()
  from edw.crm_account_equipments_pre a
	left join ufdata.crm_systemusers b
	  on a._ownerid_value = b.ownerid
	left join ufdata.crm_systemusers c
	  on a._modifiedby_value = c.ownerid
	left join ufdata.crm_systemusers d
	  on a._createdby_value = d.ownerid
	left join ufdata.crm_systemusers e
	  on a._new_setupby_value = e.ownerid
  left join ufdata.crm_accounts f
    on a._new_account_value = f.accountid
  left join edw.crm_accounts g
    on f.new_num = g.new_num
  left join ufdata.crm_new_products j
    on a._new_product_value = j.new_productid
  left join (select * from edw.dic_inventory group by cinvcode) h
    on j.new_code = h.cinvcode
  left join (select * from edw.dic_customer group by ccusname) i
    on f.name = i.ccusname
  
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030103


update edw.crm_account_equipments
   set bi_cinvcode = 'TEMP161'
      ,bi_cinvname = 'MB8/MB4'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '15'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030103

update edw.crm_account_equipments
   set bi_cinvcode = 'YQ01007'
      ,bi_cinvname = '1420ï¼ˆæ–°ç­›ï¼‰'
  where bi_cinvcode = 'è¯·æ ¸æŸ¥'
    and new_equipment_type = '10'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030103


update edw.crm_account_equipments a
 inner join (select * from edw.cm_contract group by bi_cuscode,bi_cinvcode) b
	  on a.bi_cuscode = b.bi_cuscode
	 and a.bi_cinvcode = b.bi_cinvcode
   set a.yzdw = b.cdefine11
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925030105

update edw.crm_account_equipments a
 inner join (select * from edw.map_inventory group by bi_cinvcode) b
	  on a.bi_cinvcode = b.bi_cinvcode
   set a.item_code = b.item_code
  where b.bi_cinvcode is not null

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925030106
