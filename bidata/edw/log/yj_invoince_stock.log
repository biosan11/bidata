
20190708162343开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190708162343
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190708162343
SQL开始执行时间：20190708162343
insert into edw.yj_invoince_stock
select a.uguid1,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode
 where (a.dInventoryQty<>0 or (ifnull(a.dBadQty,0)<>0) or (ifnull(a.dNoOutQty,0)<>0))

;
SQL结束执行时间：20190708162347

20190718092843开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190718092843
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190718092843
SQL开始执行时间：20190718092843
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190718092910
SQL开始执行时间：20190718092910

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190718092910

20190719014204开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719014204
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190719014204
SQL开始执行时间：20190719014204
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190719014204
SQL开始执行时间：20190719014204

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190719014204

20190720014205开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720014205
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190720014205
SQL开始执行时间：20190720014205
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190720014205
SQL开始执行时间：20190720014205

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190720014205

20190721014204开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721014204
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190721014204
SQL开始执行时间：20190721014204
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190721014204
SQL开始执行时间：20190721014204

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190721014204

20190722014204开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722014204
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190722014204
SQL开始执行时间：20190722014204
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190722014204
SQL开始执行时间：20190722014204

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190722014204

20190723014205开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723014205
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190723014205
SQL开始执行时间：20190723014205
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190723014205
SQL开始执行时间：20190723014205

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190723014205

20190724014543开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190724014543
SQL开始执行时间：20190724014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190724014611
SQL开始执行时间：20190724014611

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190724014611
SQL开始执行时间：20190724014611

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190724014611
SQL开始执行时间：20190724014611

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190724014611
SQL开始执行时间：20190724014611

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190724014611

20190724110634开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190724110634
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190724110634
SQL开始执行时间：20190724110634
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190724110702
SQL开始执行时间：20190724110702

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190724110702
SQL开始执行时间：20190724110702

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190724110702
SQL开始执行时间：20190724110702

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190724110702
SQL开始执行时间：20190724110702

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190724110702

20190725014544开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190725014544
SQL开始执行时间：20190725014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190725014612
SQL开始执行时间：20190725014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190725014612
SQL开始执行时间：20190725014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190725014612
SQL开始执行时间：20190725014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190725014612
SQL开始执行时间：20190725014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190725014612

20190725133500开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190725133500
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190725133501
SQL开始执行时间：20190725133501
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190725133528
SQL开始执行时间：20190725133528

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190725133528
SQL开始执行时间：20190725133528

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190725133528
SQL开始执行时间：20190725133528

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190725133528
SQL开始执行时间：20190725133528

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190725133528

20190726014544开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190726014544
SQL开始执行时间：20190726014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190726014612
SQL开始执行时间：20190726014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190726014612
SQL开始执行时间：20190726014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190726014612
SQL开始执行时间：20190726014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190726014612
SQL开始执行时间：20190726014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190726014612

20190726090107开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726090107
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190726090107
SQL开始执行时间：20190726090107
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190726090136
SQL开始执行时间：20190726090136

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190726090136
SQL开始执行时间：20190726090136

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190726090136
SQL开始执行时间：20190726090136

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190726090136
SQL开始执行时间：20190726090136

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190726090136

20190727014544开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190727014544
SQL开始执行时间：20190727014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190727014614
SQL开始执行时间：20190727014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190727014614
SQL开始执行时间：20190727014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190727014614
SQL开始执行时间：20190727014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190727014615
SQL开始执行时间：20190727014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190727014615

20190728014544开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190728014544
SQL开始执行时间：20190728014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190728014614
SQL开始执行时间：20190728014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190728014614
SQL开始执行时间：20190728014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190728014614
SQL开始执行时间：20190728014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190728014614
SQL开始执行时间：20190728014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190728014614

20190729014544开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190729014544
SQL开始执行时间：20190729014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190729014614
SQL开始执行时间：20190729014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190729014614
SQL开始执行时间：20190729014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190729014614
SQL开始执行时间：20190729014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190729014614
SQL开始执行时间：20190729014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190729014614

20190729111547开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111547
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190729111547
SQL开始执行时间：20190729111547
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190729111617
SQL开始执行时间：20190729111617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190729111617
SQL开始执行时间：20190729111617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190729111617
SQL开始执行时间：20190729111617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190729111617
SQL开始执行时间：20190729111617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190729111617

20190730014543开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190730014543
SQL开始执行时间：20190730014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190730014615
SQL开始执行时间：20190730014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190730014615
SQL开始执行时间：20190730014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190730014615
SQL开始执行时间：20190730014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190730014615
SQL开始执行时间：20190730014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190730014615

20190730090924开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730090924
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190730090924
SQL开始执行时间：20190730090924
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190730090957
SQL开始执行时间：20190730090957

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190730090957
SQL开始执行时间：20190730090957

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190730090957
SQL开始执行时间：20190730090957

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190730090957
SQL开始执行时间：20190730090957

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190730090957

20190731014545开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731014545
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190731014545
SQL开始执行时间：20190731014545
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190731014618
SQL开始执行时间：20190731014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190731014618
SQL开始执行时间：20190731014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190731014618
SQL开始执行时间：20190731014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190731014618
SQL开始执行时间：20190731014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190731014618

20190801014544开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190801014544
SQL开始执行时间：20190801014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190801014613
SQL开始执行时间：20190801014613

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190801014613
SQL开始执行时间：20190801014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190801014613
SQL开始执行时间：20190801014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190801014613
SQL开始执行时间：20190801014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190801014613

20190801092308开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190801092308
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190801092308
SQL开始执行时间：20190801092308
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190801092337
SQL开始执行时间：20190801092337

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190801092337
SQL开始执行时间：20190801092337

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190801092337
SQL开始执行时间：20190801092337

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190801092337
SQL开始执行时间：20190801092337

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190801092337

20190802014544开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190802014544
SQL开始执行时间：20190802014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190802014613
SQL开始执行时间：20190802014613

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190802014613
SQL开始执行时间：20190802014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190802014613
SQL开始执行时间：20190802014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190802014613
SQL开始执行时间：20190802014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190802014613

20190803014543开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190803014543
SQL开始执行时间：20190803014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190803014616
SQL开始执行时间：20190803014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190803014616
SQL开始执行时间：20190803014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190803014616
SQL开始执行时间：20190803014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190803014616
SQL开始执行时间：20190803014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190803014616

20190804014543开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190804014543
SQL开始执行时间：20190804014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190804014615
SQL开始执行时间：20190804014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190804014615
SQL开始执行时间：20190804014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190804014615
SQL开始执行时间：20190804014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190804014615
SQL开始执行时间：20190804014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190804014615

20190805014543开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190805014543
SQL开始执行时间：20190805014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190805014616
SQL开始执行时间：20190805014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190805014616
SQL开始执行时间：20190805014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190805014616
SQL开始执行时间：20190805014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190805014616
SQL开始执行时间：20190805014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190805014616

20190805132501开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190805132501
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190805132501
SQL开始执行时间：20190805132501
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190805132533
SQL开始执行时间：20190805132533

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190805132533
SQL开始执行时间：20190805132533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190805132533
SQL开始执行时间：20190805132533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190805132533
SQL开始执行时间：20190805132533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190805132533

20190806014543开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190806014543
SQL开始执行时间：20190806014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190806014612
SQL开始执行时间：20190806014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190806014612
SQL开始执行时间：20190806014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190806014612
SQL开始执行时间：20190806014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190806014612
SQL开始执行时间：20190806014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190806014612

20190807014543开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190807014543
SQL开始执行时间：20190807014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190807014613
SQL开始执行时间：20190807014613

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190807014613
SQL开始执行时间：20190807014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190807014613
SQL开始执行时间：20190807014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190807014613
SQL开始执行时间：20190807014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190807014613

20190808014542开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190808014542
SQL开始执行时间：20190808014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190808014612
SQL开始执行时间：20190808014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190808014612
SQL开始执行时间：20190808014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190808014612
SQL开始执行时间：20190808014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190808014612
SQL开始执行时间：20190808014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190808014612

20190809014542开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190809014542
SQL开始执行时间：20190809014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190809014612
SQL开始执行时间：20190809014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190809014612
SQL开始执行时间：20190809014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190809014612
SQL开始执行时间：20190809014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190809014612
SQL开始执行时间：20190809014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190809014612

20190810014543开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190810014543
SQL开始执行时间：20190810014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190810014617
SQL开始执行时间：20190810014617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190810014617
SQL开始执行时间：20190810014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190810014618
SQL开始执行时间：20190810014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190810014618
SQL开始执行时间：20190810014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190810014618

20190811014543开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190811014543
SQL开始执行时间：20190811014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190811014617
SQL开始执行时间：20190811014617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190811014617
SQL开始执行时间：20190811014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190811014617
SQL开始执行时间：20190811014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190811014617
SQL开始执行时间：20190811014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190811014617

20190812014543开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190812014543
SQL开始执行时间：20190812014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190812014618
SQL开始执行时间：20190812014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190812014618
SQL开始执行时间：20190812014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190812014618
SQL开始执行时间：20190812014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190812014618
SQL开始执行时间：20190812014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190812014618

20190813014542开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190813014542
SQL开始执行时间：20190813014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190813014612
SQL开始执行时间：20190813014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190813014612
SQL开始执行时间：20190813014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190813014612
SQL开始执行时间：20190813014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190813014612
SQL开始执行时间：20190813014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190813014612

20190814014542开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190814014542
SQL开始执行时间：20190814014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190814014612
SQL开始执行时间：20190814014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190814014612
SQL开始执行时间：20190814014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190814014613
SQL开始执行时间：20190814014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190814014613
SQL开始执行时间：20190814014613

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190814014613

20190815014542开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190815014542
SQL开始执行时间：20190815014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190815014612
SQL开始执行时间：20190815014612

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190815014612
SQL开始执行时间：20190815014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190815014612
SQL开始执行时间：20190815014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190815014612
SQL开始执行时间：20190815014612

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190815014612

20190816014543开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190816014543
SQL开始执行时间：20190816014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190816014614
SQL开始执行时间：20190816014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190816014614
SQL开始执行时间：20190816014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190816014614
SQL开始执行时间：20190816014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190816014614
SQL开始执行时间：20190816014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190816014614

20190817014543开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190817014543
SQL开始执行时间：20190817014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190817014614
SQL开始执行时间：20190817014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190817014614
SQL开始执行时间：20190817014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190817014614
SQL开始执行时间：20190817014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190817014614
SQL开始执行时间：20190817014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190817014614

20190818014542开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190818014542
SQL开始执行时间：20190818014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190818014614
SQL开始执行时间：20190818014614

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190818014614
SQL开始执行时间：20190818014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190818014614
SQL开始执行时间：20190818014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190818014614
SQL开始执行时间：20190818014614

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190818014614

20190819014543开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190819014543
SQL开始执行时间：20190819014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190819014615
SQL开始执行时间：20190819014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190819014615
SQL开始执行时间：20190819014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190819014615
SQL开始执行时间：20190819014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190819014615
SQL开始执行时间：20190819014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190819014615

20190819143100开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190819143100
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190819143100
SQL开始执行时间：20190819143100
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190819143132
SQL开始执行时间：20190819143132

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190819143132
SQL开始执行时间：20190819143132

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190819143132
SQL开始执行时间：20190819143132

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190819143132
SQL开始执行时间：20190819143132

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190819143132

20190820014543开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190820014543
SQL开始执行时间：20190820014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190820014615
SQL开始执行时间：20190820014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190820014615
SQL开始执行时间：20190820014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190820014615
SQL开始执行时间：20190820014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190820014615
SQL开始执行时间：20190820014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190820014615

20190821014543开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190821014543
SQL开始执行时间：20190821014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190821014616
SQL开始执行时间：20190821014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190821014616
SQL开始执行时间：20190821014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190821014616
SQL开始执行时间：20190821014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190821014616
SQL开始执行时间：20190821014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190821014616

20190822014543开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190822014543
SQL开始执行时间：20190822014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190822014616
SQL开始执行时间：20190822014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190822014616
SQL开始执行时间：20190822014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190822014616
SQL开始执行时间：20190822014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190822014616
SQL开始执行时间：20190822014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190822014616

20190823014542开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190823014542
SQL开始执行时间：20190823014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190823014615
SQL开始执行时间：20190823014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190823014615
SQL开始执行时间：20190823014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190823014615
SQL开始执行时间：20190823014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190823014615
SQL开始执行时间：20190823014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190823014615

20190824014543开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190824014543
SQL开始执行时间：20190824014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190824014616
SQL开始执行时间：20190824014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190824014616
SQL开始执行时间：20190824014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190824014616
SQL开始执行时间：20190824014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190824014616
SQL开始执行时间：20190824014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190824014616

20190825014543开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190825014543
SQL开始执行时间：20190825014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190825014616
SQL开始执行时间：20190825014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190825014616
SQL开始执行时间：20190825014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190825014616
SQL开始执行时间：20190825014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190825014616
SQL开始执行时间：20190825014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190825014616

20190826014542开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190826014542
SQL开始执行时间：20190826014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190826014615
SQL开始执行时间：20190826014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190826014615
SQL开始执行时间：20190826014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190826014615
SQL开始执行时间：20190826014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190826014615
SQL开始执行时间：20190826014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190826014615

20190827014542开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190827014542
SQL开始执行时间：20190827014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190827014616
SQL开始执行时间：20190827014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190827014616
SQL开始执行时间：20190827014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190827014616
SQL开始执行时间：20190827014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190827014616
SQL开始执行时间：20190827014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190827014616

20190828014542开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190828014543
SQL开始执行时间：20190828014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190828014616
SQL开始执行时间：20190828014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190828014616
SQL开始执行时间：20190828014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190828014616
SQL开始执行时间：20190828014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190828014616
SQL开始执行时间：20190828014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190828014616

20190829014543开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190829014543
SQL开始执行时间：20190829014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190829014616
SQL开始执行时间：20190829014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190829014616
SQL开始执行时间：20190829014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190829014616
SQL开始执行时间：20190829014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190829014616
SQL开始执行时间：20190829014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190829014616

20190830014543开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190830014543
SQL开始执行时间：20190830014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190830014617
SQL开始执行时间：20190830014617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190830014617
SQL开始执行时间：20190830014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190830014617
SQL开始执行时间：20190830014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190830014617
SQL开始执行时间：20190830014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190830014617

20190830141658开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830141658
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190830141658
SQL开始执行时间：20190830141658
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190830141731
SQL开始执行时间：20190830141731

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190830141731
SQL开始执行时间：20190830141731

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190830141731
SQL开始执行时间：20190830141731

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190830141731
SQL开始执行时间：20190830141731

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190830141731

20190831014543开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190831014543
SQL开始执行时间：20190831014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190831014617
SQL开始执行时间：20190831014617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190831014617
SQL开始执行时间：20190831014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190831014617
SQL开始执行时间：20190831014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190831014617
SQL开始执行时间：20190831014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190831014617

20190901014542开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190901014542
SQL开始执行时间：20190901014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190901014615
SQL开始执行时间：20190901014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190901014615
SQL开始执行时间：20190901014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190901014615
SQL开始执行时间：20190901014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190901014615
SQL开始执行时间：20190901014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190901014615

20190902014542开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190902014542
SQL开始执行时间：20190902014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190902014615
SQL开始执行时间：20190902014615

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190902014615
SQL开始执行时间：20190902014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190902014615
SQL开始执行时间：20190902014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190902014615
SQL开始执行时间：20190902014615

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190902014615

20190903014542开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190903014542
SQL开始执行时间：20190903014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190903014616
SQL开始执行时间：20190903014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190903014616
SQL开始执行时间：20190903014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190903014616
SQL开始执行时间：20190903014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190903014616
SQL开始执行时间：20190903014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190903014616

20190904014542开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190904014542
SQL开始执行时间：20190904014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190904014616
SQL开始执行时间：20190904014616

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190904014616
SQL开始执行时间：20190904014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190904014616
SQL开始执行时间：20190904014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190904014616
SQL开始执行时间：20190904014616

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190904014616

20190905014542开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190905014542
SQL开始执行时间：20190905014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190905014617
SQL开始执行时间：20190905014617

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190905014617
SQL开始执行时间：20190905014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190905014617
SQL开始执行时间：20190905014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190905014617
SQL开始执行时间：20190905014617

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190905014617

20190906014543开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190906014543
SQL开始执行时间：20190906014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190906014618
SQL开始执行时间：20190906014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190906014618
SQL开始执行时间：20190906014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190906014618
SQL开始执行时间：20190906014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190906014618
SQL开始执行时间：20190906014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190906014618

20190907014542开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907014542
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190907014542
SQL开始执行时间：20190907014542
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190907014618
SQL开始执行时间：20190907014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190907014618
SQL开始执行时间：20190907014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190907014618
SQL开始执行时间：20190907014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190907014618
SQL开始执行时间：20190907014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190907014618

20190908014543开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190908014543
SQL开始执行时间：20190908014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190908014619
SQL开始执行时间：20190908014619

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190908014619
SQL开始执行时间：20190908014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190908014619
SQL开始执行时间：20190908014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190908014619
SQL开始执行时间：20190908014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190908014619

20190909014543开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190909014543
SQL开始执行时间：20190909014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190909014618
SQL开始执行时间：20190909014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190909014618
SQL开始执行时间：20190909014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190909014618
SQL开始执行时间：20190909014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190909014618
SQL开始执行时间：20190909014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190909014618

20190910014543开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190910014543
SQL开始执行时间：20190910014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190910014619
SQL开始执行时间：20190910014619

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190910014619
SQL开始执行时间：20190910014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190910014619
SQL开始执行时间：20190910014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190910014619
SQL开始执行时间：20190910014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190910014619

20190911014543开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190911014543
SQL开始执行时间：20190911014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190911014618
SQL开始执行时间：20190911014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190911014618
SQL开始执行时间：20190911014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190911014618
SQL开始执行时间：20190911014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190911014618
SQL开始执行时间：20190911014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190911014618

20190912014543开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190912014543
SQL开始执行时间：20190912014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190912014618
SQL开始执行时间：20190912014618

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190912014618
SQL开始执行时间：20190912014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190912014618
SQL开始执行时间：20190912014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190912014618
SQL开始执行时间：20190912014618

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190912014618

20190913014543开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190913014543
SQL开始执行时间：20190913014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190913014619
SQL开始执行时间：20190913014619

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190913014619
SQL开始执行时间：20190913014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190913014619
SQL开始执行时间：20190913014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190913014619
SQL开始执行时间：20190913014619

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190913014619

20190914014545开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914014545
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190914014545
SQL开始执行时间：20190914014545
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190914014626
SQL开始执行时间：20190914014626

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190914014626
SQL开始执行时间：20190914014626

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190914014626
SQL开始执行时间：20190914014626

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190914014626
SQL开始执行时间：20190914014626

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190914014626

20190915014543开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190915014543
SQL开始执行时间：20190915014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190915014620
SQL开始执行时间：20190915014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190915014620
SQL开始执行时间：20190915014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190915014620
SQL开始执行时间：20190915014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190915014620
SQL开始执行时间：20190915014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190915014620

20190916014543开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190916014543
SQL开始执行时间：20190916014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190916014620
SQL开始执行时间：20190916014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190916014620
SQL开始执行时间：20190916014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190916014620
SQL开始执行时间：20190916014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190916014620
SQL开始执行时间：20190916014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190916014620

20190916084926开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916084926
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190916084926
SQL开始执行时间：20190916084926
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190916085003
SQL开始执行时间：20190916085003

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190916085003
SQL开始执行时间：20190916085003

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190916085003
SQL开始执行时间：20190916085003

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190916085003
SQL开始执行时间：20190916085003

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190916085003

20190916093456开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916093456
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190916093456
SQL开始执行时间：20190916093456
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190916093533
SQL开始执行时间：20190916093533

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190916093533
SQL开始执行时间：20190916093533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190916093533
SQL开始执行时间：20190916093533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190916093533
SQL开始执行时间：20190916093533

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190916093533

20190917014543开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190917014543
SQL开始执行时间：20190917014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190917014620
SQL开始执行时间：20190917014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190917014620
SQL开始执行时间：20190917014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190917014620
SQL开始执行时间：20190917014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190917014620
SQL开始执行时间：20190917014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190917014620

20190918014543开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190918014543
SQL开始执行时间：20190918014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190918014620
SQL开始执行时间：20190918014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190918014620
SQL开始执行时间：20190918014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190918014620
SQL开始执行时间：20190918014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190918014620
SQL开始执行时间：20190918014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190918014620

20190918094349开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190918094349
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190918094349
SQL开始执行时间：20190918094349
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190918094426
SQL开始执行时间：20190918094426

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190918094426
SQL开始执行时间：20190918094426

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190918094426
SQL开始执行时间：20190918094426

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190918094427
SQL开始执行时间：20190918094427

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190918094427

20190919014543开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190919014543
SQL开始执行时间：20190919014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190919014620
SQL开始执行时间：20190919014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190919014620
SQL开始执行时间：20190919014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190919014620
SQL开始执行时间：20190919014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190919014620
SQL开始执行时间：20190919014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190919014620

20190920014544开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190920014544
SQL开始执行时间：20190920014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190920014621
SQL开始执行时间：20190920014621

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190920014621
SQL开始执行时间：20190920014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190920014621
SQL开始执行时间：20190920014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190920014621
SQL开始执行时间：20190920014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190920014621

20190921014543开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190921014543
SQL开始执行时间：20190921014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190921014620
SQL开始执行时间：20190921014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190921014620
SQL开始执行时间：20190921014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190921014620
SQL开始执行时间：20190921014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190921014620
SQL开始执行时间：20190921014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190921014620

20190922014543开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190922014543
SQL开始执行时间：20190922014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190922014621
SQL开始执行时间：20190922014621

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190922014621
SQL开始执行时间：20190922014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190922014621
SQL开始执行时间：20190922014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190922014621
SQL开始执行时间：20190922014621

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190922014621

20190923014543开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190923014543
SQL开始执行时间：20190923014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190923014620
SQL开始执行时间：20190923014620

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190923014620
SQL开始执行时间：20190923014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190923014620
SQL开始执行时间：20190923014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190923014620
SQL开始执行时间：20190923014620

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190923014620

20190923114013开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190923114013
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190923114013
SQL开始执行时间：20190923114013
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190923114052
SQL开始执行时间：20190923114052

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190923114052
SQL开始执行时间：20190923114052

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190923114052
SQL开始执行时间：20190923114052

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190923114052
SQL开始执行时间：20190923114052

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190923114052

20190924014543开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190924014543
SQL开始执行时间：20190924014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190924014622
SQL开始执行时间：20190924014622

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190924014622
SQL开始执行时间：20190924014622

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190924014622
SQL开始执行时间：20190924014622

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190924014622
SQL开始执行时间：20190924014622

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190924014622

20190924094612开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190924094612
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190924094612
SQL开始执行时间：20190924094612
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190924094651
SQL开始执行时间：20190924094651

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190924094651
SQL开始执行时间：20190924094651

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190924094651
SQL开始执行时间：20190924094651

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190924094651
SQL开始执行时间：20190924094651

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190924094651

20190925014545开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925014545
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190925014545
SQL开始执行时间：20190925014545
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190925014625
SQL开始执行时间：20190925014625

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190925014625
SQL开始执行时间：20190925014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190925014625
SQL开始执行时间：20190925014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190925014625
SQL开始执行时间：20190925014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190925014625

20190925113911开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190925113911
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190925113911
SQL开始执行时间：20190925113911
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190925113950
SQL开始执行时间：20190925113950

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190925113950
SQL开始执行时间：20190925113950

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190925113950
SQL开始执行时间：20190925113950

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190925113950
SQL开始执行时间：20190925113950

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190925113950

20190926014543开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190926014543
SQL开始执行时间：20190926014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190926014623
SQL开始执行时间：20190926014623

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190926014623
SQL开始执行时间：20190926014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190926014623
SQL开始执行时间：20190926014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190926014623
SQL开始执行时间：20190926014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190926014623

20190927014544开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927014544
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190927014544
SQL开始执行时间：20190927014544
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190927014623
SQL开始执行时间：20190927014623

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190927014623
SQL开始执行时间：20190927014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190927014623
SQL开始执行时间：20190927014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190927014623
SQL开始执行时间：20190927014623

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190927014623

20190928014545开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928014545
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190928014545
SQL开始执行时间：20190928014545
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190928014625
SQL开始执行时间：20190928014625

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190928014625
SQL开始执行时间：20190928014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190928014625
SQL开始执行时间：20190928014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190928014625
SQL开始执行时间：20190928014625

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190928014625

20190929014543开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929014543
truncate table edw.yj_invoince_stock
;
SQL结束执行时间：20190929014543
SQL开始执行时间：20190929014543
insert into edw.yj_invoince_stock
select a.uguid1,
	     date(concat('20',left(a.sdefineno,2),'-',substring(a.sdefineno,3,2),'-',substring(a.sdefineno,5,2))) as ddate,
       o.sname,
       e.sname as ssupplyname,
	     upper(a.sproductcode),
	     a.sproductname,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvcode end as bi_cinvcode,
	     case when c.cinvcode is null then '请核查' else c.bi_cinvname end as bi_cinvname,
	     b.sproductstyle,
	     b.sproductmodel,
       case when ifnull( b.bnotmedical, 0 ) = 1 then '非医疗器械产品' else '医疗器械产品' end as smedical,
	     a.swarehouseno,
	     case when a.sWareHouseNo = 'YD' then '云鼎仓库'
	          when a.sWareHouseNo = '' then '未填写'
	          when a.sWareHouseNo is null then '未填写'
	          else '请核查' end as swarehousename,
	     a.sposition,
	     f.sname as spositionname,
	     a.sracking,
	     r.sname as srackingname,
	     a.scell,
	     rc.sname as scellname,
	     a.dinitqty,
	     a.dinqty,
	     a.doutqty,
	     ifnull( a.dinitqty, 0 ) + ifnull( a.dinqty, 0 ) - ifnull( a.doutqty, 0 ) as dstoreqty,
	     a.dinventoryqty,
	     a.dnooutqty,
	     a.dbadqty,
       d.sname as sbasicunit,
	     a.dprice,
	     a.dmoney,
	     a.sdefineno,
	     b.sbrand,
	     date(a.tproductdate) as tproductdate,
	     date(a.teffectdate) as teffectdate,
	     a.tlatestindate,
	     a.dqualitydays,
	     a.slicnumber,
	     a.spoductlotno,
	     ifnull( a.sproductcode, '' ) + ifnull( a.sdefineno, '' ) as sbarcode,
	     ifnull( b.dstoreday, 0 ) as dstoreday,
	     ifnull( b.dwarndays, 0 ) as dwarndays,
	     a.tsafedate,
	     '有效' as state,
	     localtimestamp() as sys_time
  from ufdata.yj_stk_productstore_position a
	left join ufdata.yj_ele_warehouse_position_racking_cell rc 
	  on a.scell = rc.scode
	left join ufdata.yj_sys_organization o 
	  on o.scode = rc.sorgcode
	left join ufdata.yj_ele_product b 
	  on a.sproductcode = b.scode 
	left join ufdata.yj_ele_supply e 
	  on e.scode=a.ssupplycode 
	 and o.uguid1=e.uorgid
  left join ufdata.yj_ele_unit d 
    on b.sbasicunit=d.scode 
	left join ufdata.yj_ele_warehouse_position f 
	  on f.scode = a.sposition
	left join ufdata.yj_ele_warehouse_position_racking r 
	  on a.sracking = r.scode
	left join (select * from edw.dic_inventory group by cinvcode) c
	  on left(upper(a.sproductcode),7) = c.cinvcode

;
SQL结束执行时间：20190929014624
SQL开始执行时间：20190929014624

delete from edw.yj_invoince_stock where sdefineno is null
;
SQL结束执行时间：20190929014624
SQL开始执行时间：20190929014624

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+1
 where uguid1 = 'B115D841-9260-4AD9-9A3F-67B76DF8ADF3'
;
SQL结束执行时间：20190929014624
SQL开始执行时间：20190929014624

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+2
 where uguid1 = '4526A2BC-EAE4-4EB5-859F-1ADE260614AF'
;
SQL结束执行时间：20190929014624
SQL开始执行时间：20190929014624

update edw.yj_invoince_stock
   set dinventoryqty = dinventoryqty+3
 where uguid1 = 'E9ABF90A-E539-4F50-8C21-BD21C69E2C8E'
;
SQL结束执行时间：20190929014624
