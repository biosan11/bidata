
20181129012028开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129012028
SQL开始执行时间：20181129012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129012028
SQL开始执行时间：20181129012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129012028
SQL开始执行时间：20181129012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181129012028
SQL开始执行时间：20181129012028

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181129012028

20181130012029开始执行2018-11-29数据加载日志:
SQL开始执行时间：20181130012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-11-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181130012029
SQL开始执行时间：20181130012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181130012029
SQL开始执行时间：20181130012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181130012029
SQL开始执行时间：20181130012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181130012029
SQL开始执行时间：20181130012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181130012029

20181201012028开始执行2018-11-30数据加载日志:
SQL开始执行时间：20181201012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-11-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181201012028
SQL开始执行时间：20181201012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181201012028
SQL开始执行时间：20181201012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181201012028
SQL开始执行时间：20181201012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181201012028
SQL开始执行时间：20181201012028

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181201012028

20181202012029开始执行2018-12-01数据加载日志:
SQL开始执行时间：20181202012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181202012029
SQL开始执行时间：20181202012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181202012029
SQL开始执行时间：20181202012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181202012029
SQL开始执行时间：20181202012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181202012029
SQL开始执行时间：20181202012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181202012029

20181203012028开始执行2018-12-02数据加载日志:
SQL开始执行时间：20181203012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20181203012028
SQL开始执行时间：20181203012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181203012028
SQL开始执行时间：20181203012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181203012028
SQL开始执行时间：20181203012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181203012029
SQL开始执行时间：20181203012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181203012029

20181204012027开始执行2018-12-03数据加载日志:
SQL开始执行时间：20181204012027


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204012028
SQL开始执行时间：20181204012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181204012028
SQL开始执行时间：20181204012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204012028
SQL开始执行时间：20181204012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181204012028
SQL开始执行时间：20181204012028

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181204012028

20181205012029开始执行2018-12-04数据加载日志:
SQL开始执行时间：20181205012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20181205012029
SQL开始执行时间：20181205012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181205012029
SQL开始执行时间：20181205012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181205012029
SQL开始执行时间：20181205012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181205012029
SQL开始执行时间：20181205012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181205012029

20181206012029开始执行2018-12-05数据加载日志:
SQL开始执行时间：20181206012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206012029
SQL开始执行时间：20181206012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181206012029
SQL开始执行时间：20181206012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206012029
SQL开始执行时间：20181206012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181206012029
SQL开始执行时间：20181206012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181206012029

20181207012029开始执行2018-12-06数据加载日志:
SQL开始执行时间：20181207012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20181207012029
SQL开始执行时间：20181207012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181207012029
SQL开始执行时间：20181207012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181207012029
SQL开始执行时间：20181207012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181207012029
SQL开始执行时间：20181207012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181207012029

20181208012029开始执行2018-12-07数据加载日志:
SQL开始执行时间：20181208012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20181208012029
SQL开始执行时间：20181208012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181208012029
SQL开始执行时间：20181208012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181208012029
SQL开始执行时间：20181208012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181208012029
SQL开始执行时间：20181208012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181208012029

20181209012028开始执行2018-12-08数据加载日志:
SQL开始执行时间：20181209012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20181209012028
SQL开始执行时间：20181209012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181209012028
SQL开始执行时间：20181209012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181209012028
SQL开始执行时间：20181209012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181209012028
SQL开始执行时间：20181209012028

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181209012028

20181210012029开始执行2018-12-09数据加载日志:
SQL开始执行时间：20181210012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20181210012029
SQL开始执行时间：20181210012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181210012029
SQL开始执行时间：20181210012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181210012029
SQL开始执行时间：20181210012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181210012029
SQL开始执行时间：20181210012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181210012029

20181211012030开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211012030
SQL开始执行时间：20181211012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181211012030
SQL开始执行时间：20181211012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211012030
SQL开始执行时间：20181211012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181211012030
SQL开始执行时间：20181211012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181211012030

20181212012028开始执行2018-12-11数据加载日志:
SQL开始执行时间：20181212012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20181212012028
SQL开始执行时间：20181212012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181212012028
SQL开始执行时间：20181212012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181212012028
SQL开始执行时间：20181212012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181212012029
SQL开始执行时间：20181212012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181212012029

20181213012028开始执行2018-12-12数据加载日志:
SQL开始执行时间：20181213012028


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20181213012028
SQL开始执行时间：20181213012028

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181213012028
SQL开始执行时间：20181213012028


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181213012028
SQL开始执行时间：20181213012028

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181213012029
SQL开始执行时间：20181213012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181213012029

20181214012029开始执行2018-12-13数据加载日志:
SQL开始执行时间：20181214012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20181214012029
SQL开始执行时间：20181214012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181214012029
SQL开始执行时间：20181214012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181214012029
SQL开始执行时间：20181214012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181214012029
SQL开始执行时间：20181214012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181214012029

20181215012029开始执行2018-12-14数据加载日志:
SQL开始执行时间：20181215012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20181215012029
SQL开始执行时间：20181215012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181215012029
SQL开始执行时间：20181215012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181215012029
SQL开始执行时间：20181215012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181215012029
SQL开始执行时间：20181215012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181215012029

20181216012029开始执行2018-12-15数据加载日志:
SQL开始执行时间：20181216012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20181216012029
SQL开始执行时间：20181216012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181216012029
SQL开始执行时间：20181216012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181216012029
SQL开始执行时间：20181216012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181216012029
SQL开始执行时间：20181216012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181216012029

20181217012029开始执行2018-12-16数据加载日志:
SQL开始执行时间：20181217012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20181217012029
SQL开始执行时间：20181217012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181217012029
SQL开始执行时间：20181217012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181217012029
SQL开始执行时间：20181217012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181217012029
SQL开始执行时间：20181217012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181217012029

20181218012029开始执行2018-12-17数据加载日志:
SQL开始执行时间：20181218012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20181218012030
SQL开始执行时间：20181218012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181218012030
SQL开始执行时间：20181218012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181218012030
SQL开始执行时间：20181218012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181218012030
SQL开始执行时间：20181218012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181218012030

20181219012029开始执行2018-12-18数据加载日志:
SQL开始执行时间：20181219012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219012029
SQL开始执行时间：20181219012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181219012029
SQL开始执行时间：20181219012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219012029
SQL开始执行时间：20181219012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181219012029
SQL开始执行时间：20181219012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181219012029

20181220012029开始执行2018-12-19数据加载日志:
SQL开始执行时间：20181220012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20181220012029
SQL开始执行时间：20181220012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181220012029
SQL开始执行时间：20181220012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181220012029
SQL开始执行时间：20181220012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181220012030
SQL开始执行时间：20181220012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181220012030

20181221012029开始执行2018-12-20数据加载日志:
SQL开始执行时间：20181221012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221012029
SQL开始执行时间：20181221012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181221012029
SQL开始执行时间：20181221012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221012029
SQL开始执行时间：20181221012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181221012029
SQL开始执行时间：20181221012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181221012029

20181222012029开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181222012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181222012029
SQL开始执行时间：20181222012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181222012029
SQL开始执行时间：20181222012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181222012029
SQL开始执行时间：20181222012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181222012029
SQL开始执行时间：20181222012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181222012029

20181223012029开始执行2018-12-22数据加载日志:
SQL开始执行时间：20181223012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20181223012030
SQL开始执行时间：20181223012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181223012030
SQL开始执行时间：20181223012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181223012030
SQL开始执行时间：20181223012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181223012030
SQL开始执行时间：20181223012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181223012030

20181224012030开始执行2018-12-23数据加载日志:
SQL开始执行时间：20181224012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224012030
SQL开始执行时间：20181224012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181224012030
SQL开始执行时间：20181224012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224012030
SQL开始执行时间：20181224012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181224012030
SQL开始执行时间：20181224012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181224012030

20181225012029开始执行2018-12-24数据加载日志:
SQL开始执行时间：20181225012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225012029
SQL开始执行时间：20181225012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181225012029
SQL开始执行时间：20181225012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225012029
SQL开始执行时间：20181225012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181225012030
SQL开始执行时间：20181225012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181225012030

20181226012029开始执行2018-12-25数据加载日志:
SQL开始执行时间：20181226012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226012029
SQL开始执行时间：20181226012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181226012029
SQL开始执行时间：20181226012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226012029
SQL开始执行时间：20181226012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181226012029
SQL开始执行时间：20181226012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181226012029

20181227012029开始执行2018-12-26数据加载日志:
SQL开始执行时间：20181227012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227012029
SQL开始执行时间：20181227012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181227012030
SQL开始执行时间：20181227012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227012030
SQL开始执行时间：20181227012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181227012030
SQL开始执行时间：20181227012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181227012030

20181228012030开始执行2018-12-27数据加载日志:
SQL开始执行时间：20181228012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20181228012030
SQL开始执行时间：20181228012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181228012030
SQL开始执行时间：20181228012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181228012030
SQL开始执行时间：20181228012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181228012030
SQL开始执行时间：20181228012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181228012030

20181229012029开始执行2018-12-28数据加载日志:
SQL开始执行时间：20181229012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229012029
SQL开始执行时间：20181229012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181229012029
SQL开始执行时间：20181229012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229012029
SQL开始执行时间：20181229012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181229012030
SQL开始执行时间：20181229012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181229012030

20181230012030开始执行2018-12-29数据加载日志:
SQL开始执行时间：20181230012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181230012030
SQL开始执行时间：20181230012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181230012030
SQL开始执行时间：20181230012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181230012030
SQL开始执行时间：20181230012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181230012030
SQL开始执行时间：20181230012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181230012030

20181231012030开始执行2018-12-30数据加载日志:
SQL开始执行时间：20181231012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181231012030
SQL开始执行时间：20181231012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181231012030
SQL开始执行时间：20181231012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181231012030
SQL开始执行时间：20181231012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20181231012030
SQL开始执行时间：20181231012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181231012030

20190101012030开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190101012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2018-12-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190101012030
SQL开始执行时间：20190101012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190101012030
SQL开始执行时间：20190101012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190101012030
SQL开始执行时间：20190101012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190101012030
SQL开始执行时间：20190101012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190101012030

20190102012030开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190102012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190102012030
SQL开始执行时间：20190102012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190102012030
SQL开始执行时间：20190102012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190102012030
SQL开始执行时间：20190102012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190102012030
SQL开始执行时间：20190102012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190102012030

20190103012029开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190103012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103012030
SQL开始执行时间：20190103012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190103012030
SQL开始执行时间：20190103012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103012030
SQL开始执行时间：20190103012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190103012030
SQL开始执行时间：20190103012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190103012030

20190104012029开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190104012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104012029
SQL开始执行时间：20190104012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190104012029
SQL开始执行时间：20190104012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104012029
SQL开始执行时间：20190104012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190104012030
SQL开始执行时间：20190104012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190104012030

20190105012031开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190105012031


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105012031
SQL开始执行时间：20190105012031

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190105012031
SQL开始执行时间：20190105012031


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105012031
SQL开始执行时间：20190105012031

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190105012031
SQL开始执行时间：20190105012031

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190105012031

20190106012029开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190106012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190106012029
SQL开始执行时间：20190106012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190106012029
SQL开始执行时间：20190106012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190106012029
SQL开始执行时间：20190106012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190106012029
SQL开始执行时间：20190106012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190106012029

20190107012032开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190107012032


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190107012032
SQL开始执行时间：20190107012032

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190107012032
SQL开始执行时间：20190107012032


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190107012032
SQL开始执行时间：20190107012032

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190107012032
SQL开始执行时间：20190107012032

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190107012032

20190108012030开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190108012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190108012030
SQL开始执行时间：20190108012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190108012030
SQL开始执行时间：20190108012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190108012030
SQL开始执行时间：20190108012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190108012031
SQL开始执行时间：20190108012031

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190108012031

20190109012034开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190109012034


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109012034
SQL开始执行时间：20190109012034

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190109012034
SQL开始执行时间：20190109012034


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109012034
SQL开始执行时间：20190109012034

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190109012034
SQL开始执行时间：20190109012034

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190109012034

20190110012029开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190110012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190110012029
SQL开始执行时间：20190110012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190110012029
SQL开始执行时间：20190110012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190110012029
SQL开始执行时间：20190110012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190110012029
SQL开始执行时间：20190110012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190110012029

20190111012029开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190111012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111012029
SQL开始执行时间：20190111012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190111012029
SQL开始执行时间：20190111012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111012029
SQL开始执行时间：20190111012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190111012029
SQL开始执行时间：20190111012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190111012029

20190112012029开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190112012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190112012029
SQL开始执行时间：20190112012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190112012029
SQL开始执行时间：20190112012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190112012029
SQL开始执行时间：20190112012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190112012030
SQL开始执行时间：20190112012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190112012030

20190113012029开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190113012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190113012029
SQL开始执行时间：20190113012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190113012029
SQL开始执行时间：20190113012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190113012029
SQL开始执行时间：20190113012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190113012030
SQL开始执行时间：20190113012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190113012030

20190114012030开始执行2019-01-13数据加载日志:
SQL开始执行时间：20190114012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114012030
SQL开始执行时间：20190114012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190114012030
SQL开始执行时间：20190114012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114012030
SQL开始执行时间：20190114012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190114012030
SQL开始执行时间：20190114012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190114012030

20190115012029开始执行2019-01-14数据加载日志:
SQL开始执行时间：20190115012029


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115012029
SQL开始执行时间：20190115012029

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190115012029
SQL开始执行时间：20190115012029


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115012029
SQL开始执行时间：20190115012029

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190115012029
SQL开始执行时间：20190115012029

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190115012029

20190116012030开始执行2019-01-15数据加载日志:
SQL开始执行时间：20190116012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190116012030
SQL开始执行时间：20190116012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190116012030
SQL开始执行时间：20190116012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190116012030
SQL开始执行时间：20190116012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190116012030
SQL开始执行时间：20190116012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190116012030

20190117012030开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117012030
SQL开始执行时间：20190117012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190117012030
SQL开始执行时间：20190117012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117012030
SQL开始执行时间：20190117012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190117012030
SQL开始执行时间：20190117012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190117012030

20190118012030开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190118012030


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118012030
SQL开始执行时间：20190118012030

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190118012030
SQL开始执行时间：20190118012030


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118012030
SQL开始执行时间：20190118012030

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190118012030
SQL开始执行时间：20190118012030

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.b_cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190118012030

20190122172527开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122172527


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122172527
SQL开始执行时间：20190122172527

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190122172528
SQL开始执行时间：20190122172528


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122172528
SQL开始执行时间：20190122172528

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190122172659
SQL开始执行时间：20190122172659

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190122172659

20190123012047开始执行2019-01-22数据加载日志:
SQL开始执行时间：20190123012047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123012047
SQL开始执行时间：20190123012047

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190123012048
SQL开始执行时间：20190123012048


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123012048
SQL开始执行时间：20190123012048

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190123012052
SQL开始执行时间：20190123012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190123012052

20190124012055开始执行2019-01-23数据加载日志:
SQL开始执行时间：20190124012055


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190124012055
SQL开始执行时间：20190124012055

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190124012056
SQL开始执行时间：20190124012056


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190124012056
SQL开始执行时间：20190124012056

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190124012100
SQL开始执行时间：20190124012100

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190124012100

20190126012040开始执行2019-01-25数据加载日志:
SQL开始执行时间：20190126012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190126012040
SQL开始执行时间：20190126012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190126012040
SQL开始执行时间：20190126012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190126012040
SQL开始执行时间：20190126012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190126012044
SQL开始执行时间：20190126012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190126012044

20190127012039开始执行2019-01-26数据加载日志:
SQL开始执行时间：20190127012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190127012039
SQL开始执行时间：20190127012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190127012039
SQL开始执行时间：20190127012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190127012039
SQL开始执行时间：20190127012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190127012039
SQL开始执行时间：20190127012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190127012039

20190128012039开始执行2019-01-27数据加载日志:
SQL开始执行时间：20190128012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128012039
SQL开始执行时间：20190128012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190128012039
SQL开始执行时间：20190128012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128012039
SQL开始执行时间：20190128012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190128012039
SQL开始执行时间：20190128012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190128012039

20190129012040开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129012040
SQL开始执行时间：20190129012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190129012040
SQL开始执行时间：20190129012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129012040
SQL开始执行时间：20190129012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190129012042
SQL开始执行时间：20190129012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190129012042

20190130012040开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190130012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190130012040
SQL开始执行时间：20190130012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190130012040
SQL开始执行时间：20190130012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190130012040
SQL开始执行时间：20190130012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190130012044
SQL开始执行时间：20190130012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190130012044

20190131012042开始执行2019-01-30数据加载日志:
SQL开始执行时间：20190131012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190131012042
SQL开始执行时间：20190131012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190131012042
SQL开始执行时间：20190131012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190131012042
SQL开始执行时间：20190131012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190131012045
SQL开始执行时间：20190131012045

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190131012045

20190201012040开始执行2019-01-31数据加载日志:
SQL开始执行时间：20190201012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-01-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190201012040
SQL开始执行时间：20190201012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190201012040
SQL开始执行时间：20190201012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190201012040
SQL开始执行时间：20190201012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190201012041
SQL开始执行时间：20190201012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190201012041

20190202012039开始执行2019-02-01数据加载日志:
SQL开始执行时间：20190202012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190202012039
SQL开始执行时间：20190202012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190202012039
SQL开始执行时间：20190202012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190202012039
SQL开始执行时间：20190202012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190202012040
SQL开始执行时间：20190202012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190202012040

20190203012038开始执行2019-02-02数据加载日志:
SQL开始执行时间：20190203012038


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190203012038
SQL开始执行时间：20190203012038

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190203012038
SQL开始执行时间：20190203012038


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190203012038
SQL开始执行时间：20190203012038

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190203012039
SQL开始执行时间：20190203012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190203012039

20190204012041开始执行2019-02-03数据加载日志:
SQL开始执行时间：20190204012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190204012041
SQL开始执行时间：20190204012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190204012041
SQL开始执行时间：20190204012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190204012041
SQL开始执行时间：20190204012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190204012041
SQL开始执行时间：20190204012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190204012041

20190205012039开始执行2019-02-04数据加载日志:
SQL开始执行时间：20190205012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190205012039
SQL开始执行时间：20190205012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190205012039
SQL开始执行时间：20190205012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190205012039
SQL开始执行时间：20190205012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190205012039
SQL开始执行时间：20190205012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190205012039

20190206012040开始执行2019-02-05数据加载日志:
SQL开始执行时间：20190206012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190206012040
SQL开始执行时间：20190206012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190206012040
SQL开始执行时间：20190206012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190206012040
SQL开始执行时间：20190206012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190206012040
SQL开始执行时间：20190206012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190206012040

20190207012038开始执行2019-02-06数据加载日志:
SQL开始执行时间：20190207012038


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190207012038
SQL开始执行时间：20190207012038

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190207012038
SQL开始执行时间：20190207012038


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190207012038
SQL开始执行时间：20190207012038

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190207012039
SQL开始执行时间：20190207012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190207012039

20190208012040开始执行2019-02-07数据加载日志:
SQL开始执行时间：20190208012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190208012040
SQL开始执行时间：20190208012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190208012040
SQL开始执行时间：20190208012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190208012040
SQL开始执行时间：20190208012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190208012040
SQL开始执行时间：20190208012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190208012040

20190209012039开始执行2019-02-08数据加载日志:
SQL开始执行时间：20190209012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190209012039
SQL开始执行时间：20190209012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190209012039
SQL开始执行时间：20190209012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190209012039
SQL开始执行时间：20190209012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190209012040
SQL开始执行时间：20190209012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190209012040

20190210012039开始执行2019-02-09数据加载日志:
SQL开始执行时间：20190210012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190210012039
SQL开始执行时间：20190210012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190210012039
SQL开始执行时间：20190210012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190210012039
SQL开始执行时间：20190210012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190210012039
SQL开始执行时间：20190210012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190210012039

20190211012039开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211012039
SQL开始执行时间：20190211012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190211012039
SQL开始执行时间：20190211012039


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211012039
SQL开始执行时间：20190211012039

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190211012039
SQL开始执行时间：20190211012039

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190211012039

20190212012040开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190212012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190212012040
SQL开始执行时间：20190212012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190212012040
SQL开始执行时间：20190212012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190212012040
SQL开始执行时间：20190212012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190212012042
SQL开始执行时间：20190212012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190212012042

20190213012039开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190213012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190213012039
SQL开始执行时间：20190213012039

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190213012040
SQL开始执行时间：20190213012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190213012040
SQL开始执行时间：20190213012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190213012042
SQL开始执行时间：20190213012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190213012042

20190214012041开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190214012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190214012042
SQL开始执行时间：20190214012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190214012042
SQL开始执行时间：20190214012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190214012042
SQL开始执行时间：20190214012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190214012044
SQL开始执行时间：20190214012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190214012044

20190215012039开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190215012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190215012040
SQL开始执行时间：20190215012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190215012040
SQL开始执行时间：20190215012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190215012040
SQL开始执行时间：20190215012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190215012042
SQL开始执行时间：20190215012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190215012042

20190216012041开始执行2019-02-15数据加载日志:
SQL开始执行时间：20190216012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190216012041
SQL开始执行时间：20190216012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190216012041
SQL开始执行时间：20190216012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190216012041
SQL开始执行时间：20190216012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190216012044
SQL开始执行时间：20190216012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190216012044

20190217012038开始执行2019-02-16数据加载日志:
SQL开始执行时间：20190217012038


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190217012038
SQL开始执行时间：20190217012038

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190217012038
SQL开始执行时间：20190217012038


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190217012038
SQL开始执行时间：20190217012038

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190217012038
SQL开始执行时间：20190217012038

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190217012038

20190218012056开始执行2019-02-17数据加载日志:
SQL开始执行时间：20190218012056


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190218012057
SQL开始执行时间：20190218012057

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190218012057
SQL开始执行时间：20190218012057


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190218012057
SQL开始执行时间：20190218012057

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190218012057
SQL开始执行时间：20190218012057

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190218012057

20190219012040开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219012040
SQL开始执行时间：20190219012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190219012040
SQL开始执行时间：20190219012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219012040
SQL开始执行时间：20190219012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190219012044
SQL开始执行时间：20190219012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190219012044

20190220012041开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220012041
SQL开始执行时间：20190220012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190220012041
SQL开始执行时间：20190220012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220012041
SQL开始执行时间：20190220012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190220012049
SQL开始执行时间：20190220012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190220012050

20190221012042开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190221012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190221012042
SQL开始执行时间：20190221012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190221012042
SQL开始执行时间：20190221012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190221012042
SQL开始执行时间：20190221012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190221012050
SQL开始执行时间：20190221012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190221012050

20190222012039开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190222012039


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190222012040
SQL开始执行时间：20190222012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190222012040
SQL开始执行时间：20190222012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190222012040
SQL开始执行时间：20190222012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190222012042
SQL开始执行时间：20190222012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190222012042

20190223012041开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190223012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190223012041
SQL开始执行时间：20190223012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190223012041
SQL开始执行时间：20190223012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190223012041
SQL开始执行时间：20190223012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190223012044
SQL开始执行时间：20190223012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190223012044

20190224012038开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190224012038


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190224012038
SQL开始执行时间：20190224012038

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190224012038
SQL开始执行时间：20190224012038


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190224012038
SQL开始执行时间：20190224012038

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190224012038
SQL开始执行时间：20190224012038

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190224012038

20190225012040开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190225012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190225012040
SQL开始执行时间：20190225012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190225012040
SQL开始执行时间：20190225012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190225012040
SQL开始执行时间：20190225012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190225012040
SQL开始执行时间：20190225012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190225012040

20190226012042开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190226012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190226012042
SQL开始执行时间：20190226012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190226012042
SQL开始执行时间：20190226012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190226012042
SQL开始执行时间：20190226012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190226012052
SQL开始执行时间：20190226012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190226012052

20190227012043开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190227012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190227012043
SQL开始执行时间：20190227012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190227012043
SQL开始执行时间：20190227012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190227012043
SQL开始执行时间：20190227012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190227012049
SQL开始执行时间：20190227012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190227012049

20190228012042开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190228012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190228012042
SQL开始执行时间：20190228012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190228012042
SQL开始执行时间：20190228012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190228012042
SQL开始执行时间：20190228012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190228012045
SQL开始执行时间：20190228012045

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190228012045

20190301012043开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301012043
SQL开始执行时间：20190301012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190301012044
SQL开始执行时间：20190301012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301012044
SQL开始执行时间：20190301012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190301012056
SQL开始执行时间：20190301012056

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190301012056

20190302012041开始执行2019-03-01数据加载日志:
SQL开始执行时间：20190302012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190302012041
SQL开始执行时间：20190302012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190302012041
SQL开始执行时间：20190302012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190302012041
SQL开始执行时间：20190302012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190302012043
SQL开始执行时间：20190302012043

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190302012044

20190303012046开始执行2019-03-02数据加载日志:
SQL开始执行时间：20190303012046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190303012046
SQL开始执行时间：20190303012046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190303012046
SQL开始执行时间：20190303012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190303012046
SQL开始执行时间：20190303012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190303012046
SQL开始执行时间：20190303012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190303012046

20190304012040开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304012040


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304012040
SQL开始执行时间：20190304012040

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190304012040
SQL开始执行时间：20190304012040


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304012040
SQL开始执行时间：20190304012040

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190304012040
SQL开始执行时间：20190304012040

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190304012040

20190305012041开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190305012041
SQL开始执行时间：20190305012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190305012041
SQL开始执行时间：20190305012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190305012041
SQL开始执行时间：20190305012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190305012046
SQL开始执行时间：20190305012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190305012046

20190306012041开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306012041
SQL开始执行时间：20190306012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190306012041
SQL开始执行时间：20190306012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306012041
SQL开始执行时间：20190306012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190306012048
SQL开始执行时间：20190306012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190306012048

20190307012042开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307012042
SQL开始执行时间：20190307012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190307012042
SQL开始执行时间：20190307012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307012042
SQL开始执行时间：20190307012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190307012045
SQL开始执行时间：20190307012045

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190307012045

20190308012043开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308012043
SQL开始执行时间：20190308012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190308012043
SQL开始执行时间：20190308012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308012043
SQL开始执行时间：20190308012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190308012046
SQL开始执行时间：20190308012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190308012046

20190309012042开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190309012042
SQL开始执行时间：20190309012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190309012042
SQL开始执行时间：20190309012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190309012042
SQL开始执行时间：20190309012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190309012047
SQL开始执行时间：20190309012047

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190309012047

20190310012043开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190310012043
SQL开始执行时间：20190310012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190310012043
SQL开始执行时间：20190310012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190310012043
SQL开始执行时间：20190310012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190310012043
SQL开始执行时间：20190310012043

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190310012043

20190311012041开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190311012041
SQL开始执行时间：20190311012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190311012041
SQL开始执行时间：20190311012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190311012041
SQL开始执行时间：20190311012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190311012041
SQL开始执行时间：20190311012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190311012041

20190312012048开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312012048


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312012048
SQL开始执行时间：20190312012048

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190312012048
SQL开始执行时间：20190312012048


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312012048
SQL开始执行时间：20190312012048

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190312012051
SQL开始执行时间：20190312012051

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190312012051

20190313012045开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190313012045
SQL开始执行时间：20190313012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190313012045
SQL开始执行时间：20190313012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190313012045
SQL开始执行时间：20190313012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190313012050
SQL开始执行时间：20190313012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190313012050

20190314012041开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314012041
SQL开始执行时间：20190314012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190314012041
SQL开始执行时间：20190314012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314012041
SQL开始执行时间：20190314012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190314012044
SQL开始执行时间：20190314012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190314012044

20190315012042开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315012042
SQL开始执行时间：20190315012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190315012042
SQL开始执行时间：20190315012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315012042
SQL开始执行时间：20190315012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190315012044
SQL开始执行时间：20190315012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190315012044

20190316012042开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190316012042
SQL开始执行时间：20190316012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190316012042
SQL开始执行时间：20190316012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190316012042
SQL开始执行时间：20190316012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190316012046
SQL开始执行时间：20190316012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190316012046

20190317012041开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190317012041
SQL开始执行时间：20190317012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190317012041
SQL开始执行时间：20190317012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190317012041
SQL开始执行时间：20190317012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190317012041
SQL开始执行时间：20190317012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190317012041

20190318012049开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318012049


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318012049
SQL开始执行时间：20190318012049

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190318012049
SQL开始执行时间：20190318012049


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318012049
SQL开始执行时间：20190318012049

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190318012049
SQL开始执行时间：20190318012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190318012049

20190319012042开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319012042
SQL开始执行时间：20190319012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190319012042
SQL开始执行时间：20190319012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319012042
SQL开始执行时间：20190319012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190319012046
SQL开始执行时间：20190319012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190319012046

20190320012043开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190320012043
SQL开始执行时间：20190320012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190320012043
SQL开始执行时间：20190320012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190320012043
SQL开始执行时间：20190320012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190320012048
SQL开始执行时间：20190320012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190320012048

20190321012043开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190321012043
SQL开始执行时间：20190321012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190321012044
SQL开始执行时间：20190321012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190321012044
SQL开始执行时间：20190321012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190321012048
SQL开始执行时间：20190321012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190321012048

20190322012042开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190322012043
SQL开始执行时间：20190322012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190322012043
SQL开始执行时间：20190322012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190322012043
SQL开始执行时间：20190322012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190322012048
SQL开始执行时间：20190322012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190322012048

20190323012042开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190323012042
SQL开始执行时间：20190323012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190323012042
SQL开始执行时间：20190323012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190323012042
SQL开始执行时间：20190323012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190323012045
SQL开始执行时间：20190323012045

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190323012045

20190324012049开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324012049


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190324012049
SQL开始执行时间：20190324012049

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190324012049
SQL开始执行时间：20190324012049


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190324012049
SQL开始执行时间：20190324012049

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190324012049
SQL开始执行时间：20190324012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190324012049

20190325012041开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325012041
SQL开始执行时间：20190325012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190325012041
SQL开始执行时间：20190325012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325012041
SQL开始执行时间：20190325012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190325012042
SQL开始执行时间：20190325012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190325012042

20190326012043开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326012044
SQL开始执行时间：20190326012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190326012044
SQL开始执行时间：20190326012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326012044
SQL开始执行时间：20190326012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190326012050
SQL开始执行时间：20190326012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190326012050

20190327012044开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190327012044
SQL开始执行时间：20190327012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190327012044
SQL开始执行时间：20190327012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190327012044
SQL开始执行时间：20190327012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190327012052
SQL开始执行时间：20190327012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190327012052

20190328012043开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328012043
SQL开始执行时间：20190328012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190328012043
SQL开始执行时间：20190328012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328012043
SQL开始执行时间：20190328012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190328012047
SQL开始执行时间：20190328012047

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190328012047

20190329012043开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190329012043
SQL开始执行时间：20190329012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190329012043
SQL开始执行时间：20190329012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190329012043
SQL开始执行时间：20190329012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190329012049
SQL开始执行时间：20190329012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190329012049

20190330012043开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190330012043
SQL开始执行时间：20190330012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190330012043
SQL开始执行时间：20190330012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190330012043
SQL开始执行时间：20190330012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190330012046
SQL开始执行时间：20190330012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190330012046

20190331012041开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190331012041
SQL开始执行时间：20190331012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190331012041
SQL开始执行时间：20190331012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190331012041
SQL开始执行时间：20190331012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190331012042
SQL开始执行时间：20190331012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190331012042

20190401012042开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-03-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401012042
SQL开始执行时间：20190401012042

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190401012042
SQL开始执行时间：20190401012042


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401012042
SQL开始执行时间：20190401012042

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190401012042
SQL开始执行时间：20190401012042

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190401012042

20190402012042开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402012042


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190402012043
SQL开始执行时间：20190402012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190402012043
SQL开始执行时间：20190402012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190402012043
SQL开始执行时间：20190402012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190402012047
SQL开始执行时间：20190402012047

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190402012047

20190403012044开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190403012044
SQL开始执行时间：20190403012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190403012044
SQL开始执行时间：20190403012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190403012044
SQL开始执行时间：20190403012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190403012046
SQL开始执行时间：20190403012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190403012047

20190404012043开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404012043
SQL开始执行时间：20190404012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190404012043
SQL开始执行时间：20190404012043


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404012043
SQL开始执行时间：20190404012043

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190404012046
SQL开始执行时间：20190404012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190404012046

20190405012043开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190405012043
SQL开始执行时间：20190405012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190405012044
SQL开始执行时间：20190405012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190405012044
SQL开始执行时间：20190405012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190405012046
SQL开始执行时间：20190405012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190405012046

20190406012041开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190406012041
SQL开始执行时间：20190406012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190406012041
SQL开始执行时间：20190406012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190406012041
SQL开始执行时间：20190406012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190406012041
SQL开始执行时间：20190406012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190406012041

20190407012055开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407012055


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190407012055
SQL开始执行时间：20190407012055

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190407012055
SQL开始执行时间：20190407012055


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190407012055
SQL开始执行时间：20190407012055

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190407012055
SQL开始执行时间：20190407012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190407012055

20190408012041开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408012041


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190408012041
SQL开始执行时间：20190408012041

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190408012041
SQL开始执行时间：20190408012041


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190408012041
SQL开始执行时间：20190408012041

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190408012041
SQL开始执行时间：20190408012041

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190408012041

20190409012043开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409012043
SQL开始执行时间：20190409012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190409012044
SQL开始执行时间：20190409012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409012044
SQL开始执行时间：20190409012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190409012048
SQL开始执行时间：20190409012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190409012048

20190410012045开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410012045
SQL开始执行时间：20190410012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190410012045
SQL开始执行时间：20190410012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410012045
SQL开始执行时间：20190410012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190410012052
SQL开始执行时间：20190410012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190410012052

20190411012045开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411012045
SQL开始执行时间：20190411012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190411012045
SQL开始执行时间：20190411012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411012045
SQL开始执行时间：20190411012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190411012049
SQL开始执行时间：20190411012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190411012049

20190412012043开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412012043


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412012043
SQL开始执行时间：20190412012043

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190412012044
SQL开始执行时间：20190412012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412012044
SQL开始执行时间：20190412012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190412012047
SQL开始执行时间：20190412012047

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190412012047

20190413012044开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190413012044
SQL开始执行时间：20190413012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190413012044
SQL开始执行时间：20190413012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190413012044
SQL开始执行时间：20190413012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190413012048
SQL开始执行时间：20190413012048

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190413012048

20190414012051开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414012051


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190414012052
SQL开始执行时间：20190414012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190414012052
SQL开始执行时间：20190414012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190414012052
SQL开始执行时间：20190414012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190414012052
SQL开始执行时间：20190414012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190414012052

20190415012044开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415012044
SQL开始执行时间：20190415012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190415012044
SQL开始执行时间：20190415012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415012044
SQL开始执行时间：20190415012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190415012044
SQL开始执行时间：20190415012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190415012044

20190416012045开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416012045
SQL开始执行时间：20190416012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190416012045
SQL开始执行时间：20190416012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416012045
SQL开始执行时间：20190416012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190416012049
SQL开始执行时间：20190416012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190416012050

20190417012045开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190417012045
SQL开始执行时间：20190417012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190417012046
SQL开始执行时间：20190417012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190417012046
SQL开始执行时间：20190417012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190417012049
SQL开始执行时间：20190417012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190417012049

20190418012046开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418012046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190418012046
SQL开始执行时间：20190418012046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190418012046
SQL开始执行时间：20190418012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190418012046
SQL开始执行时间：20190418012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190418012050
SQL开始执行时间：20190418012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190418012050

20190419012046开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419012046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190419012046
SQL开始执行时间：20190419012046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190419012046
SQL开始执行时间：20190419012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190419012046
SQL开始执行时间：20190419012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190419012051
SQL开始执行时间：20190419012051

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190419012051

20190420012045开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190420012045
SQL开始执行时间：20190420012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190420012045
SQL开始执行时间：20190420012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190420012045
SQL开始执行时间：20190420012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190420012047
SQL开始执行时间：20190420012047

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190420012047

20190421012044开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190421012044
SQL开始执行时间：20190421012044

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190421012044
SQL开始执行时间：20190421012044


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190421012044
SQL开始执行时间：20190421012044

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190421012044
SQL开始执行时间：20190421012044

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190421012044

20190422012059开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422012059


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422012059
SQL开始执行时间：20190422012059

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190422012059
SQL开始执行时间：20190422012059


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422012059
SQL开始执行时间：20190422012059

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190422012100
SQL开始执行时间：20190422012100

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190422012100

20190423012052开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190423012052
SQL开始执行时间：20190423012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190423012052
SQL开始执行时间：20190423012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190423012052
SQL开始执行时间：20190423012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190423012058
SQL开始执行时间：20190423012058

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190423012058

20190424012047开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424012047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190424012047
SQL开始执行时间：20190424012047

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190424012047
SQL开始执行时间：20190424012047


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190424012047
SQL开始执行时间：20190424012047

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190424012053
SQL开始执行时间：20190424012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190424012053

20190425012046开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425012046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425012046
SQL开始执行时间：20190425012046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190425012046
SQL开始执行时间：20190425012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425012046
SQL开始执行时间：20190425012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190425012051
SQL开始执行时间：20190425012051

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190425012051

20190425094334开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190425094334


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425094336
SQL开始执行时间：20190425094336

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190425094338
SQL开始执行时间：20190425094338


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425094339
SQL开始执行时间：20190425094339

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190425094339
SQL开始执行时间：20190425094339

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190425094340

20190426012048开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426012048


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426012048
SQL开始执行时间：20190426012048

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190426012048
SQL开始执行时间：20190426012048


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426012048
SQL开始执行时间：20190426012048

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190426012053
SQL开始执行时间：20190426012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190426012053

20190426170551开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426170551


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426170551
SQL开始执行时间：20190426170551

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190426170551
SQL开始执行时间：20190426170551


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426170551
SQL开始执行时间：20190426170551

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190426170603
SQL开始执行时间：20190426170603

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190426170603

20190427012046开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427012046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190427012046
SQL开始执行时间：20190427012046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190427012046
SQL开始执行时间：20190427012046


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190427012046
SQL开始执行时间：20190427012046

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190427012049
SQL开始执行时间：20190427012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190427012049

20190428012053开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428012053


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190428012053
SQL开始执行时间：20190428012053

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190428012053
SQL开始执行时间：20190428012053


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190428012053
SQL开始执行时间：20190428012053

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190428012053
SQL开始执行时间：20190428012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190428012053

20190429012050开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429012050


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429012050
SQL开始执行时间：20190429012050

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190429012051
SQL开始执行时间：20190429012051


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429012051
SQL开始执行时间：20190429012051

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190429012055
SQL开始执行时间：20190429012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190429012055

20190430012047开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430012047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190430012047
SQL开始执行时间：20190430012047

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190430012047
SQL开始执行时间：20190430012047


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190430012047
SQL开始执行时间：20190430012047

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190430012050
SQL开始执行时间：20190430012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190430012050

20190501012047开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501012047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-04-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190501012047
SQL开始执行时间：20190501012047

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190501012047
SQL开始执行时间：20190501012047


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190501012047
SQL开始执行时间：20190501012047

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190501012051
SQL开始执行时间：20190501012051

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190501012051

20190502012053开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502012053


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190502012053
SQL开始执行时间：20190502012053

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190502012053
SQL开始执行时间：20190502012053


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190502012053
SQL开始执行时间：20190502012053

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190502012053
SQL开始执行时间：20190502012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190502012053

20190503012044开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503012044


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190503012045
SQL开始执行时间：20190503012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190503012045
SQL开始执行时间：20190503012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190503012045
SQL开始执行时间：20190503012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190503012045
SQL开始执行时间：20190503012045

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190503012045

20190504012054开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504012054


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190504012054
SQL开始执行时间：20190504012054

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190504012054
SQL开始执行时间：20190504012054


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190504012054
SQL开始执行时间：20190504012054

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190504012054
SQL开始执行时间：20190504012054

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190504012054

20190505012045开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505012045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505012045
SQL开始执行时间：20190505012045

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190505012045
SQL开始执行时间：20190505012045


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505012045
SQL开始执行时间：20190505012045

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190505012046
SQL开始执行时间：20190505012046

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190505012046

20190505120046开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190505120046


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505120046
SQL开始执行时间：20190505120046

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190505120047
SQL开始执行时间：20190505120047


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505120047
SQL开始执行时间：20190505120047

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190505120405
SQL开始执行时间：20190505120405

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190505120406

20190506012048开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506012048


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506012048
SQL开始执行时间：20190506012048

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190506012048
SQL开始执行时间：20190506012048


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506012048
SQL开始执行时间：20190506012048

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190506012052
SQL开始执行时间：20190506012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190506012052

20190507012047开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507012047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190507012047
SQL开始执行时间：20190507012047

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190507012047
SQL开始执行时间：20190507012047


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190507012047
SQL开始执行时间：20190507012047

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190507012050
SQL开始执行时间：20190507012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190507012050

20190508012056开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508012056


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190508012056
SQL开始执行时间：20190508012056

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190508012056
SQL开始执行时间：20190508012056


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190508012056
SQL开始执行时间：20190508012056

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190508012059
SQL开始执行时间：20190508012059

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190508012059

20190509175636开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190509175636


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190509175636
SQL开始执行时间：20190509175636

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190509175637
SQL开始执行时间：20190509175637


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190509175637
SQL开始执行时间：20190509175637

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190509175646
SQL开始执行时间：20190509175646

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190509175646

20190510012052开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190510012052
SQL开始执行时间：20190510012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190510012052
SQL开始执行时间：20190510012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190510012052
SQL开始执行时间：20190510012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190510012054
SQL开始执行时间：20190510012054

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190510012054

20190511012052开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190511012052
SQL开始执行时间：20190511012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190511012052
SQL开始执行时间：20190511012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190511012052
SQL开始执行时间：20190511012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190511012053
SQL开始执行时间：20190511012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190511012053

20190512012052开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190512012052
SQL开始执行时间：20190512012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190512012052
SQL开始执行时间：20190512012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190512012052
SQL开始执行时间：20190512012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190512012052
SQL开始执行时间：20190512012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190512012052

20190513012053开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513012053


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513012053
SQL开始执行时间：20190513012053

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190513012053
SQL开始执行时间：20190513012053


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513012053
SQL开始执行时间：20190513012053

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190513012053
SQL开始执行时间：20190513012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190513012053

20190514012051开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514012051


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514012051
SQL开始执行时间：20190514012051

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190514012051
SQL开始执行时间：20190514012051


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514012051
SQL开始执行时间：20190514012051

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190514012054
SQL开始执行时间：20190514012054

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190514012054

20190515012050开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515012050


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515012050
SQL开始执行时间：20190515012050

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190515012051
SQL开始执行时间：20190515012051


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515012051
SQL开始执行时间：20190515012051

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190515012052
SQL开始执行时间：20190515012052

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190515012052

20190516012052开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190516012052
SQL开始执行时间：20190516012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190516012052
SQL开始执行时间：20190516012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190516012052
SQL开始执行时间：20190516012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190516012053
SQL开始执行时间：20190516012053

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190516012053

20190517012052开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517012052
SQL开始执行时间：20190517012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190517012052
SQL开始执行时间：20190517012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517012052
SQL开始执行时间：20190517012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190517012055
SQL开始执行时间：20190517012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190517012055

20190518012055开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518012055


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190518012055
SQL开始执行时间：20190518012055

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190518012056
SQL开始执行时间：20190518012056


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190518012056
SQL开始执行时间：20190518012056

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190518012059
SQL开始执行时间：20190518012059

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190518012059

20190519012050开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519012050


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190519012050
SQL开始执行时间：20190519012050

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190519012050
SQL开始执行时间：20190519012050


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190519012050
SQL开始执行时间：20190519012050

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190519012050
SQL开始执行时间：20190519012050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190519012050

20190520012049开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520012049


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520012049
SQL开始执行时间：20190520012049

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190520012049
SQL开始执行时间：20190520012049


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520012049
SQL开始执行时间：20190520012049

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190520012049
SQL开始执行时间：20190520012049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190520012049

20190521012052开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521012052


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190521012052
SQL开始执行时间：20190521012052

create temporary table pdm.mid_dispatch_order as 
select a.*
      ,case when a.cwhcode is null then b.cwhcode
     else a.cwhcode end as b_cwhcode
      ,case when a.cvenabbname is null then b.cvenabbname
     else a.cvenabbname end as b_cvenabbname
  from pdm.dispatch_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20190521012052
SQL开始执行时间：20190521012052


delete from pdm.mid_dispatch_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190521012052
SQL开始执行时间：20190521012052

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190521012056
SQL开始执行时间：20190521012056

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.b_cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.isum
      ,a.citemname
      ,a.b_cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_dispatch_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20190521012056

20190522012053开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522012053


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522012053
SQL开始执行时间：20190522012053



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522012053
SQL开始执行时间：20190522012053

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190522012055
SQL开始执行时间：20190522012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190522012055

20190523012053开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523012053


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523012054
SQL开始执行时间：20190523012054



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523012054
SQL开始执行时间：20190523012054

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190523012055
SQL开始执行时间：20190523012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190523012055

20190523100541开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523100541


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523100543
SQL开始执行时间：20190523100543



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523100543
SQL开始执行时间：20190523100543

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190523100543
SQL开始执行时间：20190523100543

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190523100543

20190524012056开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524012056


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524012056
SQL开始执行时间：20190524012056



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524012056
SQL开始执行时间：20190524012056

delete from pdm.dispatch_order where dlid in (select dlid from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190524012059
SQL开始执行时间：20190524012059

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190524012059

20190524141047开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524141047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524141048
SQL开始执行时间：20190524141048



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524141048
SQL开始执行时间：20190524141048

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190524141049
SQL开始执行时间：20190524141049
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190524141050
SQL开始执行时间：20190524141050
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190524141050
SQL开始执行时间：20190524141050

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190524141124开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524141124


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524141126
SQL开始执行时间：20190524141126



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524141126
SQL开始执行时间：20190524141126

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190524141127
SQL开始执行时间：20190524141127
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190524141128
SQL开始执行时间：20190524141128
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190524141128
SQL开始执行时间：20190524141128

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190524141400开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524141400


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524141401
SQL开始执行时间：20190524141401



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524141402
SQL开始执行时间：20190524141402

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190524141403
SQL开始执行时间：20190524141403
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190524141404
SQL开始执行时间：20190524141404
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190524141404
SQL开始执行时间：20190524141404

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190524141404
SQL开始执行时间：20190524141404


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190524141405

20190525012054开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525012054


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190525012054
SQL开始执行时间：20190525012054



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190525012054
SQL开始执行时间：20190525012054

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190525012054
SQL开始执行时间：20190525012054
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190525012054
SQL开始执行时间：20190525012054
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190525012057
SQL开始执行时间：20190525012057

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190525012057
SQL开始执行时间：20190525012057


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190525012058

20190526012054开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526012054


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190526012054
SQL开始执行时间：20190526012054


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190526012055

20190527012110开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527012110


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190527012110
SQL开始执行时间：20190527012110


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190527012111

20190528012059开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528012059


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190528012059
SQL开始执行时间：20190528012059



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190528012059
SQL开始执行时间：20190528012059

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190528012059
SQL开始执行时间：20190528012059
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190528012059
SQL开始执行时间：20190528012059
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190528012102
SQL开始执行时间：20190528012102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190528012102
SQL开始执行时间：20190528012102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190528012103

20190529012100开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529012100


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529012100
SQL开始执行时间：20190529012100



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529012100
SQL开始执行时间：20190529012100

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190529012100
SQL开始执行时间：20190529012100
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190529012100
SQL开始执行时间：20190529012100
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190529012103
SQL开始执行时间：20190529012103

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190529012103
SQL开始执行时间：20190529012103


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190529012104

20190529093459开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529093459


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529093459
SQL开始执行时间：20190529093459



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529093459
SQL开始执行时间：20190529093459

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190529093500
SQL开始执行时间：20190529093500
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190529093500
SQL开始执行时间：20190529093500
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190529093539
SQL开始执行时间：20190529093539

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190529093539
SQL开始执行时间：20190529093539


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190529093540

20190529100410开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529100410


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529100410
SQL开始执行时间：20190529100410



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529100410
SQL开始执行时间：20190529100410

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190529100410
SQL开始执行时间：20190529100410
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190529100410
SQL开始执行时间：20190529100410
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190529100512
SQL开始执行时间：20190529100512

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190529100512
SQL开始执行时间：20190529100512


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190529100513

20190530012059开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530012059


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190530012100
SQL开始执行时间：20190530012100



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190530012100
SQL开始执行时间：20190530012100

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190530012100
SQL开始执行时间：20190530012100
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190530012100
SQL开始执行时间：20190530012100
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190530012103
SQL开始执行时间：20190530012103

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190530012103
SQL开始执行时间：20190530012103


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190530012104

20190531012100开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531012100


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531012100
SQL开始执行时间：20190531012100



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531012100
SQL开始执行时间：20190531012100

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190531012100
SQL开始执行时间：20190531012100
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190531012100
SQL开始执行时间：20190531012100
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190531012104
SQL开始执行时间：20190531012104

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190531012104
SQL开始执行时间：20190531012104


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190531012105

20190531100835开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531100835


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531100835
SQL开始执行时间：20190531100835



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531100835
SQL开始执行时间：20190531100835

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190531100835
SQL开始执行时间：20190531100835
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190531100835
SQL开始执行时间：20190531100835
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190531100848
SQL开始执行时间：20190531100848

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190531100848
SQL开始执行时间：20190531100848


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190531100849

20190601012056开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601012056


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-05-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190601012057
SQL开始执行时间：20190601012057



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190601012057
SQL开始执行时间：20190601012057

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190601012057
SQL开始执行时间：20190601012057
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190601012057
SQL开始执行时间：20190601012057
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190601012059
SQL开始执行时间：20190601012059

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190601012059
SQL开始执行时间：20190601012059


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190601012100

20190602012054开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602012054


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190602012054
SQL开始执行时间：20190602012054



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190602012054
SQL开始执行时间：20190602012054

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190602012054
SQL开始执行时间：20190602012054
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190602012054
SQL开始执行时间：20190602012054
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190602012055
SQL开始执行时间：20190602012055

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190602012055
SQL开始执行时间：20190602012055


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190602012056

20190603012051开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603012051


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190603012051
SQL开始执行时间：20190603012051


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190603012053

20190604012058开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604012058


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190604012058
SQL开始执行时间：20190604012058



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190604012058
SQL开始执行时间：20190604012058

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190604012058
SQL开始执行时间：20190604012058
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190604012058
SQL开始执行时间：20190604012058
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190604012102
SQL开始执行时间：20190604012102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190604012102
SQL开始执行时间：20190604012102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190604012103

20190605012059开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605012059


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605012059
SQL开始执行时间：20190605012059



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605012059
SQL开始执行时间：20190605012059

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190605012059
SQL开始执行时间：20190605012059
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190605012059
SQL开始执行时间：20190605012059
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190605012102
SQL开始执行时间：20190605012102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190605012102
SQL开始执行时间：20190605012102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190605012104

20190605113425开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605113425


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605113425
SQL开始执行时间：20190605113425



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605113425
SQL开始执行时间：20190605113425

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190605113426
SQL开始执行时间：20190605113426
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190605113426
SQL开始执行时间：20190605113426
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190605113516
SQL开始执行时间：20190605113516

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190605113517
SQL开始执行时间：20190605113517


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190605113518

20190606012058开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606012058


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190606012058
SQL开始执行时间：20190606012058



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190606012058
SQL开始执行时间：20190606012058

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190606012058
SQL开始执行时间：20190606012058
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190606012058
SQL开始执行时间：20190606012058
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190606012102
SQL开始执行时间：20190606012102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190606012102
SQL开始执行时间：20190606012102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190606012104

20190610161004开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610161004


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610161005
SQL开始执行时间：20190610161005



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610161005
SQL开始执行时间：20190610161005

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190610161005
SQL开始执行时间：20190610161005
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190610161005
SQL开始执行时间：20190610161005
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190610161013
SQL开始执行时间：20190610161013

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190610161013
SQL开始执行时间：20190610161013


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190610161015

20190610162653开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610162653


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610162653
SQL开始执行时间：20190610162653



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610162653
SQL开始执行时间：20190610162653

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190610162653
SQL开始执行时间：20190610162653
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190610162653
SQL开始执行时间：20190610162653
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190610162701
SQL开始执行时间：20190610162701

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190610162701
SQL开始执行时间：20190610162701


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190610162703

20190612110011开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612110011


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190612110011
SQL开始执行时间：20190612110011



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612110011
SQL开始执行时间：20190612110011

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190612110011
SQL开始执行时间：20190612110011
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190612110011
SQL开始执行时间：20190612110011
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190612110012
SQL开始执行时间：20190612110012

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190612110012
SQL开始执行时间：20190612110012


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190612110014

20190617155636开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617155636


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190617155636
SQL开始执行时间：20190617155636



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617155636
SQL开始执行时间：20190617155636

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190617155636
SQL开始执行时间：20190617155636
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190617155636
SQL开始执行时间：20190617155636
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190617155638
SQL开始执行时间：20190617155638

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190617155638
SQL开始执行时间：20190617155638


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190617155640

20190624084720开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624084720


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624084721
SQL开始执行时间：20190624084721



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624084721
SQL开始执行时间：20190624084721

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190624084721
SQL开始执行时间：20190624084721
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190624084721
SQL开始执行时间：20190624084721
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190624084722
SQL开始执行时间：20190624084722

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190624084722
SQL开始执行时间：20190624084722


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190624084724

20190624090749开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624090749


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624090749
SQL开始执行时间：20190624090749



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624090749
SQL开始执行时间：20190624090749

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190624090750
SQL开始执行时间：20190624090750
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190624090750
SQL开始执行时间：20190624090750
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190624090825
SQL开始执行时间：20190624090825

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190624090825
SQL开始执行时间：20190624090825


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190624090829

20190624093507开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624093507


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624093507
SQL开始执行时间：20190624093507



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624093507
SQL开始执行时间：20190624093507

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190624093507
SQL开始执行时间：20190624093507
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190624093508
SQL开始执行时间：20190624093508
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190624093544
SQL开始执行时间：20190624093544

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190624093544
SQL开始执行时间：20190624093544


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190624093548

20190627091909开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190627091909


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190627091909
SQL开始执行时间：20190627091909



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627091909
SQL开始执行时间：20190627091909

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190627091910
SQL开始执行时间：20190627091910
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190627091910
SQL开始执行时间：20190627091910
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190627092008
SQL开始执行时间：20190627092008

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190627092008
SQL开始执行时间：20190627092008


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190627092013

20190628012113开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628012113


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628012113
SQL开始执行时间：20190628012113



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628012113
SQL开始执行时间：20190628012113

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190628012113
SQL开始执行时间：20190628012113
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190628012113
SQL开始执行时间：20190628012113
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190628012121
SQL开始执行时间：20190628012121

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190628012121
SQL开始执行时间：20190628012121


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190628012126

20190628134226开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190628134226


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628134227
SQL开始执行时间：20190628134227



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628134227
SQL开始执行时间：20190628134227

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190628134227
SQL开始执行时间：20190628134227
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190628134227
SQL开始执行时间：20190628134227
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190628134301
SQL开始执行时间：20190628134301

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190628134301
SQL开始执行时间：20190628134301


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190628134308

20190628160401开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628160401


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628160403
SQL开始执行时间：20190628160403



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628160403
SQL开始执行时间：20190628160403

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190628160404
SQL开始执行时间：20190628160404
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190628160406
SQL开始执行时间：20190628160406
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190628161353
SQL开始执行时间：20190628161353

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190628161354
SQL开始执行时间：20190628161354


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190628161359

20190629012114开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190629012114
SQL开始执行时间：20190629012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190629012114
SQL开始执行时间：20190629012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190629012115
SQL开始执行时间：20190629012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190629012115
SQL开始执行时间：20190629012115
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190629012124
SQL开始执行时间：20190629012124

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190629012124
SQL开始执行时间：20190629012124


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190629012129

20190630012102开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630012102


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190630012102
SQL开始执行时间：20190630012102



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190630012102
SQL开始执行时间：20190630012102

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190630012102
SQL开始执行时间：20190630012102
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190630012102
SQL开始执行时间：20190630012102
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190630012105
SQL开始执行时间：20190630012105

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190630012105
SQL开始执行时间：20190630012105


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190630012110

20190701012059开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701012059


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-06-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190701012100
SQL开始执行时间：20190701012100



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190701012100
SQL开始执行时间：20190701012100

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190701012100
SQL开始执行时间：20190701012100
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190701012100
SQL开始执行时间：20190701012100
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190701012102
SQL开始执行时间：20190701012102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190701012102
SQL开始执行时间：20190701012102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190701012108

20190702012106开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702012106


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) > '2019-07-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702012106
SQL开始执行时间：20190702012106



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702012106
SQL开始执行时间：20190702012106

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190702012106
SQL开始执行时间：20190702012106
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190702012106
SQL开始执行时间：20190702012106
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190702012112
SQL开始执行时间：20190702012112

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190702012112
SQL开始执行时间：20190702012112


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190702012118

20190702165105开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702165105


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702165106
SQL开始执行时间：20190702165106



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702165106
SQL开始执行时间：20190702165106

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190702165106
SQL开始执行时间：20190702165106
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190702165106
SQL开始执行时间：20190702165106
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190702165123
SQL开始执行时间：20190702165123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190702165123
SQL开始执行时间：20190702165123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190702165129

20190702173045开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702173045


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702173045
SQL开始执行时间：20190702173045



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702173045
SQL开始执行时间：20190702173045

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190702173045
SQL开始执行时间：20190702173045
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190702173045
SQL开始执行时间：20190702173045
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;

20190703012103开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703012103


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703012104
SQL开始执行时间：20190703012104



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703012104
SQL开始执行时间：20190703012104

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190703012104
SQL开始执行时间：20190703012104
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190703012104
SQL开始执行时间：20190703012104
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190703012123
SQL开始执行时间：20190703012123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190703012123
SQL开始执行时间：20190703012123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190703012130

20190703094311开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703094311


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703094313
SQL开始执行时间：20190703094313



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703094313
SQL开始执行时间：20190703094313

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190703094314
SQL开始执行时间：20190703094314
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190703094315
SQL开始执行时间：20190703094315
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190703095107
SQL开始执行时间：20190703095107

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190703095108
SQL开始执行时间：20190703095108


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190703095115

20190704012109开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704012109


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704012110
SQL开始执行时间：20190704012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704012110
SQL开始执行时间：20190704012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190704012111
SQL开始执行时间：20190704012111
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190704012112
SQL开始执行时间：20190704012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190704012915
SQL开始执行时间：20190704012915

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704012915
SQL开始执行时间：20190704012915


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190704012923

20190704102136开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704102136


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704102137
SQL开始执行时间：20190704102137



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704102137
SQL开始执行时间：20190704102137

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190704102139
SQL开始执行时间：20190704102139
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190704102140
SQL开始执行时间：20190704102140
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190704103212
SQL开始执行时间：20190704103212

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704103213
SQL开始执行时间：20190704103213


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190704103221

20190704104508开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190704104508


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704104510
SQL开始执行时间：20190704104510



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704104510
SQL开始执行时间：20190704104510

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190704104511
SQL开始执行时间：20190704104511
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190704104512
SQL开始执行时间：20190704104512
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190704105316
SQL开始执行时间：20190704105316

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704105317
SQL开始执行时间：20190704105317


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190704105324

20190705012108开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705012108


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705012110
SQL开始执行时间：20190705012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705012110
SQL开始执行时间：20190705012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190705012111
SQL开始执行时间：20190705012111
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190705012112
SQL开始执行时间：20190705012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190705012922
SQL开始执行时间：20190705012922

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190705012923
SQL开始执行时间：20190705012923


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190705012931

20190705101635开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190705101635


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705101635
SQL开始执行时间：20190705101635



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705101635
SQL开始执行时间：20190705101635

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190705101635
SQL开始执行时间：20190705101635
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190705101635
SQL开始执行时间：20190705101635
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190705101640
SQL开始执行时间：20190705101640

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190705101640
SQL开始执行时间：20190705101640


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190705101648

20190706012108开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706012108


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190706012108
SQL开始执行时间：20190706012108



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190706012108
SQL开始执行时间：20190706012108

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190706012108
SQL开始执行时间：20190706012108
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190706012108
SQL开始执行时间：20190706012108
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190706012117
SQL开始执行时间：20190706012117

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190706012117
SQL开始执行时间：20190706012117


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190706012125

20190707012103开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707012103


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190707012103
SQL开始执行时间：20190707012103



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190707012103
SQL开始执行时间：20190707012103

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190707012103
SQL开始执行时间：20190707012103
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190707012103
SQL开始执行时间：20190707012103
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190707012110
SQL开始执行时间：20190707012110

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190707012110
SQL开始执行时间：20190707012110


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190707012118

20190708012104开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708012104


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708012105
SQL开始执行时间：20190708012105



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708012105
SQL开始执行时间：20190708012105

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190708012105
SQL开始执行时间：20190708012105
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190708012105
SQL开始执行时间：20190708012105
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190708012109
SQL开始执行时间：20190708012109

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190708012109
SQL开始执行时间：20190708012109


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190708012116

20190708091352开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190708091352


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708091352
SQL开始执行时间：20190708091352



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708091352
SQL开始执行时间：20190708091352

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190708091352
SQL开始执行时间：20190708091352
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190708091352
SQL开始执行时间：20190708091352
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190708091401
SQL开始执行时间：20190708091401

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190708091401
SQL开始执行时间：20190708091401


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190708091409

20190709012111开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709012111


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709012111
SQL开始执行时间：20190709012111



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709012111
SQL开始执行时间：20190709012111

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190709012111
SQL开始执行时间：20190709012111
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190709012111
SQL开始执行时间：20190709012111
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190709012123
SQL开始执行时间：20190709012123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190709012123
SQL开始执行时间：20190709012123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190709012131

20190709103423开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190709103423


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709103423
SQL开始执行时间：20190709103423



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709103423
SQL开始执行时间：20190709103423

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190709103423
SQL开始执行时间：20190709103423
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190709103423
SQL开始执行时间：20190709103423
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190709103430
SQL开始执行时间：20190709103430

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190709103430
SQL开始执行时间：20190709103430


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190709103439

20190710012108开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710012108


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190710012108
SQL开始执行时间：20190710012108



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710012108
SQL开始执行时间：20190710012108

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190710012108
SQL开始执行时间：20190710012108
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190710012109
SQL开始执行时间：20190710012109
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190710012117
SQL开始执行时间：20190710012117

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190710012117
SQL开始执行时间：20190710012117


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190710012126

20190710085859开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190710085859


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190710085859
SQL开始执行时间：20190710085859



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710085859
SQL开始执行时间：20190710085859

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190710085859
SQL开始执行时间：20190710085859
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190710085859
SQL开始执行时间：20190710085859
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190710085908
SQL开始执行时间：20190710085908

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190710085908
SQL开始执行时间：20190710085908


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190710085917

20190711012116开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711012116


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711012117
SQL开始执行时间：20190711012117



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711012117
SQL开始执行时间：20190711012117

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190711012117
SQL开始执行时间：20190711012117
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190711012117
SQL开始执行时间：20190711012117
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190711012128
SQL开始执行时间：20190711012128

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190711012128
SQL开始执行时间：20190711012128


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190711012137

20190711091027开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190711091027


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711091027
SQL开始执行时间：20190711091027



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711091027
SQL开始执行时间：20190711091027

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190711091027
SQL开始执行时间：20190711091027
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190711091027
SQL开始执行时间：20190711091027
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190711091036
SQL开始执行时间：20190711091036

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190711091036
SQL开始执行时间：20190711091036


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190711091045

20190712012113开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712012113


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190712012113
SQL开始执行时间：20190712012113



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190712012113
SQL开始执行时间：20190712012113

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190712012113
SQL开始执行时间：20190712012113
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190712012113
SQL开始执行时间：20190712012113
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190712012125
SQL开始执行时间：20190712012125

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190712012125
SQL开始执行时间：20190712012125


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190712012134

20190713012114开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190713012114
SQL开始执行时间：20190713012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190713012114
SQL开始执行时间：20190713012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190713012114
SQL开始执行时间：20190713012114
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190713012114
SQL开始执行时间：20190713012114
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190713012125
SQL开始执行时间：20190713012125

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190713012125
SQL开始执行时间：20190713012125


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190713012133

20190714012108开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714012108


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190714012108
SQL开始执行时间：20190714012108



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190714012108
SQL开始执行时间：20190714012108

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190714012108
SQL开始执行时间：20190714012108
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190714012109
SQL开始执行时间：20190714012109
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190714012116
SQL开始执行时间：20190714012116

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190714012116
SQL开始执行时间：20190714012116


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190714012125

20190715012106开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715012106


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715012106
SQL开始执行时间：20190715012106



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715012106
SQL开始执行时间：20190715012106

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190715012106
SQL开始执行时间：20190715012106
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190715012106
SQL开始执行时间：20190715012106
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190715012111
SQL开始执行时间：20190715012111

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190715012111
SQL开始执行时间：20190715012111


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190715012119

20190715131143开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190715131143


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715131144
SQL开始执行时间：20190715131144



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715131144
SQL开始执行时间：20190715131144

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190715131144
SQL开始执行时间：20190715131144
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190715131144
SQL开始执行时间：20190715131144
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190715131205
SQL开始执行时间：20190715131205

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190715131205
SQL开始执行时间：20190715131205


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190715131214

20190716012113开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716012113


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716012113
SQL开始执行时间：20190716012113



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716012113
SQL开始执行时间：20190716012113

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190716012113
SQL开始执行时间：20190716012113
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190716012113
SQL开始执行时间：20190716012113
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190716012137
SQL开始执行时间：20190716012137

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716012137
SQL开始执行时间：20190716012137


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190716012146

20190716160228开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716160228


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716160229
SQL开始执行时间：20190716160229



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716160229
SQL开始执行时间：20190716160229

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190716160229
SQL开始执行时间：20190716160229
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190716160229
SQL开始执行时间：20190716160229
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190716160253
SQL开始执行时间：20190716160253

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716160253
SQL开始执行时间：20190716160253


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190716160301

20190716161552开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716161552


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716161552
SQL开始执行时间：20190716161552



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716161552
SQL开始执行时间：20190716161552

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190716161552
SQL开始执行时间：20190716161552
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190716161552
SQL开始执行时间：20190716161552
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190716161617
SQL开始执行时间：20190716161617

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716161617
SQL开始执行时间：20190716161617


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190716161626

20190716165325开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716165325


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716165325
SQL开始执行时间：20190716165325



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716165325
SQL开始执行时间：20190716165325

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190716165326
SQL开始执行时间：20190716165326
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190716165326
SQL开始执行时间：20190716165326
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190716165350
SQL开始执行时间：20190716165350

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716165350
SQL开始执行时间：20190716165350


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190716165359

20190717012118开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717012118
SQL开始执行时间：20190717012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717012118
SQL开始执行时间：20190717012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190717012118
SQL开始执行时间：20190717012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190717012118
SQL开始执行时间：20190717012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190717012144
SQL开始执行时间：20190717012144

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190717012144
SQL开始执行时间：20190717012144


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190717012153

20190717085426开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190717085426


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717085426
SQL开始执行时间：20190717085426



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717085426
SQL开始执行时间：20190717085426

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190717085426
SQL开始执行时间：20190717085426
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190717085426
SQL开始执行时间：20190717085426
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190717085435
SQL开始执行时间：20190717085435

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190717085435
SQL开始执行时间：20190717085435


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190717085444

20190718012112开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718012112


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718012112
SQL开始执行时间：20190718012112



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718012112
SQL开始执行时间：20190718012112

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190718012112
SQL开始执行时间：20190718012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190718012112
SQL开始执行时间：20190718012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190718012123
SQL开始执行时间：20190718012123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190718012123
SQL开始执行时间：20190718012123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190718012132

20190718092002开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190718092002


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718092002
SQL开始执行时间：20190718092002



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718092002
SQL开始执行时间：20190718092002

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190718092002
SQL开始执行时间：20190718092002
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190718092002
SQL开始执行时间：20190718092002
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190718092010
SQL开始执行时间：20190718092010

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190718092010
SQL开始执行时间：20190718092010


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190718092019

20190719012110开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719012110


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719012110
SQL开始执行时间：20190719012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719012110
SQL开始执行时间：20190719012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190719012110
SQL开始执行时间：20190719012110
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190719012110
SQL开始执行时间：20190719012110
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190719012121
SQL开始执行时间：20190719012121

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190719012121
SQL开始执行时间：20190719012121


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190719012130

20190719090258开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190719090258


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719090259
SQL开始执行时间：20190719090259



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719090259
SQL开始执行时间：20190719090259

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190719090259
SQL开始执行时间：20190719090259
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190719090259
SQL开始执行时间：20190719090259
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190719090306
SQL开始执行时间：20190719090306

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190719090306
SQL开始执行时间：20190719090306


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190719090315

20190720012110开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720012110


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190720012110
SQL开始执行时间：20190720012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190720012110
SQL开始执行时间：20190720012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190720012110
SQL开始执行时间：20190720012110
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190720012110
SQL开始执行时间：20190720012110
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190720012121
SQL开始执行时间：20190720012121

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190720012121
SQL开始执行时间：20190720012121


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190720012131

20190721012105开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721012105


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190721012106
SQL开始执行时间：20190721012106



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190721012106
SQL开始执行时间：20190721012106

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190721012106
SQL开始执行时间：20190721012106
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190721012106
SQL开始执行时间：20190721012106
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190721012114
SQL开始执行时间：20190721012114

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190721012114
SQL开始执行时间：20190721012114


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190721012123

20190722012106开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722012106


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190722012106
SQL开始执行时间：20190722012106



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190722012106
SQL开始执行时间：20190722012106

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190722012107
SQL开始执行时间：20190722012107
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190722012107
SQL开始执行时间：20190722012107
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190722012111
SQL开始执行时间：20190722012111

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190722012111
SQL开始执行时间：20190722012111


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190722012121

20190723012114开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723012114
SQL开始执行时间：20190723012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723012114
SQL开始执行时间：20190723012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190723012114
SQL开始执行时间：20190723012114
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190723012114
SQL开始执行时间：20190723012114
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190723012123
SQL开始执行时间：20190723012123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190723012123
SQL开始执行时间：20190723012123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190723012134

20190723164611开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190723164611


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723164611
SQL开始执行时间：20190723164611



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723164611
SQL开始执行时间：20190723164611

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190723164611
SQL开始执行时间：20190723164611
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190723164611
SQL开始执行时间：20190723164611
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190723164626
SQL开始执行时间：20190723164626

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190723164626
SQL开始执行时间：20190723164626


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190723164637

20190724012117开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724012117


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190724012117
SQL开始执行时间：20190724012117



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724012117
SQL开始执行时间：20190724012117

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190724012117
SQL开始执行时间：20190724012117
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190724012117
SQL开始执行时间：20190724012117
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190724012136
SQL开始执行时间：20190724012136

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190724012136
SQL开始执行时间：20190724012136


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190724012147

20190724110609开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190724110609


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190724110609
SQL开始执行时间：20190724110609



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724110609
SQL开始执行时间：20190724110609

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190724110609
SQL开始执行时间：20190724110609
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190724110609
SQL开始执行时间：20190724110609
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190724110623
SQL开始执行时间：20190724110623

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190724110623
SQL开始执行时间：20190724110623


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190724110634

20190725012114开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725012114
SQL开始执行时间：20190725012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725012114
SQL开始执行时间：20190725012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190725012114
SQL开始执行时间：20190725012114
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190725012114
SQL开始执行时间：20190725012114
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190725012132
SQL开始执行时间：20190725012132

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190725012132
SQL开始执行时间：20190725012132


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190725012143

20190725133427开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190725133427


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725133428
SQL开始执行时间：20190725133428



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725133428
SQL开始执行时间：20190725133428

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190725133428
SQL开始执行时间：20190725133428
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190725133428
SQL开始执行时间：20190725133428
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190725133437
SQL开始执行时间：20190725133437

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190725133437
SQL开始执行时间：20190725133437


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190725133448

20190726012112开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726012112


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726012112
SQL开始执行时间：20190726012112



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726012112
SQL开始执行时间：20190726012112

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190726012112
SQL开始执行时间：20190726012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190726012112
SQL开始执行时间：20190726012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190726012124
SQL开始执行时间：20190726012124

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190726012124
SQL开始执行时间：20190726012124


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190726012137

20190726085626开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726085626


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726085626
SQL开始执行时间：20190726085626



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726085626
SQL开始执行时间：20190726085626

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190726085626
SQL开始执行时间：20190726085626
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190726085626
SQL开始执行时间：20190726085626
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190726085638
SQL开始执行时间：20190726085638

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190726085638
SQL开始执行时间：20190726085638


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190726085651

20190726151400开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726151400


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726151400
SQL开始执行时间：20190726151400



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726151400
SQL开始执行时间：20190726151400

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190726151400
SQL开始执行时间：20190726151400
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190726151400
SQL开始执行时间：20190726151400
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190726151413
SQL开始执行时间：20190726151413

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190726151413
SQL开始执行时间：20190726151413


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190726151425

20190727012115开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727012115


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190727012115
SQL开始执行时间：20190727012115



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190727012115
SQL开始执行时间：20190727012115

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190727012115
SQL开始执行时间：20190727012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190727012115
SQL开始执行时间：20190727012115
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190727012131
SQL开始执行时间：20190727012131

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190727012131
SQL开始执行时间：20190727012131


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190727012144

20190728012110开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728012110


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190728012110
SQL开始执行时间：20190728012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190728012110
SQL开始执行时间：20190728012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190728012110
SQL开始执行时间：20190728012110
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190728012110
SQL开始执行时间：20190728012110
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190728012119
SQL开始执行时间：20190728012119

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190728012119
SQL开始执行时间：20190728012119


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190728012132

20190729012109开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729012109


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729012109
SQL开始执行时间：20190729012109



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729012109
SQL开始执行时间：20190729012109

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190729012109
SQL开始执行时间：20190729012109
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190729012109
SQL开始执行时间：20190729012109
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190729012115
SQL开始执行时间：20190729012115

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190729012115
SQL开始执行时间：20190729012115


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190729012128

20190729111522开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111522


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729111522
SQL开始执行时间：20190729111522



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729111522
SQL开始执行时间：20190729111522

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190729111522
SQL开始执行时间：20190729111522
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190729111522
SQL开始执行时间：20190729111522
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190729111534
SQL开始执行时间：20190729111534

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190729111534
SQL开始执行时间：20190729111534


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190729111546

20190730012117开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730012117


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730012117
SQL开始执行时间：20190730012117



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730012117
SQL开始执行时间：20190730012117

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190730012118
SQL开始执行时间：20190730012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190730012118
SQL开始执行时间：20190730012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190730012133
SQL开始执行时间：20190730012133

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190730012133
SQL开始执行时间：20190730012133


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190730012146

20190730090856开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730090856


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730090856
SQL开始执行时间：20190730090856



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730090856
SQL开始执行时间：20190730090856

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190730090856
SQL开始执行时间：20190730090856
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190730090856
SQL开始执行时间：20190730090856
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190730090911
SQL开始执行时间：20190730090911

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190730090911
SQL开始执行时间：20190730090911


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190730090924

20190731012117开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731012117


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731012117
SQL开始执行时间：20190731012117



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731012117
SQL开始执行时间：20190731012117

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190731012117
SQL开始执行时间：20190731012117
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190731012117
SQL开始执行时间：20190731012117
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190731012134
SQL开始执行时间：20190731012134

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190731012134
SQL开始执行时间：20190731012134


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190731012149

20190731103851开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190731103851


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731103852
SQL开始执行时间：20190731103852



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731103852
SQL开始执行时间：20190731103852

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190731103852
SQL开始执行时间：20190731103852
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190731103852
SQL开始执行时间：20190731103852
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190731103903
SQL开始执行时间：20190731103903

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190731103903
SQL开始执行时间：20190731103903


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190731103917

20190801012118开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190801012119
SQL开始执行时间：20190801012119



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190801012119
SQL开始执行时间：20190801012119

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190801012119
SQL开始执行时间：20190801012119
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190801012119
SQL开始执行时间：20190801012119
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190801012136
SQL开始执行时间：20190801012136

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190801012136
SQL开始执行时间：20190801012136


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190801012151

20190802012114开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190802012115
SQL开始执行时间：20190802012115



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190802012115
SQL开始执行时间：20190802012115

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190802012115
SQL开始执行时间：20190802012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190802012115
SQL开始执行时间：20190802012115
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190802012130
SQL开始执行时间：20190802012130

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190802012130
SQL开始执行时间：20190802012130


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190802012146

20190803012116开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803012116


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190803012116
SQL开始执行时间：20190803012116



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190803012116
SQL开始执行时间：20190803012116

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190803012117
SQL开始执行时间：20190803012117
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190803012117
SQL开始执行时间：20190803012117
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190803012128
SQL开始执行时间：20190803012128

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190803012128
SQL开始执行时间：20190803012128


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190803012144

20190804012118开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190804012118
SQL开始执行时间：20190804012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190804012118
SQL开始执行时间：20190804012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190804012118
SQL开始执行时间：20190804012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190804012118
SQL开始执行时间：20190804012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190804012128
SQL开始执行时间：20190804012128

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190804012128
SQL开始执行时间：20190804012128


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190804012144

20190805012111开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805012111


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190805012111
SQL开始执行时间：20190805012111



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805012111
SQL开始执行时间：20190805012111

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190805012111
SQL开始执行时间：20190805012111
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190805012111
SQL开始执行时间：20190805012111
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190805012119
SQL开始执行时间：20190805012119

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190805012119
SQL开始执行时间：20190805012119


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190805012135

20190806012118开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190806012118
SQL开始执行时间：20190806012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806012118
SQL开始执行时间：20190806012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190806012118
SQL开始执行时间：20190806012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190806012118
SQL开始执行时间：20190806012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190806012129
SQL开始执行时间：20190806012129

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190806012129
SQL开始执行时间：20190806012129


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190806012144

20190807012115开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807012115


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190807012115
SQL开始执行时间：20190807012115



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807012115
SQL开始执行时间：20190807012115

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190807012115
SQL开始执行时间：20190807012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190807012115
SQL开始执行时间：20190807012115
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190807012128
SQL开始执行时间：20190807012128

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190807012128
SQL开始执行时间：20190807012128


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190807012144

20190808012112开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808012112


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808012112
SQL开始执行时间：20190808012112



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808012112
SQL开始执行时间：20190808012112

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190808012112
SQL开始执行时间：20190808012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190808012112
SQL开始执行时间：20190808012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190808012124
SQL开始执行时间：20190808012124

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190808012124
SQL开始执行时间：20190808012124


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190808012139

20190808093645开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190808093645


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808093645
SQL开始执行时间：20190808093645



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808093645
SQL开始执行时间：20190808093645

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190808093645
SQL开始执行时间：20190808093645
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190808093645
SQL开始执行时间：20190808093645
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190808093713
SQL开始执行时间：20190808093713

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190808093713
SQL开始执行时间：20190808093713


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190808093729

20190809012117开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809012117


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809012118
SQL开始执行时间：20190809012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809012118
SQL开始执行时间：20190809012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190809012118
SQL开始执行时间：20190809012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190809012118
SQL开始执行时间：20190809012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190809012149
SQL开始执行时间：20190809012149

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190809012149
SQL开始执行时间：20190809012149


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190809012205

20190809111453开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190809111453


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809111453
SQL开始执行时间：20190809111453



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809111453
SQL开始执行时间：20190809111453

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190809111453
SQL开始执行时间：20190809111453
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190809111453
SQL开始执行时间：20190809111453
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190809111512
SQL开始执行时间：20190809111512

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190809111512
SQL开始执行时间：20190809111512


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190809111528

20190809112536开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190809112536


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809112536
SQL开始执行时间：20190809112536



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809112536
SQL开始执行时间：20190809112536

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190809112536
SQL开始执行时间：20190809112536
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190809112536
SQL开始执行时间：20190809112536
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190809112555
SQL开始执行时间：20190809112555

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190809112555
SQL开始执行时间：20190809112555


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190809112611

20190810012116开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810012116


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190810012116
SQL开始执行时间：20190810012116



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190810012116
SQL开始执行时间：20190810012116

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190810012116
SQL开始执行时间：20190810012116
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190810012116
SQL开始执行时间：20190810012116
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190810012138
SQL开始执行时间：20190810012138

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190810012138
SQL开始执行时间：20190810012138


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190810012155

20190811012112开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811012112


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190811012112
SQL开始执行时间：20190811012112



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190811012112
SQL开始执行时间：20190811012112

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190811012112
SQL开始执行时间：20190811012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190811012112
SQL开始执行时间：20190811012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190811012122
SQL开始执行时间：20190811012122

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190811012122
SQL开始执行时间：20190811012122


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190811012139

20190812012122开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190812012123
SQL开始执行时间：20190812012123



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812012123
SQL开始执行时间：20190812012123

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190812012123
SQL开始执行时间：20190812012123
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190812012123
SQL开始执行时间：20190812012123
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190812012130
SQL开始执行时间：20190812012130

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190812012130
SQL开始执行时间：20190812012130


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190812012147

20190812090047开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190812090047


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190812090047
SQL开始执行时间：20190812090047



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812090047
SQL开始执行时间：20190812090047

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190812090047
SQL开始执行时间：20190812090047
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190812090047
SQL开始执行时间：20190812090047
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190812090102
SQL开始执行时间：20190812090102

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190812090102
SQL开始执行时间：20190812090102


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190812090119

20190813012116开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813012116


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813012116
SQL开始执行时间：20190813012116



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813012116
SQL开始执行时间：20190813012116

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190813012116
SQL开始执行时间：20190813012116
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190813012116
SQL开始执行时间：20190813012116
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190813012134
SQL开始执行时间：20190813012134

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190813012134
SQL开始执行时间：20190813012134


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190813012151

20190813111848开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190813111848


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813111849
SQL开始执行时间：20190813111849



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813111849
SQL开始执行时间：20190813111849

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190813111849
SQL开始执行时间：20190813111849
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190813111849
SQL开始执行时间：20190813111849
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190813111907
SQL开始执行时间：20190813111907

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190813111907
SQL开始执行时间：20190813111907


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190813111923

20190814012115开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814012115


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814012115
SQL开始执行时间：20190814012115



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814012115
SQL开始执行时间：20190814012115

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190814012115
SQL开始执行时间：20190814012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190814012116
SQL开始执行时间：20190814012116
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190814012136
SQL开始执行时间：20190814012136

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190814012136
SQL开始执行时间：20190814012136


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190814012152

20190814092558开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190814092558


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814092558
SQL开始执行时间：20190814092558



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814092558
SQL开始执行时间：20190814092558

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190814092558
SQL开始执行时间：20190814092558
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190814092558
SQL开始执行时间：20190814092558
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190814092618
SQL开始执行时间：20190814092618

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190814092618
SQL开始执行时间：20190814092618


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190814092635

20190814114351开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190814114351


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814114352
SQL开始执行时间：20190814114352



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814114352
SQL开始执行时间：20190814114352

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190814114353
SQL开始执行时间：20190814114353
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190814114353
SQL开始执行时间：20190814114353
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190814114949
SQL开始执行时间：20190814114949

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190814114949
SQL开始执行时间：20190814114949


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190814115006

20190815012118开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815012119
SQL开始执行时间：20190815012119



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815012119
SQL开始执行时间：20190815012119

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190815012120
SQL开始执行时间：20190815012120
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190815012120
SQL开始执行时间：20190815012120
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190815012721
SQL开始执行时间：20190815012721

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190815012721
SQL开始执行时间：20190815012721


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190815012738

20190815095623开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190815095623


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815095623
SQL开始执行时间：20190815095623



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815095623
SQL开始执行时间：20190815095623

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190815095623
SQL开始执行时间：20190815095623
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190815095623
SQL开始执行时间：20190815095623
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190815095636
SQL开始执行时间：20190815095636

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190815095636
SQL开始执行时间：20190815095636


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190815095654

20190816012113开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816012113


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190816012114
SQL开始执行时间：20190816012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190816012114
SQL开始执行时间：20190816012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190816012114
SQL开始执行时间：20190816012114
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190816012114
SQL开始执行时间：20190816012114
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190816012130
SQL开始执行时间：20190816012130

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190816012130
SQL开始执行时间：20190816012130


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190816012148

20190817012119开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817012119


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190817012119
SQL开始执行时间：20190817012119



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190817012119
SQL开始执行时间：20190817012119

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190817012119
SQL开始执行时间：20190817012119
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190817012120
SQL开始执行时间：20190817012120
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190817012135
SQL开始执行时间：20190817012135

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190817012135
SQL开始执行时间：20190817012135


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190817012153

20190818012111开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818012111


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190818012111
SQL开始执行时间：20190818012111



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190818012111
SQL开始执行时间：20190818012111

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190818012112
SQL开始执行时间：20190818012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190818012112
SQL开始执行时间：20190818012112
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190818012123
SQL开始执行时间：20190818012123

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190818012123
SQL开始执行时间：20190818012123


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190818012142

20190819012110开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819012110


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190819012110
SQL开始执行时间：20190819012110



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819012110
SQL开始执行时间：20190819012110

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190819012110
SQL开始执行时间：20190819012110
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190819012110
SQL开始执行时间：20190819012110
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190819012119
SQL开始执行时间：20190819012119

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190819012119
SQL开始执行时间：20190819012119


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190819012137

20190819142518开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190819142518


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190819142519
SQL开始执行时间：20190819142519



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819142519
SQL开始执行时间：20190819142519

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190819142519
SQL开始执行时间：20190819142519
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190819142519
SQL开始执行时间：20190819142519
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190819142536
SQL开始执行时间：20190819142536

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190819142536
SQL开始执行时间：20190819142536


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190819142554

20190820012120开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820012120


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820012120
SQL开始执行时间：20190820012120



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820012120
SQL开始执行时间：20190820012120

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190820012121
SQL开始执行时间：20190820012121
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190820012121
SQL开始执行时间：20190820012121
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190820012140
SQL开始执行时间：20190820012140

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190820012140
SQL开始执行时间：20190820012140


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190820012159

20190820085747开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820085747


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820085748
SQL开始执行时间：20190820085748



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820085748
SQL开始执行时间：20190820085748

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190820085748
SQL开始执行时间：20190820085748
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190820085748
SQL开始执行时间：20190820085748
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190820085808
SQL开始执行时间：20190820085808

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190820085808
SQL开始执行时间：20190820085808


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190820085827

20190821012118开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821012118
SQL开始执行时间：20190821012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821012118
SQL开始执行时间：20190821012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190821012118
SQL开始执行时间：20190821012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190821012118
SQL开始执行时间：20190821012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190821012131
SQL开始执行时间：20190821012131

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190821012131
SQL开始执行时间：20190821012131


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190821012150

20190821100413开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190821100413


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821100413
SQL开始执行时间：20190821100413



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821100413
SQL开始执行时间：20190821100413

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190821100413
SQL开始执行时间：20190821100413
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190821100413
SQL开始执行时间：20190821100413
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190821100426
SQL开始执行时间：20190821100426

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190821100426
SQL开始执行时间：20190821100426


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190821100445

20190822012130开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822012130


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822012131
SQL开始执行时间：20190822012131



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822012131
SQL开始执行时间：20190822012131

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190822012131
SQL开始执行时间：20190822012131
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190822012131
SQL开始执行时间：20190822012131
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190822012150
SQL开始执行时间：20190822012150

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190822012150
SQL开始执行时间：20190822012150


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190822012210

20190822091234开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190822091234


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822091234
SQL开始执行时间：20190822091234



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822091234
SQL开始执行时间：20190822091234

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190822091234
SQL开始执行时间：20190822091234
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190822091234
SQL开始执行时间：20190822091234
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190822091253
SQL开始执行时间：20190822091253

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190822091254
SQL开始执行时间：20190822091254


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190822091313

20190823012117开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823012117


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823012117
SQL开始执行时间：20190823012117



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823012117
SQL开始执行时间：20190823012117

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190823012117
SQL开始执行时间：20190823012117
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190823012117
SQL开始执行时间：20190823012117
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190823012138
SQL开始执行时间：20190823012138

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190823012138
SQL开始执行时间：20190823012138


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190823012158

20190823092003开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190823092003


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823092004
SQL开始执行时间：20190823092004



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823092004
SQL开始执行时间：20190823092004

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190823092004
SQL开始执行时间：20190823092004
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190823092004
SQL开始执行时间：20190823092004
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190823092021
SQL开始执行时间：20190823092021

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190823092021
SQL开始执行时间：20190823092021


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190823092040

20190824012118开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190824012118
SQL开始执行时间：20190824012118



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190824012118
SQL开始执行时间：20190824012118

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190824012118
SQL开始执行时间：20190824012118
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190824012118
SQL开始执行时间：20190824012118
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190824012138
SQL开始执行时间：20190824012138

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190824012138
SQL开始执行时间：20190824012138


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190824012158

20190825012114开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825012114


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190825012114
SQL开始执行时间：20190825012114



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190825012114
SQL开始执行时间：20190825012114

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190825012114
SQL开始执行时间：20190825012114
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190825012114
SQL开始执行时间：20190825012114
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190825012127
SQL开始执行时间：20190825012127

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190825012127
SQL开始执行时间：20190825012127


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190825012147

20190826012112开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826012112


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826012112
SQL开始执行时间：20190826012112



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826012112
SQL开始执行时间：20190826012112

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190826012112
SQL开始执行时间：20190826012112
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190826012113
SQL开始执行时间：20190826012113
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190826012122
SQL开始执行时间：20190826012122

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190826012122
SQL开始执行时间：20190826012122


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190826012142

20190826092941开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190826092941


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826092941
SQL开始执行时间：20190826092941



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826092941
SQL开始执行时间：20190826092941

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190826092941
SQL开始执行时间：20190826092941
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190826092941
SQL开始执行时间：20190826092941
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190826092955
SQL开始执行时间：20190826092955

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190826092955
SQL开始执行时间：20190826092955


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190826093015

20190827012125开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827012125


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827012125
SQL开始执行时间：20190827012125



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827012125
SQL开始执行时间：20190827012125

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190827012125
SQL开始执行时间：20190827012125
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190827012125
SQL开始执行时间：20190827012125
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190827012144
SQL开始执行时间：20190827012144

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190827012144
SQL开始执行时间：20190827012144


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190827012205

20190827092511开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190827092511


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827092511
SQL开始执行时间：20190827092511



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827092511
SQL开始执行时间：20190827092511

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190827092511
SQL开始执行时间：20190827092511
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190827092511
SQL开始执行时间：20190827092511
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190827092525
SQL开始执行时间：20190827092525

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190827092525
SQL开始执行时间：20190827092525


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190827092545

20190828012123开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828012123


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828012123
SQL开始执行时间：20190828012123



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828012123
SQL开始执行时间：20190828012123

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190828012123
SQL开始执行时间：20190828012123
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190828012123
SQL开始执行时间：20190828012123
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190828012141
SQL开始执行时间：20190828012141

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190828012141
SQL开始执行时间：20190828012141


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190828012203

20190828093732开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190828093732


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828093732
SQL开始执行时间：20190828093732



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828093732
SQL开始执行时间：20190828093732

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190828093733
SQL开始执行时间：20190828093733
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190828093733
SQL开始执行时间：20190828093733
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190828093750
SQL开始执行时间：20190828093750

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190828093750
SQL开始执行时间：20190828093750


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190828093811

20190829012122开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190829012122
SQL开始执行时间：20190829012122



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190829012122
SQL开始执行时间：20190829012122

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190829012122
SQL开始执行时间：20190829012122
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190829012122
SQL开始执行时间：20190829012122
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190829012145
SQL开始执行时间：20190829012145

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190829012145
SQL开始执行时间：20190829012145


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190829012206

20190830012122开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190830012122
SQL开始执行时间：20190830012122



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190830012122
SQL开始执行时间：20190830012122

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190830012122
SQL开始执行时间：20190830012122
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190830012122
SQL开始执行时间：20190830012122
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190830012140
SQL开始执行时间：20190830012140

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190830012140
SQL开始执行时间：20190830012140


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190830012202

20190831012151开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831012151


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190831012152
SQL开始执行时间：20190831012152



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190831012152
SQL开始执行时间：20190831012152

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190831012152
SQL开始执行时间：20190831012152
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190831012152
SQL开始执行时间：20190831012152
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190831012212
SQL开始执行时间：20190831012212

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190831012212
SQL开始执行时间：20190831012212


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190831012236

20190901012115开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901012115


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-08-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190901012115
SQL开始执行时间：20190901012115



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190901012115
SQL开始执行时间：20190901012115

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190901012115
SQL开始执行时间：20190901012115
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190901012115
SQL开始执行时间：20190901012115
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190901012132
SQL开始执行时间：20190901012132

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190901012132
SQL开始执行时间：20190901012132


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190901012156

20190902012136开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902012136


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902012136
SQL开始执行时间：20190902012136



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902012136
SQL开始执行时间：20190902012136

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190902012136
SQL开始执行时间：20190902012136
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190902012136
SQL开始执行时间：20190902012136
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190902012147
SQL开始执行时间：20190902012147

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190902012147
SQL开始执行时间：20190902012147


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190902012211

20190902155234开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902155234


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902155236
SQL开始执行时间：20190902155236



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902155236
SQL开始执行时间：20190902155236

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190902155237
SQL开始执行时间：20190902155237
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190902155239
SQL开始执行时间：20190902155239
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190902160235
SQL开始执行时间：20190902160235

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190902160236
SQL开始执行时间：20190902160236


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190902160300

20190903012118开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190903012120
SQL开始执行时间：20190903012120



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190903012120
SQL开始执行时间：20190903012120

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190903012121
SQL开始执行时间：20190903012121
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190903012123
SQL开始执行时间：20190903012123
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190903013146
SQL开始执行时间：20190903013146

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190903013147
SQL开始执行时间：20190903013147


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190903013223

20190904012121开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904012121


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904012121
SQL开始执行时间：20190904012121



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904012121
SQL开始执行时间：20190904012121

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190904012121
SQL开始执行时间：20190904012121
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190904012121
SQL开始执行时间：20190904012121
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190904012137
SQL开始执行时间：20190904012137

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190904012137
SQL开始执行时间：20190904012137


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190904012201

20190904183125开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190904183125


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904183125
SQL开始执行时间：20190904183125



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904183125
SQL开始执行时间：20190904183125

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190904183125
SQL开始执行时间：20190904183125
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190904183125
SQL开始执行时间：20190904183125
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190904183147
SQL开始执行时间：20190904183147

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190904183147
SQL开始执行时间：20190904183147


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190904183211

20190905012118开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905012118


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905012119
SQL开始执行时间：20190905012119



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905012119
SQL开始执行时间：20190905012119

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190905012119
SQL开始执行时间：20190905012119
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190905012119
SQL开始执行时间：20190905012119
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190905012143
SQL开始执行时间：20190905012143

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190905012143
SQL开始执行时间：20190905012143


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190905012208

20190905110529开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190905110529


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905110530
SQL开始执行时间：20190905110530



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905110530
SQL开始执行时间：20190905110530

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190905110530
SQL开始执行时间：20190905110530
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190905110530
SQL开始执行时间：20190905110530
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190905110554
SQL开始执行时间：20190905110554

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190905110554
SQL开始执行时间：20190905110554


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190905110622

20190906012126开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906012126


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190906012126
SQL开始执行时间：20190906012126



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190906012126
SQL开始执行时间：20190906012126

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190906012127
SQL开始执行时间：20190906012127
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190906012127
SQL开始执行时间：20190906012127
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190906012155
SQL开始执行时间：20190906012155

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190906012155
SQL开始执行时间：20190906012155


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190906012220

20190907012122开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190907012123
SQL开始执行时间：20190907012123



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190907012123
SQL开始执行时间：20190907012123

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190907012123
SQL开始执行时间：20190907012123
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190907012123
SQL开始执行时间：20190907012123
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190907012141
SQL开始执行时间：20190907012141

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190907012141
SQL开始执行时间：20190907012141


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190907012207

20190908012121开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908012121


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190908012121
SQL开始执行时间：20190908012121



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190908012121
SQL开始执行时间：20190908012121

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190908012121
SQL开始执行时间：20190908012121
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190908012121
SQL开始执行时间：20190908012121
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190908012135
SQL开始执行时间：20190908012135

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190908012135
SQL开始执行时间：20190908012135


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190908012201

20190909012119开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909012119


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909012119
SQL开始执行时间：20190909012119



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909012119
SQL开始执行时间：20190909012119

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190909012119
SQL开始执行时间：20190909012119
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190909012119
SQL开始执行时间：20190909012119
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190909012131
SQL开始执行时间：20190909012131

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190909012131
SQL开始执行时间：20190909012131


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190909012156

20190909090511开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190909090511


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909090512
SQL开始执行时间：20190909090512



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909090512
SQL开始执行时间：20190909090512

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190909090512
SQL开始执行时间：20190909090512
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190909090512
SQL开始执行时间：20190909090512
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190909090532
SQL开始执行时间：20190909090532

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190909090532
SQL开始执行时间：20190909090532


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190909090557

20190910012123开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910012123


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910012124
SQL开始执行时间：20190910012124



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910012124
SQL开始执行时间：20190910012124

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190910012124
SQL开始执行时间：20190910012124
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190910012124
SQL开始执行时间：20190910012124
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190910012147
SQL开始执行时间：20190910012147

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190910012147
SQL开始执行时间：20190910012147


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190910012213

20190910101453开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190910101453


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910101454
SQL开始执行时间：20190910101454



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910101454
SQL开始执行时间：20190910101454

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190910101454
SQL开始执行时间：20190910101454
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190910101454
SQL开始执行时间：20190910101454
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190910101509
SQL开始执行时间：20190910101509

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190910101509
SQL开始执行时间：20190910101509


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190910101534

20190911012123开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911012123


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190911012123
SQL开始执行时间：20190911012123



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190911012123
SQL开始执行时间：20190911012123

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190911012123
SQL开始执行时间：20190911012123
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190911012124
SQL开始执行时间：20190911012124
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190911012142
SQL开始执行时间：20190911012142

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190911012142
SQL开始执行时间：20190911012142


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190911012207

20190912012129开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912012129


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190912012129
SQL开始执行时间：20190912012129



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190912012129
SQL开始执行时间：20190912012129

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190912012129
SQL开始执行时间：20190912012129
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190912012129
SQL开始执行时间：20190912012129
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190912012148
SQL开始执行时间：20190912012148

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190912012148
SQL开始执行时间：20190912012148


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190912012215

20190913012126开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913012126


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190913012126
SQL开始执行时间：20190913012126



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190913012126
SQL开始执行时间：20190913012126

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190913012127
SQL开始执行时间：20190913012127
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190913012127
SQL开始执行时间：20190913012127
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190913012146
SQL开始执行时间：20190913012146

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190913012146
SQL开始执行时间：20190913012146


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190913012213

20190916084545开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916084545


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916084546
SQL开始执行时间：20190916084546



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916084546
SQL开始执行时间：20190916084546

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916084546
SQL开始执行时间：20190916084546
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916084546
SQL开始执行时间：20190916084546
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916084606
SQL开始执行时间：20190916084606

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916084606
SQL开始执行时间：20190916084606


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916084632

20190916093407开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916093407


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916093407
SQL开始执行时间：20190916093407



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916093407
SQL开始执行时间：20190916093407

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916093407
SQL开始执行时间：20190916093407
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916093407
SQL开始执行时间：20190916093407
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916093429
SQL开始执行时间：20190916093429

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916093429
SQL开始执行时间：20190916093429


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916093456

20190916100546开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916100546


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916100547
SQL开始执行时间：20190916100547



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916100547
SQL开始执行时间：20190916100547

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916100547
SQL开始执行时间：20190916100547
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916100547
SQL开始执行时间：20190916100547
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916100612
SQL开始执行时间：20190916100612

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916100612
SQL开始执行时间：20190916100612


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916100639

20190916131636开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916131636


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916131637
SQL开始执行时间：20190916131637



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916131637
SQL开始执行时间：20190916131637

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916131637
SQL开始执行时间：20190916131637
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916131637
SQL开始执行时间：20190916131637
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916131726
SQL开始执行时间：20190916131726

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916131726
SQL开始执行时间：20190916131726


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916131751

20190916160411开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916160411


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916160412
SQL开始执行时间：20190916160412



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916160412
SQL开始执行时间：20190916160412

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916160412
SQL开始执行时间：20190916160412
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916160412
SQL开始执行时间：20190916160412
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916160501
SQL开始执行时间：20190916160501

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916160501
SQL开始执行时间：20190916160501


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916160527

20190916195931开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190916195931


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916195932
SQL开始执行时间：20190916195932



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916195932
SQL开始执行时间：20190916195932

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190916195934
SQL开始执行时间：20190916195934
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190916195935
SQL开始执行时间：20190916195935
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190916195935
SQL开始执行时间：20190916195935

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916195936
SQL开始执行时间：20190916195936


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190916200002

20190917012130开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917012130


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917012130
SQL开始执行时间：20190917012130



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917012130
SQL开始执行时间：20190917012130

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190917012131
SQL开始执行时间：20190917012131
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190917012132
SQL开始执行时间：20190917012132
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190917012902
SQL开始执行时间：20190917012902

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190917012902
SQL开始执行时间：20190917012902


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190917012929

20190917092315开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190917092315


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917092316
SQL开始执行时间：20190917092316



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917092316
SQL开始执行时间：20190917092316

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190917092316
SQL开始执行时间：20190917092316
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190917092316
SQL开始执行时间：20190917092316
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190917092358
SQL开始执行时间：20190917092358

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190917092358
SQL开始执行时间：20190917092358


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190917092425

20190918012132开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918012132


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918012132
SQL开始执行时间：20190918012132



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918012132
SQL开始执行时间：20190918012132

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190918012132
SQL开始执行时间：20190918012132
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190918012132
SQL开始执行时间：20190918012132
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190918012218
SQL开始执行时间：20190918012218

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190918012218
SQL开始执行时间：20190918012218


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190918012245

20190918094003开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190918094003


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918094004
SQL开始执行时间：20190918094004



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918094004
SQL开始执行时间：20190918094004

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190918094004
SQL开始执行时间：20190918094004
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190918094004
SQL开始执行时间：20190918094004
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190918094049
SQL开始执行时间：20190918094049

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190918094049
SQL开始执行时间：20190918094049


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190918094116

20190919012128开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919012128


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919012128
SQL开始执行时间：20190919012128



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919012128
SQL开始执行时间：20190919012128

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190919012129
SQL开始执行时间：20190919012129
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190919012129
SQL开始执行时间：20190919012129
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190919012218
SQL开始执行时间：20190919012218

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190919012218
SQL开始执行时间：20190919012218


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190919012245

20190919101844开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190919101844


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919101845
SQL开始执行时间：20190919101845



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919101845
SQL开始执行时间：20190919101845

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190919101845
SQL开始执行时间：20190919101845
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190919101845
SQL开始执行时间：20190919101845
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190919101934
SQL开始执行时间：20190919101934

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190919101934
SQL开始执行时间：20190919101934


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190919102001

20190920012127开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920012127


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190920012128
SQL开始执行时间：20190920012128



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920012128
SQL开始执行时间：20190920012128

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190920012128
SQL开始执行时间：20190920012128
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190920012128
SQL开始执行时间：20190920012128
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190920012221
SQL开始执行时间：20190920012221

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190920012221
SQL开始执行时间：20190920012221


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190920012249

20190920101123开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190920101123


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190920101124
SQL开始执行时间：20190920101124



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920101124
SQL开始执行时间：20190920101124

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190920101124
SQL开始执行时间：20190920101124
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190920101124
SQL开始执行时间：20190920101124
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190920101216
SQL开始执行时间：20190920101216

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190920101216
SQL开始执行时间：20190920101216


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190920101244

20190921012128开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921012128


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190921012129
SQL开始执行时间：20190921012129



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190921012129
SQL开始执行时间：20190921012129

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190921012129
SQL开始执行时间：20190921012129
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190921012129
SQL开始执行时间：20190921012129
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190921012224
SQL开始执行时间：20190921012224

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190921012224
SQL开始执行时间：20190921012224


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190921012252

20190922012122开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190922012122
SQL开始执行时间：20190922012122



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190922012122
SQL开始执行时间：20190922012122

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190922012122
SQL开始执行时间：20190922012122
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190922012122
SQL开始执行时间：20190922012122
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190922012138
SQL开始执行时间：20190922012138

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190922012138
SQL开始执行时间：20190922012138


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190922012206

20190923012122开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923012122


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923012122
SQL开始执行时间：20190923012122



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923012122
SQL开始执行时间：20190923012122

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190923012122
SQL开始执行时间：20190923012122
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190923012122
SQL开始执行时间：20190923012122
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190923012135
SQL开始执行时间：20190923012135

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190923012135
SQL开始执行时间：20190923012135


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190923012203

20190923113847开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190923113847


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923113848
SQL开始执行时间：20190923113848



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923113848
SQL开始执行时间：20190923113848

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190923113848
SQL开始执行时间：20190923113848
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190923113848
SQL开始执行时间：20190923113848
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190923113944
SQL开始执行时间：20190923113944

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190923113944
SQL开始执行时间：20190923113944


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190923114013

20190924012130开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924012130


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924012131
SQL开始执行时间：20190924012131



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924012131
SQL开始执行时间：20190924012131

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190924012131
SQL开始执行时间：20190924012131
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190924012131
SQL开始执行时间：20190924012131
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190924012234
SQL开始执行时间：20190924012234

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190924012234
SQL开始执行时间：20190924012234


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190924012303

20190924094210开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190924094210


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924094211
SQL开始执行时间：20190924094211



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924094211
SQL开始执行时间：20190924094211

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190924094211
SQL开始执行时间：20190924094211
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190924094211
SQL开始执行时间：20190924094211
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190924094313
SQL开始执行时间：20190924094313

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190924094313
SQL开始执行时间：20190924094313


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190924094342

20190925012147开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925012147


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925012147
SQL开始执行时间：20190925012147



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925012147
SQL开始执行时间：20190925012147

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190925012147
SQL开始执行时间：20190925012147
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190925012147
SQL开始执行时间：20190925012147
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190925012255
SQL开始执行时间：20190925012255

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190925012255
SQL开始执行时间：20190925012255


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190925012326

20190925113734开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190925113734


create temporary table pdm.dispatch_order_pre as 
select *
  from edw.dispatch_order a
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925113734
SQL开始执行时间：20190925113734



delete from pdm.dispatch_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925113734
SQL开始执行时间：20190925113734

CREATE INDEX index_dispatch_order_pre_db ON pdm.dispatch_order_pre(db)
;
SQL结束执行时间：20190925113735
SQL开始执行时间：20190925113735
CREATE INDEX index_dispatch_order_pre_dlid ON pdm.dispatch_order_pre(dlid)
;
SQL结束执行时间：20190925113735
SQL开始执行时间：20190925113735
delete from pdm.dispatch_order where concat(dlid,db) in (select concat(dlid,db) from  pdm.dispatch_order_pre)
;
SQL结束执行时间：20190925113841
SQL开始执行时间：20190925113841

insert into pdm.dispatch_order
select a.cdlcode
      ,a.dlid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_588_2019' then '湖北奥博特'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_889_2019' then '四川美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iquantity
      ,a.itaxunitprice
      ,a.itax
      ,a.isum
      ,a.true_itemcode
      ,a.true_itemname
      ,a.cstcode
      ,a.csocode
      ,a.cvouchtype
      ,a.isale
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.bsaleoutcreatebill
      ,a.autoid
      ,a.isosid
      ,a.cdefine22
      ,a.foutquantity
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,localtimestamp()
  from pdm.dispatch_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join edw.map_inventory e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190925113841
SQL开始执行时间：20190925113841


delete from pdm.dispatch_order where concat(db,dlid) in (select concat(db,dlid) from edw.dispatch_order where state = '无效') 
;
SQL结束执行时间：20190925113911
